<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: CodeGraph User Guide">
  <meta name="keywords" content="CodeGraph, documentation, guides">

  <meta property="og:title" content="CodeGraph User Guide - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: CodeGraph User Guide">
  <meta property="og:type" content="article">

  <title>CodeGraph User Guide - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Problems</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Solution</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Features</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Integrations</a></li>
        <li><a href="../index.html" class="nav-link active">Documentation</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/guides/TUI_USER_GUIDE.html" class="active">EN</a>
          <a href="../../ru/guides/TUI_USER_GUIDE.html" class="">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Toggle theme">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Request Demo</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Problems</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Solution</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Features</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Integrations</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Documentation</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Request Demo</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Getting Started</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Overview</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Configuration Guide</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Installation Guide</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">User Guides</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Overview</a></li>
        <li><a href="BENCHMARK_GUIDE.html">Benchmark Framework Guide</a></li>
        <li><a href="CLI_GUIDE.html">CLI Guide</a></li>
        <li><a href="CODE_REVIEW.html">Automated Code Review</a></li>
        <li><a href="CPG_EXPORT.html">CPG Export Guide</a></li>
        <li><a href="MONITORING.html">Monitoring Guide</a></li>
        <li><a href="PROGRAMMATIC_GUIDE.html">User Guide</a></li>
        <li><a href="PROJECT_IMPORT.html">Importing a New Codebase</a></li>
        <li><a href="QUICK_REFERENCE.html">CodeGraph Quick Reference</a></li>
        <li><a href="REFACTORING.html">Refactoring Analysis Guide</a></li>
        <li><a href="SCENARIOS.html">Workflow Scenarios Guide</a></li>
        <li><a href="TROUBLESHOOTING.html">Troubleshooting Guide</a></li>
        <li><a href="TUI_USER_GUIDE.html" class="active">CodeGraph User Guide</a></li>
        <li><a href="01-onboarding.html">Scenario 01: Developer Onboarding</a></li>
        <li><a href="02-security-audit.html">Scenario 02: Security Audit</a></li>
        <li><a href="03-documentation.html">Scenario 03: Documentation Generation</a></li>
        <li><a href="04-feature-development.html">Scenario 04: Feature Development</a></li>
        <li><a href="05-refactoring.html">Scenario 05: Refactoring</a></li>
        <li><a href="06-performance.html">Scenario 06: Performance Analysis</a></li>
        <li><a href="07-test-coverage.html">Scenario 07: Test Coverage</a></li>
        <li><a href="08-compliance.html">Scenario 08: Compliance Checking</a></li>
        <li><a href="09-code-review.html">Scenario 09: Code Review</a></li>
        <li><a href="10-cross-repo.html">Scenario 10: Cross-Repository Analysis</a></li>
        <li><a href="11-architecture.html">Scenario 11: Architecture Analysis</a></li>
        <li><a href="12-tech-debt.html">Scenario 12: Tech Debt Assessment</a></li>
        <li><a href="13-mass-refactoring.html">Scenario 13: Mass Refactoring</a></li>
        <li><a href="14-incident-response.html">Scenario 14: Security Incident Response</a></li>
        <li><a href="15-debugging.html">Scenario 15: Debugging Assistance</a></li>
        <li><a href="16-entry-points.html">Scenario 16: Entry Point Discovery</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Reference</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Overview</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Integrations</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Overview</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Technical Reference</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../reference/index.html">Overview</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Overview</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Documentation</a>
        <span>/</span>
        <a href="index.html">User Guides</a>
        <span>/</span>
        <span>CodeGraph User Guide</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>CodeGraph User Guide</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="codegraph-user-guide">CodeGraph User Guide<a class="heading-anchor" href="#codegraph-user-guide" title="Link to this section">&para;</a></h1>
<blockquote class="callout">
<p>Comprehensive documentation for code analysis using Code Property Graphs</p>
</blockquote>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="heading-anchor" href="#table-of-contents" title="Link to this section">&para;</a></h2>
<ol>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#developer-scenarios">Developer Scenarios</a></li>
<li><a href="#qatester-scenarios">QA/Tester Scenarios</a></li>
<li><a href="#security-specialist-scenarios">Security Specialist Scenarios</a>
   - <a href="#d3fend-source-code-hardening">D3FEND Source Code Hardening</a></li>
<li><a href="#technical-writer-scenarios">Technical Writer Scenarios</a></li>
<li><a href="#tui-command-reference">TUI Command Reference</a></li>
<li><a href="#configuration-guide">Configuration Guide</a></li>
<li><a href="#appendix-all-16-scenarios">Appendix: All 16 Scenarios</a></li>
<li><a href="#security-audit-reports-cli">Security Audit Reports (CLI)</a></li>
<li><a href="#common-workflows">Common Workflows</a></li>
<li><a href="#themes">Themes</a></li>
<li><a href="#sessions">Sessions</a></li>
<li><a href="#tips--tricks">Tips &amp; Tricks</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ol>
<hr />
<h2 id="quick-start">Quick Start<a class="heading-anchor" href="#quick-start" title="Link to this section">&para;</a></h2>
<h3 id="installation">Installation<a class="heading-anchor" href="#installation" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Clone and install dependencies</span>
<span class="nb">cd</span><span class="w"> </span>codegraph
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c1"># Set up API credentials (choose one)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">GIGACHAT_AUTH_KEY</span><span class="o">=</span><span class="s2">&quot;your-key-here&quot;</span><span class="w">    </span><span class="c1"># GigaChat (Sber)</span>
<span class="c1"># OR</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OPENAI_API_KEY</span><span class="o">=</span><span class="s2">&quot;your-key-here&quot;</span><span class="w">        </span><span class="c1"># OpenAI</span>
</code></pre></div>

<h3 id="launch-the-tui">Launch the TUI<a class="heading-anchor" href="#launch-the-tui" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>src.tui.app
</code></pre></div>

<h3 id="your-first-query">Your First Query<a class="heading-anchor" href="#your-first-query" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚  CodeGraph Interactive Console                          â”‚
â”‚  Type /help for commands, /exit to quit                 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Where is the function heap_insert defined?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ heap_insert is defined in:            â”‚
â”‚   src/backend/access/heap/heapam.c    â”‚
â”‚   Line: 2156                          â”‚
â”‚                                       â”‚
â”‚ Signature:                            â”‚
â”‚   void heap_insert(Relation relation, â”‚
â”‚                    HeapTuple tup,     â”‚
â”‚                    CommandId cid,     â”‚
â”‚                    ...)               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre></div>

<h3 id="essential-commands">Essential Commands<a class="heading-anchor" href="#essential-commands" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/help</code></td>
<td>Show all available commands</td>
</tr>
<tr>
<td><code>/scenarios</code></td>
<td>List 16 analysis scenarios</td>
</tr>
<tr>
<td><code>/select 02</code></td>
<td>Switch to Security Audit mode</td>
</tr>
<tr>
<td><code>/project</code></td>
<td>Switch between CPG projects</td>
</tr>
<tr>
<td><code>/review git</code></td>
<td>Review current code changes</td>
</tr>
<tr>
<td><code>/stat</code></td>
<td>Show database statistics</td>
</tr>
<tr>
<td><code>/exit</code></td>
<td>Save session and exit</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="developer-scenarios">Developer Scenarios<a class="heading-anchor" href="#developer-scenarios" title="Link to this section">&para;</a></h2>
<h3 id="day-1-codebase-onboarding">Day 1: Codebase Onboarding<a class="heading-anchor" href="#day-1-codebase-onboarding" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> New developer joins the team, needs to understand codebase structure quickly.</p>
<h4 id="step-1-select-onboarding-scenario">Step 1: Select Onboarding Scenario<a class="heading-anchor" href="#step-1-select-onboarding-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 01
</code></pre></div>

<h4 id="step-2-ask-overview-questions">Step 2: Ask Overview Questions<a class="heading-anchor" href="#step-2-ask-overview-questions" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nv">What</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">executor</span><span class="w"> </span><span class="nv">subsystem</span>?

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w"> </span><span class="nv">Answer</span><span class="w"> </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">executor</span><span class="w"> </span><span class="nv">subsystem</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">responsible</span><span class="w"> </span>â”‚
â”‚<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">executing</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="nv">plans</span><span class="w"> </span><span class="nv">generated</span><span class="w">   </span>â”‚
â”‚<span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">planner</span>.<span class="w">                       </span>â”‚
â”‚<span class="w">                                       </span>â”‚
â”‚<span class="w"> </span><span class="nv">Key</span><span class="w"> </span><span class="nv">components</span>:<span class="w">                       </span>â”‚
â”‚<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nv">ExecutorStart</span>:<span class="w"> </span><span class="nv">Initialize</span><span class="w"> </span><span class="nv">state</span><span class="w">   </span>â”‚
â”‚<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nv">ExecutorRun</span>:<span class="w"> </span><span class="nv">Main</span><span class="w"> </span><span class="nv">execution</span><span class="w"> </span><span class="k">loop</span><span class="w">  </span>â”‚
â”‚<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nv">ExecutorEnd</span>:<span class="w"> </span><span class="nv">Cleanup</span><span class="w"> </span><span class="nv">resources</span><span class="w">    </span>â”‚
â”‚<span class="w">                                       </span>â”‚
â”‚<span class="w"> </span><span class="nv">Entry</span><span class="w"> </span><span class="nv">point</span>:<span class="w"> </span><span class="nv">src</span><span class="o">/</span><span class="nv">backend</span><span class="o">/</span><span class="nv">executor</span><span class="o">/</span><span class="w">    </span>â”‚
â”‚<span class="w">              </span><span class="nv">execMain</span>.<span class="nv">c</span><span class="w">               </span>â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="o">&gt;</span><span class="w"> </span><span class="nv">What</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="nv">entry</span><span class="w"> </span><span class="nv">points</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">executor</span>?

<span class="o">&gt;</span><span class="w"> </span><span class="k">Show</span><span class="w"> </span><span class="nv">me</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">architecture</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="nv">execution</span>
</code></pre></div>

<h4 id="step-3-dive-into-specifics">Step 3: Dive into Specifics<a class="heading-anchor" href="#step-3-dive-into-specifics" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nv">What</span><span class="w"> </span><span class="nv">does</span><span class="w"> </span><span class="nv">ExecProcNode</span><span class="w"> </span><span class="k">do</span>?
<span class="o">&gt;</span><span class="w"> </span><span class="nv">Who</span><span class="w"> </span><span class="nv">calls</span><span class="w"> </span><span class="nv">ExecutorRun</span>?
<span class="o">&gt;</span><span class="w"> </span><span class="nv">Explain</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">relationship</span><span class="w"> </span><span class="nv">between</span><span class="w"> </span><span class="nv">Plan</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">PlanState</span>
</code></pre></div>

<h4 id="real-world-example-understanding-memory-management">Real-World Example: Understanding Memory Management<a class="heading-anchor" href="#real-world-example-understanding-memory-management" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nv">How</span><span class="w"> </span><span class="nv">does</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span><span class="nv">allocation</span><span class="w"> </span><span class="nv">work</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">PostgreSQL</span>?

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w"> </span><span class="nv">Answer</span><span class="w"> </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚<span class="w"> </span><span class="nv">PostgreSQL</span><span class="w"> </span><span class="nv">uses</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span><span class="nv">contexts</span><span class="w"> </span><span class="k">for</span><span class="w">   </span>â”‚
â”‚<span class="w"> </span><span class="nv">hierarchical</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span><span class="nv">management</span>:<span class="w">       </span>â”‚
â”‚<span class="w">                                       </span>â”‚
â”‚<span class="w"> </span><span class="nv">Key</span><span class="w"> </span><span class="nv">functions</span>:<span class="w">                        </span>â”‚
â”‚<span class="w">   </span><span class="nv">palloc</span><span class="ss">()</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Allocate</span><span class="w"> </span><span class="nv">memory</span><span class="w">         </span>â”‚
â”‚<span class="w">   </span><span class="nv">pfree</span><span class="ss">()</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nv">Free</span><span class="w"> </span><span class="nv">memory</span><span class="w">             </span>â”‚
â”‚<span class="w">   </span><span class="nv">MemoryContextCreate</span><span class="ss">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">New</span><span class="w"> </span><span class="nv">context</span><span class="w"> </span>â”‚
â”‚<span class="w">   </span><span class="nv">MemoryContextReset</span><span class="ss">()</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Bulk</span><span class="w"> </span><span class="nv">free</span><span class="w">   </span>â”‚
â”‚<span class="w">                                       </span>â”‚
â”‚<span class="w"> </span><span class="nv">Main</span><span class="w"> </span><span class="nv">contexts</span>:<span class="w">                        </span>â”‚
â”‚<span class="w">   </span><span class="nv">TopMemoryContext</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Root</span><span class="w"> </span><span class="nv">context</span><span class="w">     </span>â”‚
â”‚<span class="w">   </span><span class="nv">CurrentMemoryContext</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Active</span><span class="w"> </span><span class="nv">ctx</span><span class="w">   </span>â”‚
â”‚<span class="w">   </span><span class="nv">MessageContext</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Per</span><span class="o">-</span><span class="nv">message</span><span class="w">        </span>â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre></div>

<hr />
<h3 id="finding-function-definitions">Finding Function Definitions<a class="heading-anchor" href="#finding-function-definitions" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Developer needs to locate function implementations.</p>
<h4 id="quick-definition-search">Quick Definition Search<a class="heading-anchor" href="#quick-definition-search" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Where is palloc defined?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ palloc is defined in:                 â”‚
â”‚   src/backend/utils/mmgr/mcxt.c:1089  â”‚
â”‚                                       â”‚
â”‚ Signature:                            â”‚
â”‚   void *palloc(Size size)             â”‚
â”‚                                       â”‚
â”‚ Related functions:                    â”‚
â”‚   palloc0(), palloc_extended(),       â”‚
â”‚   repalloc(), pfree()                 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre></div>

<h4 id="with-call-graph">With Call Graph<a class="heading-anchor" href="#with-call-graph" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Show</span><span class="w"> </span><span class="n">me</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">callers</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">palloc</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Callers</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">heap_form_tuple</span><span class="p">()</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">ExecStoreTuple</span><span class="p">()</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">construct_array</span><span class="p">()</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">4.</span><span class="w"> </span><span class="n">pnstrdup</span><span class="p">()</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="n">SPI_connect</span><span class="p">()</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="p">(</span><span class="n">showing</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">847</span><span class="w"> </span><span class="n">callers</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">What</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">LWLockAcquire</span><span class="w"> </span><span class="n">call</span><span class="err">?</span>
</code></pre></div>

<h4 id="trace-data-flow">Trace Data Flow<a class="heading-anchor" href="#trace-data-flow" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">How does data flow from pg_parse_query to executor?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Data Flow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ pg_parse_query()                      â”‚
â”‚     â†“                                 â”‚
â”‚ pg_analyze_and_rewrite()              â”‚
â”‚     â†“                                 â”‚
â”‚ pg_plan_queries()                     â”‚
â”‚     â†“                                 â”‚
â”‚ PortalRun()                           â”‚
â”‚     â†“                                 â”‚
â”‚ ExecutorRun()                         â”‚
â”‚     â†“                                 â”‚
â”‚ ExecProcNode()                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre></div>

<hr />
<h3 id="adding-new-features">Adding New Features<a class="heading-anchor" href="#adding-new-features" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Developer needs to add a new join algorithm.</p>
<h4 id="step-1-select-feature-development-scenario">Step 1: Select Feature Development Scenario<a class="heading-anchor" href="#step-1-select-feature-development-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 04
</code></pre></div>

<h4 id="step-2-find-integration-points">Step 2: Find Integration Points<a class="heading-anchor" href="#step-2-find-integration-points" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&gt;</span><span class="w"> </span><span class="nx">Where</span><span class="w"> </span><span class="nx">should</span><span class="w"> </span><span class="nx">I</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">join</span><span class="w"> </span><span class="nx">algorithm</span><span class="p">?</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="nx">Answer</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">To</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">join</span><span class="w"> </span><span class="nx">algorithm</span><span class="p">:</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Define</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="k">type</span><span class="p">:</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nx">src</span><span class="o">/</span><span class="nx">include</span><span class="o">/</span><span class="nx">nodes</span><span class="o">/</span><span class="nx">plannodes</span><span class="p">.</span><span class="nx">h</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Add</span><span class="w"> </span><span class="nx">planner</span><span class="w"> </span><span class="nx">support</span><span class="p">:</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nx">src</span><span class="o">/</span><span class="nx">backend</span><span class="o">/</span><span class="nx">optimizer</span><span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nx">joinpath</span><span class="p">.</span><span class="nx">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">add_xxx_path</span><span class="p">()</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Add</span><span class="w"> </span><span class="nx">executor</span><span class="w"> </span><span class="nx">support</span><span class="p">:</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nx">src</span><span class="o">/</span><span class="nx">backend</span><span class="o">/</span><span class="nx">executor</span><span class="o">/</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nx">nodeXxxjoin</span><span class="p">.</span><span class="nx">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">ExecXxxJoin</span><span class="p">()</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="nx">Register</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">execProcnode</span><span class="p">.</span><span class="nx">c</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">What</span><span class="w"> </span><span class="nx">hooks</span><span class="w"> </span><span class="nx">exist</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">executor</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">custom</span><span class="w"> </span><span class="nx">plan</span><span class="w"> </span><span class="nx">nodes</span><span class="p">?</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Show</span><span class="w"> </span><span class="nx">me</span><span class="w"> </span><span class="nx">how</span><span class="w"> </span><span class="nx">hashjoin</span><span class="w"> </span><span class="nx">integrates</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">planner</span>
</code></pre></div>

<h4 id="step-3-understand-impact">Step 3: Understand Impact<a class="heading-anchor" href="#step-3-understand-impact" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">What would break if I modify add_path?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Impact Analysis â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Modifying add_path() affects:         â”‚
â”‚                                       â”‚
â”‚ Direct callers (47):                  â”‚
â”‚   - add_partial_path()                â”‚
â”‚   - add_partial_path_precheck()       â”‚
â”‚   - create_seqscan_path()             â”‚
â”‚   - create_index_path()               â”‚
â”‚   ...                                 â”‚
â”‚                                       â”‚
â”‚ Risk: HIGH - Core path selection      â”‚
â”‚ Recommendation: Add new function      â”‚
â”‚ instead of modifying existing         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Show dependencies of create_hashjoin_path</span>
</code></pre></div>

<hr />
<h3 id="debugging-assistance">Debugging Assistance<a class="heading-anchor" href="#debugging-assistance" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Developer debugging a crash or unexpected behavior.</p>
<h4 id="step-1-select-debugging-scenario">Step 1: Select Debugging Scenario<a class="heading-anchor" href="#step-1-select-debugging-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 15
</code></pre></div>

<h4 id="step-2-find-debug-points">Step 2: Find Debug Points<a class="heading-anchor" href="#step-2-find-debug-points" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Where are assertion macros in the executor?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Assertion macros in executor:         â”‚
â”‚                                       â”‚
â”‚ Assert() - src/include/c.h:846        â”‚
â”‚ AssertArg() - Argument validation     â”‚
â”‚ AssertState() - State validation      â”‚
â”‚                                       â”‚
â”‚ Usage in executor:                    â”‚
â”‚   execMain.c: 89 assertions           â”‚
â”‚   execProcnode.c: 34 assertions       â”‚
â”‚   execScan.c: 23 assertions           â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Find elog calls in heap_insert</span>

<span class="k">&gt; </span><span class="ge">What functions log to WAL?</span>
</code></pre></div>

<h4 id="step-3-trace-execution">Step 3: Trace Execution<a class="heading-anchor" href="#step-3-trace-execution" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Trace execution from INSERT to heap_insert</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Execution Trace â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ProcessQuery()                        â”‚
â”‚   â†“                                   â”‚
â”‚ PortalRunMulti()                      â”‚
â”‚   â†“                                   â”‚
â”‚ ExecutorRun()                         â”‚
â”‚   â†“                                   â”‚
â”‚ ExecModifyTable()                     â”‚
â”‚   â†“                                   â”‚
â”‚ ExecInsert()                          â”‚
â”‚   â†“                                   â”‚
â”‚ table_tuple_insert()                  â”‚
â”‚   â†“                                   â”‚
â”‚ heap_insert()                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Where to set breakpoints for transaction commit?</span>
</code></pre></div>

<hr />
<h3 id="refactoring-code">Refactoring Code<a class="heading-anchor" href="#refactoring-code" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Developer cleaning up technical debt during refactoring sprint.</p>
<h4 id="step-1-select-refactoring-scenario">Step 1: Select Refactoring Scenario<a class="heading-anchor" href="#step-1-select-refactoring-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 05
</code></pre></div>

<h4 id="step-2-find-dead-code">Step 2: Find Dead Code<a class="heading-anchor" href="#step-2-find-dead-code" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Find unused static functions in executor</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Dead Code â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Potentially unused static functions:  â”‚
â”‚                                       â”‚
â”‚ 1. execUtils.c:                       â”‚
â”‚    - old_get_typlenbyval() :234       â”‚
â”‚                                       â”‚
â”‚ 2. execTuples.c:                      â”‚
â”‚    - legacy_slot_init() :456          â”‚
â”‚                                       â”‚
â”‚ Total: 12 candidates                  â”‚
â”‚ Verified unused: 8                    â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Show deprecated functions still in use</span>

<span class="k">&gt; </span><span class="ge">Find duplicate error handling patterns</span>
</code></pre></div>

<h4 id="step-3-plan-refactoring">Step 3: Plan Refactoring<a class="heading-anchor" href="#step-3-plan-refactoring" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">What depends on ExecProcNode?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Dependencies â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Direct dependents: 47                 â”‚
â”‚ Transitive dependents: 312            â”‚
â”‚                                       â”‚
â”‚ Key callers:                          â”‚
â”‚   - ExecutorRun()                     â”‚
â”‚   - ExecSubPlan()                     â”‚
â”‚   - ExecMaterial()                    â”‚
â”‚   - ExecSort()                        â”‚
â”‚                                       â”‚
â”‚ Refactoring risk: CRITICAL            â”‚
â”‚ Recommendation: Staged migration      â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Impact of renaming heap_open to table_open</span>
</code></pre></div>

<hr />
<h2 id="qatester-scenarios">QA/Tester Scenarios<a class="heading-anchor" href="#qatester-scenarios" title="Link to this section">&para;</a></h2>
<h3 id="test-coverage-analysis">Test Coverage Analysis<a class="heading-anchor" href="#test-coverage-analysis" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> QA engineer needs to identify untested code paths.</p>
<h4 id="step-1-select-test-coverage-scenario">Step 1: Select Test Coverage Scenario<a class="heading-anchor" href="#step-1-select-test-coverage-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 07
</code></pre></div>

<h4 id="step-2-find-coverage-gaps">Step 2: Find Coverage Gaps<a class="heading-anchor" href="#step-2-find-coverage-gaps" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">What functions lack test coverage?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Coverage Gaps â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Functions without direct tests:       â”‚
â”‚                                       â”‚
â”‚ Critical (executor):                  â”‚
â”‚   - ExecParallelHashJoinNewBatch()    â”‚
â”‚   - ExecReScanGather()                â”‚
â”‚                                       â”‚
â”‚ High priority (storage):              â”‚
â”‚   - heap_lock_updated_tuple()         â”‚
â”‚   - heap_abort_speculative()          â”‚
â”‚                                       â”‚
â”‚ Total untested: 234 functions         â”‚
â”‚ Coverage estimate: 78%                â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Which critical functions need tests first?</span>

<span class="k">&gt; </span><span class="ge">Find untested error handling paths</span>
</code></pre></div>

<h4 id="step-3-prioritize-testing">Step 3: Prioritize Testing<a class="heading-anchor" href="#step-3-prioritize-testing" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Which untested functions have highest impact?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Priority List â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ High Impact + No Tests:               â”‚
â”‚                                       â”‚
â”‚ 1. heap_lock_updated_tuple()          â”‚
â”‚    Impact: Transaction integrity      â”‚
â”‚    Callers: 23                        â”‚
â”‚                                       â”‚
â”‚ 2. ExecParallelHashJoinNewBatch()     â”‚
â”‚    Impact: Parallel query correctness â”‚
â”‚    Callers: 8                         â”‚
â”‚                                       â”‚
â”‚ 3. AtEOXact_RelationCache()           â”‚
â”‚    Impact: Cache consistency          â”‚
â”‚    Callers: 4                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Show entry points without tests</span>
</code></pre></div>

<hr />
<h3 id="code-review-assistance">Code Review Assistance<a class="heading-anchor" href="#code-review-assistance" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Reviewer needs to analyze a pull request for quality and security issues.</p>
<h4 id="option-a-github-pr">Option A: GitHub PR<a class="heading-anchor" href="#option-a-github-pr" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review github 123
</code></pre></div>

<h4 id="option-b-gitlab-mr">Option B: GitLab MR<a class="heading-anchor" href="#option-b-gitlab-mr" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review gitlab 456
</code></pre></div>

<h4 id="option-c-local-git-changes">Option C: Local Git Changes<a class="heading-anchor" href="#option-c-local-git-changes" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review git
</code></pre></div>

<h4 id="option-d-patch-file">Option D: Patch File<a class="heading-anchor" href="#option-d-patch-file" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review file path/to/changes.patch
</code></pre></div>

<h4 id="understanding-output">Understanding Output<a class="heading-anchor" href="#understanding-output" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Review Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                           â”‚
â”‚  Score: 72/100         Recommendation: REQUEST_CHANGES    â”‚
â”‚                                                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                           â”‚
â”‚  Findings:                                                â”‚
â”‚                                                           â”‚
â”‚  ğŸ”´ CRITICAL  SQL Injection Risk                          â”‚
â”‚     Location: src/api/user_query.c:45                     â”‚
â”‚     Pattern: User input concatenated in query             â”‚
â”‚     Fix: Use parameterized queries                        â”‚
â”‚                                                           â”‚
â”‚  ğŸŸ¡ MEDIUM    Cyclomatic Complexity                       â”‚
â”‚     Location: src/parser/gram.y:1234                      â”‚
â”‚     Value: 47 (threshold: 10)                             â”‚
â”‚     Fix: Extract helper functions                         â”‚
â”‚                                                           â”‚
â”‚  ğŸŸ¢ LOW       Missing NULL check                          â”‚
â”‚     Location: src/utils/string.c:89                       â”‚
â”‚     Fix: Add NULL pointer validation                      â”‚
â”‚                                                           â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre></div>

<h4 id="review-with-inline-comments">Review with Inline Comments<a class="heading-anchor" href="#review-with-inline-comments" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="nt">review</span><span class="w"> </span><span class="nt">git</span><span class="w"> </span><span class="nt">--format</span><span class="w"> </span><span class="nt">md</span><span class="w"> </span><span class="nt">--inline</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="nt">Inline</span><span class="w"> </span><span class="nt">Comments</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">src</span><span class="o">/</span><span class="nt">api</span><span class="o">/</span><span class="nt">user_query</span><span class="p">.</span><span class="nc">c</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">Line</span><span class="w"> </span><span class="nt">45</span><span class="o">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nt">sprintf</span><span class="o">(</span><span class="nt">query</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;SELECT * FROM users WHERE id=%s&quot;</span><span class="o">,</span><span class="w"> </span><span class="nt">id</span><span class="o">);</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">ğŸ”´</span><span class="w"> </span><span class="nt">SQL</span><span class="w"> </span><span class="nt">Injection</span><span class="o">:</span><span class="w"> </span><span class="nt">Use</span><span class="w"> </span><span class="nt">snprintf</span><span class="w"> </span><span class="nt">with</span><span class="w"> </span><span class="nt">proper</span><span class="w"> </span><span class="nt">escaping</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">Line</span><span class="w"> </span><span class="nt">67</span><span class="o">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nt">char</span><span class="w"> </span><span class="o">*</span><span class="nt">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">malloc</span><span class="o">(</span><span class="nt">len</span><span class="o">);</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">ğŸŸ¡</span><span class="w"> </span><span class="nt">Memory</span><span class="o">:</span><span class="w"> </span><span class="nt">Check</span><span class="w"> </span><span class="nt">malloc</span><span class="w"> </span><span class="nt">return</span><span class="w"> </span><span class="nt">value</span><span class="w"> </span><span class="nt">for</span><span class="w"> </span><span class="nt">NULL</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<hr />
<h3 id="generating-test-cases">Generating Test Cases<a class="heading-anchor" href="#generating-test-cases" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> QA needs to create comprehensive tests for a function.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">heap_insert</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Test</span><span class="w"> </span><span class="n">Cases</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Function</span><span class="p">:</span><span class="w"> </span><span class="n">heap_insert</span><span class="p">()</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">File</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">access</span><span class="o">/</span><span class="n">heap</span><span class="o">/</span><span class="n">heapam</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">2156</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">Normal</span><span class="w"> </span><span class="n">Insertion</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Input</span><span class="p">:</span><span class="w"> </span><span class="n">Valid</span><span class="w"> </span><span class="n">relation</span><span class="p">,</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">tuple</span><span class="p">,</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">CommandId</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Expected</span><span class="p">:</span><span class="w"> </span><span class="n">OID</span><span class="w"> </span><span class="n">returned</span><span class="p">,</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">visible</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">Relation</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Input</span><span class="p">:</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">relation</span><span class="w"> </span><span class="n">pointer</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Expected</span><span class="p">:</span><span class="w"> </span><span class="n">Assert</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">graceful</span><span class="w"> </span><span class="n">error</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">Oversized</span><span class="w"> </span><span class="n">Tuple</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Input</span><span class="p">:</span><span class="w"> </span><span class="n">Tuple</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">BLCKSZ</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Expected</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">clear</span><span class="w"> </span><span class="n">message</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">4.</span><span class="w"> </span><span class="n">Concurrent</span><span class="w"> </span><span class="n">Insert</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Input</span><span class="p">:</span><span class="w"> </span><span class="n">Multiple</span><span class="w"> </span><span class="n">threads</span><span class="w"> </span><span class="n">inserting</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Expected</span><span class="p">:</span><span class="w"> </span><span class="n">All</span><span class="w"> </span><span class="n">inserts</span><span class="w"> </span><span class="n">succeed</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">corruption</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="n">Transaction</span><span class="w"> </span><span class="n">Rollback</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Input</span><span class="p">:</span><span class="w"> </span><span class="n">Insert</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">ROLLBACK</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Expected</span><span class="p">:</span><span class="w"> </span><span class="n">Tuple</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">visible</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">rollback</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mf">6.</span><span class="w"> </span><span class="n">TOAST</span><span class="w"> </span><span class="n">Required</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Input</span><span class="p">:</span><span class="w"> </span><span class="n">Tuple</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">varlena</span><span class="w"> </span><span class="n">field</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Expected</span><span class="p">:</span><span class="w"> </span><span class="n">TOAST</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">populated</span><span class="w"> </span><span class="n">correctly</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">What</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">LWLockAcquire</span><span class="err">?</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="n">commit</span><span class="w"> </span><span class="n">scenarios</span>
</code></pre></div>

<hr />
<h2 id="security-specialist-scenarios">Security Specialist Scenarios<a class="heading-anchor" href="#security-specialist-scenarios" title="Link to this section">&para;</a></h2>
<h3 id="vulnerability-scanning">Vulnerability Scanning<a class="heading-anchor" href="#vulnerability-scanning" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Security engineer performing audit sprint.</p>
<h4 id="step-1-select-security-scenario">Step 1: Select Security Scenario<a class="heading-anchor" href="#step-1-select-security-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 02
</code></pre></div>

<h4 id="step-2-scan-for-vulnerabilities">Step 2: Scan for Vulnerabilities<a class="heading-anchor" href="#step-2-scan-for-vulnerabilities" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nt">Find</span><span class="w"> </span><span class="nt">SQL</span><span class="w"> </span><span class="nt">injection</span><span class="w"> </span><span class="nt">vulnerabilities</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="nt">Security</span><span class="w"> </span><span class="nt">Findings</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ğŸ”´</span><span class="w"> </span><span class="nt">CRITICAL</span><span class="o">:</span><span class="w"> </span><span class="nt">SQL</span><span class="w"> </span><span class="nt">Injection</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Location</span><span class="o">:</span><span class="w"> </span><span class="nt">src</span><span class="o">/</span><span class="nt">pl</span><span class="o">/</span><span class="nt">plpgsql</span><span class="o">/</span><span class="nt">src</span><span class="o">/</span><span class="nt">pl_exec</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">4567</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Pattern</span><span class="o">:</span><span class="w"> </span><span class="nt">Dynamic</span><span class="w"> </span><span class="nt">query</span><span class="w"> </span><span class="nt">with</span><span class="w"> </span><span class="nt">string</span><span class="w"> </span><span class="nt">concatenation</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Code</span><span class="o">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="nt">snprintf</span><span class="o">(</span><span class="nt">query</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;SELECT * FROM %s&quot;</span><span class="o">,</span><span class="w"> </span><span class="nt">table_name</span><span class="o">);</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Risk</span><span class="o">:</span><span class="w"> </span><span class="nt">User-controlled</span><span class="w"> </span><span class="nt">table_name</span><span class="w"> </span><span class="nt">can</span><span class="w"> </span><span class="nt">inject</span><span class="w"> </span><span class="nt">SQL</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Fix</span><span class="o">:</span><span class="w"> </span><span class="nt">Use</span><span class="w"> </span><span class="nt">quote_identifier</span><span class="o">()</span><span class="w"> </span><span class="nt">for</span><span class="w"> </span><span class="nt">table</span><span class="w"> </span><span class="nt">names</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">CWE</span><span class="o">:</span><span class="w"> </span><span class="nt">CWE-89</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Location</span><span class="o">:</span><span class="w"> </span><span class="nt">src</span><span class="o">/</span><span class="nt">backend</span><span class="o">/</span><span class="nt">utils</span><span class="o">/</span><span class="nt">adt</span><span class="o">/</span><span class="nt">ruleutils</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">2341</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Pattern</span><span class="o">:</span><span class="w"> </span><span class="nt">Format</span><span class="w"> </span><span class="nt">string</span><span class="w"> </span><span class="nt">with</span><span class="w"> </span><span class="nt">external</span><span class="w"> </span><span class="nt">input</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Risk</span><span class="o">:</span><span class="w"> </span><span class="nt">Potential</span><span class="w"> </span><span class="nt">format</span><span class="w"> </span><span class="nt">string</span><span class="w"> </span><span class="nt">injection</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nt">Fix</span><span class="o">:</span><span class="w"> </span><span class="nt">Validate</span><span class="w"> </span><span class="nt">format</span><span class="w"> </span><span class="nt">specifiers</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">Total</span><span class="w"> </span><span class="nt">findings</span><span class="o">:</span><span class="w"> </span><span class="nt">7</span><span class="w"> </span><span class="nt">critical</span><span class="o">,</span><span class="w"> </span><span class="nt">12</span><span class="w"> </span><span class="nt">high</span><span class="o">,</span><span class="w"> </span><span class="nt">34</span><span class="w"> </span><span class="nt">medium</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="nt">Find</span><span class="w"> </span><span class="nt">buffer</span><span class="w"> </span><span class="nt">overflow</span><span class="w"> </span><span class="nt">risks</span><span class="w"> </span><span class="nt">in</span><span class="w"> </span><span class="nt">string</span><span class="w"> </span><span class="nt">functions</span>

<span class="o">&gt;</span><span class="w"> </span><span class="nt">Show</span><span class="w"> </span><span class="nt">functions</span><span class="w"> </span><span class="nt">using</span><span class="w"> </span><span class="nt">sprintf</span><span class="w"> </span><span class="nt">without</span><span class="w"> </span><span class="nt">bounds</span>
</code></pre></div>

<hr />
<h3 id="taint-flow-analysis">Taint Flow Analysis<a class="heading-anchor" href="#taint-flow-analysis" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Security engineer tracing untrusted data through the system.</p>
<h4 id="step-1-identify-entry-points">Step 1: Identify Entry Points<a class="heading-anchor" href="#step-1-identify-entry-points" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&gt;</span><span class="w"> </span><span class="nx">Find</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="kd">external</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="nx">points</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="nx">Entry</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Network</span><span class="w"> </span><span class="nx">Entry</span><span class="w"> </span><span class="nx">Points</span><span class="p">:</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pq_getmsgstring</span><span class="p">()</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Read</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">client</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pq_getmsgint</span><span class="p">()</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nx">Read</span><span class="w"> </span><span class="nx">int</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">client</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">ProcessClientRead</span><span class="p">()</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Raw</span><span class="w"> </span><span class="nx">socket</span><span class="w"> </span><span class="nx">read</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">Entry</span><span class="w"> </span><span class="nx">Points</span><span class="p">:</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">exec_simple_query</span><span class="p">()</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Direct</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">execution</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">exec_parse_message</span><span class="p">()</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Prepared</span><span class="w"> </span><span class="nx">statement</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">exec_bind_message</span><span class="p">()</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Parameter</span><span class="w"> </span><span class="nx">binding</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">File</span><span class="w"> </span><span class="nx">Entry</span><span class="w"> </span><span class="nx">Points</span><span class="p">:</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pg_read_file</span><span class="p">()</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nx">Read</span><span class="w"> </span><span class="nx">arbitrary</span><span class="w"> </span><span class="nx">file</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pg_ls_dir</span><span class="p">()</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="nx">List</span><span class="w"> </span><span class="nx">directory</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Total</span><span class="p">:</span><span class="w"> </span><span class="mi">47</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="nx">points</span><span class="w"> </span><span class="nx">identified</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Show</span><span class="w"> </span><span class="nx">network</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="nx">handlers</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">List</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="nx">functions</span>
</code></pre></div>

<h4 id="step-2-trace-data-flow">Step 2: Trace Data Flow<a class="heading-anchor" href="#step-2-trace-data-flow" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Trace</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">PQgetvalue</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">execution</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Taint</span><span class="w"> </span><span class="n">Flow</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">SOURCE</span><span class="o">:</span><span class="w"> </span><span class="n">PQgetvalue</span><span class="p">()</span><span class="w"> </span><span class="p">[</span><span class="n">Client</span><span class="w"> </span><span class="n">Input</span><span class="p">]</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â†“</span><span class="w">                                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">pq_getmsgstring</span><span class="p">()</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â†“</span><span class="w">                                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">exec_simple_query</span><span class="p">()</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â†“</span><span class="w">                                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">pg_parse_query</span><span class="p">()</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â†“</span><span class="w">                                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">SINK</span><span class="o">:</span><span class="w"> </span><span class="n">SPI_execute</span><span class="p">()</span><span class="w"> </span><span class="p">[</span><span class="n">SQL</span><span class="w"> </span><span class="n">Execution</span><span class="p">]</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Sanitization</span><span class="w"> </span><span class="n">found</span><span class="o">:</span><span class="w"> </span><span class="nb">YES</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Location</span><span class="o">:</span><span class="w"> </span><span class="n">pg_parse_query</span><span class="p">()</span><span class="w"> </span><span class="n">validates</span><span class="w"> </span><span class="n">syntax</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">BUT</span><span class="o">:</span><span class="w"> </span><span class="n">Does</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">semantic</span><span class="w"> </span><span class="n">injection</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Risk</span><span class="w"> </span><span class="n">Level</span><span class="o">:</span><span class="w"> </span><span class="n">HIGH</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Recommendation</span><span class="o">:</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">validation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">point</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Does</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">reach</span><span class="w"> </span><span class="n">strcpy</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">validation</span><span class="o">?</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Show</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">allocation</span>
</code></pre></div>

<h4 id="step-3-find-sanitization">Step 3: Find Sanitization<a class="heading-anchor" href="#step-3-find-sanitization" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Where</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">sanitized</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">execution</span><span class="err">?</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Sanitization</span><span class="w"> </span><span class="n">Points</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Identified</span><span class="w"> </span><span class="n">sanitizers</span><span class="p">:</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">quote_identifier</span><span class="p">()</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Location</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">adt</span><span class="o">/</span><span class="n">ruleutils</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">10234</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Purpose</span><span class="p">:</span><span class="w"> </span><span class="n">Escape</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">identifiers</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Coverage</span><span class="p">:</span><span class="w"> </span><span class="n">Partial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">used</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">quote_literal</span><span class="p">()</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Location</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">adt</span><span class="o">/</span><span class="n">quote</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">45</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Purpose</span><span class="p">:</span><span class="w"> </span><span class="n">Escape</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">literals</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Coverage</span><span class="p">:</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">widely</span><span class="w"> </span><span class="n">used</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">pg_parse_query</span><span class="p">()</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Location</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">tcop</span><span class="o">/</span><span class="n">postgres</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">645</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Purpose</span><span class="p">:</span><span class="w"> </span><span class="n">Syntax</span><span class="w"> </span><span class="n">validation</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Coverage</span><span class="p">:</span><span class="w"> </span><span class="n">All</span><span class="w"> </span><span class="n">queries</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Missing</span><span class="w"> </span><span class="n">sanitization</span><span class="w"> </span><span class="n">at</span><span class="p">:</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Dynamic</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">construction</span><span class="w"> </span><span class="p">(</span><span class="mi">12</span><span class="w"> </span><span class="n">locations</span><span class="p">)</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Format</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">building</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="n">locations</span><span class="p">)</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">validation</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">authentication</span>
</code></pre></div>

<hr />
<h3 id="d3fend-source-code-hardening">D3FEND Source Code Hardening<a class="heading-anchor" href="#d3fend-source-code-hardening" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Security engineer checking defensive coding practices using MITRE D3FEND framework.</p>
<p>The D3FEND module analyzes code for 11 Source Code Hardening techniques defined by MITRE:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ID</th>
<th>Technique</th>
<th>Description</th>
<th>CWE</th>
</tr>
</thead>
<tbody>
<tr>
<td>D3-VI</td>
<td>Variable Initialization</td>
<td>Uninitialized variables</td>
<td>CWE-457</td>
</tr>
<tr>
<td>D3-CS</td>
<td>Credential Scrubbing</td>
<td>Hardcoded credentials</td>
<td>CWE-798</td>
</tr>
<tr>
<td>D3-IRV</td>
<td>Integer Range Validation</td>
<td>Integer overflow risks</td>
<td>CWE-190</td>
</tr>
<tr>
<td>D3-PV</td>
<td>Pointer Validation</td>
<td>Pointer dereference without check</td>
<td>CWE-476</td>
</tr>
<tr>
<td>D3-RN</td>
<td>Reference Nullification</td>
<td>Use-after-free risks</td>
<td>CWE-416</td>
</tr>
<tr>
<td>D3-TL</td>
<td>Trusted Library</td>
<td>Unsafe function usage</td>
<td>CWE-676</td>
</tr>
<tr>
<td>D3-VTV</td>
<td>Variable Type Validation</td>
<td>Type confusion</td>
<td>CWE-704</td>
</tr>
<tr>
<td>D3-MBSV</td>
<td>Memory Block Start Validation</td>
<td>Buffer bounds</td>
<td>CWE-119</td>
</tr>
<tr>
<td>D3-NPC</td>
<td>Null Pointer Checking</td>
<td>Missing NULL checks</td>
<td>CWE-476</td>
</tr>
<tr>
<td>D3-DLV</td>
<td>Domain Logic Validation</td>
<td>Business logic errors</td>
<td>CWE-20</td>
</tr>
<tr>
<td>D3-OLV</td>
<td>Operational Logic Validation</td>
<td>State management</td>
<td>CWE-754</td>
</tr>
</tbody>
</table></div>
<h4 id="use-case-1-full-hardening-audit">Use Case 1: Full Hardening Audit<a class="heading-anchor" href="#use-case-1-full-hardening-audit" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">select</span><span class="w"> </span><span class="mi">02</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">D3FEND</span><span class="w"> </span><span class="n">hardening</span><span class="w"> </span><span class="n">compliance</span><span class="w"> </span><span class="n">check</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">D3FEND</span><span class="w"> </span><span class="n">Compliance</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Overall</span><span class="w"> </span><span class="n">Compliance</span><span class="w"> </span><span class="n">Score</span><span class="p">:</span><span class="w"> </span><span class="mf">72.5</span><span class="o">%</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Findings</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">Technique</span><span class="p">:</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">VI</span><span class="w"> </span><span class="p">(</span><span class="n">Variable</span><span class="w"> </span><span class="n">Initialization</span><span class="p">):</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="n">issues</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">palloc</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">palloc0</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="n">locations</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Uninitialized</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">members</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">locations</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="w"> </span><span class="p">(</span><span class="n">Trusted</span><span class="w"> </span><span class="n">Library</span><span class="p">):</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="n">issues</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">ğŸ”´</span><span class="w"> </span><span class="n">strcpy</span><span class="w"> </span><span class="n">usage</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">adt</span><span class="o">/</span><span class="n">varlena</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">234</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">ğŸ”´</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="n">usage</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">567</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">ğŸŸ¡</span><span class="w"> </span><span class="n">strtok</span><span class="w"> </span><span class="n">usage</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">parser</span><span class="o">/</span><span class="n">gram</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">1234</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="w"> </span><span class="p">(</span><span class="n">Null</span><span class="w"> </span><span class="n">Pointer</span><span class="w"> </span><span class="n">Checking</span><span class="p">):</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">issues</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">malloc</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">check</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">locations</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">palloc</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">assertion</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">locations</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">RN</span><span class="w"> </span><span class="p">(</span><span class="n">Reference</span><span class="w"> </span><span class="n">Nullification</span><span class="p">):</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">issues</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">pfree</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">locations</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Category</span><span class="w"> </span><span class="n">Scores</span><span class="p">:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Initialization</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="o">%</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Memory</span><span class="w"> </span><span class="n">Safety</span><span class="p">:</span><span class="w"> </span><span class="mi">78</span><span class="o">%</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Pointer</span><span class="w"> </span><span class="n">Safety</span><span class="p">:</span><span class="w"> </span><span class="mi">82</span><span class="o">%</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Library</span><span class="w"> </span><span class="n">Safety</span><span class="p">:</span><span class="w"> </span><span class="mi">58</span><span class="o">%</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="use-case-2-check-specific-d3fend-techniques">Use Case 2: Check Specific D3FEND Techniques<a class="heading-anchor" href="#use-case-2-check-specific-d3fend-techniques" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">unsafe</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="w"> </span><span class="n">Trusted</span><span class="w"> </span><span class="n">Library</span><span class="p">)</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="p">:</span><span class="w"> </span><span class="n">Trusted</span><span class="w"> </span><span class="n">Library</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Unsafe</span><span class="w"> </span><span class="n">Functions</span><span class="w"> </span><span class="n">Found</span><span class="p">:</span><span class="w"> </span><span class="mi">47</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ğŸ”´</span><span class="w"> </span><span class="n">CRITICAL</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">strcpy</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="w"> </span><span class="n">overflow</span><span class="w"> </span><span class="n">risk</span><span class="p">):</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">adt</span><span class="o">/</span><span class="n">varlena</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">234</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">pqformat</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">567</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">pl</span><span class="o">/</span><span class="n">plpgsql</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pl_exec</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">1234</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ğŸ”´</span><span class="w"> </span><span class="n">CRITICAL</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="p">(</span><span class="n">format</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">risk</span><span class="p">):</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">567</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">error</span><span class="o">/</span><span class="n">elog</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">890</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ğŸŸ¡</span><span class="w"> </span><span class="n">HIGH</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="p">(</span><span class="n">deprecated</span><span class="p">,</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">unsafe</span><span class="p">):</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">None</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="err">âœ“</span><span class="w">                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ğŸŸ¡</span><span class="w"> </span><span class="n">HIGH</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rand</span><span class="w"> </span><span class="p">(</span><span class="n">weak</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">generator</span><span class="p">):</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">pg_random</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">45</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Remediation</span><span class="p">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">strcpy</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">strncpy</span><span class="o">/</span><span class="n">strlcpy</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">snprintf</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">fgets</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">rand</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">pg_prng_</span><span class="o">*</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">arc4random</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">vulnerabilities</span><span class="w"> </span><span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="p">)</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="p">:</span><span class="w"> </span><span class="n">Null</span><span class="w"> </span><span class="n">Pointer</span><span class="w"> </span><span class="n">Checking</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Missing</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">Allocation</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">malloc</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">check</span><span class="p">:</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">mmgr</span><span class="o">/</span><span class="n">aset</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">345</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">use</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">â†</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">check</span><span class="o">!</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">palloc</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">assertion</span><span class="p">:</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">executor</span><span class="o">/</span><span class="n">execUtils</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">234</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">TupleTableSlot</span><span class="w"> </span><span class="o">*</span><span class="n">slot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="o">...</span><span class="p">));</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">slot</span><span class="o">-&gt;</span><span class="n">tts_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="o">...</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">â†</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">check</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">PostgreSQL</span><span class="w"> </span><span class="n">Note</span><span class="p">:</span><span class="w"> </span><span class="n">palloc</span><span class="p">()</span><span class="w"> </span><span class="n">raises</span><span class="w"> </span><span class="n">ERROR</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">OOM</span><span class="p">,</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">but</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">checks</span><span class="w"> </span><span class="n">improve</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">clarity</span><span class="o">.</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Example</span><span class="w"> </span><span class="n">Fix</span><span class="p">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">        </span><span class="n">ereport</span><span class="p">(</span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">errcode</span><span class="p">(</span><span class="n">ERRCODE_OUT_OF_MEMORY</span><span class="p">)));</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="p">}</span><span class="w">                                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="use-case-3-check-memory-safety-d3-rn-reference-nullification">Use Case 3: Check Memory Safety (D3-RN Reference Nullification)<a class="heading-anchor" href="#use-case-3-check-memory-safety-d3-rn-reference-nullification" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">use</span><span class="o">-</span><span class="n">after</span><span class="o">-</span><span class="n">free</span><span class="w"> </span><span class="n">risks</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="nl">RN:</span><span class="w"> </span><span class="n">Reference</span><span class="w"> </span><span class="n">Nullification</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Free</span><span class="w"> </span><span class="n">Without</span><span class="w"> </span><span class="nl">Nullification:</span><span class="w"> </span><span class="mh">34</span><span class="w"> </span><span class="n">locations</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">pfree</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="nl">assignment:</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">relcache</span><span class="p">.</span><span class="nl">c:</span><span class="mh">567</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">pfree</span><span class="p">(</span><span class="n">rel</span><span class="o">-&gt;</span><span class="n">rd_options</span><span class="p">);</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="c1">// rel-&gt;rd_options still points to freed memory!         â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">âœ“</span><span class="w"> </span><span class="nl">FIX:</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">pfree</span><span class="p">(</span><span class="n">rel</span><span class="o">-&gt;</span><span class="n">rd_options</span><span class="p">);</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">rel</span><span class="o">-&gt;</span><span class="n">rd_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">executor</span><span class="o">/</span><span class="n">nodeHash</span><span class="p">.</span><span class="nl">c:</span><span class="mh">234</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">pfree</span><span class="p">(</span><span class="n">hashtable</span><span class="o">-&gt;</span><span class="n">buckets</span><span class="p">);</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="c1">// Dangling pointer risk in error paths                  â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">MemoryContextDelete</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="nl">nullification:</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">mmgr</span><span class="o">/</span><span class="n">mcxt</span><span class="p">.</span><span class="nl">c:</span><span class="mh">890</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">MemoryContextDelete</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="c1">// ctx may be accessed later!                            â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">CWE</span><span class="w"> </span><span class="nl">Reference:</span><span class="w"> </span><span class="n">CWE</span><span class="o">-</span><span class="mh">416</span><span class="w"> </span><span class="p">(</span><span class="n">Use</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">Free</span><span class="p">)</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="use-case-4-check-variable-initialization-d3-vi">Use Case 4: Check Variable Initialization (D3-VI)<a class="heading-anchor" href="#use-case-4-check-variable-initialization-d3-vi" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="n">uninitialized</span><span class="w"> </span><span class="n">variables</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="n">VI</span><span class="p">:</span><span class="w"> </span><span class="n">Variable</span><span class="w"> </span><span class="n">Initialization</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Uninitialized</span><span class="w"> </span><span class="n">Variables</span><span class="w"> </span><span class="n">Found</span><span class="p">:</span><span class="w"> </span><span class="mi">56</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Stack</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">initialization</span><span class="p">:</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">executor</span><span class="o">/</span><span class="n">execMain</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">456</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">EState</span><span class="w"> </span><span class="o">*</span><span class="n">estate</span><span class="p">;</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">â†</span><span class="w"> </span><span class="n">Uninitialized</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">QueryDesc</span><span class="w"> </span><span class="o">*</span><span class="n">queryDesc</span><span class="p">;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">â†</span><span class="w"> </span><span class="n">Uninitialized</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">âœ“</span><span class="w"> </span><span class="n">FIX</span><span class="p">:</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">EState</span><span class="w"> </span><span class="o">*</span><span class="n">estate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">QueryDesc</span><span class="w"> </span><span class="o">*</span><span class="n">queryDesc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">palloc</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">palloc0</span><span class="p">:</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">nodes</span><span class="o">/</span><span class="n">copyfuncs</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">234</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">newnode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">));</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="n">Fields</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">garbage</span><span class="o">!</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">âœ“</span><span class="w"> </span><span class="n">FIX</span><span class="p">:</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">newnode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc0</span><span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">));</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Struct</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">memset</span><span class="p">:</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">struct</span><span class="w"> </span><span class="n">MyStruct</span><span class="w"> </span><span class="n">s</span><span class="p">;</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="err">â†</span><span class="w"> </span><span class="n">Uninitialized</span><span class="w"> </span><span class="n">fields</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">âœ“</span><span class="w"> </span><span class="n">FIX</span><span class="p">:</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">struct</span><span class="w"> </span><span class="n">MyStruct</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Zero</span><span class="o">-</span><span class="n">initialize</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">CWE</span><span class="w"> </span><span class="n">Reference</span><span class="p">:</span><span class="w"> </span><span class="n">CWE</span><span class="o">-</span><span class="mi">457</span><span class="w"> </span><span class="p">(</span><span class="n">Use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Uninitialized</span><span class="w"> </span><span class="n">Variable</span><span class="p">)</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="use-case-5-credential-scrubbing-d3-cs">Use Case 5: Credential Scrubbing (D3-CS)<a class="heading-anchor" href="#use-case-5-credential-scrubbing-d3-cs" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="n">hardcoded</span><span class="w"> </span><span class="n">credentials</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="n">CS</span><span class="p">:</span><span class="w"> </span><span class="n">Credential</span><span class="w"> </span><span class="n">Scrubbing</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ğŸ”´</span><span class="w"> </span><span class="n">CRITICAL</span><span class="p">:</span><span class="w"> </span><span class="n">Hardcoded</span><span class="w"> </span><span class="n">Credentials</span><span class="w"> </span><span class="n">Found</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Password</span><span class="w"> </span><span class="n">literals</span><span class="p">:</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">123</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">default_password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;postgres123&quot;</span><span class="p">;</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="o">//</span><span class="w">    </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="n">NEVER</span><span class="w"> </span><span class="n">hardcode</span><span class="w"> </span><span class="n">passwords</span><span class="o">!</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">API</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="n">patterns</span><span class="p">:</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">contrib</span><span class="o">/</span><span class="n">postgres_fdw</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">456</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="c1">#define AWS_SECRET_KEY &quot;AKIAIOSFODNN7EXAMPLE&quot;            â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="n">Exposed</span><span class="w"> </span><span class="n">credential</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">code</span><span class="o">!</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Token</span><span class="w"> </span><span class="n">patterns</span><span class="p">:</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">None</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="err">âœ“</span><span class="w">                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Remediation</span><span class="p">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="p">:</span><span class="w"> </span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DB_PASSWORD&quot;</span><span class="p">)</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">credential</span><span class="w"> </span><span class="n">stores</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="o">.</span><span class="n">pgpass</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">PostgreSQL</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Implement</span><span class="w"> </span><span class="n">credential</span><span class="w"> </span><span class="n">rotation</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">CWE</span><span class="w"> </span><span class="n">Reference</span><span class="p">:</span><span class="w"> </span><span class="n">CWE</span><span class="o">-</span><span class="mi">798</span><span class="w"> </span><span class="p">(</span><span class="n">Use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Hard</span><span class="o">-</span><span class="n">coded</span><span class="w"> </span><span class="n">Credentials</span><span class="p">)</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="use-case-6-integer-range-validation-d3-irv">Use Case 6: Integer Range Validation (D3-IRV)<a class="heading-anchor" href="#use-case-6-integer-range-validation-d3-irv" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">Check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">integer</span><span class="w"> </span><span class="n">overflow</span><span class="w"> </span><span class="n">risks</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="nl">IRV</span><span class="p">:</span><span class="w"> </span><span class="k">Integer</span><span class="w"> </span><span class="k">Range</span><span class="w"> </span><span class="n">Validation</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">Integer</span><span class="w"> </span><span class="n">Overflow</span><span class="w"> </span><span class="nl">Risks</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Allocation</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="n">calculation</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="k">check</span><span class="err">:</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">palloc</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">234</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">size_t</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">count</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sizeof</span><span class="p">(</span><span class="nc">int</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">May</span><span class="w"> </span><span class="n">overflow</span><span class="err">!</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="k">size</span><span class="p">);</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">âœ“</span><span class="w"> </span><span class="n">FIX</span><span class="w"> </span><span class="p">(</span><span class="n">PostgreSQL</span><span class="w"> </span><span class="n">style</span><span class="p">)</span><span class="err">:</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">SIZE_MAX</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sizeof</span><span class="p">(</span><span class="nc">int</span><span class="p">))</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="n">ereport</span><span class="p">(</span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="nf">count</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sizeof</span><span class="p">(</span><span class="nc">int</span><span class="p">));</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">âœ“</span><span class="w"> </span><span class="n">FIX</span><span class="w"> </span><span class="p">(</span><span class="k">with</span><span class="w"> </span><span class="n">overflow</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">macro</span><span class="p">)</span><span class="err">:</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pg_mul_s64_overflow</span><span class="p">(</span><span class="nf">count</span><span class="p">,</span><span class="w"> </span><span class="n">sizeof</span><span class="p">(</span><span class="nc">int</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="k">size</span><span class="p">))</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="n">ereport</span><span class="p">(</span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="k">size</span><span class="p">);</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">Array</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="nl">calculation</span><span class="p">:</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">access</span><span class="o">/</span><span class="n">heap</span><span class="o">/</span><span class="n">heapam</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">567</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="nc">int</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta</span><span class="p">;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">May</span><span class="w"> </span><span class="n">wrap</span><span class="w"> </span><span class="n">around</span><span class="err">!</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="k">array</span><span class="o">[</span><span class="n">offset</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">CWE</span><span class="w"> </span><span class="nl">Reference</span><span class="p">:</span><span class="w"> </span><span class="n">CWE</span><span class="o">-</span><span class="mi">190</span><span class="w"> </span><span class="p">(</span><span class="k">Integer</span><span class="w"> </span><span class="n">Overflow</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                               </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="use-case-7-domain-specific-checks-postgresql">Use Case 7: Domain-Specific Checks (PostgreSQL)<a class="heading-anchor" href="#use-case-7-domain-specific-checks-postgresql" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="n">Run</span> <span class="n">PostgreSQL</span><span class="o">-</span><span class="n">specific</span> <span class="n">hardening</span> <span class="n">checks</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span> <span class="n">PostgreSQL</span> <span class="n">Hardening</span> <span class="n">Report</span> <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">PostgreSQL</span><span class="o">-</span><span class="n">Specific</span> <span class="n">D3FEND</span> <span class="n">Findings</span>                          <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">VI</span><span class="o">-</span><span class="n">PG</span><span class="p">:</span> <span class="n">palloc</span> <span class="n">vs</span> <span class="n">palloc0</span>                                  <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                                <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">palloc</span> <span class="n">without</span> <span class="n">initialization</span><span class="p">:</span> <span class="mi">45</span> <span class="n">locations</span>                <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">Recommendation</span><span class="p">:</span> <span class="n">Use</span> <span class="n">palloc0</span><span class="p">()</span> <span class="n">for</span> <span class="n">structs</span>                  <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="o">-</span><span class="n">PG</span><span class="p">:</span> <span class="n">Standard</span> <span class="n">C</span> <span class="n">vs</span> <span class="n">PostgreSQL</span> <span class="n">functions</span>                 <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">malloc</span> <span class="n">usage</span> <span class="p">(</span><span class="n">should</span> <span class="n">use</span> <span class="n">palloc</span><span class="p">):</span> <span class="mi">12</span> <span class="n">locations</span>             <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">free</span> <span class="n">usage</span> <span class="p">(</span><span class="n">should</span> <span class="n">use</span> <span class="n">pfree</span><span class="p">):</span> <span class="mi">8</span> <span class="n">locations</span>                 <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">strdup</span> <span class="n">usage</span> <span class="p">(</span><span class="n">should</span> <span class="n">use</span> <span class="n">pstrdup</span><span class="p">):</span> <span class="mi">5</span> <span class="n">locations</span>             <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">DLV</span><span class="o">-</span><span class="n">PG</span><span class="p">:</span> <span class="n">OID</span> <span class="n">Validation</span>                                    <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                                <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">SearchSysCache</span> <span class="n">without</span> <span class="n">OidIsValid</span><span class="p">:</span> <span class="mi">7</span> <span class="n">locations</span>             <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">GetSysCacheOid</span> <span class="n">without</span> <span class="n">check</span><span class="p">:</span> <span class="mi">3</span> <span class="n">locations</span>                  <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">OLV</span><span class="o">-</span><span class="n">PG</span><span class="p">:</span> <span class="n">SPI</span> <span class="n">State</span> <span class="n">Management</span>                              <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                              <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">SPI_execute</span> <span class="n">without</span> <span class="n">SPI_connect</span><span class="p">:</span> <span class="mi">2</span> <span class="n">locations</span>               <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="n">Missing</span> <span class="n">SPI_finish</span> <span class="n">in</span> <span class="n">error</span> <span class="n">paths</span><span class="p">:</span> <span class="mi">4</span> <span class="n">locations</span>             <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">PostgreSQL</span> <span class="n">Best</span> <span class="n">Practices</span><span class="p">:</span>                                   <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                                   <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="err">âœ“</span> <span class="n">Use</span> <span class="n">palloc</span><span class="o">/</span><span class="n">pfree</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">malloc</span><span class="o">/</span><span class="n">free</span>                  <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="err">âœ“</span> <span class="n">Use</span> <span class="n">palloc0</span> <span class="n">for</span> <span class="n">struct</span> <span class="n">initialization</span>                    <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="err">âœ“</span> <span class="n">Always</span> <span class="n">check</span> <span class="n">OidIsValid</span><span class="p">()</span> <span class="n">before</span> <span class="n">cache</span> <span class="n">lookups</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="err">âœ“</span> <span class="n">Use</span> <span class="n">HeapTupleIsValid</span><span class="p">()</span> <span class="n">after</span> <span class="n">SearchSysCache</span>              <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="err">âœ“</span> <span class="n">Balance</span> <span class="n">SPI_connect</span><span class="o">/</span><span class="n">SPI_finish</span> <span class="n">in</span> <span class="n">all</span> <span class="n">paths</span>              <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="use-case-8-generate-compliance-report">Use Case 8: Generate Compliance Report<a class="heading-anchor" href="#use-case-8-generate-compliance-report" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="n">Generate</span> <span class="n">D3FEND</span> <span class="n">compliance</span> <span class="n">report</span> <span class="n">for</span> <span class="n">audit</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span> <span class="n">D3FEND</span> <span class="n">Compliance</span> <span class="n">Audit</span> <span class="n">Report</span> <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">MITRE</span> <span class="n">D3FEND</span> <span class="n">Source</span> <span class="n">Code</span> <span class="n">Hardening</span> <span class="n">Compliance</span>                <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>                  <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">Audit</span> <span class="n">Date</span><span class="p">:</span> <span class="mi">2024</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">09</span>                                       <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">Target</span><span class="p">:</span> <span class="n">PostgreSQL</span> <span class="mf">16.1</span> <span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/*</span><span class="p">)</span>                      <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">Language</span><span class="p">:</span> <span class="n">C</span>                                                  <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">EXECUTIVE</span> <span class="n">SUMMARY</span>                                            <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                                            <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">Overall</span> <span class="n">Compliance</span> <span class="n">Score</span><span class="p">:</span> <span class="mf">72.5</span><span class="err">%</span>                              <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">Total</span> <span class="n">Findings</span><span class="p">:</span> <span class="mi">156</span>                                          <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="o">-</span> <span class="n">Critical</span><span class="p">:</span> <span class="mi">12</span>                                             <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="o">-</span> <span class="n">High</span><span class="p">:</span> <span class="mi">34</span>                                                 <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="o">-</span> <span class="n">Medium</span><span class="p">:</span> <span class="mi">67</span>                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>    <span class="o">-</span> <span class="n">Low</span><span class="p">:</span> <span class="mi">43</span>                                                  <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">TECHNIQUE</span> <span class="n">COMPLIANCE</span>                                         <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                                        <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">VI</span>  <span class="n">Variable</span> <span class="n">Initialization</span>     <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘</span>  <span class="mi">78</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">CS</span>  <span class="n">Credential</span> <span class="n">Scrubbing</span>        <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>  <span class="mi">95</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">IRV</span> <span class="n">Integer</span> <span class="n">Range</span> <span class="n">Validation</span>    <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘</span>  <span class="mi">68</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">PV</span>  <span class="n">Pointer</span> <span class="n">Validation</span>          <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘</span>  <span class="mi">82</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">RN</span>  <span class="n">Reference</span> <span class="n">Nullification</span>     <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘</span>  <span class="mi">62</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">TL</span>  <span class="n">Trusted</span> <span class="n">Library</span>             <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘</span>  <span class="mi">58</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">VTV</span> <span class="n">Variable</span> <span class="n">Type</span> <span class="n">Validation</span>    <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘</span>  <span class="mi">85</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">MBSV</span> <span class="n">Memory</span> <span class="n">Block</span> <span class="n">Validation</span>    <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘</span>  <span class="mi">72</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">NPC</span> <span class="n">Null</span> <span class="n">Pointer</span> <span class="n">Checking</span>       <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘</span>  <span class="mi">80</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">DLV</span> <span class="n">Domain</span> <span class="n">Logic</span> <span class="n">Validation</span>     <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘</span>  <span class="mi">75</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">D3</span><span class="o">-</span><span class="n">OLV</span> <span class="n">Operational</span> <span class="n">Logic</span> <span class="n">Valid</span><span class="p">.</span>    <span class="err">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘</span>  <span class="mi">65</span><span class="err">%</span>           <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">TOP</span> <span class="n">PRIORITY</span> <span class="n">REMEDIATION</span>                                     <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>                                     <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="mi">1</span><span class="p">.</span> <span class="n">Replace</span> <span class="n">unsafe</span> <span class="n">string</span> <span class="n">functions</span> <span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="p">)</span>                   <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="mi">2</span><span class="p">.</span> <span class="n">Add</span> <span class="n">NULL</span> <span class="n">checks</span> <span class="n">after</span> <span class="n">allocations</span> <span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="p">)</span>                <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="mi">3</span><span class="p">.</span> <span class="n">Nullify</span> <span class="n">pointers</span> <span class="n">after</span> <span class="n">free</span> <span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">RN</span><span class="p">)</span>                       <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="mi">4</span><span class="p">.</span> <span class="n">Add</span> <span class="n">overflow</span> <span class="n">checks</span> <span class="n">in</span> <span class="n">size</span> <span class="n">calculations</span> <span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">IRV</span><span class="p">)</span>         <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â”‚</span>  <span class="n">Full</span> <span class="n">report</span> <span class="n">saved</span> <span class="n">to</span><span class="p">:</span> <span class="n">d3fend_audit_2024</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">09</span><span class="p">.</span><span class="n">md</span>             <span class="err">â”‚</span>
<span class="err">â”‚</span>                                                               <span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</code></pre></div>

<h4 id="programmatic-api-usage">Programmatic API Usage<a class="heading-anchor" href="#programmatic-api-usage" title="Link to this section">&para;</a></h4>
<p>For automation and CI/CD integration:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hardening</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardeningScanner</span><span class="p">,</span> <span class="n">HardeningCategory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.services.cpg_query_service</span><span class="w"> </span><span class="kn">import</span> <span class="n">CPGQueryService</span>

<span class="c1"># Initialize scanner</span>
<span class="k">with</span> <span class="n">CPGQueryService</span><span class="p">()</span> <span class="k">as</span> <span class="n">cpg</span><span class="p">:</span>
    <span class="n">scanner</span> <span class="o">=</span> <span class="n">HardeningScanner</span><span class="p">(</span><span class="n">cpg</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>

    <span class="c1"># Run all checks</span>
    <span class="n">findings</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan_all</span><span class="p">(</span><span class="n">limit_per_check</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

    <span class="c1"># Or run specific D3FEND techniques</span>
    <span class="n">findings</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan_by_d3fend_id</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;D3-VI&quot;</span><span class="p">,</span> <span class="s2">&quot;D3-NPC&quot;</span><span class="p">,</span> <span class="s2">&quot;D3-TL&quot;</span><span class="p">],</span>
        <span class="n">limit</span><span class="o">=</span><span class="mi">30</span>
    <span class="p">)</span>

    <span class="c1"># Or run by category</span>
    <span class="n">findings</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan_by_category</span><span class="p">(</span>
        <span class="n">HardeningCategory</span><span class="o">.</span><span class="n">MEMORY_SAFETY</span><span class="p">,</span>
        <span class="n">limit</span><span class="o">=</span><span class="mi">20</span>
    <span class="p">)</span>

    <span class="c1"># Get compliance scores</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">get_compliance_score</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall Score: </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;overall_score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;By D3FEND: </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;d3fend_scores&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Generate remediation report</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">get_remediation_report</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;hardening_report.md&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
</code></pre></div>

<hr />
<h3 id="compliance-checking">Compliance Checking<a class="heading-anchor" href="#compliance-checking" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Auditor checking codebase for regulatory compliance.</p>
<h4 id="step-1-select-compliance-scenario">Step 1: Select Compliance Scenario<a class="heading-anchor" href="#step-1-select-compliance-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 08
</code></pre></div>

<h4 id="step-2-check-standards">Step 2: Check Standards<a class="heading-anchor" href="#step-2-check-standards" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Check for OWASP Top 10 vulnerabilities</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ OWASP Top 10 Audit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                           â”‚
â”‚  A01:2021 - Broken Access Control                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚  Status: 3 findings                                       â”‚
â”‚    - Missing ACL check in pg_ls_dir()                     â”‚
â”‚    - Privilege escalation in ALTER ROLE                   â”‚
â”‚                                                           â”‚
â”‚  A02:2021 - Cryptographic Failures                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚  Status: PASS                                             â”‚
â”‚    - Using OpenSSL for encryption                         â”‚
â”‚    - scram-sha-256 for authentication                     â”‚
â”‚                                                           â”‚
â”‚  A03:2021 - Injection                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚  Status: 7 findings                                       â”‚
â”‚    - See SQL injection report above                       â”‚
â”‚                                                           â”‚
â”‚  A04:2021 - Insecure Design                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚
â”‚  Status: 2 findings                                       â”‚
â”‚    - Default superuser without password                   â”‚
â”‚                                                           â”‚
â”‚  Overall Score: 72/100                                    â”‚
â”‚                                                           â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Find hardcoded credentials</span>

<span class="k">&gt; </span><span class="ge">Generate compliance report for CWE-89</span>
</code></pre></div>

<hr />
<h3 id="pythondjango-security-audit">Python/Django Security Audit<a class="heading-anchor" href="#pythondjango-security-audit" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Security engineer auditing a Django web application.</p>
<p>When analyzing Python/Django projects, the copilot uses specialized security patterns for web vulnerabilities:</p>
<h4 id="supported-vulnerabilities">Supported Vulnerabilities<a class="heading-anchor" href="#supported-vulnerabilities" title="Link to this section">&para;</a></h4>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ID</th>
<th>Vulnerability</th>
<th>CWE</th>
<th>Indicators</th>
</tr>
</thead>
<tbody>
<tr>
<td>DJANGO_SQL_INJECTION</td>
<td>SQL Injection via Raw Query</td>
<td>CWE-89</td>
<td><code>raw()</code>, <code>extra()</code>, <code>RawSQL()</code>, <code>cursor.execute()</code></td>
</tr>
<tr>
<td>DJANGO_XSS</td>
<td>Cross-Site Scripting</td>
<td>CWE-79</td>
<td><code>mark_safe()</code>, <code>\|safe</code>, <code>autoescape off</code></td>
</tr>
<tr>
<td>DJANGO_CSRF</td>
<td>CSRF Vulnerability</td>
<td>CWE-352</td>
<td><code>@csrf_exempt</code></td>
</tr>
<tr>
<td>DJANGO_AUTH_BYPASS</td>
<td>Authentication Bypass</td>
<td>CWE-287</td>
<td><code>@permission_classes([])</code>, <code>AllowAny</code></td>
</tr>
<tr>
<td>DJANGO_INSECURE_DESERIALIZE</td>
<td>Insecure Deserialization</td>
<td>CWE-502</td>
<td><code>pickle.loads</code>, <code>yaml.load</code>, <code>eval()</code></td>
</tr>
<tr>
<td>DJANGO_PATH_TRAVERSAL</td>
<td>Path Traversal</td>
<td>CWE-22</td>
<td><code>open()</code>, <code>os.path.join()</code> with user input</td>
</tr>
<tr>
<td>DJANGO_CMD_INJECTION</td>
<td>Command Injection</td>
<td>CWE-78</td>
<td><code>subprocess.*</code>, <code>os.system()</code>, <code>shell=True</code></td>
</tr>
<tr>
<td>DJANGO_MASS_ASSIGNMENT</td>
<td>Mass Assignment</td>
<td>CWE-915</td>
<td><code>**request.data</code>, <code>update(**kwargs)</code></td>
</tr>
</tbody>
</table></div>
<h4 id="example-queries">Example Queries<a class="heading-anchor" href="#example-queries" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Switch to Django project first
/project switch fsin_module

<span class="gh">#</span> Then select Security Audit scenario
/select 02

<span class="gh">#</span> Ask security questions
<span class="k">&gt; </span><span class="ge">Find SQL injection vulnerabilities in views</span>
<span class="k">&gt; </span><span class="ge">Check for XSS in templates</span>
<span class="k">&gt; </span><span class="ge">Find endpoints without CSRF protection</span>
<span class="k">&gt; </span><span class="ge">Show functions using eval() or exec()</span>
</code></pre></div>

<h4 id="taint-sources-user-input">Taint Sources (User Input)<a class="heading-anchor" href="#taint-sources-user-input" title="Link to this section">&para;</a></h4>
<p>The system tracks data flow from these Django sources:
- <code>request.GET.get()</code>, <code>request.POST.get()</code>, <code>request.data.get()</code>
- <code>request.body</code>, <code>request.path</code>, <code>request.FILES</code>
- <code>form.cleaned_data</code>, <code>serializer.validated_data</code>
- URL parameters (<code>kwargs.get()</code>)</p>
<h4 id="taint-sinks-dangerous-functions">Taint Sinks (Dangerous Functions)<a class="heading-anchor" href="#taint-sinks-dangerous-functions" title="Link to this section">&para;</a></h4>
<p>Data reaching these sinks is flagged:
- <strong>SQL</strong>: <code>raw()</code>, <code>extra()</code>, <code>execute()</code>, <code>RawSQL()</code>
- <strong>XSS</strong>: <code>mark_safe()</code>, <code>HttpResponse()</code>
- <strong>Command</strong>: <code>subprocess.*</code>, <code>os.system()</code>, <code>os.popen()</code>
- <strong>File</strong>: <code>open()</code>, <code>FileResponse()</code>
- <strong>Deserialize</strong>: <code>pickle.loads()</code>, <code>yaml.load()</code>, <code>eval()</code>, <code>exec()</code></p>
<hr />
<h3 id="incident-response">Incident Response<a class="heading-anchor" href="#incident-response" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Security team investigating a breach.</p>
<h4 id="step-1-select-incident-scenario">Step 1: Select Incident Scenario<a class="heading-anchor" href="#step-1-select-incident-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 14
</code></pre></div>

<h4 id="step-2-trace-attack-path">Step 2: Trace Attack Path<a class="heading-anchor" href="#step-2-trace-attack-path" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Trace</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">admin</span><span class="w"> </span><span class="n">access</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Attack</span><span class="w"> </span><span class="n">Path</span><span class="w"> </span><span class="n">Analysis</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Potential</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">escalation</span><span class="w"> </span><span class="n">paths</span><span class="p">:</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Path</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">Injection</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Superuser</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">login</span><span class="p">()</span><span class="w"> </span><span class="n">accepts</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">input</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">Input</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">authenticate</span><span class="p">()</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">concatenation</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">Injection</span><span class="w"> </span><span class="n">bypasses</span><span class="w"> </span><span class="n">authentication</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">5.</span><span class="w"> </span><span class="n">Session</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="n">superuser</span><span class="w"> </span><span class="n">privileges</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Path</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">Function</span><span class="w"> </span><span class="n">Overloading</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">creates</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">signature</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">Search</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">manipulation</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">Malicious</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">superuser</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Mitigation</span><span class="p">:</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Parameterized</span><span class="w"> </span><span class="n">queries</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Explicit</span><span class="w"> </span><span class="n">schema</span><span class="w"> </span><span class="n">qualification</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">SECURITY</span><span class="w"> </span><span class="n">DEFINER</span><span class="w"> </span><span class="n">audit</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">escalation</span><span class="w"> </span><span class="n">paths</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">Show</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">compromised</span><span class="w"> </span><span class="n">function</span>
</code></pre></div>

<h4 id="step-3-assess-impact">Step 3: Assess Impact<a class="heading-anchor" href="#step-3-assess-impact" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">What data could be accessed from auth_check function?</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Impact Assessment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                           â”‚
â”‚  Function: auth_check()                                   â”‚
â”‚  Access Level: Superuser context                          â”‚
â”‚                                                           â”‚
â”‚  Reachable Data:                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚
â”‚                                                           â”‚
â”‚  Direct Access:                                           â”‚
â”‚    - pg_authid (passwords, roles)                         â”‚
â”‚    - pg_auth_members (role membership)                    â”‚
â”‚    - All user tables                                      â”‚
â”‚                                                           â”‚
â”‚  Via Function Calls:                                      â”‚
â”‚    - pg_read_file() - Filesystem access                   â”‚
â”‚    - pg_ls_dir() - Directory listing                      â”‚
â”‚    - COPY TO PROGRAM - Command execution                  â”‚
â”‚                                                           â”‚
â”‚  Blast Radius: CRITICAL                                   â”‚
â”‚    - Full database compromise                             â”‚
â”‚    - Potential OS-level access                            â”‚
â”‚                                                           â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="k">&gt; </span><span class="ge">Find all callers of compromised component</span>
</code></pre></div>

<hr />
<h2 id="technical-writer-scenarios">Technical Writer Scenarios<a class="heading-anchor" href="#technical-writer-scenarios" title="Link to this section">&para;</a></h2>
<h3 id="generating-api-documentation">Generating API Documentation<a class="heading-anchor" href="#generating-api-documentation" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Technical writer documenting public API.</p>
<h4 id="step-1-select-documentation-scenario">Step 1: Select Documentation Scenario<a class="heading-anchor" href="#step-1-select-documentation-scenario" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 03
</code></pre></div>

<h4 id="step-2-generate-function-docs">Step 2: Generate Function Docs<a class="heading-anchor" href="#step-2-generate-function-docs" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&gt;</span><span class="w"> </span><span class="nx">Generate</span><span class="w"> </span><span class="nx">documentation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">heap_insert</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="nx">API</span><span class="w"> </span><span class="nx">Documentation</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">##</span><span class="w"> </span><span class="nx">heap_insert</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Inserts</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">tuple</span><span class="w"> </span><span class="nx">into</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">heap</span><span class="w"> </span><span class="nx">relation</span><span class="p">.</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">###</span><span class="w"> </span><span class="nx">Signature</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">```</span><span class="nx">c</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">void</span><span class="w"> </span><span class="nx">heap_insert</span><span class="p">(</span><span class="nx">Relation</span><span class="w"> </span><span class="nx">relation</span><span class="p">,</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                   </span><span class="nx">HeapTuple</span><span class="w"> </span><span class="nx">tup</span><span class="p">,</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                   </span><span class="nx">CommandId</span><span class="w"> </span><span class="nx">cid</span><span class="p">,</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                   </span><span class="nx">int</span><span class="w"> </span><span class="nx">options</span><span class="p">,</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                   </span><span class="nx">BulkInsertState</span><span class="w"> </span><span class="nx">bistate</span><span class="p">)</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">```</span><span class="w">                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">###</span><span class="w"> </span><span class="nx">Parameters</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">Parameter</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Type</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Description</span><span class="w"> </span><span class="o">|</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">|-----------|------|-------------|</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">relation</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Relation</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Target</span><span class="w"> </span><span class="nx">heap</span><span class="w"> </span><span class="nx">relation</span><span class="w"> </span><span class="o">|</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">tup</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">HeapTuple</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Tuple</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">insert</span><span class="w"> </span><span class="o">|</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">cid</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">CommandId</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="nx">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">MVCC</span><span class="w"> </span><span class="o">|</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">int</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Insert</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="nx">flags</span><span class="w"> </span><span class="o">|</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">bistate</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">BulkInsertState</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Bulk</span><span class="w"> </span><span class="nx">insert</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="o">|</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">###</span><span class="w"> </span><span class="nx">Returns</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">void</span><span class="w"> </span><span class="p">(</span><span class="nx">tuple</span><span class="w"> </span><span class="nx">modified</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">place</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">OID</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">applicable</span><span class="p">)</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">###</span><span class="w"> </span><span class="nx">Example</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">```</span><span class="nx">c</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">HeapTuple</span><span class="w"> </span><span class="nx">tuple</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">heap_form_tuple</span><span class="p">(</span><span class="nx">desc</span><span class="p">,</span><span class="w"> </span><span class="nx">values</span><span class="p">,</span><span class="w"> </span><span class="nx">nulls</span><span class="p">);</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">heap_insert</span><span class="p">(</span><span class="nx">rel</span><span class="p">,</span><span class="w"> </span><span class="nx">tuple</span><span class="p">,</span><span class="w"> </span><span class="nx">GetCurrentCommandId</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">              </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nx">NULL</span><span class="p">);</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">```</span><span class="w">                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">###</span><span class="w"> </span><span class="nx">See</span><span class="w"> </span><span class="nx">Also</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">heap_update</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Update</span><span class="w"> </span><span class="nx">existing</span><span class="w"> </span><span class="nx">tuple</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">heap_delete</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Delete</span><span class="w"> </span><span class="nx">tuple</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">simple_heap_insert</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Simplified</span><span class="w"> </span><span class="nx">wrapper</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">###</span><span class="w"> </span><span class="nx">Source</span><span class="w">                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">src</span><span class="o">/</span><span class="nx">backend</span><span class="o">/</span><span class="nx">access</span><span class="o">/</span><span class="nx">heap</span><span class="o">/</span><span class="nx">heapam</span><span class="p">.</span><span class="nx">c</span><span class="p">:</span><span class="mi">2156</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Document</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">SPI</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">functions</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Create</span><span class="w"> </span><span class="nx">API</span><span class="w"> </span><span class="nx">reference</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">lock</span><span class="w"> </span><span class="nx">management</span>
</code></pre></div>

<hr />
<h3 id="understanding-module-architecture">Understanding Module Architecture<a class="heading-anchor" href="#understanding-module-architecture" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Technical writer documenting system architecture.</p>
<div class="highlight"><pre><span></span><code><span class="p">&gt;</span><span class="w"> </span><span class="nx">Explain</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">executor</span><span class="w"> </span><span class="nx">module</span><span class="w"> </span><span class="nx">architecture</span>

<span class="err">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="nx">Architecture</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Executor</span><span class="w"> </span><span class="nx">Module</span><span class="w"> </span><span class="nx">Architecture</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Purpose</span><span class="p">:</span><span class="w"> </span><span class="nx">Execute</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">plans</span><span class="w"> </span><span class="nx">generated</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">planner</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Directory</span><span class="p">:</span><span class="w"> </span><span class="nx">src</span><span class="o">/</span><span class="nx">backend</span><span class="o">/</span><span class="nx">executor</span><span class="o">/</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Core</span><span class="w"> </span><span class="nx">Components</span><span class="p">:</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">execMain</span><span class="p">.</span><span class="nx">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Main</span><span class="w"> </span><span class="nx">executor</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="nx">points</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">ExecutorStart</span><span class="p">():</span><span class="w"> </span><span class="nx">Initialize</span><span class="w"> </span><span class="nx">execution</span><span class="w"> </span><span class="nx">state</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">ExecutorRun</span><span class="p">():</span><span class="w"> </span><span class="nx">Main</span><span class="w"> </span><span class="nx">execution</span><span class="w"> </span><span class="nx">loop</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">ExecutorEnd</span><span class="p">():</span><span class="w"> </span><span class="nx">Cleanup</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">shutdown</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">execProcnode</span><span class="p">.</span><span class="nx">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Node</span><span class="w"> </span><span class="nx">dispatcher</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">ExecProcNode</span><span class="p">():</span><span class="w"> </span><span class="nx">Route</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">specific</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="nx">types</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">ExecInitNode</span><span class="p">():</span><span class="w"> </span><span class="nx">Initialize</span><span class="w"> </span><span class="nx">plan</span><span class="w"> </span><span class="nx">nodes</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">ExecEndNode</span><span class="p">():</span><span class="w"> </span><span class="nx">Cleanup</span><span class="w"> </span><span class="nx">plan</span><span class="w"> </span><span class="nx">nodes</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Node</span><span class="o">-</span><span class="nx">specific</span><span class="w"> </span><span class="nx">executors</span><span class="p">:</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">nodeSeqscan</span><span class="p">.</span><span class="nx">c</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Sequential</span><span class="w"> </span><span class="nx">scan</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">nodeIndexscan</span><span class="p">.</span><span class="nx">c</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Index</span><span class="w"> </span><span class="nx">scan</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">nodeHashjoin</span><span class="p">.</span><span class="nx">c</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Hash</span><span class="w"> </span><span class="nx">join</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">nodeMergejoin</span><span class="p">.</span><span class="nx">c</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Merge</span><span class="w"> </span><span class="nx">join</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">nodeAgg</span><span class="p">.</span><span class="nx">c</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nx">Aggregation</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">nodeSort</span><span class="p">.</span><span class="nx">c</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="nx">Sorting</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Data</span><span class="w"> </span><span class="nx">Flow</span><span class="p">:</span><span class="w">                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Plan</span><span class="w"> </span><span class="nx">Tree</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">PlanState</span><span class="w"> </span><span class="nx">Tree</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Tuple</span><span class="w"> </span><span class="nx">Output</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Dependencies</span><span class="p">:</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="nx">access</span><span class="o">/</span><span class="w">    </span><span class="p">(</span><span class="nx">storage</span><span class="w"> </span><span class="nx">layer</span><span class="p">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="nx">utils</span><span class="o">/</span><span class="w">     </span><span class="p">(</span><span class="nx">memory</span><span class="p">,</span><span class="w"> </span><span class="nx">cache</span><span class="p">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="nx">nodes</span><span class="o">/</span><span class="w">     </span><span class="p">(</span><span class="nx">node</span><span class="w"> </span><span class="nx">definitions</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">What</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">main</span><span class="w"> </span><span class="nx">components</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">WAL</span><span class="p">?</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">How</span><span class="w"> </span><span class="nx">does</span><span class="w"> </span><span class="nx">MVCC</span><span class="w"> </span><span class="nx">work</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">PostgreSQL</span><span class="p">?</span>
</code></pre></div>

<hr />
<h3 id="creating-function-references">Creating Function References<a class="heading-anchor" href="#creating-function-references" title="Link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> Technical writer building function index.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nv">List</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">public</span><span class="w"> </span><span class="nv">functions</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">executor</span><span class="w"> </span><span class="nv">module</span>

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w"> </span><span class="nv">Function</span><span class="w"> </span><span class="nv">Reference</span><span class="w"> </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚<span class="w">                                                           </span>â”‚
â”‚<span class="w">  </span><span class="nv">Executor</span><span class="w"> </span><span class="nv">Public</span><span class="w"> </span><span class="nv">Functions</span><span class="w">                                </span>â”‚
â”‚<span class="w">  </span>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•<span class="w">                                </span>â”‚
â”‚<span class="w">                                                           </span>â”‚
â”‚<span class="w">  </span><span class="nv">Entry</span><span class="w"> </span><span class="nv">Points</span>:<span class="w">                                            </span>â”‚
â”‚<span class="w">  </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">                                            </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecutorStart</span><span class="ss">()</span><span class="w">      </span><span class="nv">Initialize</span><span class="w"> </span><span class="nv">execution</span><span class="w">                </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecutorRun</span><span class="ss">()</span><span class="w">        </span><span class="nv">Execute</span><span class="w"> </span><span class="nv">plan</span><span class="w">                        </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecutorFinish</span><span class="ss">()</span><span class="w">     </span><span class="nv">Post</span><span class="o">-</span><span class="nv">execution</span><span class="w"> </span><span class="nv">processing</span><span class="w">           </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecutorEnd</span><span class="ss">()</span><span class="w">        </span><span class="nv">Cleanup</span><span class="w">                             </span>â”‚
â”‚<span class="w">                                                           </span>â”‚
â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="nv">Operations</span>:<span class="w">                                         </span>â”‚
â”‚<span class="w">  </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">                                         </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecProcNode</span><span class="ss">()</span><span class="w">       </span><span class="nv">Execute</span><span class="w"> </span><span class="nv">single</span><span class="w"> </span><span class="nv">node</span><span class="w">                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecInitNode</span><span class="ss">()</span><span class="w">       </span><span class="nv">Initialize</span><span class="w"> </span><span class="nv">node</span><span class="w">                     </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecEndNode</span><span class="ss">()</span><span class="w">        </span><span class="nv">Cleanup</span><span class="w"> </span><span class="nv">node</span><span class="w">                        </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecReScan</span><span class="ss">()</span><span class="w">         </span><span class="nv">Reset</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">rescan</span><span class="w">                    </span>â”‚
â”‚<span class="w">                                                           </span>â”‚
â”‚<span class="w">  </span><span class="nv">Tuple</span><span class="w"> </span><span class="nv">Operations</span>:<span class="w">                                        </span>â”‚
â”‚<span class="w">  </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">                                        </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecStoreTuple</span><span class="ss">()</span><span class="w">     </span><span class="nv">Store</span><span class="w"> </span><span class="nv">tuple</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">slot</span><span class="w">                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecClearTuple</span><span class="ss">()</span><span class="w">     </span><span class="nv">Clear</span><span class="w"> </span><span class="nv">slot</span><span class="w">                          </span>â”‚
â”‚<span class="w">  </span><span class="nv">ExecCopySlot</span><span class="ss">()</span><span class="w">       </span><span class="nv">Copy</span><span class="w"> </span><span class="nv">slot</span><span class="w"> </span><span class="nv">contents</span><span class="w">                  </span>â”‚
â”‚<span class="w">                                                           </span>â”‚
â”‚<span class="w">  </span><span class="nv">Total</span>:<span class="w"> </span><span class="mi">156</span><span class="w"> </span><span class="nv">public</span><span class="w"> </span><span class="nv">functions</span><span class="w">                              </span>â”‚
â”‚<span class="w">                                                           </span>â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

<span class="o">&gt;</span><span class="w"> </span><span class="k">Show</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">entry</span><span class="w"> </span><span class="nv">points</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">their</span><span class="w"> </span><span class="nv">signatures</span>
</code></pre></div>

<h4 id="using-direct-sql-query">Using Direct SQL Query<a class="heading-anchor" href="#using-direct-sql-query" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/query SELECT name, signature, filename FROM nodes_method
       WHERE filename LIKE &#39;%executor%&#39;
       ORDER BY name
       LIMIT 20

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Query Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                           â”‚
â”‚  name              | signature              | filename    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  ExecAgg           | ExecAgg(PlanState*)    | nodeAgg.c   â”‚
â”‚  ExecAppend        | ExecAppend(...)        | nodeAppend  â”‚
â”‚  ExecBitmapAnd     | ExecBitmapAnd(...)     | nodeBitma   â”‚
â”‚  ...               | ...                    | ...         â”‚
â”‚                                                           â”‚
â”‚  20 rows returned                                         â”‚
â”‚                                                           â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre></div>

<hr />
<h2 id="tui-command-reference">TUI Command Reference<a class="heading-anchor" href="#tui-command-reference" title="Link to this section">&para;</a></h2>
<h3 id="all-commands">All Commands<a class="heading-anchor" href="#all-commands" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Command</th>
<th>Arguments</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/help</code></td>
<td><code>[command]</code></td>
<td>Show help for all commands or specific command</td>
</tr>
<tr>
<td><code>/scenarios</code></td>
<td><code>[group]</code></td>
<td>List available scenarios, optionally filtered</td>
</tr>
<tr>
<td><code>/select</code></td>
<td><code>&lt;number&gt;</code></td>
<td>Select scenario by number (01-16)</td>
</tr>
<tr>
<td><code>/history</code></td>
<td><code>[count]</code></td>
<td>Show conversation history</td>
</tr>
<tr>
<td><code>/save</code></td>
<td><code>[filename]</code></td>
<td>Save current session</td>
</tr>
<tr>
<td><code>/load</code></td>
<td><code>&lt;filename&gt;</code></td>
<td>Load saved session</td>
</tr>
<tr>
<td><code>/config</code></td>
<td><code>[section] [key] [value]</code></td>
<td>View or edit configuration</td>
</tr>
<tr>
<td><code>/stat</code></td>
<td></td>
<td>Show CPG and ChromaDB statistics</td>
</tr>
<tr>
<td><code>/query</code></td>
<td><code>&lt;SQL&gt;</code></td>
<td>Execute SQL on CPG database</td>
</tr>
<tr>
<td><code>/review</code></td>
<td><code>[source] [id] [--format] [--inline]</code></td>
<td>Launch code review</td>
</tr>
<tr>
<td><code>/demo</code></td>
<td><code>[--scenarios N,N] [--lang en\|ru]</code></td>
<td>Run quick benchmark</td>
</tr>
<tr>
<td><code>/clear</code></td>
<td></td>
<td>Clear the screen</td>
</tr>
<tr>
<td><code>/exit</code></td>
<td></td>
<td>Exit the application</td>
</tr>
<tr>
<td><code>/project</code></td>
<td><code>[list\|switch\|add]</code></td>
<td>Manage CPG projects</td>
</tr>
</tbody>
</table></div>
<h3 id="command-details">Command Details<a class="heading-anchor" href="#command-details" title="Link to this section">&para;</a></h3>
<h4 id="project">/project<a class="heading-anchor" href="#project" title="Link to this section">&para;</a></h4>
<p>Manage multiple CPG projects (switch between different codebases).</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Show current project info</span>
/project

<span class="c1"># List all available projects</span>
/project<span class="w"> </span>list

<span class="c1"># Switch to a different project</span>
/project<span class="w"> </span>switch<span class="w"> </span>fsin_module
/project<span class="w"> </span>switch<span class="w"> </span>postgresql

<span class="c1"># Add a new project</span>
/project<span class="w"> </span>add<span class="w"> </span>myproject<span class="w"> </span>path/to/project.duckdb<span class="w"> </span>python<span class="w"> </span><span class="s2">&quot;My Python Project&quot;</span>
</code></pre></div>

<p><strong>Project Configuration (projects.yaml):</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">projects</span><span class="p">:</span>
<span class="w">  </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">    </span><span class="nt">db_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cpg.duckdb&quot;</span>
<span class="w">    </span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PostgreSQL</span><span class="nv"> </span><span class="s">17</span><span class="nv"> </span><span class="s">source</span><span class="nv"> </span><span class="s">code&quot;</span>
<span class="w">  </span><span class="nt">fsin_module</span><span class="p">:</span>
<span class="w">    </span><span class="nt">db_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;workspace/fsin_module_v2.duckdb&quot;</span>
<span class="w">    </span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Django</span><span class="nv"> </span><span class="s">FSIN</span><span class="nv"> </span><span class="s">Module&quot;</span>

<span class="nt">active_project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
</code></pre></div>

<p><strong>Domain Auto-Switching:</strong></p>
<p>When switching projects, the system automatically activates the appropriate domain plugin:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Language</th>
<th>Domain Plugin</th>
<th>Security Patterns</th>
</tr>
</thead>
<tbody>
<tr>
<td>c, cpp</td>
<td>postgresql / generic_cpp</td>
<td>Memory safety, buffer overflow</td>
</tr>
<tr>
<td>python</td>
<td>python_django</td>
<td>SQL injection, XSS, CSRF</td>
</tr>
</tbody>
</table></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Example: switch to Python/Django project</span>
/project<span class="w"> </span>switch<span class="w"> </span>fsin_module
<span class="c1"># Output: Domain activated: python_django</span>

<span class="c1"># Example: switch back to C project</span>
/project<span class="w"> </span>switch<span class="w"> </span>postgresql
<span class="c1"># Output: Domain activated: postgresql</span>
</code></pre></div>

<h4 id="scenarios">/scenarios<a class="heading-anchor" href="#scenarios" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># List all scenarios</span>
/scenarios

<span class="c1"># Filter by group</span>
/scenarios<span class="w"> </span>security<span class="w">    </span><span class="c1"># Security-related scenarios</span>
/scenarios<span class="w"> </span>dev<span class="w">         </span><span class="c1"># Development scenarios</span>
/scenarios<span class="w"> </span>qa<span class="w">          </span><span class="c1"># Quality assurance scenarios</span>
</code></pre></div>

<h4 id="select">/select<a class="heading-anchor" href="#select" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Select by number</span>
/select<span class="w"> </span><span class="m">1</span><span class="w">     </span><span class="c1"># Onboarding</span>
/select<span class="w"> </span><span class="m">02</span><span class="w">    </span><span class="c1"># Security Audit</span>
/select<span class="w"> </span><span class="m">15</span><span class="w">    </span><span class="c1"># Debugging</span>
</code></pre></div>

<h4 id="config">/config<a class="heading-anchor" href="#config" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># View all configuration sections</span>
/config

<span class="c1"># View specific section</span>
/config<span class="w"> </span>llm

<span class="c1"># Set a value</span>
/config<span class="w"> </span>llm<span class="w"> </span>temperature<span class="w"> </span><span class="m">0</span>.7
/config<span class="w"> </span>llm<span class="w"> </span>provider<span class="w"> </span>gigachat
</code></pre></div>

<h4 id="query">/query<a class="heading-anchor" href="#query" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Basic queries</span>
/query<span class="w"> </span>SELECT<span class="w"> </span>COUNT<span class="o">(</span>*<span class="o">)</span><span class="w"> </span>FROM<span class="w"> </span>nodes_method
/query<span class="w"> </span>SELECT<span class="w"> </span>name,<span class="w"> </span>filename<span class="w"> </span>FROM<span class="w"> </span>nodes_method<span class="w"> </span>WHERE<span class="w"> </span>name<span class="w"> </span>LIKE<span class="w"> </span><span class="s1">&#39;heap%&#39;</span>

<span class="c1"># Describe tables</span>
/query<span class="w"> </span>DESCRIBE<span class="w"> </span>nodes_method
/query<span class="w"> </span>SHOW<span class="w"> </span>TABLES

<span class="c1"># Complex queries</span>
/query<span class="w"> </span>SELECT<span class="w"> </span>caller.name,<span class="w"> </span>callee.name
<span class="w">       </span>FROM<span class="w"> </span>edges_call<span class="w"> </span>e
<span class="w">       </span>JOIN<span class="w"> </span>nodes_method<span class="w"> </span><span class="nb">caller</span><span class="w"> </span>ON<span class="w"> </span>e.src<span class="w"> </span><span class="o">=</span><span class="w"> </span>caller.id
<span class="w">       </span>JOIN<span class="w"> </span>nodes_method<span class="w"> </span>callee<span class="w"> </span>ON<span class="w"> </span>e.dst<span class="w"> </span><span class="o">=</span><span class="w"> </span>callee.id
<span class="w">       </span>WHERE<span class="w"> </span>callee.name<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;palloc&#39;</span>
<span class="w">       </span>LIMIT<span class="w"> </span><span class="m">10</span>
</code></pre></div>

<h4 id="review">/review<a class="heading-anchor" href="#review" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Interactive mode (choose source)</span>
/review

<span class="c1"># GitHub PR</span>
/review<span class="w"> </span>github<span class="w"> </span><span class="m">123</span>
/review<span class="w"> </span>github<span class="w"> </span><span class="m">123</span><span class="w"> </span>--format<span class="w"> </span>json

<span class="c1"># GitLab MR</span>
/review<span class="w"> </span>gitlab<span class="w"> </span><span class="m">456</span><span class="w"> </span>--inline

<span class="c1"># Local git changes</span>
/review<span class="w"> </span>git
/review<span class="w"> </span>git<span class="w"> </span>--format<span class="w"> </span>yaml

<span class="c1"># Patch file</span>
/review<span class="w"> </span>file<span class="w"> </span>changes.patch<span class="w"> </span>--format<span class="w"> </span>md<span class="w"> </span>--inline
</code></pre></div>

<hr />
<h2 id="configuration-guide">Configuration Guide<a class="heading-anchor" href="#configuration-guide" title="Link to this section">&para;</a></h2>
<h3 id="llm-provider-setup">LLM Provider Setup<a class="heading-anchor" href="#llm-provider-setup" title="Link to this section">&para;</a></h3>
<h4 id="gigachat-sber">GigaChat (Sber)<a class="heading-anchor" href="#gigachat-sber" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># config.yaml</span>
<span class="nt">llm</span><span class="p">:</span>
<span class="w">  </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gigachat&quot;</span>
<span class="w">  </span><span class="nt">gigachat</span><span class="p">:</span>
<span class="w">    </span><span class="nt">credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${GIGACHAT_AUTH_KEY}</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GigaChat-2&quot;</span><span class="w">  </span><span class="c1"># or GigaChat-2-Pro, GigaChat-2-Max</span>
<span class="w">    </span><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Environment variable</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">GIGACHAT_AUTH_KEY</span><span class="o">=</span><span class="s2">&quot;your-base64-encoded-key&quot;</span>
</code></pre></div>

<h4 id="openai">OpenAI<a class="heading-anchor" href="#openai" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># config.yaml</span>
<span class="nt">llm</span><span class="p">:</span>
<span class="w">  </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;openai&quot;</span>
<span class="w">  </span><span class="nt">openai</span><span class="p">:</span>
<span class="w">    </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_API_KEY}</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gpt-4&quot;</span>
<span class="w">    </span><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Environment variable</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OPENAI_API_KEY</span><span class="o">=</span><span class="s2">&quot;sk-...&quot;</span>
</code></pre></div>

<h4 id="local-model-llamacpp">Local Model (llama.cpp)<a class="heading-anchor" href="#local-model-llamacpp" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># config.yaml</span>
<span class="nt">llm</span><span class="p">:</span>
<span class="w">  </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;local&quot;</span>
<span class="w">  </span><span class="nt">local</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${LLMXCPG_MODEL_PATH}</span>
<span class="w">    </span><span class="nt">n_gpu_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-1</span><span class="w">  </span><span class="c1"># All layers on GPU</span>
<span class="w">    </span><span class="nt">n_ctx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8192</span>
</code></pre></div>

<h3 id="retrieval-settings">Retrieval Settings<a class="heading-anchor" href="#retrieval-settings" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">retrieval</span><span class="p">:</span>
<span class="w">  </span><span class="nt">embedding_model</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;all-MiniLM-L6-v2&quot;</span>
<span class="w">  </span><span class="nt">top_k_qa</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span><span class="w">       </span><span class="c1"># QA examples to retrieve</span>
<span class="w">  </span><span class="nt">max_results</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span><span class="w">   </span><span class="c1"># Maximum search results</span>
</code></pre></div>

<h3 id="query-limits">Query Limits<a class="heading-anchor" href="#query-limits" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">query</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w">  </span><span class="c1"># Default LIMIT for SQL</span>
<span class="w">  </span><span class="nt">max_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span><span class="w">     </span><span class="c1"># Maximum allowed LIMIT</span>
</code></pre></div>

<hr />
<h2 id="appendix-all-16-scenarios">Appendix: All 16 Scenarios<a class="heading-anchor" href="#appendix-all-16-scenarios" title="Link to this section">&para;</a></h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>#</th>
<th>Name</th>
<th>Best For</th>
<th>Example Query</th>
</tr>
</thead>
<tbody>
<tr>
<td>01</td>
<td>Onboarding</td>
<td>New developers</td>
<td>&ldquo;Where is function X defined?&rdquo;</td>
</tr>
<tr>
<td>02</td>
<td>Security Audit</td>
<td>Security team</td>
<td>&ldquo;Find SQL injection vulnerabilities&rdquo;</td>
</tr>
<tr>
<td>03</td>
<td>Documentation</td>
<td>Tech writers</td>
<td>&ldquo;Generate docs for function X&rdquo;</td>
</tr>
<tr>
<td>04</td>
<td>Feature Development</td>
<td>Adding features</td>
<td>&ldquo;Where to add a new hook?&rdquo;</td>
</tr>
<tr>
<td>05</td>
<td>Refactoring</td>
<td>Code cleanup</td>
<td>&ldquo;Find dead code in module X&rdquo;</td>
</tr>
<tr>
<td>06</td>
<td>Performance</td>
<td>Optimization</td>
<td>&ldquo;Find performance hotspots&rdquo;</td>
</tr>
<tr>
<td>07</td>
<td>Test Coverage</td>
<td>QA team</td>
<td>&ldquo;What functions lack tests?&rdquo;</td>
</tr>
<tr>
<td>08</td>
<td>Compliance</td>
<td>Auditors</td>
<td>&ldquo;Check OWASP Top 10&rdquo;</td>
</tr>
<tr>
<td>09</td>
<td>Code Review</td>
<td>Reviewers</td>
<td>&ldquo;Review this patch&rdquo;</td>
</tr>
<tr>
<td>10</td>
<td>Cross-Repo</td>
<td>Architects</td>
<td>&ldquo;Find cross-repo dependencies&rdquo;</td>
</tr>
<tr>
<td>11</td>
<td>Architecture</td>
<td>Architects</td>
<td>&ldquo;Find layering violations&rdquo;</td>
</tr>
<tr>
<td>12</td>
<td>Tech Debt</td>
<td>Managers</td>
<td>&ldquo;Quantify technical debt&rdquo;</td>
</tr>
<tr>
<td>13</td>
<td>Mass Refactoring</td>
<td>Large changes</td>
<td>&ldquo;Rename all X to Y&rdquo;</td>
</tr>
<tr>
<td>14</td>
<td>Incident Response</td>
<td>Security</td>
<td>&ldquo;Trace attack vector&rdquo;</td>
</tr>
<tr>
<td>15</td>
<td>Debugging</td>
<td>Developers</td>
<td>&ldquo;Find debug points&rdquo;</td>
</tr>
<tr>
<td>16</td>
<td>Entry Points</td>
<td>Security</td>
<td>&ldquo;List all API endpoints&rdquo;</td>
</tr>
</tbody>
</table></div>
<h3 id="scenario-selection-guide">Scenario Selection Guide<a class="heading-anchor" href="#scenario-selection-guide" title="Link to this section">&para;</a></h3>
<p><strong>For Developers:</strong>
- Day 1: Scenario 01 (Onboarding)
- Feature work: Scenario 04 (Feature Development)
- Bug fixing: Scenario 15 (Debugging)
- Cleanup: Scenario 05 (Refactoring)</p>
<p><strong>For QA/Testers:</strong>
- Coverage gaps: Scenario 07 (Test Coverage)
- Code review: Scenario 09 (Code Review)
- Quality metrics: Scenario 12 (Tech Debt)</p>
<p><strong>For Security:</strong>
- Vulnerability scan: Scenario 02 (Security Audit)
- Compliance: Scenario 08 (Compliance)
- Incident: Scenario 14 (Incident Response)
- Attack surface: Scenario 16 (Entry Points)</p>
<p><strong>For Technical Writers:</strong>
- API docs: Scenario 03 (Documentation)
- Architecture: Scenario 11 (Architecture)
- Dependencies: Scenario 10 (Cross-Repo)</p>
<hr />
<h2 id="security-audit-reports-cli">Security Audit Reports (CLI)<a class="heading-anchor" href="#security-audit-reports-cli" title="Link to this section">&para;</a></h2>
<h3 id="overview">Overview<a class="heading-anchor" href="#overview" title="Link to this section">&para;</a></h3>
<p>CodeGraph provides a CLI tool for generating comprehensive security audit reports.
Reports can be generated in multiple formats (Markdown, JSON, SARIF) with full
localization support (English, Russian).</p>
<h3 id="scenario-django-project-security-audit">Scenario: Django Project Security Audit<a class="heading-anchor" href="#scenario-django-project-security-audit" title="Link to this section">&para;</a></h3>
<p><strong>Situation:</strong> Security engineer needs to audit a Django project before production deployment.</p>
<h4 id="step-1-run-full-security-scan">Step 1: Run Full Security Scan<a class="heading-anchor" href="#step-1-run-full-security-scan" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>src.cli.security_audit<span class="w"> </span>full<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--path<span class="w"> </span>/path/to/django/project<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--output-dir<span class="w"> </span>./security_reports<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--language<span class="w"> </span>ru
</code></pre></div>

<h4 id="step-2-review-generated-report">Step 2: Review Generated Report<a class="heading-anchor" href="#step-2-review-generated-report" title="Link to this section">&para;</a></h4>
<p>The tool generates three files:</p>
<ul>
<li><code>security_report.md</code> - Human-readable Markdown report</li>
<li><code>security_report.json</code> - Machine-readable JSON for CI/CD</li>
<li><code>security_report.sarif</code> - GitHub Security Alerts format</li>
</ul>
<h4 id="example-output-markdown">Example Output (Markdown)<a class="heading-anchor" href="#example-output-markdown" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh"># Security Report: My Django Project</span>

<span class="gs">**Project Path:**</span> <span class="sb">`/path/to/django/project`</span>
<span class="gs">**Audit Time:**</span> 2025-12-09 20:43:19
<span class="gs">**Files Analyzed:**</span> 88

<span class="gu">## Summary</span>

| Severity | Count |
|----------|-------|
| ğŸ”´ CRITICAL | 2 |
| ğŸŸ  HIGH | 6 |
| ğŸŸ¡ MEDIUM | 2 |

<span class="gu">## ğŸ”´ CRITICAL Level (2) Vulnerabilities</span>

<span class="gu">### 1. SECRET_KEY with Fallback (File Scan)</span>

<span class="gs">**File:**</span> <span class="sb">`backend/settings.py:25`</span>
<span class="gs">**CWE:**</span> CWE-798

<span class="gs">**Description:**</span> SECRET_KEY with insecure fallback value

<span class="gs">**Vulnerable Code:**</span>
```python
SECRET_KEY = os.environ.get(&#39;SECRET_KEY&#39;, &#39;insecure-fallback&#39;)
</code></pre></div>

<p><strong>Recommendation:</strong>
Remove the fallback value: SECRET_KEY = os.environ[&ldquo;SECRET_KEY&rdquo;]</p>
<div class="highlight"><pre><span></span><code><span class="gu">##</span># Scenario: Quick Security Check

**Situation:** Developer wants a quick vulnerability scan before commit.

```bash
python -m src.cli.security_audit quick --path .

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Quick Scan Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                           â”‚
â”‚  Files scanned: 45                                        â”‚
â”‚  Time: 0.3s                                               â”‚
â”‚                                                           â”‚
â”‚  Findings:                                                â”‚
â”‚    ğŸ”´ Critical: 0                                         â”‚
â”‚    ğŸŸ  High: 2                                             â”‚
â”‚    ğŸŸ¡ Medium: 1                                           â”‚
â”‚                                                           â”‚
â”‚  Run &#39;security-audit full&#39; for detailed report            â”‚
â”‚                                                           â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre></div>

<h3 id="scenario-cicd-integration">Scenario: CI/CD Integration<a class="heading-anchor" href="#scenario-cicd-integration" title="Link to this section">&para;</a></h3>
<p><strong>Situation:</strong> Add security checks to GitLab CI pipeline.</p>
<h4 id="gitlab-ciyml"><code>.gitlab-ci.yml</code><a class="heading-anchor" href="#gitlab-ciyml" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nt">security-audit</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install -r requirements.txt</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python -m src.cli.security_audit full \</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">--path . \</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">--output-dir ./security_reports \</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">--format json,sarif</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">CRITICAL=$(jq &#39;.summary.critical_issues&#39; security_reports/security_report.json)</span>
<span class="w">      </span><span class="no">if [ &quot;$CRITICAL&quot; -gt 0 ]; then</span>
<span class="w">        </span><span class="no">echo &quot;âŒ Critical vulnerabilities found!&quot;</span>
<span class="w">        </span><span class="no">exit 1</span>
<span class="w">      </span><span class="no">fi</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_reports/</span>
<span class="w">    </span><span class="nt">reports</span><span class="p">:</span>
<span class="w">      </span><span class="nt">sast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_reports/security_report.sarif</span>
</code></pre></div>

<h3 id="programmatic-usage">Programmatic Usage<a class="heading-anchor" href="#programmatic-usage" title="Link to this section">&para;</a></h3>
<p><strong>Situation:</strong> Generate reports from Python code.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.file_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileSecurityScanner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.security.report_generator</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReportGenerator</span>

<span class="c1"># Initialize scanner</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">FileSecurityScanner</span><span class="p">()</span>

<span class="c1"># Run scan</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan_project</span><span class="p">(</span><span class="s1">&#39;/path/to/project&#39;</span><span class="p">)</span>

<span class="c1"># Generate report</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">ReportGenerator</span><span class="p">()</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s1">&#39;My Project&#39;</span><span class="p">,</span>
    <span class="n">project_path</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span>
    <span class="n">scan_result</span><span class="o">=</span><span class="n">result</span>
<span class="p">)</span>

<span class="c1"># Save in multiple formats</span>
<span class="n">output_files</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">save_report</span><span class="p">(</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;./reports&#39;</span><span class="p">,</span>
    <span class="n">formats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;markdown&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="s1">&#39;sarif&#39;</span><span class="p">],</span>
    <span class="n">language</span><span class="o">=</span><span class="s1">&#39;ru&#39;</span>  <span class="c1"># Russian localization</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Report saved to: </span><span class="si">{</span><span class="n">output_files</span><span class="p">[</span><span class="s1">&#39;markdown&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="detected-vulnerability-patterns">Detected Vulnerability Patterns<a class="heading-anchor" href="#detected-vulnerability-patterns" title="Link to this section">&para;</a></h3>
<p>The security scanner detects Django/Python specific patterns:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Pattern ID</th>
<th>Severity</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FILE_SECRET_FALLBACK_001</code></td>
<td>Critical</td>
<td>SECRET_KEY with insecure fallback</td>
</tr>
<tr>
<td><code>FILE_DJANGO_DEBUG_001</code></td>
<td>Critical</td>
<td>DEBUG=True in production</td>
</tr>
<tr>
<td><code>FILE_CORS_001</code></td>
<td>High</td>
<td>CORS_ALLOW_ALL_ORIGINS=True</td>
</tr>
<tr>
<td><code>FILE_HOSTS_001</code></td>
<td>High</td>
<td>ALLOWED_HOSTS=[&lsquo;*&rsquo;]</td>
</tr>
<tr>
<td><code>FILE_DB_001</code></td>
<td>High</td>
<td>Default database password</td>
</tr>
<tr>
<td><code>FILE_JWT_001</code></td>
<td>High</td>
<td>JWT access token &gt; 24h</td>
</tr>
<tr>
<td><code>FILE_PATH_001</code></td>
<td>High</td>
<td>Path traversal risk</td>
</tr>
<tr>
<td><code>FILE_DEBUG_PERM_001</code></td>
<td>High</td>
<td>Permission based on DEBUG</td>
</tr>
<tr>
<td><code>FILE_TOOLBAR_001</code></td>
<td>Medium</td>
<td>Debug toolbar unconditionally enabled</td>
</tr>
<tr>
<td><code>FILE_PAGESIZE_001</code></td>
<td>Medium</td>
<td>PAGE_SIZE &gt; 1000 (DoS risk)</td>
</tr>
</tbody>
</table></div>
<h3 id="d3fend-compliance-section">D3FEND Compliance Section<a class="heading-anchor" href="#d3fend-compliance-section" title="Link to this section">&para;</a></h3>
<p>Reports include MITRE D3FEND Source Code Hardening compliance:</p>
<div class="highlight"><pre><span></span><code><span class="gu">## Ğ¡Ğ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ D3FEND Source Code Hardening</span>

| Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° | ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ |
|---------|----------|--------|--------------|
| D3-CS | ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° ÑƒÑ‡Ñ‘Ñ‚Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… | âœ… | ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ğ¾ Ğ´Ğ»Ñ Python |
| D3-DLV | Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾Ğ¼ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ | âœ… | ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ğ¾ Ğ´Ğ»Ñ Python |
| D3-OLV | Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ¾Ğ¹ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ | âœ… | ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ğ¾ Ğ´Ğ»Ñ Python |
| D3-VI | Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… | N/A | Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ C/C++ |

<span class="gs">**ĞĞ±Ñ‰Ğ¸Ğ¹ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ñ:**</span> 100% (3/3 Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ñ‹Ñ… Ñ‚ĞµÑ…Ğ½Ğ¸Ğº)
</code></pre></div>

<hr />
<h2 id="common-workflows">Common Workflows<a class="heading-anchor" href="#common-workflows" title="Link to this section">&para;</a></h2>
<h3 id="daily-security-check">Daily Security Check<a class="heading-anchor" href="#daily-security-check" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Morning security review</span>
/select<span class="w"> </span><span class="m">02</span>
&gt;<span class="w"> </span>Find<span class="w"> </span>new<span class="w"> </span>vulnerabilities<span class="w"> </span><span class="k">in</span><span class="w"> </span>recently<span class="w"> </span>modified<span class="w"> </span>files
/review<span class="w"> </span>git
/exit
</code></pre></div>

<h3 id="weekly-code-quality">Weekly Code Quality<a class="heading-anchor" href="#weekly-code-quality" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Weekly quality review</span>
/select<span class="w"> </span><span class="m">05</span>
&gt;<span class="w"> </span>Find<span class="w"> </span>dead<span class="w"> </span>code<span class="w"> </span>introduced<span class="w"> </span>this<span class="w"> </span>week

/select<span class="w"> </span><span class="m">12</span>
&gt;<span class="w"> </span>Show<span class="w"> </span>technical<span class="w"> </span>debt<span class="w"> </span>summary

/select<span class="w"> </span><span class="m">07</span>
&gt;<span class="w"> </span>What<span class="w"> </span>new<span class="w"> </span>functions<span class="w"> </span>lack<span class="w"> </span><span class="nb">test</span><span class="w"> </span>coverage?
</code></pre></div>

<h3 id="pre-release-audit">Pre-Release Audit<a class="heading-anchor" href="#pre-release-audit" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Before major release</span>
/select<span class="w"> </span><span class="m">08</span>
&gt;<span class="w"> </span>Generate<span class="w"> </span>OWASP<span class="w"> </span>Top<span class="w"> </span><span class="m">10</span><span class="w"> </span>compliance<span class="w"> </span>report

/select<span class="w"> </span><span class="m">02</span>
&gt;<span class="w"> </span>Find<span class="w"> </span>all<span class="w"> </span>critical<span class="w"> </span>vulnerabilities

/review<span class="w"> </span>git<span class="w"> </span>--format<span class="w"> </span>json<span class="w"> </span>&gt;<span class="w"> </span>audit_report.json
</code></pre></div>

<h3 id="new-developer-onboarding">New Developer Onboarding<a class="heading-anchor" href="#new-developer-onboarding" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># First day setup</span>
/select<span class="w"> </span><span class="m">01</span>
&gt;<span class="w"> </span>Explain<span class="w"> </span>the<span class="w"> </span>overall<span class="w"> </span>architecture
&gt;<span class="w"> </span>What<span class="w"> </span>are<span class="w"> </span>the<span class="w"> </span>main<span class="w"> </span>subsystems?
&gt;<span class="w"> </span>Where<span class="w"> </span>should<span class="w"> </span>I<span class="w"> </span>start<span class="w"> </span>reading<span class="w"> </span>code?

/save<span class="w"> </span>onboarding_session
</code></pre></div>

<hr />
<h2 id="themes">Themes<a class="heading-anchor" href="#themes" title="Link to this section">&para;</a></h2>
<h3 id="available-themes">Available Themes<a class="heading-anchor" href="#available-themes" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Theme</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>default</code></td>
<td>Cyan accents, balanced contrast</td>
</tr>
<tr>
<td><code>dark</code></td>
<td>Magenta accents, dark-friendly</td>
</tr>
<tr>
<td><code>light</code></td>
<td>Blue accents, light terminal friendly</td>
</tr>
</tbody>
</table></div>
<h3 id="using-themes">Using Themes<a class="heading-anchor" href="#using-themes" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Command line</span>
python<span class="w"> </span>-m<span class="w"> </span>src.tui.app<span class="w"> </span>--theme<span class="w"> </span>dark

<span class="c1"># In config.yaml</span>
tui:
<span class="w">  </span>theme:<span class="w"> </span>dark
</code></pre></div>

<h3 id="theme-elements">Theme Elements<a class="heading-anchor" href="#theme-elements" title="Link to this section">&para;</a></h3>
<p>Themes customize:
- Title and subtitle colors
- Message colors (user, assistant, system, error)
- Border colors
- Scenario indicators
- Code highlighting
- Progress indicators</p>
<hr />
<h2 id="sessions">Sessions<a class="heading-anchor" href="#sessions" title="Link to this section">&para;</a></h2>
<h3 id="automatic-session-management">Automatic Session Management<a class="heading-anchor" href="#automatic-session-management" title="Link to this section">&para;</a></h3>
<p>Sessions are automatically:
- Created on TUI start
- Saved periodically during use
- Saved on exit</p>
<h3 id="manual-session-control">Manual Session Control<a class="heading-anchor" href="#manual-session-control" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>/save<span class="w">              </span><span class="c1"># Save current session</span>
/save<span class="w"> </span>analysis_v2<span class="w">  </span><span class="c1"># Save with custom name</span>
/load<span class="w">              </span><span class="c1"># List sessions</span>
/load<span class="w"> </span>analysis_v2<span class="w">  </span><span class="c1"># Load specific session</span>
</code></pre></div>

<h3 id="session-contents">Session Contents<a class="heading-anchor" href="#session-contents" title="Link to this section">&para;</a></h3>
<p>Sessions store:
- Conversation history
- Current scenario
- Configuration state
- Project context
- Metadata (timestamps, message counts)</p>
<h3 id="session-storage-location">Session Storage Location<a class="heading-anchor" href="#session-storage-location" title="Link to this section">&para;</a></h3>
<p>Default: <code>./sessions/</code></p>
<p>Custom: <code>python -m src.tui.app --session-dir /path/to/sessions</code></p>
<hr />
<h2 id="tips-tricks">Tips &amp; Tricks<a class="heading-anchor" href="#tips-tricks" title="Link to this section">&para;</a></h2>
<h3 id="keyboard-shortcuts">Keyboard Shortcuts<a class="heading-anchor" href="#keyboard-shortcuts" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Key</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Ctrl+C</code></td>
<td>Cancel current input</td>
</tr>
<tr>
<td><code>Ctrl+D</code></td>
<td>Exit (with confirmation)</td>
</tr>
<tr>
<td><code>Up Arrow</code></td>
<td>Previous command (readline)</td>
</tr>
<tr>
<td><code>Down Arrow</code></td>
<td>Next command (readline)</td>
</tr>
</tbody>
</table></div>
<h3 id="command-aliases">Command Aliases<a class="heading-anchor" href="#command-aliases" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Alias</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/h</code></td>
<td><code>/help</code></td>
</tr>
<tr>
<td><code>/q</code></td>
<td><code>/exit</code></td>
</tr>
<tr>
<td><code>/quit</code></td>
<td><code>/exit</code></td>
</tr>
<tr>
<td><code>/stats</code></td>
<td><code>/stat</code></td>
</tr>
<tr>
<td><code>/sql</code></td>
<td><code>/query</code></td>
</tr>
<tr>
<td><code>/proj</code></td>
<td><code>/project</code></td>
</tr>
<tr>
<td><code>/grp</code></td>
<td><code>/group</code></td>
</tr>
<tr>
<td><code>/sess</code></td>
<td><code>/session</code></td>
</tr>
<tr>
<td><code>/whoami</code></td>
<td><code>/auth me</code></td>
</tr>
</tbody>
</table></div>
<h3 id="efficient-workflows">Efficient Workflows<a class="heading-anchor" href="#efficient-workflows" title="Link to this section">&para;</a></h3>
<p><strong>Quick Security Audit:</strong></p>
<div class="highlight"><pre><span></span><code>/select<span class="w"> </span><span class="m">2</span>
Find<span class="w"> </span>SQL<span class="w"> </span>injection<span class="w"> </span>vulnerabilities
Find<span class="w"> </span><span class="nb">command</span><span class="w"> </span>injection<span class="w"> </span>risks
Find<span class="w"> </span>XSS<span class="w"> </span>vulnerabilities
</code></pre></div>

<p><strong>Code Exploration:</strong></p>
<div class="highlight"><pre><span></span><code>/select<span class="w"> </span><span class="m">1</span>
What<span class="w"> </span>does<span class="w"> </span>the<span class="w"> </span>main<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="k">do</span>?
Show<span class="w"> </span>me<span class="w"> </span>the<span class="w"> </span>call<span class="w"> </span>graph<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">function</span><span class="w"> </span>X
</code></pre></div>

<p><strong>Review Workflow:</strong></p>
<div class="highlight"><pre><span></span><code>/review<span class="w"> </span>git
<span class="c1"># Review results</span>
/save<span class="w"> </span>security_review_dec9
</code></pre></div>

<h3 id="query-tips">Query Tips<a class="heading-anchor" href="#query-tips" title="Link to this section">&para;</a></h3>
<ol>
<li><strong>Be specific</strong>: &ldquo;Find SQL injection in authentication module&rdquo; &gt; &ldquo;Find SQL injection&rdquo;</li>
<li><strong>Use scenario context</strong>: Select appropriate scenario before querying</li>
<li><strong>Check statistics first</strong>: Use <code>/stat</code> to understand database size</li>
<li><strong>Use SQL for precision</strong>: <code>/query SELECT * FROM nodes_method WHERE name LIKE '%auth%'</code></li>
</ol>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="heading-anchor" href="#troubleshooting" title="Link to this section">&para;</a></h2>
<h3 id="common-issues">Common Issues<a class="heading-anchor" href="#common-issues" title="Link to this section">&para;</a></h3>
<h4 id="copilot-not-available">&ldquo;Copilot not available&rdquo;<a class="heading-anchor" href="#copilot-not-available" title="Link to this section">&para;</a></h4>
<p><strong>Cause</strong>: ChromaDB not installed or initialization failed.</p>
<p><strong>Solutions:</strong></p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>chromadb
<span class="c1"># or</span>
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div>

<h4 id="database-not-found">&ldquo;Database not found&rdquo;<a class="heading-anchor" href="#database-not-found" title="Link to this section">&para;</a></h4>
<p><strong>Cause</strong>: No CPG database available.</p>
<p><strong>Solutions:</strong>
1. Import a project:
   <code>bash
   python -m src.cli.import_commands full --path ./mycode</code>
2. Check project configuration:
   <code>bash
   /project list</code></p>
<h4 id="llm-provider-error">&ldquo;LLM Provider Error&rdquo;<a class="heading-anchor" href="#llm-provider-error" title="Link to this section">&para;</a></h4>
<p><strong>Cause</strong>: Missing API credentials.</p>
<p><strong>Solutions:</strong>
1. Check environment variables:
   <code>bash
   echo $GIGACHAT_CREDENTIALS
   echo $OPENAI_API_KEY</code>
2. Verify config.yaml:
   <code>bash
   /config llm</code></p>
<h4 id="slow-responses">Slow Responses<a class="heading-anchor" href="#slow-responses" title="Link to this section">&para;</a></h4>
<p><strong>Cause</strong>: Large database or network latency.</p>
<p><strong>Solutions:</strong>
1. Check database statistics: <code>/stat</code>
2. Use more specific queries
3. Consider local LLM provider
4. Reduce context size in config.yaml:
   <code>yaml
   llm:
     local:
       n_ctx: 4096  # Reduce from 8192</code></p>
<h4 id="character-encoding-issues-windows">Character Encoding Issues (Windows)<a class="heading-anchor" href="#character-encoding-issues-windows" title="Link to this section">&para;</a></h4>
<p><strong>Cause</strong>: Terminal encoding mismatch.</p>
<p><strong>Solutions:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Set UTF-8 in PowerShell</span>
<span class="o">[</span>Console<span class="o">]</span>::OutputEncoding<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>System.Text.Encoding<span class="o">]</span>::UTF8

<span class="c1"># Or use Windows Terminal (recommended)</span>
</code></pre></div>

<h3 id="debug-mode">Debug Mode<a class="heading-anchor" href="#debug-mode" title="Link to this section">&para;</a></h3>
<p>Enable debug logging for troubleshooting:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>src.tui.app<span class="w"> </span>--debug
</code></pre></div>

<p>This shows:
- LLM API calls
- Database queries
- Retrieval operations
- Error stack traces</p>
<h3 id="log-files">Log Files<a class="heading-anchor" href="#log-files" title="Link to this section">&para;</a></h3>
<p>Logs are written to <code>logs/tui.log</code> (if configured).</p>
<h3 id="getting-help">Getting Help<a class="heading-anchor" href="#getting-help" title="Link to this section">&para;</a></h3>
<ul>
<li>Type <code>/help</code> for command reference</li>
<li>Type <code>/help &lt;command&gt;</code> for specific command help</li>
<li>Check logs in <code>logs/</code> directory</li>
<li>Report issues: https://github.com/anthropics/claude-code/issues</li>
</ul>
<hr />
<h2 id="see-also">See Also<a class="heading-anchor" href="#see-also" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="./CLI_GUIDE.html">CLI Guide</a> - Command-line interface</li>
<li><a href="./SCENARIOS.html">Scenarios</a> - Programmatic scenario usage</li>
<li><a href="../api/REST_API.html">REST API</a> - HTTP API reference</li>
<li><a href="../reference/SECURITY.html">Security</a> - Security features</li>
</ul>
<hr />
<p><em>Generated for CodeGraph v1.0</em></p>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="QUICK_REFERENCE.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Previous</span>
        <span class="doc-page-nav-title">CodeGraph Quick Reference</span>
      </a>

      <a href="CLI_GUIDE.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Next</span>
        <span class="doc-page-nav-title">CLI Guide</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Last updated: 2025-12-28</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/guides/TUI_USER_GUIDE.md" target="_blank" rel="noopener">Edit on GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">On this page</div>
      <ul class="doc-toc-list">
        <li><a href="#codegraph-user-guide" class="level-1">CodeGraph User Guide</a></li>
<li><a href="#table-of-contents" class="level-2">Table of Contents</a></li>
<li><a href="#quick-start" class="level-2">Quick Start</a></li>
<li><a href="#installation" class="level-3">Installation</a></li>
<li><a href="#clone-and-install-dependencies" class="level-1">Clone and install dependencies</a></li>
<li><a href="#set-up-api-credentials-choose-one" class="level-1">Set up API credentials (choose one)</a></li>
<li><a href="#or" class="level-1">OR</a></li>
<li><a href="#launch-the-tui" class="level-3">Launch the TUI</a></li>
<li><a href="#your-first-query" class="level-3">Your First Query</a></li>
<li><a href="#essential-commands" class="level-3">Essential Commands</a></li>
<li><a href="#developer-scenarios" class="level-2">Developer Scenarios</a></li>
<li><a href="#day-1-codebase-onboarding" class="level-3">Day 1: Codebase Onboarding</a></li>
<li><a href="#finding-function-definitions" class="level-3">Finding Function Definitions</a></li>
<li><a href="#adding-new-features" class="level-3">Adding New Features</a></li>
<li><a href="#debugging-assistance" class="level-3">Debugging Assistance</a></li>
<li><a href="#refactoring-code" class="level-3">Refactoring Code</a></li>
<li><a href="#qatester-scenarios" class="level-2">QA/Tester Scenarios</a></li>
<li><a href="#test-coverage-analysis" class="level-3">Test Coverage Analysis</a></li>
<li><a href="#code-review-assistance" class="level-3">Code Review Assistance</a></li>
<li><a href="#generating-test-cases" class="level-3">Generating Test Cases</a></li>
<li><a href="#security-specialist-scenarios" class="level-2">Security Specialist Scenarios</a></li>
<li><a href="#vulnerability-scanning" class="level-3">Vulnerability Scanning</a></li>
<li><a href="#taint-flow-analysis" class="level-3">Taint Flow Analysis</a></li>
<li><a href="#d3fend-source-code-hardening" class="level-3">D3FEND Source Code Hardening</a></li>
<li><a href="#initialize-scanner" class="level-1">Initialize scanner</a></li>
<li><a href="#compliance-checking" class="level-3">Compliance Checking</a></li>
<li><a href="#pythondjango-security-audit" class="level-3">Python/Django Security Audit</a></li>
<li><a href="#switch-to-django-project-first" class="level-1">Switch to Django project first</a></li>
<li><a href="#then-select-security-audit-scenario" class="level-1">Then select Security Audit scenario</a></li>
<li><a href="#ask-security-questions" class="level-1">Ask security questions</a></li>
<li><a href="#incident-response" class="level-3">Incident Response</a></li>
<li><a href="#technical-writer-scenarios" class="level-2">Technical Writer Scenarios</a></li>
<li><a href="#generating-api-documentation" class="level-3">Generating API Documentation</a></li>
<li><a href="#understanding-module-architecture" class="level-3">Understanding Module Architecture</a></li>
<li><a href="#creating-function-references" class="level-3">Creating Function References</a></li>
<li><a href="#tui-command-reference" class="level-2">TUI Command Reference</a></li>
<li><a href="#all-commands" class="level-3">All Commands</a></li>
<li><a href="#command-details" class="level-3">Command Details</a></li>
<li><a href="#show-current-project-info" class="level-1">Show current project info</a></li>
<li><a href="#list-all-available-projects" class="level-1">List all available projects</a></li>
<li><a href="#switch-to-a-different-project" class="level-1">Switch to a different project</a></li>
<li><a href="#add-a-new-project" class="level-1">Add a new project</a></li>
<li><a href="#example-switch-to-pythondjango-project" class="level-1">Example: switch to Python/Django project</a></li>
<li><a href="#output-domain-activated-python-django" class="level-1">Output: Domain activated: python_django</a></li>
<li><a href="#example-switch-back-to-c-project" class="level-1">Example: switch back to C project</a></li>
<li><a href="#output-domain-activated-postgresql" class="level-1">Output: Domain activated: postgresql</a></li>
<li><a href="#list-all-scenarios" class="level-1">List all scenarios</a></li>
<li><a href="#filter-by-group" class="level-1">Filter by group</a></li>
<li><a href="#select-by-number" class="level-1">Select by number</a></li>
<li><a href="#view-all-configuration-sections" class="level-1">View all configuration sections</a></li>
<li><a href="#view-specific-section" class="level-1">View specific section</a></li>
<li><a href="#set-a-value" class="level-1">Set a value</a></li>
<li><a href="#basic-queries" class="level-1">Basic queries</a></li>
<li><a href="#describe-tables" class="level-1">Describe tables</a></li>
<li><a href="#complex-queries" class="level-1">Complex queries</a></li>
<li><a href="#interactive-mode-choose-source" class="level-1">Interactive mode (choose source)</a></li>
<li><a href="#github-pr" class="level-1">GitHub PR</a></li>
<li><a href="#gitlab-mr" class="level-1">GitLab MR</a></li>
<li><a href="#local-git-changes" class="level-1">Local git changes</a></li>
<li><a href="#patch-file" class="level-1">Patch file</a></li>
<li><a href="#configuration-guide" class="level-2">Configuration Guide</a></li>
<li><a href="#llm-provider-setup" class="level-3">LLM Provider Setup</a></li>
<li><a href="#configyaml" class="level-1">config.yaml</a></li>
<li><a href="#environment-variable" class="level-1">Environment variable</a></li>
<li><a href="#configyaml" class="level-1">config.yaml</a></li>
<li><a href="#environment-variable" class="level-1">Environment variable</a></li>
<li><a href="#configyaml" class="level-1">config.yaml</a></li>
<li><a href="#retrieval-settings" class="level-3">Retrieval Settings</a></li>
<li><a href="#query-limits" class="level-3">Query Limits</a></li>
<li><a href="#appendix-all-16-scenarios" class="level-2">Appendix: All 16 Scenarios</a></li>
<li><a href="#scenario-selection-guide" class="level-3">Scenario Selection Guide</a></li>
<li><a href="#security-audit-reports-cli" class="level-2">Security Audit Reports (CLI)</a></li>
<li><a href="#overview" class="level-3">Overview</a></li>
<li><a href="#scenario-django-project-security-audit" class="level-3">Scenario: Django Project Security Audit</a></li>
<li><a href="#security-report-my-django-project" class="level-1">Security Report: My Django Project</a></li>
<li><a href="#summary" class="level-2">Summary</a></li>
<li><a href="#critical-level-2-vulnerabilities" class="level-2">ğŸ”´ CRITICAL Level (2) Vulnerabilities</a></li>
<li><a href="#1-secret-key-with-fallback-file-scan" class="level-3">1. SECRET_KEY with Fallback (File Scan)</a></li>
<li><a href="#scenario-quick-security-check" class="level-3">Scenario: Quick Security Check</a></li>
<li><a href="#scenario-cicd-integration" class="level-3">Scenario: CI/CD Integration</a></li>
<li><a href="#programmatic-usage" class="level-3">Programmatic Usage</a></li>
<li><a href="#initialize-scanner" class="level-1">Initialize scanner</a></li>
<li><a href="#run-scan" class="level-1">Run scan</a></li>
<li><a href="#generate-report" class="level-1">Generate report</a></li>
<li><a href="#save-in-multiple-formats" class="level-1">Save in multiple formats</a></li>
<li><a href="#detected-vulnerability-patterns" class="level-3">Detected Vulnerability Patterns</a></li>
<li><a href="#d3fend-compliance-section" class="level-3">D3FEND Compliance Section</a></li>
<li><a href="#sootvetstvie-d3fend-source-code-hardening" class="level-2">Ğ¡Ğ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ D3FEND Source Code Hardening</a></li>
<li><a href="#common-workflows" class="level-2">Common Workflows</a></li>
<li><a href="#daily-security-check" class="level-3">Daily Security Check</a></li>
<li><a href="#morning-security-review" class="level-1">Morning security review</a></li>
<li><a href="#weekly-code-quality" class="level-3">Weekly Code Quality</a></li>
<li><a href="#weekly-quality-review" class="level-1">Weekly quality review</a></li>
<li><a href="#pre-release-audit" class="level-3">Pre-Release Audit</a></li>
<li><a href="#before-major-release" class="level-1">Before major release</a></li>
<li><a href="#new-developer-onboarding" class="level-3">New Developer Onboarding</a></li>
<li><a href="#first-day-setup" class="level-1">First day setup</a></li>
<li><a href="#themes" class="level-2">Themes</a></li>
<li><a href="#available-themes" class="level-3">Available Themes</a></li>
<li><a href="#using-themes" class="level-3">Using Themes</a></li>
<li><a href="#command-line" class="level-1">Command line</a></li>
<li><a href="#in-configyaml" class="level-1">In config.yaml</a></li>
<li><a href="#theme-elements" class="level-3">Theme Elements</a></li>
<li><a href="#sessions" class="level-2">Sessions</a></li>
<li><a href="#automatic-session-management" class="level-3">Automatic Session Management</a></li>
<li><a href="#manual-session-control" class="level-3">Manual Session Control</a></li>
<li><a href="#session-contents" class="level-3">Session Contents</a></li>
<li><a href="#session-storage-location" class="level-3">Session Storage Location</a></li>
<li><a href="#tips-tricks" class="level-2">Tips & Tricks</a></li>
<li><a href="#keyboard-shortcuts" class="level-3">Keyboard Shortcuts</a></li>
<li><a href="#command-aliases" class="level-3">Command Aliases</a></li>
<li><a href="#efficient-workflows" class="level-3">Efficient Workflows</a></li>
<li><a href="#review-results" class="level-1">Review results</a></li>
<li><a href="#query-tips" class="level-3">Query Tips</a></li>
<li><a href="#troubleshooting" class="level-2">Troubleshooting</a></li>
<li><a href="#common-issues" class="level-3">Common Issues</a></li>
<li><a href="#or" class="level-1">or</a></li>
<li><a href="#set-utf-8-in-powershell" class="level-1">Set UTF-8 in PowerShell</a></li>
<li><a href="#or-use-windows-terminal-recommended" class="level-1">Or use Windows Terminal (recommended)</a></li>
<li><a href="#debug-mode" class="level-3">Debug Mode</a></li>
<li><a href="#log-files" class="level-3">Log Files</a></li>
<li><a href="#getting-help" class="level-3">Getting Help</a></li>
<li><a href="#see-also" class="level-2">See Also</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI copilot for source code analysis</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Product</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Features</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Integrations</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Documentation</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Getting Started</a></li>
              <li><a href="../guides/index.html" class="footer-link">Guides</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Resources</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Contacts</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
