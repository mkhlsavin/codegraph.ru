<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: Hypothesis System Reference">
  <meta name="keywords" content="CodeGraph, documentation, reference">

  <meta property="og:title" content="Hypothesis System Reference - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: Hypothesis System Reference">
  <meta property="og:type" content="article">

  <title>Hypothesis System Reference - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Problems</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Solution</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Features</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Integrations</a></li>
        <li><a href="../index.html" class="nav-link active">Documentation</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/reference/HYPOTHESIS_SYSTEM.html" class="active">EN</a>
          <a href="../../ru/reference/HYPOTHESIS_SYSTEM.html" class="">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Toggle theme">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Request Demo</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Problems</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Solution</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Features</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Integrations</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Documentation</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Request Demo</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Getting Started</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Overview</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Configuration Guide</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Installation Guide</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">User Guides</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../guides/index.html">Overview</a></li>
        <li><a href="../guides/BENCHMARK_GUIDE.html">Benchmark Framework Guide</a></li>
        <li><a href="../guides/CLI_GUIDE.html">CLI Guide</a></li>
        <li><a href="../guides/CODE_REVIEW.html">Automated Code Review</a></li>
        <li><a href="../guides/CPG_EXPORT.html">CPG Export Guide</a></li>
        <li><a href="../guides/MONITORING.html">Monitoring Guide</a></li>
        <li><a href="../guides/PROGRAMMATIC_GUIDE.html">User Guide</a></li>
        <li><a href="../guides/PROJECT_IMPORT.html">Importing a New Codebase</a></li>
        <li><a href="../guides/QUICK_REFERENCE.html">CodeGraph Quick Reference</a></li>
        <li><a href="../guides/REFACTORING.html">Refactoring Analysis Guide</a></li>
        <li><a href="../guides/SCENARIOS.html">Workflow Scenarios Guide</a></li>
        <li><a href="../guides/TROUBLESHOOTING.html">Troubleshooting Guide</a></li>
        <li><a href="../guides/TUI_USER_GUIDE.html">CodeGraph User Guide</a></li>
        <li><a href="../guides/01-onboarding.html">Scenario 01: Developer Onboarding</a></li>
        <li><a href="../guides/02-security-audit.html">Scenario 02: Security Audit</a></li>
        <li><a href="../guides/03-documentation.html">Scenario 03: Documentation Generation</a></li>
        <li><a href="../guides/04-feature-development.html">Scenario 04: Feature Development</a></li>
        <li><a href="../guides/05-refactoring.html">Scenario 05: Refactoring</a></li>
        <li><a href="../guides/06-performance.html">Scenario 06: Performance Analysis</a></li>
        <li><a href="../guides/07-test-coverage.html">Scenario 07: Test Coverage</a></li>
        <li><a href="../guides/08-compliance.html">Scenario 08: Compliance Checking</a></li>
        <li><a href="../guides/09-code-review.html">Scenario 09: Code Review</a></li>
        <li><a href="../guides/10-cross-repo.html">Scenario 10: Cross-Repository Analysis</a></li>
        <li><a href="../guides/11-architecture.html">Scenario 11: Architecture Analysis</a></li>
        <li><a href="../guides/12-tech-debt.html">Scenario 12: Tech Debt Assessment</a></li>
        <li><a href="../guides/13-mass-refactoring.html">Scenario 13: Mass Refactoring</a></li>
        <li><a href="../guides/14-incident-response.html">Scenario 14: Security Incident Response</a></li>
        <li><a href="../guides/15-debugging.html">Scenario 15: Debugging Assistance</a></li>
        <li><a href="../guides/16-entry-points.html">Scenario 16: Entry Point Discovery</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Reference</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Overview</a></li>
        <li><a href="../api/REST_API.html">CodeGraph REST API Documentation</a></li>
        <li><a href="../api/WEBSOCKET_API.html">WebSocket API Reference</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Integrations</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Overview</a></li>
        <li><a href="../integrations/GIGACHAT.html">GigaChat Integration Guide</a></li>
        <li><a href="../integrations/YANDEX_AI_STUDIO.html">Yandex AI Studio Integration Guide</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Technical Reference</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Overview</a></li>
        <li><a href="AGENTS.html">Agents Reference</a></li>
        <li><a href="ANALYSIS_MODULES.html">Analysis Modules Reference</a></li>
        <li><a href="API.html">API Reference</a></li>
        <li><a href="HYPOTHESIS_SYSTEM.html" class="active">Hypothesis System Reference</a></li>
        <li><a href="SCHEMA.html">DuckDB CPG Schema Design (CPG Spec v1.1)</a></li>
        <li><a href="SECURITY.html">Enterprise Security Module</a></li>
        <li><a href="SQL_QUERY_COOKBOOK.html">SQL Query Cookbook for DuckDB CPG</a></li>
        <li><a href="WORKFLOWS.html">Workflows Reference</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Overview</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Documentation</a>
        <span>/</span>
        <a href="index.html">Technical Reference</a>
        <span>/</span>
        <span>Hypothesis System Reference</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>Hypothesis System Reference</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="hypothesis-system-reference">Hypothesis System Reference<a class="heading-anchor" href="#hypothesis-system-reference" title="Link to this section">&para;</a></h1>
<p>This document describes the multi-criteria security hypothesis generation and validation system used for automated vulnerability detection in CodeGraph.</p>
<h2 id="table-of-contents">Table of Contents<a class="heading-anchor" href="#table-of-contents" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#pipeline-architecture">Pipeline Architecture</a></li>
<li><a href="#core-data-models">Core Data Models</a></li>
<li><a href="#securityhypothesis">SecurityHypothesis</a></li>
<li><a href="#evidence">Evidence</a></li>
<li><a href="#validationstatus">ValidationStatus</a></li>
<li><a href="#severity-levels">Severity Levels</a></li>
<li><a href="#hypothesis-generation">Hypothesis Generation</a></li>
<li><a href="#template-format">Template Format</a></li>
<li><a href="#category-templates">Category Templates</a></li>
<li><a href="#generation-algorithm">Generation Algorithm</a></li>
<li><a href="#cwe-category-mapping">CWE Category Mapping</a></li>
<li><a href="#multi-criteria-scoring">Multi-Criteria Scoring</a></li>
<li><a href="#scoring-formula">Scoring Formula</a></li>
<li><a href="#score-components">Score Components</a></li>
<li><a href="#bonus-multipliers">Bonus Multipliers</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#query-synthesis">Query Synthesis</a></li>
<li><a href="#sql-templates">SQL Templates</a></li>
<li><a href="#template-examples">Template Examples</a></li>
<li><a href="#hypothesis-execution">Hypothesis Execution</a></li>
<li><a href="#executor-usage">Executor Usage</a></li>
<li><a href="#evidence-collection">Evidence Collection</a></li>
<li><a href="#validation">Validation</a></li>
<li><a href="#validation-process">Validation Process</a></li>
<li><a href="#validation-results">Validation Results</a></li>
<li><a href="#knowledge-base">Knowledge Base</a></li>
<li><a href="#cwe-database">CWE Database</a></li>
<li><a href="#language-patterns">Language Patterns</a></li>
<li><a href="#supported-cwes-partial-list">Supported CWEs (Partial List)</a></li>
<li><a href="#python-api">Python API</a></li>
<li><a href="#complete-example">Complete Example</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#benchmark-results">Benchmark Results</a></li>
<li><a href="#validated-cves-postgresql-17">Validated CVEs (PostgreSQL 17)</a></li>
<li><a href="#see-also">See Also</a></li>
</ul>
<h2 id="overview">Overview<a class="heading-anchor" href="#overview" title="Link to this section">&para;</a></h2>
<p>The hypothesis system generates testable security hypotheses by combining:
- <strong>CWE vulnerability patterns</strong> (Common Weakness Enumeration)
- <strong>CAPEC attack patterns</strong> (Common Attack Pattern Enumeration)
- <strong>Language-specific patterns</strong> (sinks, sources, sanitizers)
- <strong>Codebase-specific context</strong> (from CPG analysis)</p>
<h3 id="pipeline-architecture">Pipeline Architecture<a class="heading-anchor" href="#pipeline-architecture" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>+-----------------------------------------------------------+
|                  HYPOTHESIS PIPELINE                       |
+-----------------------------------------------------------+

1. GENERATION
   HypothesisGenerator.generate()
   +-- CWE Database (120+ patterns)
   +-- CAPEC Database (50+ attack patterns)
   +-- Language Patterns (C, Python, Java)
   +-- Cartesian Product: CWEs x CAPECs x Patterns
   +-- Template Instantiation
   +-- Output: SecurityHypothesis[]

2. SCORING
   MultiCriteriaScorer.score_batch()
   +-- CWE Frequency Score (0.40 weight)
   +-- Attack Similarity Score (0.30 weight)
   +-- Codebase Exposure Score (0.30 weight)
   +-- Bonuses: Known CVE, Critical Severity
   +-- Output: Priority scores [0.0-1.0]

3. QUERY SYNTHESIS
   QuerySynthesizer.synthesize()
   +-- Match hypothesis to SQL template
   +-- Parameter substitution
   +-- Output: DuckDB SQL/PGQ queries

4. EXECUTION
   HypothesisExecutor.execute()
   +-- Run queries against CPG
   +-- Collect evidence
   +-- Output: Evidence[]

5. VALIDATION
   HypothesisValidator.validate()
   +-- Analyze evidence
   +-- Update hypothesis status
   +-- Calculate metrics
   +-- Output: ValidationResults
</code></pre></div>

<hr />
<h2 id="core-data-models">Core Data Models<a class="heading-anchor" href="#core-data-models" title="Link to this section">&para;</a></h2>
<h3 id="securityhypothesis">SecurityHypothesis<a class="heading-anchor" href="#securityhypothesis" title="Link to this section">&para;</a></h3>
<p>The central data structure for hypothesis-driven security analysis.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityHypothesis</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>                          <span class="c1"># Unique identifier</span>
    <span class="n">hypothesis_text</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># Human-readable statement</span>

    <span class="c1"># Classification</span>
    <span class="n">cwe_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>              <span class="c1"># [&quot;CWE-120&quot;, &quot;CWE-119&quot;]</span>
    <span class="n">capec_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>            <span class="c1"># [&quot;CAPEC-100&quot;]</span>
    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span>                   <span class="c1"># &quot;C&quot;, &quot;Python&quot;, etc.</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>                   <span class="c1"># &quot;buffer_overflow&quot;, &quot;injection&quot;</span>

    <span class="c1"># Taint patterns</span>
    <span class="n">source_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>      <span class="c1"># [&quot;PQgetvalue&quot;, &quot;getenv&quot;]</span>
    <span class="n">sink_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>        <span class="c1"># [&quot;strcpy&quot;, &quot;memcpy&quot;]</span>
    <span class="n">sanitizer_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>   <span class="c1"># [&quot;strlcpy&quot;, &quot;sizeof&quot;]</span>

    <span class="c1"># Scoring</span>
    <span class="n">priority_score</span><span class="p">:</span> <span class="nb">float</span>           <span class="c1"># 0.0-1.0, overall priority</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>               <span class="c1"># 0.0-1.0, hypothesis confidence</span>

    <span class="c1"># Multi-criteria breakdown</span>
    <span class="n">cwe_frequency_score</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">attack_similarity_score</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">codebase_exposure_score</span><span class="p">:</span> <span class="nb">float</span>

    <span class="c1"># Generated SQL query</span>
    <span class="n">sql_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="c1"># Validation</span>
    <span class="n">evidence</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Evidence</span><span class="p">]</span>
    <span class="n">validation_status</span><span class="p">:</span> <span class="n">ValidationStatus</span>
</code></pre></div>

<h3 id="evidence">Evidence<a class="heading-anchor" href="#evidence" title="Link to this section">&para;</a></h3>
<p>Captures query results supporting or refuting a hypothesis.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Evidence</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">hypothesis_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">query_executed</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># SQL query that found this</span>
    <span class="n">result_count</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>  <span class="c1"># Query results</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">line_number</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">code_snippet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>               <span class="c1"># 0.0-1.0</span>
</code></pre></div>

<h3 id="validationstatus">ValidationStatus<a class="heading-anchor" href="#validationstatus" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ValidationStatus</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">PENDING</span> <span class="o">=</span> <span class="s2">&quot;pending&quot;</span>
    <span class="n">IN_PROGRESS</span> <span class="o">=</span> <span class="s2">&quot;in_progress&quot;</span>
    <span class="n">CONFIRMED</span> <span class="o">=</span> <span class="s2">&quot;confirmed&quot;</span>
    <span class="n">REJECTED</span> <span class="o">=</span> <span class="s2">&quot;rejected&quot;</span>
    <span class="n">INCONCLUSIVE</span> <span class="o">=</span> <span class="s2">&quot;inconclusive&quot;</span>
</code></pre></div>

<h3 id="severity-levels">Severity Levels<a class="heading-anchor" href="#severity-levels" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Severity</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s2">&quot;critical&quot;</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
    <span class="n">INFO</span> <span class="o">=</span> <span class="s2">&quot;info&quot;</span>
</code></pre></div>

<hr />
<h2 id="hypothesis-generation">Hypothesis Generation<a class="heading-anchor" href="#hypothesis-generation" title="Link to this section">&para;</a></h2>
<h3 id="template-format">Template Format<a class="heading-anchor" href="#template-format" title="Link to this section">&para;</a></h3>
<p>Hypotheses follow the pattern:</p>
<div class="highlight"><pre><span></span><code><span class="ss">&quot;If [source] flows to [sink] without [sanitizer], then [CWE] enables [attack]&quot;</span>
</code></pre></div>

<h3 id="category-templates">Category Templates<a class="heading-anchor" href="#category-templates" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Category</th>
<th>Template</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>buffer_overflow</code></td>
<td>&ldquo;If untrusted data from {sources} flows to {sinks} without bounds checking via {sanitizers}, then {cwe} enables {attack} attack, potentially allowing memory corruption or code execution.&rdquo;</td>
</tr>
<tr>
<td><code>sql_injection</code></td>
<td>&ldquo;If user input from {sources} is incorporated into SQL queries via {sinks} without parameterization ({sanitizers}), then {cwe} enables {attack} attack.&rdquo;</td>
</tr>
<tr>
<td><code>command_injection</code></td>
<td>&ldquo;If untrusted data from {sources} flows to command execution via {sinks} without proper escaping ({sanitizers}), then {cwe} enables {attack} attack.&rdquo;</td>
</tr>
<tr>
<td><code>information_disclosure</code></td>
<td>&ldquo;If sensitive data is accessed via {sinks} without authorization checks ({sanitizers}), then {cwe} enables {attack} attack.&rdquo;</td>
</tr>
</tbody>
</table></div>
<h3 id="generation-algorithm">Generation Algorithm<a class="heading-anchor" href="#generation-algorithm" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">HypothesisGenerator</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">HypothesisGenerator</span><span class="p">()</span>

<span class="c1"># Generate for specific CWE</span>
<span class="n">hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">cwe_filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CWE-120&quot;</span><span class="p">,</span> <span class="s2">&quot;CWE-78&quot;</span><span class="p">],</span>
    <span class="n">max_hypotheses</span><span class="o">=</span><span class="mi">50</span>
<span class="p">)</span>

<span class="c1"># Generate for category</span>
<span class="n">buffer_hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_by_category</span><span class="p">(</span><span class="s2">&quot;buffer_overflow&quot;</span><span class="p">)</span>

<span class="c1"># Full enumeration</span>
<span class="n">all_hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_all</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="cwe-category-mapping">CWE Category Mapping<a class="heading-anchor" href="#cwe-category-mapping" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>CWE</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td>CWE-120, CWE-119, CWE-787, CWE-125</td>
<td><code>buffer_overflow</code></td>
</tr>
<tr>
<td>CWE-78, CWE-77, CWE-88</td>
<td><code>command_injection</code></td>
</tr>
<tr>
<td>CWE-89</td>
<td><code>sql_injection</code></td>
</tr>
<tr>
<td>CWE-94, CWE-95</td>
<td><code>code_injection</code></td>
</tr>
<tr>
<td>CWE-134</td>
<td><code>format_string</code></td>
</tr>
<tr>
<td>CWE-200, CWE-209, CWE-862</td>
<td><code>information_disclosure</code></td>
</tr>
<tr>
<td>CWE-416</td>
<td><code>use_after_free</code></td>
</tr>
<tr>
<td>CWE-190, CWE-191</td>
<td><code>integer_overflow</code></td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="multi-criteria-scoring">Multi-Criteria Scoring<a class="heading-anchor" href="#multi-criteria-scoring" title="Link to this section">&para;</a></h2>
<h3 id="scoring-formula">Scoring Formula<a class="heading-anchor" href="#scoring-formula" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Priority Score = (CWE_Frequency × 0.40)
               + (Attack_Similarity × 0.30)
               + (Codebase_Exposure × 0.30)
</code></pre></div>

<h3 id="score-components">Score Components<a class="heading-anchor" href="#score-components" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Component</th>
<th>Weight</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>CWE Frequency</td>
<td>0.40</td>
<td>How common is this CWE in CVE database</td>
</tr>
<tr>
<td>Attack Similarity</td>
<td>0.30</td>
<td>How similar to known attack patterns</td>
</tr>
<tr>
<td>Codebase Exposure</td>
<td>0.30</td>
<td>How exposed is the codebase</td>
</tr>
</tbody>
</table></div>
<h3 id="bonus-multipliers">Bonus Multipliers<a class="heading-anchor" href="#bonus-multipliers" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Bonus</th>
<th>Multiplier</th>
<th>Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>Known CVE</td>
<td>1.20 (+20%)</td>
<td>Matches known CVE pattern</td>
</tr>
<tr>
<td>Critical Severity</td>
<td>1.10 (+10%)</td>
<td>Critical severity CWE</td>
</tr>
<tr>
<td>Recent Exploit</td>
<td>1.15 (+15%)</td>
<td>Recently exploited in wild</td>
</tr>
</tbody>
</table></div>
<h3 id="usage">Usage<a class="heading-anchor" href="#usage" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiCriteriaScorer</span><span class="p">,</span> <span class="n">CodebaseStats</span>

<span class="c1"># Gather codebase statistics</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">CodebaseStats</span><span class="p">(</span>
    <span class="n">total_methods</span><span class="o">=</span><span class="mi">52000</span><span class="p">,</span>
    <span class="n">total_calls</span><span class="o">=</span><span class="mi">110000</span><span class="p">,</span>
    <span class="n">sink_counts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;strcpy&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="s2">&quot;memcpy&quot;</span><span class="p">:</span> <span class="mi">800</span><span class="p">},</span>
    <span class="n">source_counts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;getenv&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;recv&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Score hypotheses</span>
<span class="n">scorer</span> <span class="o">=</span> <span class="n">MultiCriteriaScorer</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;cwe_frequency&#39;</span><span class="p">:</span> <span class="mf">0.40</span><span class="p">,</span>
    <span class="s1">&#39;attack_similarity&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span>
    <span class="s1">&#39;codebase_exposure&#39;</span><span class="p">:</span> <span class="mf">0.30</span>
<span class="p">})</span>

<span class="n">scored_hypotheses</span> <span class="o">=</span> <span class="n">scorer</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

<span class="c1"># Get top priority</span>
<span class="n">top_10</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scored_hypotheses</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="n">h</span><span class="o">.</span><span class="n">priority_score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div>

<hr />
<h2 id="query-synthesis">Query Synthesis<a class="heading-anchor" href="#query-synthesis" title="Link to this section">&para;</a></h2>
<h3 id="sql-templates">SQL Templates<a class="heading-anchor" href="#sql-templates" title="Link to this section">&para;</a></h3>
<p>The system generates DuckDB SQL queries for each hypothesis category:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuerySynthesizer</span>

<span class="n">synthesizer</span> <span class="o">=</span> <span class="n">QuerySynthesizer</span><span class="p">()</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">synthesizer</span><span class="o">.</span><span class="n">synthesize_query</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span>
</code></pre></div>

<h3 id="template-examples">Template Examples<a class="heading-anchor" href="#template-examples" title="Link to this section">&para;</a></h3>
<p><strong>Buffer Overflow Detection:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sink_function</span><span class="p">,</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">code</span><span class="p">,</span>
<span class="w">       </span><span class="n">nc</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">line_number</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="n">nc</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;strcpy&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;strcat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;sprintf&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;memcpy&#39;</span><span class="p">)</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</code></pre></div>

<p><strong>Command Injection Detection:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sink_function</span><span class="p">,</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">code</span><span class="p">,</span>
<span class="w">       </span><span class="n">nc</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">line_number</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="n">nc</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;popen&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;execl&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;execv&#39;</span><span class="p">)</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</code></pre></div>

<p><strong>Data Flow with SQL/PGQ:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">:</span><span class="n">IDENTIFIER</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">REACHING_DEF</span><span class="o">*</span><span class="mi">1</span><span class="p">..</span><span class="mi">5</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">sink</span><span class="p">:</span><span class="n">CALL_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">src</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;request&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">AND</span><span class="w"> </span><span class="n">sink</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;execute&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">src</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">source_var</span><span class="p">,</span>
<span class="w">        </span><span class="n">sink</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sink_function</span><span class="p">,</span>
<span class="w">        </span><span class="n">sink</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span>
<span class="w">        </span><span class="n">sink</span><span class="p">.</span><span class="n">line_number</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">)</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</code></pre></div>

<hr />
<h2 id="hypothesis-execution">Hypothesis Execution<a class="heading-anchor" href="#hypothesis-execution" title="Link to this section">&para;</a></h2>
<h3 id="executor-usage">Executor Usage<a class="heading-anchor" href="#executor-usage" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">HypothesisExecutor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">HypothesisExecutor</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>

<span class="c1"># Execute single hypothesis</span>
<span class="n">evidence</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span>

<span class="c1"># Execute batch</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h3 id="evidence-collection">Evidence Collection<a class="heading-anchor" href="#evidence-collection" title="Link to this section">&para;</a></h3>
<p>For each executed query:
1. Execute SQL against CPG
2. Capture result count and findings
3. Extract filename, line number, code snippet
4. Calculate evidence confidence
5. Associate evidence with hypothesis</p>
<hr />
<h2 id="validation">Validation<a class="heading-anchor" href="#validation" title="Link to this section">&para;</a></h2>
<h3 id="validation-process">Validation Process<a class="heading-anchor" href="#validation-process" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">HypothesisValidator</span>

<span class="n">validator</span> <span class="o">=</span> <span class="n">HypothesisValidator</span><span class="p">()</span>

<span class="c1"># Validate single hypothesis</span>
<span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span>

<span class="c1"># Validate batch</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">validate_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">)</span>
</code></pre></div>

<h3 id="validation-results">Validation Results<a class="heading-anchor" href="#validation-results" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ValidationResults</span><span class="p">:</span>
    <span class="n">batch_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_hypotheses</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">executed_queries</span><span class="p">:</span> <span class="nb">int</span>

    <span class="c1"># CVE Detection metrics</span>
    <span class="n">cves_found</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">cves_missed</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="c1"># Precision/Recall</span>
    <span class="n">true_positives</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">false_positives</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">false_negatives</span><span class="p">:</span> <span class="nb">int</span>

    <span class="c1"># Hypothesis quality</span>
    <span class="n">confirmed_hypotheses</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">rejected_hypotheses</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">inconclusive_hypotheses</span><span class="p">:</span> <span class="nb">int</span>

    <span class="c1"># Computed metrics</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">detection_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">precision</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">recall</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">f1_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>
</code></pre></div>

<hr />
<h2 id="knowledge-base">Knowledge Base<a class="heading-anchor" href="#knowledge-base" title="Link to this section">&para;</a></h2>
<h3 id="cwe-database">CWE Database<a class="heading-anchor" href="#cwe-database" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_knowledge_base</span>

<span class="n">kb</span> <span class="o">=</span> <span class="n">get_knowledge_base</span><span class="p">()</span>

<span class="c1"># Get CWE entry</span>
<span class="n">cwe</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">get_cwe</span><span class="p">(</span><span class="s2">&quot;CWE-120&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">cwe</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Severity: </span><span class="si">{</span><span class="n">cwe</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CVSS: </span><span class="si">{</span><span class="n">cwe</span><span class="o">.</span><span class="n">cvss_base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Get by category</span>
<span class="n">memory_cwes</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">get_cwes_by_category</span><span class="p">(</span><span class="s2">&quot;memory&quot;</span><span class="p">)</span>

<span class="c1"># Get related CAPECs</span>
<span class="n">capecs</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">get_capecs_for_cwe</span><span class="p">(</span><span class="s2">&quot;CWE-120&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="language-patterns">Language Patterns<a class="heading-anchor" href="#language-patterns" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Get C patterns</span>
<span class="n">c_patterns</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">get_language_patterns</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">c_patterns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Category: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sinks: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">sinks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sources: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">sources</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sanitizers: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">sanitizers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="supported-cwes-partial-list">Supported CWEs (Partial List)<a class="heading-anchor" href="#supported-cwes-partial-list" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>CWE ID</th>
<th>Name</th>
<th>Severity</th>
<th>CVSS</th>
</tr>
</thead>
<tbody>
<tr>
<td>CWE-120</td>
<td>Buffer Copy without Checking Size</td>
<td>HIGH</td>
<td>8.0</td>
</tr>
<tr>
<td>CWE-119</td>
<td>Improper Restriction of Operations</td>
<td>HIGH</td>
<td>8.0</td>
</tr>
<tr>
<td>CWE-78</td>
<td>OS Command Injection</td>
<td>CRITICAL</td>
<td>9.8</td>
</tr>
<tr>
<td>CWE-89</td>
<td>SQL Injection</td>
<td>CRITICAL</td>
<td>9.8</td>
</tr>
<tr>
<td>CWE-200</td>
<td>Exposure of Sensitive Information</td>
<td>MEDIUM</td>
<td>5.3</td>
</tr>
<tr>
<td>CWE-416</td>
<td>Use After Free</td>
<td>HIGH</td>
<td>8.1</td>
</tr>
<tr>
<td>CWE-190</td>
<td>Integer Overflow</td>
<td>HIGH</td>
<td>7.5</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="python-api">Python API<a class="heading-anchor" href="#python-api" title="Link to this section">&para;</a></h2>
<h3 id="complete-example">Complete Example<a class="heading-anchor" href="#complete-example" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">HypothesisGenerator</span><span class="p">,</span>
    <span class="n">MultiCriteriaScorer</span><span class="p">,</span>
    <span class="n">QuerySynthesizer</span><span class="p">,</span>
    <span class="n">HypothesisExecutor</span><span class="p">,</span>
    <span class="n">HypothesisValidator</span><span class="p">,</span>
    <span class="n">CodebaseStats</span>
<span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>

<span class="c1"># 1. Connect to CPG</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>

<span class="c1"># 2. Gather codebase statistics</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">CodebaseStats</span><span class="p">(</span>
    <span class="n">total_methods</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM nodes_method&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">total_calls</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM nodes_call&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># 3. Generate hypotheses</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">HypothesisGenerator</span><span class="p">()</span>
<span class="n">hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">max_hypotheses</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 4. Score and prioritize</span>
<span class="n">scorer</span> <span class="o">=</span> <span class="n">MultiCriteriaScorer</span><span class="p">()</span>
<span class="n">scored</span> <span class="o">=</span> <span class="n">scorer</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

<span class="c1"># 5. Synthesize SQL queries</span>
<span class="n">synthesizer</span> <span class="o">=</span> <span class="n">QuerySynthesizer</span><span class="p">()</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">scored</span><span class="p">:</span>
    <span class="n">h</span><span class="o">.</span><span class="n">sql_query</span> <span class="o">=</span> <span class="n">synthesizer</span><span class="o">.</span><span class="n">synthesize_query</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

<span class="c1"># 6. Execute against CPG</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">HypothesisExecutor</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">scored</span><span class="p">[:</span><span class="mi">20</span><span class="p">]:</span>  <span class="c1"># Top 20</span>
    <span class="n">evidence</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">h</span><span class="o">.</span><span class="n">evidence</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">evidence</span><span class="p">)</span>

<span class="c1"># 7. Validate and report</span>
<span class="n">validator</span> <span class="o">=</span> <span class="n">HypothesisValidator</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">validate_batch</span><span class="p">(</span><span class="n">scored</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detection Rate: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">detection_rate</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">precision</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">recall</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1 Score: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">f1_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="performance">Performance<a class="heading-anchor" href="#performance" title="Link to this section">&para;</a></h2>
<h3 id="benchmark-results">Benchmark Results<a class="heading-anchor" href="#benchmark-results" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>CVE Detection Rate</td>
<td>100% (3/3 target CVEs)</td>
</tr>
<tr>
<td>Hypothesis Confirmation Rate</td>
<td>55%</td>
</tr>
<tr>
<td>Average Query Time</td>
<td>2-3ms</td>
</tr>
<tr>
<td>Generation Time (100 hypotheses)</td>
<td>&lt;1s</td>
</tr>
<tr>
<td>Execution Time (20 hypotheses)</td>
<td>&lt;30s</td>
</tr>
</tbody>
</table></div>
<h3 id="validated-cves-postgresql-17">Validated CVEs (PostgreSQL 17)<a class="heading-anchor" href="#validated-cves-postgresql-17" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>CVE</th>
<th>Type</th>
<th>Detection Method</th>
</tr>
</thead>
<tbody>
<tr>
<td>CVE-2025-8713</td>
<td>Statistics Disclosure</td>
<td>Hypothesis + Method</td>
</tr>
<tr>
<td>CVE-2025-8714</td>
<td>pg_dump Injection</td>
<td>Method-based</td>
</tr>
<tr>
<td>CVE-2025-8715</td>
<td>Newline Injection</td>
<td>Method-based</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="see-also">See Also<a class="heading-anchor" href="#see-also" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="../guides/CPG_EXPORT.html">CPG Export Guide</a> - Export CPG for analysis</li>
<li><a href="./SQL_QUERY_COOKBOOK.html">SQL Query Cookbook</a> - Query examples</li>
<li><a href="./ANALYSIS_MODULES.html">Analysis Modules</a> - Advanced analysis documentation</li>
<li><a href="https://cwe.mitre.org/">CWE Database</a></li>
<li><a href="https://capec.mitre.org/">CAPEC Database</a></li>
</ul>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="WORKFLOWS.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Previous</span>
        <span class="doc-page-nav-title">Workflows Reference</span>
      </a>

      <a href="API.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Next</span>
        <span class="doc-page-nav-title">API Reference</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Last updated: 2025-12-27</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/reference/HYPOTHESIS_SYSTEM.md" target="_blank" rel="noopener">Edit on GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">On this page</div>
      <ul class="doc-toc-list">
        <li><a href="#hypothesis-system-reference" class="level-1">Hypothesis System Reference</a></li>
<li><a href="#table-of-contents" class="level-2">Table of Contents</a></li>
<li><a href="#overview" class="level-2">Overview</a></li>
<li><a href="#pipeline-architecture" class="level-3">Pipeline Architecture</a></li>
<li><a href="#core-data-models" class="level-2">Core Data Models</a></li>
<li><a href="#securityhypothesis" class="level-3">SecurityHypothesis</a></li>
<li><a href="#evidence" class="level-3">Evidence</a></li>
<li><a href="#validationstatus" class="level-3">ValidationStatus</a></li>
<li><a href="#severity-levels" class="level-3">Severity Levels</a></li>
<li><a href="#hypothesis-generation" class="level-2">Hypothesis Generation</a></li>
<li><a href="#template-format" class="level-3">Template Format</a></li>
<li><a href="#category-templates" class="level-3">Category Templates</a></li>
<li><a href="#generation-algorithm" class="level-3">Generation Algorithm</a></li>
<li><a href="#generate-for-specific-cwe" class="level-1">Generate for specific CWE</a></li>
<li><a href="#generate-for-category" class="level-1">Generate for category</a></li>
<li><a href="#full-enumeration" class="level-1">Full enumeration</a></li>
<li><a href="#cwe-category-mapping" class="level-3">CWE Category Mapping</a></li>
<li><a href="#multi-criteria-scoring" class="level-2">Multi-Criteria Scoring</a></li>
<li><a href="#scoring-formula" class="level-3">Scoring Formula</a></li>
<li><a href="#score-components" class="level-3">Score Components</a></li>
<li><a href="#bonus-multipliers" class="level-3">Bonus Multipliers</a></li>
<li><a href="#usage" class="level-3">Usage</a></li>
<li><a href="#gather-codebase-statistics" class="level-1">Gather codebase statistics</a></li>
<li><a href="#score-hypotheses" class="level-1">Score hypotheses</a></li>
<li><a href="#get-top-priority" class="level-1">Get top priority</a></li>
<li><a href="#query-synthesis" class="level-2">Query Synthesis</a></li>
<li><a href="#sql-templates" class="level-3">SQL Templates</a></li>
<li><a href="#template-examples" class="level-3">Template Examples</a></li>
<li><a href="#hypothesis-execution" class="level-2">Hypothesis Execution</a></li>
<li><a href="#executor-usage" class="level-3">Executor Usage</a></li>
<li><a href="#execute-single-hypothesis" class="level-1">Execute single hypothesis</a></li>
<li><a href="#execute-batch" class="level-1">Execute batch</a></li>
<li><a href="#evidence-collection" class="level-3">Evidence Collection</a></li>
<li><a href="#validation" class="level-2">Validation</a></li>
<li><a href="#validation-process" class="level-3">Validation Process</a></li>
<li><a href="#validate-single-hypothesis" class="level-1">Validate single hypothesis</a></li>
<li><a href="#validate-batch" class="level-1">Validate batch</a></li>
<li><a href="#validation-results" class="level-3">Validation Results</a></li>
<li><a href="#knowledge-base" class="level-2">Knowledge Base</a></li>
<li><a href="#cwe-database" class="level-3">CWE Database</a></li>
<li><a href="#get-cwe-entry" class="level-1">Get CWE entry</a></li>
<li><a href="#get-by-category" class="level-1">Get by category</a></li>
<li><a href="#get-related-capecs" class="level-1">Get related CAPECs</a></li>
<li><a href="#language-patterns" class="level-3">Language Patterns</a></li>
<li><a href="#get-c-patterns" class="level-1">Get C patterns</a></li>
<li><a href="#supported-cwes-partial-list" class="level-3">Supported CWEs (Partial List)</a></li>
<li><a href="#python-api" class="level-2">Python API</a></li>
<li><a href="#complete-example" class="level-3">Complete Example</a></li>
<li><a href="#1-connect-to-cpg" class="level-1">1. Connect to CPG</a></li>
<li><a href="#2-gather-codebase-statistics" class="level-1">2. Gather codebase statistics</a></li>
<li><a href="#3-generate-hypotheses" class="level-1">3. Generate hypotheses</a></li>
<li><a href="#4-score-and-prioritize" class="level-1">4. Score and prioritize</a></li>
<li><a href="#5-synthesize-sql-queries" class="level-1">5. Synthesize SQL queries</a></li>
<li><a href="#6-execute-against-cpg" class="level-1">6. Execute against CPG</a></li>
<li><a href="#7-validate-and-report" class="level-1">7. Validate and report</a></li>
<li><a href="#performance" class="level-2">Performance</a></li>
<li><a href="#benchmark-results" class="level-3">Benchmark Results</a></li>
<li><a href="#validated-cves-postgresql-17" class="level-3">Validated CVEs (PostgreSQL 17)</a></li>
<li><a href="#see-also" class="level-2">See Also</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI copilot for source code analysis</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Product</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Features</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Integrations</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Documentation</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Getting Started</a></li>
              <li><a href="../guides/index.html" class="footer-link">Guides</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Resources</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Contacts</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
