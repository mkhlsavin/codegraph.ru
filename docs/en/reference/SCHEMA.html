<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: DuckDB CPG Schema Design (CPG Spec v1.1)">
  <meta name="keywords" content="CodeGraph, documentation, reference">

  <meta property="og:title" content="DuckDB CPG Schema Design (CPG Spec v1.1) - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: DuckDB CPG Schema Design (CPG Spec v1.1)">
  <meta property="og:type" content="article">

  <title>DuckDB CPG Schema Design (CPG Spec v1.1) - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Problems</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Solution</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Features</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Integrations</a></li>
        <li><a href="../index.html" class="nav-link active">Documentation</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/reference/SCHEMA.html" class="active">EN</a>
          <a href="../../ru/reference/SCHEMA.html" class="">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Toggle theme">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Request Demo</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Problems</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Solution</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Features</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Integrations</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Documentation</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Request Demo</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Getting Started</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Overview</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Configuration Guide</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Installation Guide</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">User Guides</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../guides/index.html">Overview</a></li>
        <li><a href="../guides/BENCHMARK_GUIDE.html">Benchmark Framework Guide</a></li>
        <li><a href="../guides/CLI_GUIDE.html">CLI Guide</a></li>
        <li><a href="../guides/CODE_REVIEW.html">Automated Code Review</a></li>
        <li><a href="../guides/CPG_EXPORT.html">CPG Export Guide</a></li>
        <li><a href="../guides/MONITORING.html">Monitoring Guide</a></li>
        <li><a href="../guides/PROGRAMMATIC_GUIDE.html">User Guide</a></li>
        <li><a href="../guides/PROJECT_IMPORT.html">Importing a New Codebase</a></li>
        <li><a href="../guides/QUICK_REFERENCE.html">CodeGraph Quick Reference</a></li>
        <li><a href="../guides/REFACTORING.html">Refactoring Analysis Guide</a></li>
        <li><a href="../guides/SCENARIOS.html">Workflow Scenarios Guide</a></li>
        <li><a href="../guides/TROUBLESHOOTING.html">Troubleshooting Guide</a></li>
        <li><a href="../guides/TUI_USER_GUIDE.html">CodeGraph User Guide</a></li>
        <li><a href="../guides/01-onboarding.html">Scenario 01: Developer Onboarding</a></li>
        <li><a href="../guides/02-security-audit.html">Scenario 02: Security Audit</a></li>
        <li><a href="../guides/03-documentation.html">Scenario 03: Documentation Generation</a></li>
        <li><a href="../guides/04-feature-development.html">Scenario 04: Feature Development</a></li>
        <li><a href="../guides/05-refactoring.html">Scenario 05: Refactoring</a></li>
        <li><a href="../guides/06-performance.html">Scenario 06: Performance Analysis</a></li>
        <li><a href="../guides/07-test-coverage.html">Scenario 07: Test Coverage</a></li>
        <li><a href="../guides/08-compliance.html">Scenario 08: Compliance Checking</a></li>
        <li><a href="../guides/09-code-review.html">Scenario 09: Code Review</a></li>
        <li><a href="../guides/10-cross-repo.html">Scenario 10: Cross-Repository Analysis</a></li>
        <li><a href="../guides/11-architecture.html">Scenario 11: Architecture Analysis</a></li>
        <li><a href="../guides/12-tech-debt.html">Scenario 12: Tech Debt Assessment</a></li>
        <li><a href="../guides/13-mass-refactoring.html">Scenario 13: Mass Refactoring</a></li>
        <li><a href="../guides/14-incident-response.html">Scenario 14: Security Incident Response</a></li>
        <li><a href="../guides/15-debugging.html">Scenario 15: Debugging Assistance</a></li>
        <li><a href="../guides/16-entry-points.html">Scenario 16: Entry Point Discovery</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Reference</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Overview</a></li>
        <li><a href="../api/REST_API.html">CodeGraph REST API Documentation</a></li>
        <li><a href="../api/WEBSOCKET_API.html">WebSocket API Reference</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Integrations</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Overview</a></li>
        <li><a href="../integrations/GIGACHAT.html">GigaChat Integration Guide</a></li>
        <li><a href="../integrations/YANDEX_AI_STUDIO.html">Yandex AI Studio Integration Guide</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Technical Reference</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Overview</a></li>
        <li><a href="AGENTS.html">Agents Reference</a></li>
        <li><a href="ANALYSIS_MODULES.html">Analysis Modules Reference</a></li>
        <li><a href="API.html">API Reference</a></li>
        <li><a href="HYPOTHESIS_SYSTEM.html">Hypothesis System Reference</a></li>
        <li><a href="SCHEMA.html" class="active">DuckDB CPG Schema Design (CPG Spec v1.1)</a></li>
        <li><a href="SECURITY.html">Enterprise Security Module</a></li>
        <li><a href="SQL_QUERY_COOKBOOK.html">SQL Query Cookbook for DuckDB CPG</a></li>
        <li><a href="WORKFLOWS.html">Workflows Reference</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Overview</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Documentation</a>
        <span>/</span>
        <a href="index.html">Technical Reference</a>
        <span>/</span>
        <span>DuckDB CPG Schema Design (CPG Spec v1.1)</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>DuckDB CPG Schema Design (CPG Spec v1.1)</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="duckdb-cpg-schema-design-cpg-spec-v11">DuckDB CPG Schema Design (CPG Spec v1.1)<a class="heading-anchor" href="#duckdb-cpg-schema-design-cpg-spec-v11" title="Link to this section">&para;</a></h1>
<h2 id="table-of-contents">Table of Contents<a class="heading-anchor" href="#table-of-contents" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#core-design-principles">Core Design Principles</a></li>
<li><a href="#node-tables">Node Tables</a></li>
<li><a href="#nodes_method">nodes_method</a></li>
<li><a href="#nodes_call">nodes_call</a></li>
<li><a href="#nodes_identifier">nodes_identifier</a></li>
<li><a href="#nodes_field_identifier">nodes_field_identifier</a></li>
<li><a href="#nodes_literal">nodes_literal</a></li>
<li><a href="#nodes_local">nodes_local</a></li>
<li><a href="#nodes_param">nodes_param</a></li>
<li><a href="#nodes_param_out">nodes_param_out</a></li>
<li><a href="#nodes_method_return">nodes_method_return</a></li>
<li><a href="#nodes_return">nodes_return</a></li>
<li><a href="#nodes_block">nodes_block</a></li>
<li><a href="#nodes_control_structure">nodes_control_structure</a></li>
<li><a href="#nodes_member">nodes_member</a></li>
<li><a href="#nodes_type_decl">nodes_type_decl</a></li>
<li><a href="#nodes_metadata">nodes_metadata</a></li>
<li><a href="#nodes_file">nodes_file</a></li>
<li><a href="#nodes_namespace_block">nodes_namespace_block</a></li>
<li><a href="#nodes_method_ref">nodes_method_ref</a></li>
<li><a href="#nodes_type_ref">nodes_type_ref</a></li>
<li><a href="#nodes_unknown">nodes_unknown</a></li>
<li><a href="#nodes_jump_target">nodes_jump_target</a></li>
<li><a href="#nodes_type_parameter">nodes_type_parameter</a></li>
<li><a href="#nodes_type_argument">nodes_type_argument</a></li>
<li><a href="#nodes_binding">nodes_binding</a></li>
<li><a href="#nodes_closure_binding">nodes_closure_binding</a></li>
<li><a href="#nodes_comment">nodes_comment</a></li>
<li><a href="#edge-tables">Edge Tables</a></li>
<li><a href="#edges_ast">edges_ast</a></li>
<li><a href="#edges_cfg">edges_cfg</a></li>
<li><a href="#edges_call">edges_call</a></li>
<li><a href="#edges_ref">edges_ref</a></li>
<li><a href="#edges_reaching_def">edges_reaching_def</a></li>
<li><a href="#edges_argument">edges_argument</a></li>
<li><a href="#edges_receiver">edges_receiver</a></li>
<li><a href="#edges_condition">edges_condition</a></li>
<li><a href="#edges_dominate">edges_dominate</a></li>
<li><a href="#edges_post_dominate">edges_post_dominate</a></li>
<li><a href="#edges_cdg">edges_cdg</a></li>
<li><a href="#edges_binds">edges_binds</a></li>
<li><a href="#edges_binds_to">edges_binds_to</a></li>
<li><a href="#edges_source_file">edges_source_file</a></li>
<li><a href="#edges_alias_of">edges_alias_of</a></li>
<li><a href="#edges_inherits_from">edges_inherits_from</a></li>
<li><a href="#edges_capture">edges_capture</a></li>
<li><a href="#edges_captured_by">edges_captured_by</a></li>
<li><a href="#property-graph-definition">Property Graph Definition</a></li>
<li><a href="#step-1-create-materialized-unified-nodes-table">Step 1: Create Materialized Unified Nodes Table</a></li>
<li><a href="#step-2-create-comprehensive-property-graph">Step 2: Create Comprehensive Property Graph</a></li>
<li><a href="#example-queries">Example Queries</a></li>
<li><a href="#standard-sql-query-find-all-calls-to-a-specific-method">Standard SQL Query: Find all calls to a specific method</a></li>
<li><a href="#duckdb-pgq-query-find-direct-call-chains-caller---callee">DuckDB PGQ Query: Find direct call chains (caller -&gt; callee)</a></li>
<li><a href="#duckdb-pgq-query-find-methods-and-their-ast-children">DuckDB PGQ Query: Find methods and their AST children</a></li>
<li><a href="#duckdb-pgq-query-data-flow-paths-using-reaching_def">DuckDB PGQ Query: Data flow paths using REACHING_DEF</a></li>
<li><a href="#duckdb-pgq-query-cfg-paths-control-flow">DuckDB PGQ Query: CFG paths (control flow)</a></li>
<li><a href="#duckdb-pgq-query-find-all-identifiers-and-their-references">DuckDB PGQ Query: Find all identifiers and their references</a></li>
<li><a href="#duckdb-pgq-query-type-hierarchy-inheritance">DuckDB PGQ Query: Type hierarchy (inheritance)</a></li>
<li><a href="#combined-query-methods-with-most-incoming-calls">Combined Query: Methods with most incoming calls</a></li>
<li><a href="#migration-from-joern">Migration from Joern</a></li>
<li><a href="#phase-1-critical---completed-">Phase 1 (CRITICAL) - COMPLETED ✓</a></li>
<li><a href="#phase-2-oop-support---completed-">Phase 2 (OOP SUPPORT) - COMPLETED ✓</a></li>
<li><a href="#phase-3-namespace-and-file-support---completed-">Phase 3 (NAMESPACE AND FILE SUPPORT) - COMPLETED ✓</a></li>
<li><a href="#phase-4-remaining-features---completed-">Phase 4 (REMAINING FEATURES) - COMPLETED ✓</a></li>
<li><a href="#performance-considerations">Performance Considerations</a></li>
<li><a href="#schema-version">Schema Version</a></li>
<li><a href="#changelog">Changelog</a></li>
<li><a href="#v50-2025-11-16---phase-4-complete-compliance">v5.0 (2025-11-16) - Phase 4 Complete Compliance</a></li>
<li><a href="#v40-2025-11-16---phase-3-namespace-and-file-support">v4.0 (2025-11-16) - Phase 3 Namespace and File Support</a></li>
<li><a href="#v30-2025-11-16---phase-2-oop-support">v3.0 (2025-11-16) - Phase 2 OOP Support</a></li>
<li><a href="#v20-2025-11-16---phase-1-critical-updates">v2.0 (2025-11-16) - Phase 1 Critical Updates</a></li>
<li><a href="#v10-2025-11-15---initial-release">v1.0 (2025-11-15) - Initial Release</a></li>
<li><a href="#extension-semantic-tag-system">Extension: Semantic Tag System</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#nodes_tag">nodes_tag</a></li>
<li><a href="#edges_tagged_by">edges_tagged_by</a></li>
<li><a href="#tag-categories">Tag Categories</a></li>
<li><a href="#example-tag-queries">Example Tag Queries</a></li>
<li><a href="#tag-statistics">Tag Statistics</a></li>
<li><a href="#integration-notes">Integration Notes</a></li>
</ul>
<h2 id="overview">Overview<a class="heading-anchor" href="#overview" title="Link to this section">&para;</a></h2>
<p>This schema implements the Code Property Graph specification v1.1 in DuckDB using the duckpgq extension for efficient property graph queries.</p>
<h2 id="core-design-principles">Core Design Principles<a class="heading-anchor" href="#core-design-principles" title="Link to this section">&para;</a></h2>
<ol>
<li><strong>Node Tables</strong>: Separate tables for each major node type (METHOD, CALL, IDENTIFIER, etc.)</li>
<li><strong>Edge Tables</strong>: Separate tables for each edge type (AST, CFG, CALL, REF, REACHING_DEF, etc.)</li>
<li><strong>Property Graph</strong>: Use duckpgq&rsquo;s CREATE PROPERTY GRAPH for unified graph queries</li>
<li><strong>Efficient Indexing</strong>: B-tree indexes on id, full_name, and frequently queried properties</li>
<li><strong>Batch Processing</strong>: Support for large-scale CPG imports (50K+ methods)</li>
</ol>
<h2 id="node-tables">Node Tables<a class="heading-anchor" href="#node-tables" title="Link to this section">&para;</a></h2>
<h3 id="nodes-method">nodes_method<a class="heading-anchor" href="#nodes-method" title="Link to this section">&para;</a></h3>
<p>Core table for function/method declarations.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">signature</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">filename</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number_end</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number_end</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">offset</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">          </span><span class="c1">-- NEW: Byte offset in file (Phase 2)</span>
<span class="w">    </span><span class="n">offset_end</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">      </span><span class="c1">-- NEW: End byte offset (Phase 2)</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_external</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="n">ast_parent_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">ast_parent_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">hash</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">[]</span><span class="w">       </span><span class="c1">-- NEW: Access modifiers (Phase 2)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_method_full_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_method</span><span class="p">(</span><span class="n">full_name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_method_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_method</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_method_filename</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_method</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- FULL_NAME, NAME, SIGNATURE: Method identification
- IS_EXTERNAL: Whether defined in source
- AST_PARENT_FULL_NAME, AST_PARENT_TYPE: Type context
- FILENAME, LINE_NUMBER, COLUMN_NUMBER: Source location
- OFFSET, OFFSET_END: Precise byte-level source location (Phase 2 - NEW!)
- CODE: Method source code
- HASH: Summary hash
- MODIFIER: Access modifiers (Phase 2 - NEW!)
  - Values: STATIC, PUBLIC, PROTECTED, PRIVATE, ABSTRACT, NATIVE, CONSTRUCTOR, VIRTUAL, INTERNAL, FINAL, READONLY, MODULE</p>
<p><strong>Modifier Examples:</strong>
- <code>public void foo()</code> → modifier=[&ldquo;PUBLIC&rdquo;]
- <code>private static int bar()</code> → modifier=[&ldquo;PRIVATE&rdquo;, &ldquo;STATIC&rdquo;]
- <code>abstract void baz()</code> → modifier=[&ldquo;ABSTRACT&rdquo;]</p>
<h3 id="nodes-call">nodes_call<a class="heading-anchor" href="#nodes-call" title="Link to this section">&para;</a></h3>
<p>Represents function/method invocations.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">method_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">signature</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">dispatch_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">filename</span><span class="w"> </span><span class="nb">VARCHAR</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_call_method_full_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_call</span><span class="p">(</span><span class="n">method_full_name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_call_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_call</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- METHOD_FULL_NAME: Target method
- DISPATCH_TYPE: Call mechanism (STATIC_DISPATCH, DYNAMIC_DISPATCH)
- TYPE_FULL_NAME: Return type
- SIGNATURE: Parameter types</p>
<h3 id="nodes-identifier">nodes_identifier<a class="heading-anchor" href="#nodes-identifier" title="Link to this section">&para;</a></h3>
<p>Variable and reference names.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_identifier</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">offset</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">           </span><span class="c1">-- NEW: Byte offset in file</span>
<span class="w">    </span><span class="n">offset_end</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">       </span><span class="c1">-- NEW: End byte offset</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_identifier_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_identifier</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: Variable identifier
- TYPE_FULL_NAME: Variable type
- OFFSET/OFFSET_END: Precise source location (Phase 2)</p>
<h3 id="nodes-field-identifier">nodes_field_identifier<a class="heading-anchor" href="#nodes-field-identifier" title="Link to this section">&para;</a></h3>
<p>Field access identifiers (OOP - e.g., obj.field).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_field_identifier</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">canonical_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Normalized field name</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">               </span><span class="c1">-- As it appears in code</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">offset</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">offset_end</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_field_identifier_canonical</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_field_identifier</span><span class="p">(</span><span class="n">canonical_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- CANONICAL_NAME: Normalized name (e.g., &ldquo;myField&rdquo; for both a.myField and b.myField)
- CODE: Field access as written (e.g., &ldquo;obj.field&rdquo;)
- Purpose: Identify field accesses in OOP code (critical for alias analysis)</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">Point</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="p">};</span>
<span class="n">Point</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">  </span><span class="c1">// &lt;- &quot;x&quot; is FIELD_IDENTIFIER with canonical_name=&quot;x&quot;</span>
</code></pre></div>

<h3 id="nodes-literal">nodes_literal<a class="heading-anchor" href="#nodes-literal" title="Link to this section">&para;</a></h3>
<p>Constant values.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_literal</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- TYPE_FULL_NAME: Literal type
- CODE: Literal value</p>
<h3 id="nodes-local">nodes_local<a class="heading-anchor" href="#nodes-local" title="Link to this section">&para;</a></h3>
<p>Local variable declarations.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_local</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_local_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_local</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: Local variable name
- TYPE_FULL_NAME: Declared type</p>
<h3 id="nodes-param">nodes_param<a class="heading-anchor" href="#nodes-param" title="Link to this section">&para;</a></h3>
<p>Method parameters (formal parameters).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_param</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_variadic</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="n">evaluation_strategy</span><span class="w"> </span><span class="nb">VARCHAR</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_param_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_param</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- INDEX: Parameter position
- IS_VARIADIC: Variable-length parameter
- EVALUATION_STRATEGY: BY_VALUE, BY_REFERENCE, BY_SHARING</p>
<h3 id="nodes-param-out">nodes_param_out<a class="heading-anchor" href="#nodes-param-out" title="Link to this section">&para;</a></h3>
<p>Method output parameters (for SSA/data flow analysis).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_param_out</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_variadic</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="n">evaluation_strategy</span><span class="w"> </span><span class="nb">VARCHAR</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_param_out_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_param_out</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Corresponds to METHOD_PARAMETER_IN for data flow
- INDEX: Parameter position (matches input parameter)
- EVALUATION_STRATEGY: BY_VALUE, BY_REFERENCE, BY_SHARING
- Required for SSA (Static Single Assignment) analysis</p>
<h3 id="nodes-method-return">nodes_method_return<a class="heading-anchor" href="#nodes-method-return" title="Link to this section">&para;</a></h3>
<p>Method return parameter (formal return).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_method_return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">evaluation_strategy</span><span class="w"> </span><span class="nb">VARCHAR</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- TYPE_FULL_NAME: Return type
- CODE: Typically &ldquo;RET&rdquo; or empty
- EVALUATION_STRATEGY: How return value is passed
- One per method (formal return parameter, not return statement)</p>
<h3 id="nodes-return">nodes_return<a class="heading-anchor" href="#nodes-return" title="Link to this section">&para;</a></h3>
<p>Return statements (actual return in code).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Note:</strong> This is the RETURN statement node. Different from METHOD_RETURN which is the formal return parameter.</p>
<h3 id="nodes-block">nodes_block<a class="heading-anchor" href="#nodes-block" title="Link to this section">&para;</a></h3>
<p>Compound statements (code blocks).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_block</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="nodes-control-structure">nodes_control_structure<a class="heading-anchor" href="#nodes-control-structure" title="Link to this section">&para;</a></h3>
<p>Control flow constructs (if, while, for, etc.).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_control_structure</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">control_structure_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="c1">-- IF, WHILE, FOR, SWITCH, TRY, etc.</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">parser_type_name</span><span class="w"> </span><span class="nb">VARCHAR</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- CONTROL_STRUCTURE_TYPE: BREAK, CONTINUE, DO, WHILE, FOR, GOTO, IF, ELSE, TRY, THROW, SWITCH</p>
<h3 id="nodes-member">nodes_member<a class="heading-anchor" href="#nodes-member" title="Link to this section">&para;</a></h3>
<p>Type members (fields of classes/structs).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_member</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Field type</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">               </span><span class="c1">-- Declaration code</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">offset</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">          </span><span class="c1">-- NEW: Byte offset</span>
<span class="w">    </span><span class="n">offset_end</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">      </span><span class="c1">-- NEW: End byte offset</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">ast_parent_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Usually &quot;TYPE_DECL&quot;</span>
<span class="w">    </span><span class="n">ast_parent_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_member_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_member</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_member_parent</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_member</span><span class="p">(</span><span class="n">ast_parent_full_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: Member name (e.g., &ldquo;x&rdquo;, &ldquo;y&rdquo;)
- TYPE_FULL_NAME: Member type (e.g., &ldquo;int&rdquo;, &ldquo;std::string&rdquo;)
- AST_PARENT_FULL_NAME: Containing type
- Purpose: Represent fields/members of classes/structs</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">Point</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">     </span><span class="c1">// &lt;- MEMBER: name=&quot;x&quot;, type_full_name=&quot;int&quot;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">     </span><span class="c1">// &lt;- MEMBER: name=&quot;y&quot;, type_full_name=&quot;int&quot;</span>
<span class="p">};</span>
</code></pre></div>

<h3 id="nodes-type-decl">nodes_type_decl<a class="heading-anchor" href="#nodes-type-decl" title="Link to this section">&para;</a></h3>
<p>Type declarations (classes, structs).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_type_decl</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_external</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="n">inherits_from_type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">[],</span>
<span class="w">    </span><span class="n">alias_type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">filename</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">offset</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">          </span><span class="c1">-- NEW: Byte offset</span>
<span class="w">    </span><span class="n">offset_end</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">      </span><span class="c1">-- NEW: End byte offset</span>
<span class="w">    </span><span class="n">ast_parent_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">ast_parent_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">[]</span><span class="w">       </span><span class="c1">-- NEW: Access modifiers (PUBLIC, PRIVATE, etc.)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_type_decl_full_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_type_decl</span><span class="p">(</span><span class="n">full_name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_type_decl_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_type_decl</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- FULL_NAME, NAME: Type identification
- IS_EXTERNAL: Whether defined in source
- INHERITS_FROM_TYPE_FULL_NAME: Base types (array)
- ALIAS_TYPE_FULL_NAME: Type alias
- MODIFIER: Access modifiers (Phase 2 - NEW!)
  - Values: STATIC, PUBLIC, PROTECTED, PRIVATE, ABSTRACT, NATIVE, CONSTRUCTOR, VIRTUAL, INTERNAL, FINAL, READONLY, MODULE</p>
<p><strong>Modifier Examples:</strong>
- <code>public class Foo</code> → modifier=[&ldquo;PUBLIC&rdquo;]
- <code>private static class Bar</code> → modifier=[&ldquo;PRIVATE&rdquo;, &ldquo;STATIC&rdquo;]
- <code>abstract class Baz</code> → modifier=[&ldquo;ABSTRACT&rdquo;]</p>
<h3 id="nodes-metadata">nodes_metadata<a class="heading-anchor" href="#nodes-metadata" title="Link to this section">&para;</a></h3>
<p>CPG metadata (required by spec).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_metadata</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="k">language</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="k">version</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="c1">-- &quot;1.1&quot;</span>
<span class="w">    </span><span class="n">overlays</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">[],</span>
<span class="w">    </span><span class="n">root</span><span class="w"> </span><span class="nb">VARCHAR</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- LANGUAGE: Source language
- VERSION: CPG spec version
- OVERLAYS: Applied overlays
- ROOT: Root path</p>
<h3 id="nodes-file">nodes_file<a class="heading-anchor" href="#nodes-file" title="Link to this section">&para;</a></h3>
<p>Source file nodes (required by spec).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_file</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">           </span><span class="c1">-- File path (relative to root)</span>
<span class="w">    </span><span class="n">hash</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">           </span><span class="c1">-- File content hash</span>
<span class="w">    </span><span class="n">content</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">           </span><span class="c1">-- Optional: file source code</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_file_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_file</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_file_hash</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_file</span><span class="p">(</span><span class="n">hash</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: File path relative to root (from METADATA.ROOT)
- HASH: SHA-256 or MD5 hash of file content
- CONTENT: Optional - full source code of the file
- ORDER_INDEX: Always 0 (file nodes have no siblings)</p>
<p><strong>Purpose:</strong>
- Index for looking up all code elements by file
- Root nodes of Abstract Syntax Trees (AST)
- Source file metadata storage
- Required for SOURCE_FILE edges</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code>name=&quot;src/main.c&quot;, hash=&quot;abc123...&quot;, order_index=0
</code></pre></div>

<p><strong>Note:</strong> Each source file SHOULD have exactly one FILE node. FILE nodes serve as AST roots and allow navigation from file to all contained code elements.</p>
<h3 id="nodes-namespace-block">nodes_namespace_block<a class="heading-anchor" href="#nodes-namespace-block" title="Link to this section">&para;</a></h3>
<p>Namespace block nodes (namespace scopes).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">           </span><span class="c1">-- Namespace name (dot-separated)</span>
<span class="w">    </span><span class="n">full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">      </span><span class="c1">-- Unique identifier (file + namespace)</span>
<span class="w">    </span><span class="n">filename</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">       </span><span class="c1">-- Containing file</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_namespace_block_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_namespace_block_full_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="p">(</span><span class="n">full_name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_namespace_block_filename</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: Human-readable namespace name (e.g., &ldquo;foo.bar&rdquo;)
  - Dot-separated: &ldquo;foo.bar&rdquo; means namespace &ldquo;bar&rdquo; inside &ldquo;foo&rdquo;
- FULL_NAME: Unique identifier combining file and namespace
  - Should include file info to ensure uniqueness
- FILENAME: Source file containing this namespace block
- ORDER_INDEX: Position in parent AST</p>
<p><strong>Purpose:</strong>
- Represent namespace blocks (C++ <code>namespace{}</code>, Java <code>package</code>)
- Structure code into logical units
- Allow namespace-based code queries
- Support multi-file namespace analysis</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// C++:</span>
<span class="k">namespace</span><span class="w"> </span><span class="nn">foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">namespace</span><span class="w"> </span><span class="nn">bar</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// code</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// NAME=&quot;foo.bar&quot;, FULL_NAME=&quot;main.cpp:foo.bar&quot;</span>

<span class="c1">// Java:</span>
<span class="n">package</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">myapp</span><span class="p">;</span>
<span class="c1">// NAME=&quot;com.example.myapp&quot;, FULL_NAME=&quot;Main.java:com.example.myapp&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> NAMESPACE nodes (indices) are auto-generated from NAMESPACE_BLOCK nodes when CPG is loaded.</p>
<h3 id="nodes-method-ref">nodes_method_ref<a class="heading-anchor" href="#nodes-method-ref" title="Link to this section">&para;</a></h3>
<p>Method reference nodes (method as value).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_method_ref</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">method_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Referenced method&#39;s full name</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">    </span><span class="c1">-- Method&#39;s type (function pointer type)</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">                 </span><span class="c1">-- As it appears in code</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset_end&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_method_ref_method_full_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_method_ref</span><span class="p">(</span><span class="n">method_full_name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_method_ref_type</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_method_ref</span><span class="p">(</span><span class="n">type_full_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- METHOD_FULL_NAME: Fully-qualified name of referenced method
- TYPE_FULL_NAME: Type of the method (e.g., &ldquo;int(*)(int, int)&rdquo; in C)
- CODE: How the reference appears in source
- OFFSET/OFFSET_END: Precise source location</p>
<p><strong>Purpose:</strong>
- Represent methods passed as arguments (higher-order functions)
- Function pointers (C/C++)
- Lambda expressions / closures
- Method handles (Java)
- Delegate types (C#)</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// C function pointer:</span>
<span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">func_ptr</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">myFunction</span><span class="p">;</span>
<span class="c1">// METHOD_REF: method_full_name=&quot;myFunction&quot;, type_full_name=&quot;int(*)(int)&quot;</span>

<span class="c1">// Java method reference:</span>
<span class="n">list</span><span class="p">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="o">::</span><span class="n">println</span><span class="p">);</span>
<span class="c1">// METHOD_REF: method_full_name=&quot;System.out.println&quot;, type_full_name=&quot;Consumer&lt;Object&gt;&quot;</span>

<span class="c1">// Python:</span>
<span class="n">callback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_function</span>
<span class="c1">// METHOD_REF: method_full_name=&quot;some_function&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> METHOD_REF is used when a method is referenced but not called at that location.</p>
<h3 id="nodes-type-ref">nodes_type_ref<a class="heading-anchor" href="#nodes-type-ref" title="Link to this section">&para;</a></h3>
<p>Type reference nodes (type as value).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_type_ref</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">    </span><span class="c1">-- Referenced type&#39;s full name</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">                 </span><span class="c1">-- As it appears in code</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset_end&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_type_ref_type</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_type_ref</span><span class="p">(</span><span class="n">type_full_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- TYPE_FULL_NAME: Fully-qualified name of referenced type
- CODE: How the reference appears in source
- OFFSET/OFFSET_END: Precise source location</p>
<p><strong>Purpose:</strong>
- Represent types used as values (not instantiations)
- typeof/typeid operations
- Type casting
- Reflection (Java .class, C# typeof)
- Type arguments to generics</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Java reflection:</span>
<span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>
<span class="c1">// TYPE_REF: type_full_name=&quot;java.lang.String&quot;</span>

<span class="c1">// C++ type casting:</span>
<span class="n">auto</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">static_cast</span><span class="o">&lt;</span><span class="n">MyClass</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="c1">// TYPE_REF: type_full_name=&quot;MyClass&quot;</span>

<span class="c1">// Generic type argument:</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="c1">// TYPE_REF: type_full_name=&quot;java.lang.Integer&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> TYPE_REF is used when a type is referenced as a value, not when creating an instance.</p>
<h3 id="nodes-unknown">nodes_unknown<a class="heading-anchor" href="#nodes-unknown" title="Link to this section">&para;</a></h3>
<p>Unknown AST nodes (catch-all for unsupported constructs).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_unknown</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">parser_type_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Parser/disassembler type name</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">    </span><span class="c1">-- Best-guess type</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset_end&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_unknown_parser_type</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_unknown</span><span class="p">(</span><span class="n">parser_type_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- PARSER_TYPE_NAME: Name of construct as emitted by parser
- TYPE_FULL_NAME: Best-effort type inference
- CODE: Source code representation</p>
<p><strong>Purpose:</strong>
- Include AST nodes not specified in CPG spec
- Language-specific constructs
- Experimental/proprietary language features
- Maintain complete AST even for unsupported features</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Python walrus operator (if not in spec):</span>
<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="o">...</span>
<span class="c1"># UNKNOWN: parser_type_name=&quot;NamedExpr&quot;, code=&quot;n := len(items)&quot;</span>

<span class="c1"># Proprietary language extension:</span>
<span class="nd">@CustomDirective</span>
<span class="c1"># UNKNOWN: parser_type_name=&quot;CustomDirective&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> UNKNOWN should be used sparingly - prefer proper node types when available.</p>
<h3 id="nodes-jump-target">nodes_jump_target<a class="heading-anchor" href="#nodes-jump-target" title="Link to this section">&para;</a></h3>
<p>Jump targets (labels for goto/break/continue).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_jump_target</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">              </span><span class="c1">-- Label name</span>
<span class="w">    </span><span class="n">parser_type_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">  </span><span class="c1">-- e.g., &quot;Label&quot;, &quot;CaseLabel&quot;</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset_end&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_jump_target_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_jump_target</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: Label name
- PARSER_TYPE_NAME: Type of label construct
- CODE: Label as it appears in source</p>
<p><strong>Purpose:</strong>
- Represent jump targets (goto labels, case labels)
- Support control flow analysis with jumps
- Enable goto-based code analysis
- Track switch case targets</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// C goto label:</span>
<span class="nl">error_handler</span><span class="p">:</span>
<span class="w">    </span><span class="n">cleanup</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="c1">// JUMP_TARGET: name=&quot;error_handler&quot;, parser_type_name=&quot;Label&quot;</span>

<span class="c1">// Switch case label:</span>
<span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">42</span><span class="p">:</span><span class="w">  </span><span class="c1">// JUMP_TARGET: name=&quot;case_42&quot;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Note:</strong> Modern languages discourage goto, but it&rsquo;s common in C/assembly.</p>
<h3 id="nodes-type-parameter">nodes_type_parameter<a class="heading-anchor" href="#nodes-type-parameter" title="Link to this section">&para;</a></h3>
<p>Type parameters (generics/templates formal parameters).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_type_parameter</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">              </span><span class="c1">-- Parameter name (e.g., &quot;T&quot;, &quot;K&quot;, &quot;V&quot;)</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_type_parameter_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_type_parameter</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: Type parameter name</p>
<p><strong>Purpose:</strong>
- Formal type parameters in generic/template declarations
- Java Generics: <code>class List&lt;T&gt;</code>
- C++ Templates: <code>template&lt;typename T&gt;</code>
- C# Generics: <code>class Dictionary&lt;TKey, TValue&gt;</code></p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Java:</span>
<span class="kd">class</span> <span class="nc">Box</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// TYPE_PARAMETER: name=&quot;T&quot;</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// C++:</span>
<span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">typename</span><span class="w"> </span><span class="n">V</span><span class="o">&gt;</span>
<span class="c1">// TYPE_PARAMETER: name=&quot;K&quot;</span>
<span class="c1">// TYPE_PARAMETER: name=&quot;V&quot;</span>
<span class="kd">class</span> <span class="nc">Map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>

<p><strong>Note:</strong> TYPE_PARAMETER is the formal parameter, TYPE_ARGUMENT is the actual type used.</p>
<h3 id="nodes-type-argument">nodes_type_argument<a class="heading-anchor" href="#nodes-type-argument" title="Link to this section">&para;</a></h3>
<p>Type arguments (generics/templates actual arguments).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_type_argument</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">                 </span><span class="c1">-- Type argument as written</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">argument_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- CODE: Type argument code (e.g., &ldquo;Integer&rdquo;, &ldquo;String&rdquo;)</p>
<p><strong>Purpose:</strong>
- Actual type arguments in generic/template instantiations
- Connects to TYPE_PARAMETER via BINDS_TO edge
- Java: <code>List&lt;Integer&gt;</code> - &ldquo;Integer&rdquo; is TYPE_ARGUMENT
- C++: <code>vector&lt;int&gt;</code> - &ldquo;int&rdquo; is TYPE_ARGUMENT</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
<span class="c1">// TYPE_ARGUMENT: code=&quot;Integer&quot; (for List)</span>
<span class="c1">// TYPE_ARGUMENT: code=&quot;String&quot; (for ArrayList)</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">map</span><span class="p">;</span>
<span class="c1">// TYPE_ARGUMENT: code=&quot;String&quot;</span>
<span class="c1">// TYPE_ARGUMENT: code=&quot;Integer&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> TYPE_ARGUMENT instances bind to TYPE_PARAMETER declarations.</p>
<h3 id="nodes-binding">nodes_binding<a class="heading-anchor" href="#nodes-binding" title="Link to this section">&para;</a></h3>
<p>Name-signature bindings (method resolution).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_binding</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">              </span><span class="c1">-- Method name</span>
<span class="w">    </span><span class="n">signature</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">         </span><span class="c1">-- Method signature</span>
<span class="w">    </span><span class="n">method_full_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w">   </span><span class="c1">-- Resolved method (if known)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binding_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_binding</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binding_signature</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_binding</span><span class="p">(</span><span class="n">signature</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binding_method_full_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_binding</span><span class="p">(</span><span class="n">method_full_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- NAME: Method name
- SIGNATURE: Method signature
- METHOD_FULL_NAME: Fully-qualified resolved method name</p>
<p><strong>Purpose:</strong>
- Resolve (name, signature) pairs at type declarations
- Support virtual method dispatch
- Enable polymorphism analysis
- Connect TYPE_DECL to bound methods</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Type declaration with methods:</span>
<span class="kd">class</span> <span class="nc">Animal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">speak</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">// BINDING: name=&quot;speak&quot;, signature=&quot;void()&quot;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Dog</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">speak</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">// BINDING: name=&quot;speak&quot;, signature=&quot;void()&quot;</span>
<span class="p">}</span>

<span class="c1">// BINDING nodes allow resolving which speak() is called</span>
</code></pre></div>

<p><strong>Note:</strong> BINDING connects TYPE_DECL to METHOD via BINDS and REF edges.</p>
<h3 id="nodes-closure-binding">nodes_closure_binding<a class="heading-anchor" href="#nodes-closure-binding" title="Link to this section">&para;</a></h3>
<p>Closure variable capture (lambda/closure bindings).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_closure_binding</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">closure_binding_id</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">    </span><span class="c1">-- Unique capture identifier</span>
<span class="w">    </span><span class="n">evaluation_strategy</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">   </span><span class="c1">-- BY_VALUE, BY_REFERENCE, BY_SHARING</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_closure_binding_id</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_closure_binding</span><span class="p">(</span><span class="n">closure_binding_id</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- CLOSURE_BINDING_ID: Unique identifier for this capture
- EVALUATION_STRATEGY: How variable is captured
- CODE: Captured variable name</p>
<p><strong>Purpose:</strong>
- Represent variable capture in closures/lambdas
- Connect captured LOCAL/PARAM to closure
- Support closure analysis
- Enable escape analysis</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">outer</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">inner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">y</span><span class="p">);</span><span class="w">  </span><span class="c1">// x and y are captured</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
<span class="c1">// CLOSURE_BINDING for x: closure_binding_id=&quot;outer.inner.x&quot;</span>
<span class="c1">// CLOSURE_BINDING for y: closure_binding_id=&quot;outer.inner.y&quot;</span>

<span class="c1">// Java lambda:</span>
<span class="kr">int</span><span class="w"> </span><span class="nx">multiplier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="nx">list</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">item</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">multiplier</span><span class="p">);</span>
<span class="c1">// CLOSURE_BINDING for multiplier</span>
</code></pre></div>

<p><strong>Note:</strong> CLOSURE_BINDING connects to LOCAL via CAPTURED_BY and to METHOD_REF via CAPTURE.</p>
<h3 id="nodes-comment">nodes_comment<a class="heading-anchor" href="#nodes-comment" title="Link to this section">&para;</a></h3>
<p>Source code comments.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_comment</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">                 </span><span class="c1">-- Comment text</span>
<span class="w">    </span><span class="n">filename</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w">          </span><span class="c1">-- Source file</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;offset_end&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_comment_filename</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_comment</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- CODE: Comment text (including delimiters)
- FILENAME: Source file containing comment
- OFFSET/OFFSET_END: Precise location</p>
<p><strong>Purpose:</strong>
- Preserve source code comments
- Documentation extraction
- Code annotation analysis
- Comment-based security markers</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Single-line comment</span>
<span class="c1">// COMMENT: code=&quot;// Single-line comment&quot;</span>

<span class="cm">/* Multi-line</span>
<span class="cm">   comment */</span>
<span class="c1">// COMMENT: code=&quot;/* Multi-line\n   comment */&quot;</span>

<span class="cm">/** JavaDoc comment</span>
<span class="cm">  * @param x Parameter description</span>
<span class="cm">  */</span>
<span class="c1">// COMMENT: code=&quot;/** JavaDoc...*/&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> Comments are AST nodes connected to FILE via AST edges.</p>
<h2 id="edge-tables">Edge Tables<a class="heading-anchor" href="#edge-tables" title="Link to this section">&para;</a></h2>
<h3 id="edges-ast">edges_ast<a class="heading-anchor" href="#edges-ast" title="Link to this section">&para;</a></h3>
<p>Abstract Syntax Tree edges (parent-child relationships).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_ast</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ast_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ast</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ast_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ast</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-cfg">edges_cfg<a class="heading-anchor" href="#edges-cfg" title="Link to this section">&para;</a></h3>
<p>Control Flow Graph edges.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_cfg</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cfg_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cfg</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cfg_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cfg</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-call">edges_call<a class="heading-anchor" href="#edges-call" title="Link to this section">&para;</a></h3>
<p>Call site to method declaration edges.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_call</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- CALL node id</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- METHOD node id</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_call_edge_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_call</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_call_edge_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_call</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-ref">edges_ref<a class="heading-anchor" href="#edges-ref" title="Link to this section">&para;</a></h3>
<p>Reference edges (identifier to declaration).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_ref</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- IDENTIFIER/CALL node id</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- DECLARATION node id (LOCAL, PARAM, METHOD, TYPE_DECL)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ref_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ref</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ref_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ref</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-reaching-def">edges_reaching_def<a class="heading-anchor" href="#edges-reaching-def" title="Link to this section">&para;</a></h3>
<p>Data flow edges (reaching definitions).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">variable</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Variable name</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="k">variable</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_reaching_def_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_reaching_def_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_reaching_def_variable</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="p">(</span><span class="k">variable</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- VARIABLE: Variable name being tracked</p>
<h3 id="edges-argument">edges_argument<a class="heading-anchor" href="#edges-argument" title="Link to this section">&para;</a></h3>
<p>Argument edges (call to argument expressions, return to returned expression).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_argument</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_argument_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_argument</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_argument_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_argument</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-receiver">edges_receiver<a class="heading-anchor" href="#edges-receiver" title="Link to this section">&para;</a></h3>
<p>Receiver edges (call to receiver object).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_receiver</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- CALL node id</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Receiver expression id</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="edges-condition">edges_condition<a class="heading-anchor" href="#edges-condition" title="Link to this section">&para;</a></h3>
<p>Condition edges (control structure to conditional expression).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_condition</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- CONTROL_STRUCTURE node id</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Expression node id</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="edges-dominate">edges_dominate<a class="heading-anchor" href="#edges-dominate" title="Link to this section">&para;</a></h3>
<p>Immediate dominator edges (control flow domination).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_dominate</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="edges-post-dominate">edges_post_dominate<a class="heading-anchor" href="#edges-post-dominate" title="Link to this section">&para;</a></h3>
<p>Post-dominator edges.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_post_dominate</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_post_dominate_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_post_dominate</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_post_dominate_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_post_dominate</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-cdg">edges_cdg<a class="heading-anchor" href="#edges-cdg" title="Link to this section">&para;</a></h3>
<p>Control Dependence Graph edges (CRITICAL for PDG).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_cdg</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Control structure node id (condition/branch)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Dependent node id (code that depends on condition)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cdg_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cdg</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cdg_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cdg</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- CDG edge means: dst is control-dependent on src
- Essential for Program Dependence Graph (PDG = DDG + CDG)
- Used for program slicing, security analysis, compiler optimizations
- Example: statements inside IF block are control-dependent on IF condition</p>
<h3 id="edges-binds">edges_binds<a class="heading-anchor" href="#edges-binds" title="Link to this section">&para;</a></h3>
<p>Binding edges (name bindings).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_binds</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- BINDING node id</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- METHOD or TYPE_DECL node id</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Connects BINDING nodes to their declarations
- Used for variable/function name resolution
- Example: import statement binds name to actual definition</p>
<h3 id="edges-binds-to">edges_binds_to<a class="heading-anchor" href="#edges-binds-to" title="Link to this section">&para;</a></h3>
<p>Reverse binding edges (name uses).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_binds_to</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Variable/function reference node id</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- BINDING node id</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_to_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds_to</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_to_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds_to</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Reverse of BINDS edge
- Connects uses of names to their bindings
- Example: variable reference → binding → declaration</p>
<p><strong>BINDS workflow:</strong></p>
<div class="highlight"><pre><span></span><code>Declaration (METHOD/TYPE_DECL)
     ↑
   BINDS
     |
  BINDING node (import/using statement)
     ↑
 BINDS_TO
     |
Reference (IDENTIFIER/CALL)
</code></pre></div>

<h3 id="edges-source-file">edges_source_file<a class="heading-anchor" href="#edges-source-file" title="Link to this section">&para;</a></h3>
<p>Source file edges (node to file mapping).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_source_file</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Any AST node id</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- FILE node id</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_source_file_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_source_file</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_source_file_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_source_file</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Connects nodes to their source FILE
- Auto-created based on FILENAME properties
- <strong>MUST NOT be created by language frontend</strong> - created automatically
- One-to-one relationship: each node has exactly one source file</p>
<p><strong>Purpose:</strong>
- Map any code element back to its source file
- Navigate from FILE to all contained elements
- Support file-based queries and analysis
- Enable IDE &ldquo;go to file&rdquo; functionality</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nx">METHOD</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">SOURCE_FILE</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">FILE</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">=</span><span class="s">&quot;main.c&quot;</span><span class="p">)</span>
<span class="nx">CALL</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">SOURCE_FILE</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">FILE</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">=</span><span class="s">&quot;main.c&quot;</span><span class="p">)</span>
<span class="nx">TYPE_DECL</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">300</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">SOURCE_FILE</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">FILE</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">=</span><span class="s">&quot;types.h&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Auto-creation logic:</strong>
1. Frontend sets FILENAME property on nodes (METHOD, TYPE_DECL, etc.)
2. CPG loader creates FILE nodes for unique filenames
3. CPG loader creates SOURCE_FILE edges from nodes to FILE nodes
4. Results in complete file→code mapping</p>
<h3 id="edges-alias-of">edges_alias_of<a class="heading-anchor" href="#edges-alias-of" title="Link to this section">&para;</a></h3>
<p>Type alias edges.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_alias_of</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- TYPE_DECL node (alias)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- TYPE node (actual type)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_alias_of_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_alias_of</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_alias_of_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_alias_of</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Connects TYPE_DECL (alias) to TYPE (actual)
- <strong>MUST NOT be created by frontend</strong> - auto-created from ALIAS_TYPE_FULL_NAME
- One-to-one relationship</p>
<p><strong>Purpose:</strong>
- Represent type aliases (C typedef, using, type aliases)
- Enable alias resolution
- Support type synonym analysis</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// C typedef:</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Integer</span><span class="p">;</span>
<span class="c1">// TYPE_DECL &quot;Integer&quot; --ALIAS_OF--&gt; TYPE &quot;int&quot;</span>

<span class="c1">// C++ using:</span>
<span class="n">using</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">;</span>
<span class="c1">// TYPE_DECL &quot;String&quot; --ALIAS_OF--&gt; TYPE &quot;std::string&quot;</span>

<span class="c1">// Rust type alias:</span>
<span class="n">type</span><span class="w"> </span><span class="n">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">result</span><span class="o">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">// TYPE_DECL &quot;Result&quot; --ALIAS_OF--&gt; TYPE &quot;std::result::Result&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> Auto-generated when CPG is loaded based on ALIAS_TYPE_FULL_NAME property.</p>
<h3 id="edges-inherits-from">edges_inherits_from<a class="heading-anchor" href="#edges-inherits-from" title="Link to this section">&para;</a></h3>
<p>Type inheritance edges.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_inherits_from</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- TYPE_DECL node (derived)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- TYPE node (base)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_inherits_from_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_inherits_from</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_inherits_from_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_inherits_from</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Connects TYPE_DECL (derived) to TYPE (base)
- <strong>MUST NOT be created by frontend</strong> - auto-created from INHERITS_FROM_TYPE_FULL_NAME
- One-to-many relationship (multiple inheritance supported)</p>
<p><strong>Purpose:</strong>
- Represent class/interface inheritance
- Enable polymorphism analysis
- Support type hierarchy queries
- Track inheritance chains</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Java single inheritance:</span>
<span class="kd">class</span> <span class="nc">Dog</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Comparable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span>
<span class="p">}</span>
<span class="c1">// TYPE_DECL &quot;Dog&quot; --INHERITS_FROM--&gt; TYPE &quot;Animal&quot;</span>
<span class="c1">// TYPE_DECL &quot;Dog&quot; --INHERITS_FROM--&gt; TYPE &quot;Comparable&quot;</span>

<span class="c1">// C++ multiple inheritance:</span>
<span class="kd">class</span> <span class="nc">D</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
<span class="c1">// TYPE_DECL &quot;D&quot; --INHERITS_FROM--&gt; TYPE &quot;A&quot;</span>
<span class="c1">// TYPE_DECL &quot;D&quot; --INHERITS_FROM--&gt; TYPE &quot;B&quot;</span>
</code></pre></div>

<p><strong>Note:</strong> Auto-generated when CPG is loaded based on INHERITS_FROM_TYPE_FULL_NAME array.</p>
<h3 id="edges-capture">edges_capture<a class="heading-anchor" href="#edges-capture" title="Link to this section">&para;</a></h3>
<p>Closure capture edges.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_capture</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- METHOD_REF or TYPE_REF node</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- CLOSURE_BINDING node</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_capture_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_capture</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_capture_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_capture</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Connects METHOD_REF/TYPE_REF to CLOSURE_BINDING
- Represents variable capture in closure/lambda
- One-to-many relationship (closure can capture multiple variables)</p>
<p><strong>Purpose:</strong>
- Track which variables are captured by closures
- Enable escape analysis
- Support closure optimization
- Identify captured variable lifetimes</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">outer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">inner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span><span class="w">  </span><span class="c1">// captures x and y</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
<span class="c1">// METHOD_REF &quot;inner&quot; --CAPTURE--&gt; CLOSURE_BINDING for x</span>
<span class="c1">// METHOD_REF &quot;inner&quot; --CAPTURE--&gt; CLOSURE_BINDING for y</span>
</code></pre></div>

<p><strong>Note:</strong> CAPTURE edge connects closure to its captured variables.</p>
<h3 id="edges-captured-by">edges_captured_by<a class="heading-anchor" href="#edges-captured-by" title="Link to this section">&para;</a></h3>
<p>Reverse closure capture edges.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_captured_by</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- LOCAL or METHOD_PARAMETER_IN node</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- CLOSURE_BINDING node</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_captured_by_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_captured_by</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_captured_by_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_captured_by</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties</strong> (from CPG spec):
- Connects LOCAL/METHOD_PARAMETER_IN to CLOSURE_BINDING
- Reverse of CAPTURE edge
- Indicates which closures capture this variable</p>
<p><strong>Purpose:</strong>
- Track which closures capture a variable
- Identify variables that escape their scope
- Support variable lifetime analysis
- Enable closure-related refactorings</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_counter</span><span class="p">():</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># LOCAL</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">increment</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">count</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">count</span>
    <span class="k">return</span> <span class="n">increment</span>
<span class="c1"># LOCAL &quot;count&quot; --CAPTURED_BY--&gt; CLOSURE_BINDING</span>
</code></pre></div>

<p><strong>Closure workflow:</strong></p>
<div class="highlight"><pre><span></span><code>LOCAL/PARAM &quot;x&quot;
     |
CAPTURED_BY
     ↓
CLOSURE_BINDING
     ↑
  CAPTURE
     |
METHOD_REF (closure/lambda)
</code></pre></div>

<p><strong>Note:</strong> CAPTURED_BY connects captured variable to closure binding.</p>
<h2 id="property-graph-definition">Property Graph Definition<a class="heading-anchor" href="#property-graph-definition" title="Link to this section">&para;</a></h2>
<p>Using duckpgq to create a unified property graph with full CPG schema support.</p>
<p><strong>KEY INSIGHT</strong>: DuckDB PGQ does not support views in VERTEX TABLES, but we can use
<strong>materialized tables</strong> instead! This allows full support for polymorphic edges.</p>
<h3 id="step-1-create-materialized-unified-nodes-table">Step 1: Create Materialized Unified Nodes Table<a class="heading-anchor" href="#step-1-create-materialized-unified-nodes-table" title="Link to this section">&para;</a></h3>
<p><strong>Important</strong>: Use <code>CREATE TABLE</code> (not <code>CREATE VIEW</code>) to materialize the unified node set.</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Create materialized unified table of all CPG nodes for polymorphic edge support</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="p">;</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="k">AS</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FILE&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">node_type</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_file</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NAMESPACE_BLOCK&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_namespace_block</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;METHOD&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;METHOD_REF&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method_ref</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CALL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_call</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;IDENTIFIER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_identifier</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FIELD_IDENTIFIER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_field_identifier</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LITERAL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_literal</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LOCAL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_local</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PARAM&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_param</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PARAM_OUT&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_param_out</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;METHOD_RETURN&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method_return</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;RETURN&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_return</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BLOCK&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_block</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONTROL_STRUCTURE&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_control_structure</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MEMBER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_member</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_DECL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_decl</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_REF&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_ref</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_PARAMETER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_parameter</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_ARGUMENT&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_argument</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;UNKNOWN&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_unknown</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JUMP_TARGET&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_jump_target</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BINDING&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_binding</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CLOSURE_BINDING&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_closure_binding</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;COMMENT&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_comment</span><span class="p">;</span>

<span class="c1">-- Add primary key and indexes</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cpg_nodes_type</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="p">(</span><span class="n">node_type</span><span class="p">);</span>
</code></pre></div>

<h3 id="step-2-create-comprehensive-property-graph">Step 2: Create Comprehensive Property Graph<a class="heading-anchor" href="#step-2-create-comprehensive-property-graph" title="Link to this section">&para;</a></h3>
<p><strong>Full Implementation</strong> (with ALL edge types including polymorphic edges):</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="n">PROPERTY</span><span class="w"> </span><span class="n">GRAPH</span><span class="w"> </span><span class="n">cpg</span>
<span class="n">VERTEX</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- Materialized unified node table for polymorphic edge support</span>
<span class="w">    </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CPG_NODE</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- Individual typed node tables for specific queries</span>
<span class="w">    </span><span class="n">nodes_file</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">FILE_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_namespace_block</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">NAMESPACE_BLOCK</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="k">METHOD</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_method_ref</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">METHOD_REF</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_call</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CALL_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_identifier</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">IDENTIFIER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_field_identifier</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">FIELD_IDENTIFIER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_literal</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">LITERAL</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_local</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="k">LOCAL</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_param</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">PARAM</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_param_out</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">PARAM_OUT</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_method_return</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">METHOD_RETURN</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_return</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">RETURN_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_block</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_control_structure</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CONTROL_STRUCTURE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_member</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">MEMBER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_decl</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">TYPE_DECL</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_ref</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">TYPE_REF</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_parameter</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">TYPE_PARAMETER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_argument</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">TYPE_ARGUMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_unknown</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="k">UNKNOWN</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_jump_target</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">JUMP_TARGET</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_binding</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">BINDING</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_closure_binding</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CLOSURE_BINDING</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_comment</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">COMMENT_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_metadata</span><span class="w"> </span><span class="n">LABEL</span><span class="w"> </span><span class="n">METADATA</span>
<span class="p">)</span>
<span class="n">EDGE</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- ========================================</span>
<span class="w">    </span><span class="c1">-- POLYMORPHIC EDGES (via cpg_nodes table)</span>
<span class="w">    </span><span class="c1">-- ========================================</span>

<span class="w">    </span><span class="n">edges_ast</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">AST</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_cfg</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CFG</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_ref</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="k">REF</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_reaching_def</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">REACHING_DEF</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_argument</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">ARGUMENT</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_dominate</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">DOMINATE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_post_dominate</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">POST_DOMINATE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_cdg</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CDG</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_binds</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">BINDS</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_binds_to</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">BINDS_TO</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- ========================================</span>
<span class="w">    </span><span class="c1">-- TYPED EDGES (specific source/destination)</span>
<span class="w">    </span><span class="c1">-- ========================================</span>

<span class="w">    </span><span class="n">edges_call</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CALLS</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_receiver</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">RECEIVER</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_condition</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_control_structure</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CONDITION</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_source_file</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_file</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">SOURCE_FILE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_alias_of</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_type_decl</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">ALIAS_OF</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_inherits_from</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_type_decl</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">INHERITS_FROM</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_capture</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_closure_binding</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CAPTURE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_captured_by</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_closure_binding</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="n">LABEL</span><span class="w"> </span><span class="n">CAPTURED_BY</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Key Features</strong>:
- ✅ <strong>Full CPG schema support</strong> with ALL edge types
- ✅ <strong>Polymorphic edges</strong> (AST, CFG, REF, etc.) via materialized <code>cpg_nodes</code> table
- ✅ <strong>Typed vertices</strong> for efficient targeted queries
- ✅ <strong>DuckDB PGQ compatible</strong> (uses tables, not views)
- ✅ <strong>100% Joern CPG spec v1.1 compliant</strong></p>
<h2 id="example-queries">Example Queries<a class="heading-anchor" href="#example-queries" title="Link to this section">&para;</a></h2>
<h3 id="standard-sql-query-find-all-calls-to-a-specific-method">Standard SQL Query: Find all calls to a specific method<a class="heading-anchor" href="#standard-sql-query-find-all-calls-to-a-specific-method" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">line_number</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="k">c</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_call</span><span class="w"> </span><span class="n">ec</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">.</span><span class="n">src</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">ec</span><span class="p">.</span><span class="n">dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;com.example.MyClass.myMethod:void()&#39;</span><span class="p">;</span>
</code></pre></div>

<h3 id="duckdb-pgq-query-find-direct-call-chains-caller-callee">DuckDB PGQ Query: Find direct call chains (caller -&gt; callee)<a class="heading-anchor" href="#duckdb-pgq-query-find-direct-call-chains-caller-callee" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">caller</span><span class="p">:</span><span class="k">METHOD</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">CALLS</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="k">call</span><span class="p">:</span><span class="n">CALL_NODE</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">CALLS</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">callee</span><span class="p">:</span><span class="k">METHOD</span><span class="p">)</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">caller</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;main&#39;</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="n">caller</span><span class="p">.</span><span class="n">full_name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">caller_name</span><span class="p">,</span><span class="w"> </span><span class="n">callee</span><span class="p">.</span><span class="n">full_name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">callee_name</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="duckdb-pgq-query-find-methods-and-their-ast-children">DuckDB PGQ Query: Find methods and their AST children<a class="heading-anchor" href="#duckdb-pgq-query-find-methods-and-their-ast-children" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="k">METHOD</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">AST</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">child</span><span class="p">:</span><span class="n">CPG_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">method</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">child_id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="duckdb-pgq-query-data-flow-paths-using-reaching-def">DuckDB PGQ Query: Data flow paths using REACHING_DEF<a class="heading-anchor" href="#duckdb-pgq-query-data-flow-paths-using-reaching-def" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="k">source</span><span class="p">:</span><span class="n">CPG_NODE</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">REACHING_DEF</span><span class="o">*</span><span class="mi">1</span><span class="p">..</span><span class="mi">5</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">sink</span><span class="p">:</span><span class="n">CPG_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="k">source</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">sink</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</code></pre></div>

<h3 id="duckdb-pgq-query-cfg-paths-control-flow">DuckDB PGQ Query: CFG paths (control flow)<a class="heading-anchor" href="#duckdb-pgq-query-cfg-paths-control-flow" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="k">start</span><span class="p">:</span><span class="n">CPG_NODE</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">CFG</span><span class="o">*</span><span class="mi">1</span><span class="p">..</span><span class="mi">3</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="n">CPG_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="k">start</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">start_node</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">end_node</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</code></pre></div>

<h3 id="duckdb-pgq-query-find-all-identifiers-and-their-references">DuckDB PGQ Query: Find all identifiers and their references<a class="heading-anchor" href="#duckdb-pgq-query-find-all-identifiers-and-their-references" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="n">IDENTIFIER</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="k">REF</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">decl</span><span class="p">:</span><span class="n">CPG_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">identifier_name</span><span class="p">,</span><span class="w"> </span><span class="n">decl</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">declaration_id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="duckdb-pgq-query-type-hierarchy-inheritance">DuckDB PGQ Query: Type hierarchy (inheritance)<a class="heading-anchor" href="#duckdb-pgq-query-type-hierarchy-inheritance" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">derived</span><span class="p">:</span><span class="n">TYPE_DECL</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">INHERITS_FROM</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">base</span><span class="p">:</span><span class="n">CPG_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="n">derived</span><span class="p">.</span><span class="n">full_name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">derived_type</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">base_type</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="combined-query-methods-with-most-incoming-calls">Combined Query: Methods with most incoming calls<a class="heading-anchor" href="#combined-query-methods-with-most-incoming-calls" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">call_count</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="k">c</span><span class="p">:</span><span class="n">CALL_NODE</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">CALLS</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="k">METHOD</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">call_count</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</code></pre></div>

<h2 id="migration-from-joern">Migration from Joern<a class="heading-anchor" href="#migration-from-joern" title="Link to this section">&para;</a></h2>
<h3 id="phase-1-critical-completed">Phase 1 (CRITICAL) - COMPLETED ✓<a class="heading-anchor" href="#phase-1-critical-completed" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ nodes_method (with all properties)</li>
<li>✓ nodes_call (with method_full_name, name, signature)</li>
<li>✓ edges_call (call site to method)</li>
<li>✓ nodes_param_out (METHOD_PARAMETER_OUT) - NEW!</li>
<li>✓ nodes_method_return (METHOD_RETURN) - NEW!</li>
<li>✓ edges_cdg (Control Dependence Graph) - NEW!</li>
</ul>
<h3 id="phase-2-oop-support-completed">Phase 2 (OOP SUPPORT) - COMPLETED ✓<a class="heading-anchor" href="#phase-2-oop-support-completed" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ nodes_field_identifier (FIELD_IDENTIFIER) - NEW!</li>
<li>✓ nodes_member (MEMBER) - NEW!</li>
<li>✓ OFFSET/OFFSET_END properties on METHOD, TYPE_DECL, IDENTIFIER - NEW!</li>
<li>✓ MODIFIER property on METHOD, TYPE_DECL - NEW!</li>
<li>✓ edges_binds (BINDS) - NEW!</li>
<li>✓ edges_binds_to (BINDS_TO) - NEW!</li>
</ul>
<h3 id="phase-3-namespace-and-file-support-completed">Phase 3 (NAMESPACE AND FILE SUPPORT) - COMPLETED ✓<a class="heading-anchor" href="#phase-3-namespace-and-file-support-completed" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ nodes_file (FILE) - NEW!</li>
<li>✓ nodes_namespace_block (NAMESPACE_BLOCK) - NEW!</li>
<li>✓ nodes_method_ref (METHOD_REF) - NEW!</li>
<li>✓ nodes_type_ref (TYPE_REF) - NEW!</li>
<li>✓ edges_source_file (SOURCE_FILE) - NEW!</li>
</ul>
<h3 id="phase-4-remaining-features-completed">Phase 4 (REMAINING FEATURES) - COMPLETED ✓<a class="heading-anchor" href="#phase-4-remaining-features-completed" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ Export AST edges</li>
<li>✓ Export CFG edges</li>
<li>✓ Export REF, REACHING_DEF edges</li>
<li>✓ Export additional node types (UNKNOWN, JUMP_TARGET, TYPE_PARAMETER, TYPE_ARGUMENT, BINDING, CLOSURE_BINDING, COMMENT)</li>
<li>✓ Export remaining edges (ALIAS_OF, INHERITS_FROM, CAPTURE, CAPTURED_BY)</li>
</ul>
<h2 id="performance-considerations">Performance Considerations<a class="heading-anchor" href="#performance-considerations" title="Link to this section">&para;</a></h2>
<ol>
<li><strong>Batching</strong>: Use 10,000 row batches for INSERT operations</li>
<li><strong>Indexing</strong>: Create indexes after bulk load for faster imports</li>
<li><strong>Partitioning</strong>: Consider partitioning by filename for large codebases</li>
<li><strong>Compression</strong>: Use DuckDB&rsquo;s automatic compression for TEXT columns</li>
<li><strong>Memory</strong>: Configure DuckDB memory limit based on CPG size</li>
</ol>
<h2 id="schema-version">Schema Version<a class="heading-anchor" href="#schema-version" title="Link to this section">&para;</a></h2>
<ul>
<li>CPG Spec: v1.1</li>
<li>DuckDB: 1.1.3+</li>
<li>duckpgq: Latest stable</li>
<li>Schema Version: 5.0 (Phase 4 Complete Compliance)</li>
<li>Last Updated: 2025-11-16</li>
</ul>
<h2 id="changelog">Changelog<a class="heading-anchor" href="#changelog" title="Link to this section">&para;</a></h2>
<h3 id="v50-2025-11-16-phase-4-complete-compliance">v5.0 (2025-11-16) - Phase 4 Complete Compliance<a class="heading-anchor" href="#v50-2025-11-16-phase-4-complete-compliance" title="Link to this section">&para;</a></h3>
<p><strong>MAJOR UPDATE: Achieved 100% Joern schema compliance with all remaining features</strong></p>
<p><strong>New Node Types:</strong>
- <code>nodes_unknown</code> (UNKNOWN) - Catch-all for unsupported AST constructs
- <code>nodes_jump_target</code> (JUMP_TARGET) - Labels for goto/break/continue statements
- <code>nodes_type_parameter</code> (TYPE_PARAMETER) - Generic/template formal parameters
- <code>nodes_type_argument</code> (TYPE_ARGUMENT) - Generic/template actual arguments
- <code>nodes_binding</code> (BINDING) - Method resolution bindings
- <code>nodes_closure_binding</code> (CLOSURE_BINDING) - Variable capture in closures
- <code>nodes_comment</code> (COMMENT) - Source code comments</p>
<p><strong>New Edge Types:</strong>
- <code>edges_alias_of</code> (ALIAS_OF) - Type alias relationships
- <code>edges_inherits_from</code> (INHERITS_FROM) - Type inheritance relationships
- <code>edges_capture</code> (CAPTURE) - Closure variable capture
- <code>edges_captured_by</code> (CAPTURED_BY) - Reverse closure capture</p>
<p><strong>Impact:</strong>
- <strong>100% Joern schema compliance achieved</strong>
- Complete AST coverage with UNKNOWN nodes
- Full generic/template support
- Closure and lambda analysis enabled
- Type alias and inheritance resolution
- Comment preservation for documentation
- Complete program analysis capabilities</p>
<p><strong>Compliance:</strong> ~95% → <strong>100% Joern schema</strong></p>
<h3 id="v40-2025-11-16-phase-3-namespace-and-file-support">v4.0 (2025-11-16) - Phase 3 Namespace and File Support<a class="heading-anchor" href="#v40-2025-11-16-phase-3-namespace-and-file-support" title="Link to this section">&para;</a></h3>
<p><strong>MAJOR UPDATE: Added file mapping, namespace support, and method/type references</strong></p>
<p><strong>New Node Types:</strong>
- <code>nodes_file</code> (FILE) - Source file nodes for file-based indexing
- <code>nodes_namespace_block</code> (NAMESPACE_BLOCK) - Namespace blocks (C++ namespace, Java package)
- <code>nodes_method_ref</code> (METHOD_REF) - Method references (higher-order functions, function pointers)
- <code>nodes_type_ref</code> (TYPE_REF) - Type references (reflection, type casting, generics)</p>
<p><strong>New Edge Types:</strong>
- <code>edges_source_file</code> (SOURCE_FILE) - Node to file mapping (auto-created from FILENAME)</p>
<p><strong>Impact:</strong>
- File-based code navigation enabled
- Namespace-aware analysis supported
- Higher-order function tracking (callbacks, delegates)
- Type reflection and generics support
- Complete source file mapping (IDE integration ready)
- Cross-file dependency analysis improved</p>
<p><strong>Compliance:</strong> ~90% → ~95% Joern schema compliance</p>
<h3 id="v30-2025-11-16-phase-2-oop-support">v3.0 (2025-11-16) - Phase 2 OOP Support<a class="heading-anchor" href="#v30-2025-11-16-phase-2-oop-support" title="Link to this section">&para;</a></h3>
<p><strong>MAJOR UPDATE: Added OOP analysis support and precise source mapping</strong></p>
<p><strong>New Node Types:</strong>
- <code>nodes_field_identifier</code> (FIELD_IDENTIFIER) - Field access nodes for OOP
- <code>nodes_member</code> (MEMBER) - Class/struct field declarations</p>
<p><strong>New Edge Types:</strong>
- <code>edges_binds</code> (BINDS) - Name binding edges (import/using statements)
- <code>edges_binds_to</code> (BINDS_TO) - Reverse binding edges (name resolution)</p>
<p><strong>New Properties:</strong>
- OFFSET, OFFSET_END: Precise byte-level source mapping (added to METHOD, TYPE_DECL, IDENTIFIER, FIELD_IDENTIFIER, MEMBER)
- MODIFIER: Access modifiers array (added to METHOD, TYPE_DECL)
- CANONICAL_NAME: Normalized identifier name (added to FIELD_IDENTIFIER)</p>
<p><strong>Impact:</strong>
- OOP code analysis fully supported (field access tracking)
- Precise source code location mapping (byte-level)
- Visibility analysis enabled (PUBLIC, PRIVATE, STATIC, etc.)
- Variable/function name resolution improved
- Alias analysis enabled (canonical names)</p>
<p><strong>Compliance:</strong> ~80% → ~90% Joern schema compliance</p>
<h3 id="v20-2025-11-16-phase-1-critical-updates">v2.0 (2025-11-16) - Phase 1 Critical Updates<a class="heading-anchor" href="#v20-2025-11-16-phase-1-critical-updates" title="Link to this section">&para;</a></h3>
<p><strong>MAJOR UPDATE: Added critical components for PDG and SSA analysis</strong></p>
<p><strong>New Node Types:</strong>
- <code>nodes_param_out</code> (METHOD_PARAMETER_OUT) - Output parameters for SSA analysis
- <code>nodes_method_return</code> (METHOD_RETURN) - Formal return parameter</p>
<p><strong>New Edge Types:</strong>
- <code>edges_cdg</code> (Control Dependence Graph) - Critical for PDG!</p>
<p><strong>Impact:</strong>
- PDG now complete (DDG + CDG)
- SSA analysis now possible
- Program slicing enabled
- Security taint analysis improved</p>
<p><strong>Compliance:</strong> ~70% → ~80% Joern schema compliance</p>
<h3 id="v10-2025-11-15-initial-release">v1.0 (2025-11-15) - Initial Release<a class="heading-anchor" href="#v10-2025-11-15-initial-release" title="Link to this section">&para;</a></h3>
<ul>
<li>11 node types (METHOD, CALL, IDENTIFIER, LITERAL, LOCAL, PARAM, RETURN, BLOCK, CONTROL_STRUCTURE, TYPE_DECL, METADATA)</li>
<li>10 edge types (AST, CFG, CALL, REF, REACHING_DEF, ARGUMENT, RECEIVER, CONDITION, DOMINATE, POST_DOMINATE)</li>
</ul>
<hr />
<h2 id="extension-semantic-tag-system">Extension: Semantic Tag System<a class="heading-anchor" href="#extension-semantic-tag-system" title="Link to this section">&para;</a></h2>
<h3 id="overview_1">Overview<a class="heading-anchor" href="#overview_1" title="Link to this section">&para;</a></h3>
<p>The tag system extends the CPG with semantic annotations for methods and other code elements. Tags are custom extensions (not part of CPG spec v1.1) that enable semantic search, code classification, and intelligent analysis.</p>
<h3 id="nodes-tag">nodes_tag<a class="heading-anchor" href="#nodes-tag" title="Link to this section">&para;</a></h3>
<p>Stores tag definitions (semantic labels for code elements).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">     </span><span class="c1">-- Tag category (e.g., &#39;subsystem-name&#39;, &#39;security-risk&#39;)</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w">              </span><span class="c1">-- Tag value (e.g., &#39;executor&#39;, &#39;high&#39;)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tag_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_tag</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tag_value</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_tag</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
</code></pre></div>

<p><strong>Properties:</strong>
- NAME: Tag category identifier (unique semantic dimension)
- VALUE: Tag value within that category</p>
<h3 id="edges-tagged-by">edges_tagged_by<a class="heading-anchor" href="#edges-tagged-by" title="Link to this section">&para;</a></h3>
<p>Connects code elements to their semantic tags.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">                </span><span class="c1">-- Source node id (typically METHOD)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w">                </span><span class="c1">-- Tag node id</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tagged_by_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tagged_by_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Relationship:</strong>
- Source: Any CPG node (typically nodes_method)
- Destination: nodes_tag entry</p>
<h3 id="tag-categories">Tag Categories<a class="heading-anchor" href="#tag-categories" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
<th>Example Values</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>subsystem-name</code></td>
<td>Code organizational unit</td>
<td>&lsquo;executor&rsquo;, &lsquo;planner&rsquo;, &lsquo;parser&rsquo;, &lsquo;storage&rsquo;</td>
</tr>
<tr>
<td><code>security-risk</code></td>
<td>Security classification</td>
<td>&lsquo;critical&rsquo;, &lsquo;high&rsquo;, &lsquo;medium&rsquo;, &lsquo;low&rsquo;</td>
</tr>
<tr>
<td><code>taint-source</code></td>
<td>Untrusted data entry point</td>
<td>Boolean tagging</td>
</tr>
<tr>
<td><code>taint-sink</code></td>
<td>Security-sensitive output</td>
<td>Boolean tagging</td>
</tr>
<tr>
<td><code>perf-hotspot</code></td>
<td>Performance critical code</td>
<td>Boolean tagging</td>
</tr>
<tr>
<td><code>allocation-heavy</code></td>
<td>Memory-intensive methods</td>
<td>Boolean tagging</td>
</tr>
<tr>
<td><code>test-coverage</code></td>
<td>Has associated tests</td>
<td>Boolean tagging</td>
</tr>
<tr>
<td><code>cyclomatic-complexity</code></td>
<td>Code complexity metric</td>
<td>Numeric values (e.g., &lsquo;15&rsquo;, &lsquo;25&rsquo;)</td>
</tr>
<tr>
<td><code>function-purpose</code></td>
<td>Semantic description</td>
<td>Free-form text description</td>
</tr>
<tr>
<td><code>entry-point</code></td>
<td>System entry point</td>
<td>Boolean tagging</td>
</tr>
</tbody>
</table></div>
<h3 id="example-tag-queries">Example Tag Queries<a class="heading-anchor" href="#example-tag-queries" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Find all security-critical methods</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">m</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">src</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;security-risk&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;critical&#39;</span><span class="p">;</span>

<span class="c1">-- List all subsystems</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subsystem</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;subsystem-name&#39;</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>

<span class="c1">-- Find methods in a specific subsystem</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">line_number</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">m</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">src</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;subsystem-name&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;executor&#39;</span><span class="p">;</span>

<span class="c1">-- Get complexity hotspots</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">complexity</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">m</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">src</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;cyclomatic-complexity&#39;</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">)</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- Count tags by category</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">count</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">count</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>

<h3 id="tag-statistics">Tag Statistics<a class="heading-anchor" href="#tag-statistics" title="Link to this section">&para;</a></h3>
<p>Current database contains approximately:
- <strong>15.68M tags</strong> across <strong>98 categories</strong>
- Primary categories: subsystem-name, security-risk, function-purpose
- Tags enable semantic code search and intelligent analysis</p>
<h3 id="integration-notes">Integration Notes<a class="heading-anchor" href="#integration-notes" title="Link to this section">&para;</a></h3>
<p>Tags are enriched post-CPG generation through:
1. <strong>Static analysis</strong>: Joern tag queries (<code>cpg.method.tag.name(...)</code>)
2. <strong>LLM enrichment</strong>: AI-generated function purpose descriptions
3. <strong>Computed metrics</strong>: Cyclomatic complexity from CFG analysis
4. <strong>Manual annotation</strong>: Security audit findings</p>
<p>Tags extend the CPG without modifying the core schema, maintaining compatibility with standard CPG tools while enabling advanced semantic analysis.</p>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="index.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Previous</span>
        <span class="doc-page-nav-title">Overview</span>
      </a>

      <a href="SQL_QUERY_COOKBOOK.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Next</span>
        <span class="doc-page-nav-title">SQL Query Cookbook for DuckDB CPG</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Last updated: 2025-12-27</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/reference/SCHEMA.md" target="_blank" rel="noopener">Edit on GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">On this page</div>
      <ul class="doc-toc-list">
        <li><a href="#duckdb-cpg-schema-design-cpg-spec-v11" class="level-1">DuckDB CPG Schema Design (CPG Spec v1.1)</a></li>
<li><a href="#table-of-contents" class="level-2">Table of Contents</a></li>
<li><a href="#overview" class="level-2">Overview</a></li>
<li><a href="#core-design-principles" class="level-2">Core Design Principles</a></li>
<li><a href="#node-tables" class="level-2">Node Tables</a></li>
<li><a href="#nodes-method" class="level-3">nodes_method</a></li>
<li><a href="#nodes-call" class="level-3">nodes_call</a></li>
<li><a href="#nodes-identifier" class="level-3">nodes_identifier</a></li>
<li><a href="#nodes-field-identifier" class="level-3">nodes_field_identifier</a></li>
<li><a href="#nodes-literal" class="level-3">nodes_literal</a></li>
<li><a href="#nodes-local" class="level-3">nodes_local</a></li>
<li><a href="#nodes-param" class="level-3">nodes_param</a></li>
<li><a href="#nodes-param-out" class="level-3">nodes_param_out</a></li>
<li><a href="#nodes-method-return" class="level-3">nodes_method_return</a></li>
<li><a href="#nodes-return" class="level-3">nodes_return</a></li>
<li><a href="#nodes-block" class="level-3">nodes_block</a></li>
<li><a href="#nodes-control-structure" class="level-3">nodes_control_structure</a></li>
<li><a href="#nodes-member" class="level-3">nodes_member</a></li>
<li><a href="#nodes-type-decl" class="level-3">nodes_type_decl</a></li>
<li><a href="#nodes-metadata" class="level-3">nodes_metadata</a></li>
<li><a href="#nodes-file" class="level-3">nodes_file</a></li>
<li><a href="#nodes-namespace-block" class="level-3">nodes_namespace_block</a></li>
<li><a href="#nodes-method-ref" class="level-3">nodes_method_ref</a></li>
<li><a href="#nodes-type-ref" class="level-3">nodes_type_ref</a></li>
<li><a href="#nodes-unknown" class="level-3">nodes_unknown</a></li>
<li><a href="#python-walrus-operator-if-not-in-spec" class="level-1">Python walrus operator (if not in spec):</a></li>
<li><a href="#unknown-parser-type-namenamedexpr-coden-lenitems" class="level-1">UNKNOWN: parser_type_name="NamedExpr", code="n := len(items)"</a></li>
<li><a href="#proprietary-language-extension" class="level-1">Proprietary language extension:</a></li>
<li><a href="#unknown-parser-type-namecustomdirective" class="level-1">UNKNOWN: parser_type_name="CustomDirective"</a></li>
<li><a href="#nodes-jump-target" class="level-3">nodes_jump_target</a></li>
<li><a href="#nodes-type-parameter" class="level-3">nodes_type_parameter</a></li>
<li><a href="#nodes-type-argument" class="level-3">nodes_type_argument</a></li>
<li><a href="#nodes-binding" class="level-3">nodes_binding</a></li>
<li><a href="#nodes-closure-binding" class="level-3">nodes_closure_binding</a></li>
<li><a href="#nodes-comment" class="level-3">nodes_comment</a></li>
<li><a href="#edge-tables" class="level-2">Edge Tables</a></li>
<li><a href="#edges-ast" class="level-3">edges_ast</a></li>
<li><a href="#edges-cfg" class="level-3">edges_cfg</a></li>
<li><a href="#edges-call" class="level-3">edges_call</a></li>
<li><a href="#edges-ref" class="level-3">edges_ref</a></li>
<li><a href="#edges-reaching-def" class="level-3">edges_reaching_def</a></li>
<li><a href="#edges-argument" class="level-3">edges_argument</a></li>
<li><a href="#edges-receiver" class="level-3">edges_receiver</a></li>
<li><a href="#edges-condition" class="level-3">edges_condition</a></li>
<li><a href="#edges-dominate" class="level-3">edges_dominate</a></li>
<li><a href="#edges-post-dominate" class="level-3">edges_post_dominate</a></li>
<li><a href="#edges-cdg" class="level-3">edges_cdg</a></li>
<li><a href="#edges-binds" class="level-3">edges_binds</a></li>
<li><a href="#edges-binds-to" class="level-3">edges_binds_to</a></li>
<li><a href="#edges-source-file" class="level-3">edges_source_file</a></li>
<li><a href="#edges-alias-of" class="level-3">edges_alias_of</a></li>
<li><a href="#edges-inherits-from" class="level-3">edges_inherits_from</a></li>
<li><a href="#edges-capture" class="level-3">edges_capture</a></li>
<li><a href="#edges-captured-by" class="level-3">edges_captured_by</a></li>
<li><a href="#local-count-captured-by-closure-binding" class="level-1">LOCAL "count" --CAPTURED_BY--> CLOSURE_BINDING</a></li>
<li><a href="#property-graph-definition" class="level-2">Property Graph Definition</a></li>
<li><a href="#step-1-create-materialized-unified-nodes-table" class="level-3">Step 1: Create Materialized Unified Nodes Table</a></li>
<li><a href="#step-2-create-comprehensive-property-graph" class="level-3">Step 2: Create Comprehensive Property Graph</a></li>
<li><a href="#example-queries" class="level-2">Example Queries</a></li>
<li><a href="#standard-sql-query-find-all-calls-to-a-specific-method" class="level-3">Standard SQL Query: Find all calls to a specific method</a></li>
<li><a href="#duckdb-pgq-query-find-direct-call-chains-caller-callee" class="level-3">DuckDB PGQ Query: Find direct call chains (caller -> callee)</a></li>
<li><a href="#duckdb-pgq-query-find-methods-and-their-ast-children" class="level-3">DuckDB PGQ Query: Find methods and their AST children</a></li>
<li><a href="#duckdb-pgq-query-data-flow-paths-using-reaching-def" class="level-3">DuckDB PGQ Query: Data flow paths using REACHING_DEF</a></li>
<li><a href="#duckdb-pgq-query-cfg-paths-control-flow" class="level-3">DuckDB PGQ Query: CFG paths (control flow)</a></li>
<li><a href="#duckdb-pgq-query-find-all-identifiers-and-their-references" class="level-3">DuckDB PGQ Query: Find all identifiers and their references</a></li>
<li><a href="#duckdb-pgq-query-type-hierarchy-inheritance" class="level-3">DuckDB PGQ Query: Type hierarchy (inheritance)</a></li>
<li><a href="#combined-query-methods-with-most-incoming-calls" class="level-3">Combined Query: Methods with most incoming calls</a></li>
<li><a href="#migration-from-joern" class="level-2">Migration from Joern</a></li>
<li><a href="#phase-1-critical-completed" class="level-3">Phase 1 (CRITICAL) - COMPLETED ✓</a></li>
<li><a href="#phase-2-oop-support-completed" class="level-3">Phase 2 (OOP SUPPORT) - COMPLETED ✓</a></li>
<li><a href="#phase-3-namespace-and-file-support-completed" class="level-3">Phase 3 (NAMESPACE AND FILE SUPPORT) - COMPLETED ✓</a></li>
<li><a href="#phase-4-remaining-features-completed" class="level-3">Phase 4 (REMAINING FEATURES) - COMPLETED ✓</a></li>
<li><a href="#performance-considerations" class="level-2">Performance Considerations</a></li>
<li><a href="#schema-version" class="level-2">Schema Version</a></li>
<li><a href="#changelog" class="level-2">Changelog</a></li>
<li><a href="#v50-2025-11-16-phase-4-complete-compliance" class="level-3">v5.0 (2025-11-16) - Phase 4 Complete Compliance</a></li>
<li><a href="#v40-2025-11-16-phase-3-namespace-and-file-support" class="level-3">v4.0 (2025-11-16) - Phase 3 Namespace and File Support</a></li>
<li><a href="#v30-2025-11-16-phase-2-oop-support" class="level-3">v3.0 (2025-11-16) - Phase 2 OOP Support</a></li>
<li><a href="#v20-2025-11-16-phase-1-critical-updates" class="level-3">v2.0 (2025-11-16) - Phase 1 Critical Updates</a></li>
<li><a href="#v10-2025-11-15-initial-release" class="level-3">v1.0 (2025-11-15) - Initial Release</a></li>
<li><a href="#extension-semantic-tag-system" class="level-2">Extension: Semantic Tag System</a></li>
<li><a href="#overview" class="level-3">Overview</a></li>
<li><a href="#nodes-tag" class="level-3">nodes_tag</a></li>
<li><a href="#edges-tagged-by" class="level-3">edges_tagged_by</a></li>
<li><a href="#tag-categories" class="level-3">Tag Categories</a></li>
<li><a href="#example-tag-queries" class="level-3">Example Tag Queries</a></li>
<li><a href="#tag-statistics" class="level-3">Tag Statistics</a></li>
<li><a href="#integration-notes" class="level-3">Integration Notes</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI copilot for source code analysis</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Product</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Features</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Integrations</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Documentation</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Getting Started</a></li>
              <li><a href="../guides/index.html" class="footer-link">Guides</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Resources</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Contacts</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
