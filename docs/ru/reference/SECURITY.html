<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: Модуль корпоративной безопасности">
  <meta name="keywords" content="CodeGraph, documentation, reference">

  <meta property="og:title" content="Модуль корпоративной безопасности - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: Модуль корпоративной безопасности">
  <meta property="og:type" content="article">

  <title>Модуль корпоративной безопасности - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="nav-link active">Документация</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/reference/SECURITY.html" class="">EN</a>
          <a href="../../ru/reference/SECURITY.html" class="active">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Переключить тему">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Запросить демо</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Документация</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Запросить демо</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Начало работы</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Обзор</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Руководство по настройке</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Руководство по установке</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Руководства</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../guides/index.html">Обзор</a></li>
        <li><a href="../guides/BENCHMARK_GUIDE.html">Руководство по тестовой платформе</a></li>
        <li><a href="../guides/CLI_GUIDE.html">Руководство по CLI</a></li>
        <li><a href="../guides/CODE_REVIEW.html">Автоматический код-ревью</a></li>
        <li><a href="../guides/CPG_EXPORT.html">Руководство по экспорту CPG</a></li>
        <li><a href="../guides/MONITORING.html">Руководство по мониторингу</a></li>
        <li><a href="../guides/PROGRAMMATIC_GUIDE.html">Руководство пользователя</a></li>
        <li><a href="../guides/PROJECT_IMPORT.html">Импорт новой кодовой базы</a></li>
        <li><a href="../guides/QUICK_REFERENCE.html">Краткое руководство по CodeGraph</a></li>
        <li><a href="../guides/REFACTORING.html">Руководство по анализу рефакторинга</a></li>
        <li><a href="../guides/SCENARIOS.html">Руководство по сценариям рабочих процессов</a></li>
        <li><a href="../guides/TROUBLESHOOTING.html">Руководство по устранению неполадок</a></li>
        <li><a href="../guides/TUI_USER_GUIDE.html">Руководство пользователя CodeGraph</a></li>
        <li><a href="../guides/01-onboarding.html">Сценарий 01: Ввод нового разработчика</a></li>
        <li><a href="../guides/02-security-audit.html">Сценарий 02: Аудит безопасности</a></li>
        <li><a href="../guides/03-documentation.html">Сценарий 03: Генерация документации</a></li>
        <li><a href="../guides/04-feature-development.html">Сценарий 04: Разработка функций</a></li>
        <li><a href="../guides/05-refactoring.html">Сценарий 05: Рефакторинг</a></li>
        <li><a href="../guides/06-performance.html">Сценарий 06: Анализ производительности</a></li>
        <li><a href="../guides/07-test-coverage.html">Сценарий 07: Покрытие тестами</a></li>
        <li><a href="../guides/08-compliance.html">Сценарий 08: Проверка соответствия требованиям</a></li>
        <li><a href="../guides/09-code-review.html">Сценарий 09: Код-ревью</a></li>
        <li><a href="../guides/10-cross-repo.html">Сценарий 10: Анализ между репозиториями</a></li>
        <li><a href="../guides/11-architecture.html">Сценарий 11: Анализ архитектуры</a></li>
        <li><a href="../guides/12-tech-debt.html">Сценарий 12: Оценка технического долга</a></li>
        <li><a href="../guides/13-mass-refactoring.html">Сценарий 13: Массовая рефакторизация</a></li>
        <li><a href="../guides/14-incident-response.html">Сценарий 14: Реагирование на инциденты безопасности</a></li>
        <li><a href="../guides/15-debugging.html">Сценарий 15: Помощь в отладке</a></li>
        <li><a href="../guides/16-entry-points.html">Сценарий 16: Обнаружение точки входа</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Документация</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Обзор</a></li>
        <li><a href="../api/ACP_INTEGRATION.html">Интеграция Agent Client Protocol (ACP)</a></li>
        <li><a href="../api/REST_API.html">Документация по REST API CodeGraph</a></li>
        <li><a href="../api/WEBSOCKET_API.html">Справочная документация по WebSocket API</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Интеграции</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Обзор</a></li>
        <li><a href="../integrations/GIGACHAT.html">Руководство по интеграции GigaChat</a></li>
        <li><a href="../integrations/YANDEX_AI_STUDIO.html">Руководство по интеграции Yandex AI Studio</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Справочник</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Обзор</a></li>
        <li><a href="AGENTS.html">Справочник агентов</a></li>
        <li><a href="ANALYSIS_MODULES.html">Справочник модулей анализа</a></li>
        <li><a href="API.html">Справочник API</a></li>
        <li><a href="HYPOTHESIS_SYSTEM.html">Справочная система гипотез</a></li>
        <li><a href="SCHEMA.html">Дизайн схемы DuckDB CPG (CPG Spec v1.1)</a></li>
        <li><a href="SECURITY.html" class="active">Модуль корпоративной безопасности</a></li>
        <li><a href="SQL_QUERY_COOKBOOK.html">Кулинарная книга SQL-запросов для DuckDB CPG</a></li>
        <li><a href="WORKFLOWS.html">Справочник по рабочим процессам</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Обзор</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Документация</a>
        <span>/</span>
        <a href="index.html">Справочник</a>
        <span>/</span>
        <span>Модуль корпоративной безопасности</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>Модуль корпоративной безопасности</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="modul-korporativnoy-bezopasnosti">Модуль корпоративной безопасности<a class="heading-anchor" href="#modul-korporativnoy-bezopasnosti" title="Link to this section">&para;</a></h1>
<h2 id="soderzhanie">Содержание<a class="heading-anchor" href="#soderzhanie" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="#overview">Обзор</a></li>
<li><a href="#features">Возможности</a></li>
<li><a href="#1-llm-requestresponse-logging">1. Логирование запросов/ответов LLM</a></li>
<li><a href="#2-siem-integration">2. Интеграция с SIEM</a></li>
<li><a href="#3-dlp-data-loss-prevention">3. DLP (предотвращение утечки данных)</a></li>
<li><a href="#4-hashicorp-vault-integration">4. Интеграция с HashiCorp Vault</a></li>
<li><a href="#architecture">Архитектура</a></li>
<li><a href="#configuration">Конфигурация</a></li>
<li><a href="#enable-security-module">Включение модуля безопасности</a></li>
<li><a href="#full-configuration-configyaml">Полная конфигурация (config.yaml)</a></li>
<li><a href="#environment-variables">Переменные окружения</a></li>
<li><a href="#usage-examples">Примеры использования</a></li>
<li><a href="#basic-usage-automatic">Базовое использование (автоматическое)</a></li>
<li><a href="#manual-security-wrapper">Ручная обертка безопасности</a></li>
<li><a href="#dlp-scanning-only">Только сканирование DLP</a></li>
<li><a href="#siem-event-dispatch">Отправка событий в SIEM</a></li>
<li><a href="#dlp-patterns">Шаблоны DLP</a></li>
<li><a href="#built-in-patterns">Встроенные шаблоны</a></li>
<li><a href="#custom-patterns">Пользовательские шаблоны</a></li>
<li><a href="#database-tables">Таблицы базы данных</a></li>
<li><a href="#llm_audit_log">llm_audit_log</a></li>
<li><a href="#dlp_events">dlp_events</a></li>
<li><a href="#siem-event-formats">Форматы событий SIEM</a></li>
<li><a href="#syslog-rfc-5424">SysLog (RFC 5424)</a></li>
<li><a href="#cef">CEF</a></li>
<li><a href="#leef">LEEF</a></li>
<li><a href="#webhook-integration">Интеграция через вебхуки</a></li>
<li><a href="#security-best-practices">Рекомендации по безопасности</a></li>
<li><a href="#compliance">Соответствие требованиям</a></li>
<li><a href="#advanced-security-features">Расширенные функции безопасности</a></li>
<li><a href="#5-file-based-security-scanner">5. Сканер безопасности на основе файлов</a></li>
<li><a href="#6-taint-verified-scanner">6. Сканер с проверкой заражения (taint-verified)</a></li>
<li><a href="#7-mitre-d3fend-hardening-checks">7. Проверки укрепления безопасности по MITRE D3FEND</a></li>
<li><a href="#8-sast-comparison">8. Сравнение с SAST</a></li>
<li><a href="#9-security-report-generator">9. Генератор отчетов по безопасности</a></li>
<li><a href="#10-cpg-context-resolver">10. Решатель контекста CPG</a></li>
<li><a href="#security-module-structure">Структура модуля безопасности</a></li>
<li><a href="#quick-start-guide">Краткое руководство</a></li>
<li><a href="#1-enable-security-features">1. Включение функций безопасности</a></li>
<li><a href="#2-run-security-audit">2. Запуск аудита безопасности</a></li>
<li><a href="#3-review-reports">3. Просмотр отчетов</a></li>
<li><a href="#4-integrate-with-cicd">4. Интеграция с CI/CD</a></li>
<li><a href="#see-also">См. также</a></li>
</ul>
<h2 id="overview">Обзор<a class="heading-anchor" href="#overview" title="Link to this section">&para;</a></h2>
<p>CodeGraph включает модуль безопасности корпоративного уровня для защиты конфиденциальных данных при использовании внешних поставщиков LLM (GigaChat, Yandex AI, OpenAI). Этот модуль обеспечивает соответствие требованиям защиты данных и предоставляет расширенные возможности аудита.</p>
<h2 id="features">Возможности<a class="heading-anchor" href="#features" title="Link to this section">&para;</a></h2>
<h3 id="1-zhurnalirovanie-zaprosov-i-otvetov-llm">1. Журналирование запросов и ответов LLM<a class="heading-anchor" href="#1-zhurnalirovanie-zaprosov-i-otvetov-llm" title="Link to this section">&para;</a></h3>
<ul>
<li>Полная аудиторская запись всех взаимодействий с LLM</li>
<li>Настройка маскирования промптов перед записью в лог</li>
<li>Метрики использования токенов и задержки</li>
<li>Хранение в базе данных с политиками хранения</li>
</ul>
<h3 id="2-siem-integration">2. Интеграция с SIEM<a class="heading-anchor" href="#2-siem-integration" title="Link to this section">&para;</a></h3>
<p>Потоковая передача логов в корпоративные системы SIEM в реальном времени:
- <strong>SysLog (RFC 5424)</strong> — Стандартный syslog со структурированными данными
- <strong>CEF (Common Event Format)</strong> — Для интеграции с ArcSight
- <strong>LEEF (Log Event Extended Format)</strong> — Для интеграции с IBM QRadar</p>
<h3 id="3-dlp-data-loss-prevention">3. DLP (предотвращение утечки данных)<a class="heading-anchor" href="#3-dlp-data-loss-prevention" title="Link to this section">&para;</a></h3>
<p>Сканирование по шаблонам для предотвращения утечек данных:
- <strong>Обнаружение учётных данных</strong> — Ключи API, пароли, приватные ключи
- <strong>Обнаружение персональных данных (PII)</strong> — Электронная почта, телефоны, номера кредитных карт, ИНН/СНИЛС
- <strong>Пути к исходному коду</strong> — Внутренние пути, строки подключения
- <strong>Пользовательские ключевые слова</strong> — Чёрные списки, специфичные для организации</p>
<p>Настройка действий для каждой категории:
- <code>BLOCK</code> — Полностью отклонить запрос
- <code>MASK</code> — Заменить конфиденциальные данные на <code>[REDACTED]</code>
- <code>WARN</code> — Зарегистрировать предупреждение, но разрешить запрос
- <code>LOG_ONLY</code> — Записать в лог только для аудита</p>
<h3 id="4-hashicorp-vault-integration">4. Интеграция с HashiCorp Vault<a class="heading-anchor" href="#4-hashicorp-vault-integration" title="Link to this section">&para;</a></h3>
<p>Безопасное управление секретами:
- Динамическое получение учётных данных
- Поддержка нескольких методов аутентификации (Token, AppRole, Kubernetes)
- Автоматическая ротация секретов
- Кэширование с ограничением времени жизни (TTL)</p>
<h2 id="architecture">Архитектура<a class="heading-anchor" href="#architecture" title="Link to this section">&para;</a></h2>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                        Пользовательский запрос                   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     SecureLLMProvider                            │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐  │
│  │  Сканер DLP  │  │ Фильтр      │  │  Журнал запросов к   │  │
│  │  (до/после)  │  │ контента     │  │  LLM (БД + SIEM)     │  │
│  └──────────────┘  └──────────────┘  └──────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
         │                    │                    │
         ▼                    ▼                    ▼
┌──────────────┐     ┌──────────────┐     ┌──────────────────────┐
│  Действия DLP│     │ BaseLLMProv. │     │   Отправка в SIEM    │
│  BLOCK/MASK  │     │ (GigaChat)   │     │  ┌────┐┌────┐┌────┐ │
│  /WARN/LOG   │     │              │     │  │Sys ││CEF ││LEEF│ │
└──────────────┘     └──────────────┘     │  │Log ││    ││    │ │
         │                                 │  └────┘└────┘└────┘ │
         ▼                                 └──────────────────────┘
┌──────────────┐                                    │
│ Вебхук DLP   │                                    ▼
│ (внешний)    │                           ┌──────────────┐
└──────────────┘                           │    SIEM      │
                                           │  (Splunk/    │
┌──────────────┐                           │   QRadar)    │
│ HashiCorp    │◄── Ротация секретов       └──────────────┘
│ Vault        │
└──────────────┘
</code></pre></div>

<h2 id="configuration">Конфигурация<a class="heading-anchor" href="#configuration" title="Link to this section">&para;</a></h2>
<h3 id="enable-security-module">Включение модуля безопасности<a class="heading-anchor" href="#enable-security-module" title="Link to this section">&para;</a></h3>
<p>Установите переменные окружения или обновите файл <code>config.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">SECURITY_ENABLED</span><span class="o">=</span><span class="bp">true</span>
<span class="k">export</span><span class="w"> </span><span class="n">SIEM_ENABLED</span><span class="o">=</span><span class="bp">true</span>
<span class="k">export</span><span class="w"> </span><span class="n">DLP_ENABLED</span><span class="o">=</span><span class="bp">true</span>
</code></pre></div>

<h3 id="full-configuration-configyaml">Полная конфигурация (config.yaml)<a class="heading-anchor" href="#full-configuration-configyaml" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>security:
  # Главный переключатель
  enabled: true

  # Логирование LLM
  llm_logging:
    enabled: true
    log_prompts: true
    redact_prompts: true
    max_prompt_length: 2000
    log_responses: true
    log_token_usage: true
    log_latency: true
    log_to_database: true

  # SIEM
  siem:
    enabled: true
    syslog:
      enabled: true
      protocol: &quot;tls&quot;  # udp, tcp, tls
      host: &quot;siem.company.com&quot;
      port: 6514
      facility: 16  # local0
      app_name: &quot;codegraph&quot;
    cef:
      enabled: true
      host: &quot;arcsight.company.com&quot;
      port: 514
    leef:
      enabled: false

  # DLP
  dlp:
    enabled: true
    pre_request:
      enabled: true
      default_action: &quot;WARN&quot;
    post_response:
      enabled: true
      default_action: &quot;MASK&quot;
    categories:
      credentials:
        enabled: true
        action: &quot;BLOCK&quot;
        severity: &quot;critical&quot;
      pii:
        enabled: true
        action: &quot;MASK&quot;
        severity: &quot;high&quot;
    webhook:
      enabled: true
      endpoint: &quot;https://dlp.company.com/api/alerts&quot;
      notify_on: [&quot;BLOCK&quot;, &quot;WARN&quot;]

  # Vault
  vault:
    enabled: true
    url: &quot;https://vault.company.com:8200&quot;
    auth_method: &quot;approle&quot;
    secrets_mount_point: &quot;secret&quot;
    llm_secrets_path: &quot;codegraph/llm&quot;
</code></pre></div>

<h3 id="peremennye-okruzheniya">Переменные окружения<a class="heading-anchor" href="#peremennye-okruzheniya" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Переменная</th>
<th>Описание</th>
<th>По умолчанию</th>
</tr>
</thead>
<tbody>
<tr>
<td>SECURITY_ENABLED</td>
<td>Включить модуль безопасности</td>
<td>false</td>
</tr>
<tr>
<td>SIEM_ENABLED</td>
<td>Включить интеграцию с SIEM</td>
<td>false</td>
</tr>
<tr>
<td>SIEM_SYSLOG_HOST</td>
<td>Хост сервера SysLog</td>
<td>localhost</td>
</tr>
<tr>
<td>SIEM_SYSLOG_PORT</td>
<td>Порт сервера SysLog</td>
<td>514</td>
</tr>
<tr>
<td>SIEM_CEF_HOST</td>
<td>Хост сервера CEF</td>
<td>localhost</td>
</tr>
<tr>
<td>SIEM_LEEF_HOST</td>
<td>Хост сервера LEEF</td>
<td>localhost</td>
</tr>
<tr>
<td>DLP_ENABLED</td>
<td>Включить сканирование DLP</td>
<td>true</td>
</tr>
<tr>
<td>DLP_WEBHOOK_URL</td>
<td>Конечная точка вебхука DLP</td>
<td>—</td>
</tr>
<tr>
<td>DLP_WEBHOOK_AUTH</td>
<td>Заголовок авторизации вебхука DLP</td>
<td>—</td>
</tr>
<tr>
<td>VAULT_ENABLED</td>
<td>Включить интеграцию с Vault</td>
<td>false</td>
</tr>
<tr>
<td>VAULT_ADDR</td>
<td>URL сервера Vault</td>
<td>http://localhost:8200</td>
</tr>
<tr>
<td>VAULT_TOKEN</td>
<td>Токен Vault</td>
<td>—</td>
</tr>
<tr>
<td>VAULT_ROLE_ID</td>
<td>Идентификатор роли AppRole</td>
<td>—</td>
</tr>
<tr>
<td>VAULT_SECRET_ID</td>
<td>Секретный идентификатор AppRole</td>
<td>—</td>
</tr>
</tbody>
</table></div>
<h2 id="usage-examples">Примеры использования<a class="heading-anchor" href="#usage-examples" title="Link to this section">&para;</a></h2>
<h3 id="basic-usage-automatic">Базовое использование (автоматическое)<a class="heading-anchor" href="#basic-usage-automatic" title="Link to this section">&para;</a></h3>
<p>Безопасность обеспечивается автоматически при включении:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.llm</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_llm_provider</span>

<span class="c1"># Поставщик автоматически оборачивается в защитный слой {#provider-is-automatically-wrapped-with-security-layer}</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">create_llm_provider</span><span class="p">()</span>

<span class="c1"># Теперь все запросы фильтруются и записываются в лог {#all-requests-are-now-filtered-and-logged}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">system_prompt</span><span class="o">=</span><span class="s2">&quot;Вы — аналитик кода&quot;</span><span class="p">,</span>
    <span class="n">user_prompt</span><span class="o">=</span><span class="s2">&quot;Проанализируйте эту функцию&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="manual-security-wrapper">Ручная обертка безопасности<a class="heading-anchor" href="#manual-security-wrapper" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.llm</span><span class="w"> </span><span class="kn">import</span> <span class="n">GigaChatProvider</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.security</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_security_config</span><span class="p">,</span> <span class="n">SecureLLMProvider</span>

<span class="c1"># Создание базового поставщика {#create-base-provider}</span>
<span class="n">base_provider</span> <span class="o">=</span> <span class="n">GigaChatProvider</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Оборачивание в защитный слой {#wrap-with-security}</span>
<span class="n">secure_provider</span> <span class="o">=</span> <span class="n">SecureLLMProvider</span><span class="p">(</span>
    <span class="n">wrapped_provider</span><span class="o">=</span><span class="n">base_provider</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">get_security_config</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># Использование защищённого поставщика {#use-secure-provider}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">secure_provider</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">system_prompt</span><span class="o">=</span><span class="s2">&quot;Проанализируй код&quot;</span><span class="p">,</span>
    <span class="n">user_prompt</span><span class="o">=</span><span class="s2">&quot;def process_payment(card_number=&#39;4111111111111111&#39;)...&quot;</span><span class="p">,</span>
    <span class="n">_user_id</span><span class="o">=</span><span class="s2">&quot;user-123&quot;</span><span class="p">,</span>  <span class="c1"># Опционально: контекст пользователя</span>
    <span class="n">_ip_address</span><span class="o">=</span><span class="s2">&quot;192.168.1.100&quot;</span><span class="p">,</span>  <span class="c1"># Опционально: IP для аудита</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="dlp-scanning-only">Только сканирование DLP<a class="heading-anchor" href="#dlp-scanning-only" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.dlp</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContentScanner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.security.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_security_config</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">get_security_config</span><span class="p">()</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">ContentScanner</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dlp</span><span class="p">)</span>

<span class="c1"># Сканирование содержимого {#scan-content}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan_request</span><span class="p">(</span><span class="s2">&quot;API_KEY=sk-1234567890abcdef&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">blocked</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Контент заблокирован! Совпадения: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">matches</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">result</span><span class="o">.</span><span class="n">has_matches</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Обнаружены конфиденциальные данные: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">matches</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Использовать замаскированный контент</span>
    <span class="n">safe_content</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">modified_content</span>
</code></pre></div>

<h3 id="siem-event-dispatch">Отправка событий в SIEM<a class="heading-anchor" href="#siem-event-dispatch" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.siem</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">SecurityEvent</span><span class="p">,</span> <span class="n">SecurityEventType</span><span class="p">,</span>
    <span class="n">init_siem_dispatcher</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.security.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_security_config</span>

<span class="c1"># Инициализация диспетчера {#initialize-dispatcher}</span>
<span class="n">dispatcher</span> <span class="o">=</span> <span class="n">init_siem_dispatcher</span><span class="p">(</span><span class="n">get_security_config</span><span class="p">()</span><span class="o">.</span><span class="n">siem</span><span class="p">)</span>

<span class="c1"># Создание и отправка события {#create-and-dispatch-event}</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">SecurityEvent</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">event_type</span><span class="o">=</span><span class="n">SecurityEventType</span><span class="o">.</span><span class="n">DLP_BLOCK</span><span class="p">,</span>
    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Учётные данные обнаружены в запросе LLM&quot;</span><span class="p">,</span>
    <span class="n">severity</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># Ошибка</span>
    <span class="n">user_id</span><span class="o">=</span><span class="s2">&quot;user-123&quot;</span><span class="p">,</span>
    <span class="n">request_id</span><span class="o">=</span><span class="s2">&quot;req-456&quot;</span><span class="p">,</span>
    <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;aws_key&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;credentials&quot;</span><span class="p">}</span>
<span class="p">)</span>

<span class="n">dispatcher</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div>

<h2 id="dlp-patterns">Шаблоны DLP<a class="heading-anchor" href="#dlp-patterns" title="Link to this section">&para;</a></h2>
<h3 id="built-in-patterns">Встроенные шаблоны<a class="heading-anchor" href="#built-in-patterns" title="Link to this section">&para;</a></h3>
<h4 id="uchyotnye-dannye">Учётные данные<a class="heading-anchor" href="#uchyotnye-dannye" title="Link to this section">&para;</a></h4>
<ul>
<li><code>api_key</code> - Общие ключи API</li>
<li><code>aws_key</code> - Идентификаторы ключей доступа AWS (AKIA…)</li>
<li><code>aws_secret</code> - Секретные ключи AWS</li>
<li><code>private_key</code> - Закрытые ключи в формате PEM</li>
<li><code>password</code> - Шаблоны паролей</li>
<li><code>jwt_token</code> - JSON Web Token (JWT)</li>
<li><code>bearer_token</code> - Токены аутентификации Bearer</li>
<li><code>basic_auth</code> - Base64 строки аутентификации Basic</li>
</ul>
<h4 id="personalnye-dannye-russkaya-lokal">Персональные данные (русская локаль)<a class="heading-anchor" href="#personalnye-dannye-russkaya-lokal" title="Link to this section">&para;</a></h4>
<ul>
<li><code>email</code> - Адреса электронной почты</li>
<li><code>phone_ru</code> - Российские номера телефонов</li>
<li><code>credit_card</code> - Номера кредитных карт</li>
<li><code>inn</code> - Российский ИНН</li>
<li><code>snils</code> - Российский СНИЛС</li>
<li><code>passport_ru</code> - Номера российских паспортов</li>
</ul>
<h4 id="ishodnyy-kod">Исходный код<a class="heading-anchor" href="#ishodnyy-kod" title="Link to this section">&para;</a></h4>
<ul>
<li><code>connection_string</code> - Строки подключения к базам данных</li>
<li><code>internal_path</code> - Внутренние пути к файлам</li>
<li><code>ip_address</code> - IP-адреса</li>
</ul>
<h3 id="custom-patterns">Пользовательские шаблоны<a class="heading-anchor" href="#custom-patterns" title="Link to this section">&para;</a></h3>
<p>Добавьте пользовательские шаблоны через конфигурацию:</p>
<div class="highlight"><pre><span></span><code><span class="n">dlp</span><span class="o">:</span>
<span class="w">  </span><span class="n">categories</span><span class="o">:</span>
<span class="w">    </span><span class="n">custom</span><span class="o">:</span>
<span class="w">      </span><span class="n">enabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">      </span><span class="n">action</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;WARN&quot;</span>
<span class="w">      </span><span class="n">severity</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span>
<span class="w">      </span><span class="n">patterns</span><span class="o">:</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;project_code&quot;</span>
<span class="w">          </span><span class="n">regex</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;PROJECT-[A-Z]{2,4}-\d{4,6}&quot;</span>
<span class="w">          </span><span class="n">mask_with</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;[PROJECT-ID]&quot;</span>
</code></pre></div>

<h2 id="database-tables">Таблицы базы данных<a class="heading-anchor" href="#database-tables" title="Link to this section">&para;</a></h2>
<h3 id="llm-audit-log">llm_audit_log<a class="heading-anchor" href="#llm-audit-log" title="Link to this section">&para;</a></h3>
<p>Содержит все взаимодействия с LLM:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Столбец</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>request_id</td>
<td>UUID</td>
<td>Уникальный идентификатор запроса</td>
</tr>
<tr>
<td>user_id</td>
<td>UUID</td>
<td>Пользователь, отправивший запрос</td>
</tr>
<tr>
<td>provider</td>
<td>VARCHAR</td>
<td>Название провайдера LLM</td>
</tr>
<tr>
<td>model</td>
<td>VARCHAR</td>
<td>Название модели</td>
</tr>
<tr>
<td>system_prompt_hash</td>
<td>VARCHAR</td>
<td>SHA256 системного промпта</td>
</tr>
<tr>
<td>user_prompt_preview</td>
<td>TEXT</td>
<td>Предварительный просмотр промпта (с отредактированными данными)</td>
</tr>
<tr>
<td>response_preview</td>
<td>TEXT</td>
<td>Предварительный просмотр ответа</td>
</tr>
<tr>
<td>prompt_tokens</td>
<td>INT</td>
<td>Количество токенов в промпте</td>
</tr>
<tr>
<td>completion_tokens</td>
<td>INT</td>
<td>Количество токенов в ответе</td>
</tr>
<tr>
<td>latency_ms</td>
<td>FLOAT</td>
<td>Задержка запроса (в миллисекундах)</td>
</tr>
<tr>
<td>dlp_action</td>
<td>VARCHAR</td>
<td>Применённое действие DLP</td>
</tr>
<tr>
<td>dlp_categories</td>
<td>ARRAY</td>
<td>Категории DLP, совпавшие с запросом</td>
</tr>
<tr>
<td>timestamp</td>
<td>TIMESTAMP</td>
<td>Время запроса</td>
</tr>
</tbody>
</table></div>
<h3 id="dlp-events">dlp_events<a class="heading-anchor" href="#dlp-events" title="Link to this section">&para;</a></h3>
<p>Детальные события срабатывания DLP:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Столбец</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>request_id</td>
<td>UUID</td>
<td>Идентификатор запроса</td>
</tr>
<tr>
<td>action</td>
<td>VARCHAR</td>
<td>Принятое действие</td>
</tr>
<tr>
<td>category</td>
<td>VARCHAR</td>
<td>Категория DLP</td>
</tr>
<tr>
<td>pattern_name</td>
<td>VARCHAR</td>
<td>Имя совпавшего шаблона</td>
</tr>
<tr>
<td>severity</td>
<td>VARCHAR</td>
<td>Уровень серьёзности совпадения</td>
</tr>
<tr>
<td>timestamp</td>
<td>TIMESTAMP</td>
<td>Время события</td>
</tr>
</tbody>
</table></div>
<h2 id="siem-event-formats">Форматы событий SIEM<a class="heading-anchor" href="#siem-event-formats" title="Link to this section">&para;</a></h2>
<h3 id="syslog-rfc-5424">SysLog (RFC 5424)<a class="heading-anchor" href="#syslog-rfc-5424" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="mi">134</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="mi">2024-12-09</span><span class="n">T10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mf">00.000</span><span class="n">Z</span><span class="w"> </span><span class="n">codegraph</span><span class="p">.</span><span class="n">company</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">codegraph</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">llm</span><span class="p">.</span><span class="n">dlp</span><span class="p">.</span><span class="n">block</span><span class="w"> </span><span class="p">[</span><span class="n">llm</span><span class="mi">@12345</span><span class="w"> </span><span class="n">requestId</span><span class="o">=</span><span class="s">&quot;req-123&quot;</span><span class="w"> </span><span class="n">userId</span><span class="o">=</span><span class="s">&quot;user-456&quot;</span><span class="w"> </span><span class="n">provider</span><span class="o">=</span><span class="s">&quot;GigaChat&quot;</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="s">&quot;BLOCK&quot;</span><span class="w"> </span><span class="n">category</span><span class="o">=</span><span class="s">&quot;credentials&quot;</span><span class="p">]</span><span class="w"> </span><span class="n">DLP</span><span class="w"> </span><span class="n">BLOCK</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">patterns</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">request</span>
</code></pre></div>

<h3 id="cef">CEF<a class="heading-anchor" href="#cef" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">CEF</span><span class="o">:</span><span class="mi">0</span><span class="o">|</span><span class="n">CodeGraph</span><span class="o">|</span><span class="n">CodeAnalysis</span><span class="o">|</span><span class="mf">1.0</span><span class="o">|</span><span class="n">llm</span><span class="o">.</span><span class="na">dlp</span><span class="o">.</span><span class="na">block</span><span class="o">|</span><span class="n">DLP</span><span class="w"> </span><span class="n">Block</span><span class="o">|</span><span class="mi">7</span><span class="o">|</span><span class="n">rt</span><span class="o">=</span><span class="n">Dec</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="mi">2024</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">00</span><span class="w"> </span><span class="n">src</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.100</span><span class="w"> </span><span class="n">suser</span><span class="o">=</span><span class="n">user</span><span class="o">-</span><span class="mi">456</span><span class="w"> </span><span class="n">cs1</span><span class="o">=</span><span class="n">req</span><span class="o">-</span><span class="mi">123</span><span class="w"> </span><span class="n">cs1Label</span><span class="o">=</span><span class="n">RequestID</span><span class="w"> </span><span class="n">cs2</span><span class="o">=</span><span class="n">GigaChat</span><span class="w"> </span><span class="n">cs2Label</span><span class="o">=</span><span class="n">Provider</span><span class="w"> </span><span class="n">act</span><span class="o">=</span><span class="n">BLOCK</span><span class="w"> </span><span class="n">cat</span><span class="o">=</span><span class="n">credentials</span>
</code></pre></div>

<h3 id="leef">LEEF<a class="heading-anchor" href="#leef" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">LEEF</span><span class="o">:</span><span class="mf">2.0</span><span class="o">|</span><span class="n">CodeGraph</span><span class="o">|</span><span class="n">CodeAnalysis</span><span class="o">|</span><span class="mf">1.0</span><span class="o">|</span><span class="n">llm</span><span class="o">.</span><span class="na">dlp</span><span class="o">.</span><span class="na">block</span><span class="o">|</span><span class="w">  </span><span class="n">devTime</span><span class="o">=</span><span class="n">Dec</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="mi">2024</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">00</span><span class="w">    </span><span class="n">src</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.100</span><span class="w">   </span><span class="n">usrName</span><span class="o">=</span><span class="n">user</span><span class="o">-</span><span class="mi">456</span><span class="w">    </span><span class="n">requestId</span><span class="o">=</span><span class="n">req</span><span class="o">-</span><span class="mi">123</span><span class="w">   </span><span class="n">provider</span><span class="o">=</span><span class="n">GigaChat</span><span class="w">   </span><span class="n">action</span><span class="o">=</span><span class="n">BLOCK</span><span class="w">    </span><span class="n">category</span><span class="o">=</span><span class="n">credentials</span>
</code></pre></div>

<h2 id="webhook-integration">Интеграция через вебхук<a class="heading-anchor" href="#webhook-integration" title="Link to this section">&para;</a></h2>
<p>Формат полезной нагрузки вебхука DLP:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="s">&quot;alert_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;a1b2c3d4e5f6&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2024-12-09T10:30:00.000Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;BLOCK&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;match_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;categories&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;credentials&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="s">&quot;patterns&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;api_key&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;aws_key&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="s">&quot;request_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;req-123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;user-456&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;ip_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.100&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;critical&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="security-best-practices">Рекомендации по обеспечению безопасности<a class="heading-anchor" href="#security-best-practices" title="Link to this section">&para;</a></h2>
<ol>
<li><strong>Включите TLS</strong> для подключений SIEM в рабочей среде</li>
<li><strong>Используйте AppRole</strong> или аутентификацию через Kubernetes для Vault (а не простые токены)</li>
<li><strong>Настройте соответствующие действия DLP</strong> — БЛОКИРОВКА для учетных данных, МАСКИРОВАНИЕ для персональных данных</li>
<li><strong>Настройте хранение логов</strong> в вашей системе SIEM для соответствия требованиям</li>
<li><strong>Мониторьте события DLP_BLOCK</strong> на предмет попыток несанкционированного копирования данных</li>
<li><strong>Регулярно обновляйте шаблоны</strong> для обнаружения новых форматов учетных данных</li>
<li><strong>Тестируйте шаблоны DLP</strong> перед развертыванием в рабочей среде</li>
</ol>
<h2 id="compliance">Соответствие требованиям<a class="heading-anchor" href="#compliance" title="Link to this section">&para;</a></h2>
<p>Модуль безопасности помогает выполнить требования следующих нормативных актов:
- <strong>GDPR</strong> — обнаружение и маскировка персональных данных (PII)
- <strong>PCI DSS</strong> — обнаружение номеров кредитных карт
- <strong>SOX</strong> — полный аудит всех действий
- <strong>HIPAA</strong> — защита медицинской информации (PHI) (с использованием пользовательских шаблонов)
- <strong>152-ФЗ</strong> — российский закон о персональных данных (шаблоны PII)</p>
<hr />
<h2 id="advanced-security-features">Расширенные функции безопасности<a class="heading-anchor" href="#advanced-security-features" title="Link to this section">&para;</a></h2>
<h3 id="5-file-based-security-scanner">5. Сканер безопасности на основе файлов<a class="heading-anchor" href="#5-file-based-security-scanner" title="Link to this section">&para;</a></h3>
<p>Быстрое сканирование на уровне файлов для оперативной оценки безопасности без построения CPG.</p>
<h4 id="ispolzovanie">Использование<a class="heading-anchor" href="#ispolzovanie" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.file_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileSecurityScanner</span>

<span class="n">scanner</span> <span class="o">=</span> <span class="n">FileSecurityScanner</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="s2">&quot;/путь/к/проекту&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Критические: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">critical_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Высокий уровень: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">high_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">findings</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Файл: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">line_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="ispolzovanie-cherez-cli">Использование через CLI<a class="heading-anchor" href="#ispolzovanie-cherez-cli" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Быстрое сканирование {#quick-scan}
python -m src.cli.security_audit quick --path ./myproject

<span class="gh">#</span> Полное сканирование с отчётом {#full-scan-with-report}
python -m src.cli.security_audit full --path ./myproject --format all
</code></pre></div>

<h3 id="6-skaner-s-proverkoy-zarazheniya-dannyh-taint-verified-scanner">6. Сканер с проверкой заражения данных (Taint-Verified Scanner)<a class="heading-anchor" href="#6-skaner-s-proverkoy-zarazheniya-dannyh-taint-verified-scanner" title="Link to this section">&para;</a></h3>
<p>Снижает количество ложных срабатываний за счёт анализа потока данных от источников к уязвимым местам с использованием CPG.</p>
<h4 id="kontseptsiya">Концепция<a class="heading-anchor" href="#kontseptsiya" title="Link to this section">&para;</a></h4>
<p>Традиционное сопоставление шаблонов приводит к большому количеству ложных срабатываний. Сканер с проверкой заражения данных:
1. Выявляет потенциальные уязвимости с помощью шаблонов
2. Отслеживает путь данных от источников заражения (ввод пользователя) к уязвимым функциям (sink)
3. Сообщает только о проблемах, для которых подтверждён путь заражения</p>
<h4 id="istochniki-zarazheniya-dannyh-pythondjango">Источники заражения данных (Python/Django)<a class="heading-anchor" href="#istochniki-zarazheniya-dannyh-pythondjango" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Данные запроса Django {#django-request-data}
request.GET, request.POST, request.data
request.body, request.FILES, request.META

<span class="gh">#</span> Данные запроса Flask {#flask-request-data}
request.args, request.form, request.json

<span class="gh">#</span> Обычный ввод {#generic-input}
input(), raw_input(), sys.stdin, os.getenv()

<span class="gh">#</span> Ввод из файлов или сети {#filenetwork-input}
open(), read(), recv(), urlopen()
</code></pre></div>

<h4 id="opasnye-uyazvimye-mesta-sinks-po-kategoriyam">Опасные уязвимые места (sinks) по категориям<a class="heading-anchor" href="#opasnye-uyazvimye-mesta-sinks-po-kategoriyam" title="Link to this section">&para;</a></h4>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Категория</th>
<th>Уязвимые места</th>
</tr>
</thead>
<tbody>
<tr>
<td>SQL-инъекция</td>
<td>execute,raw,cursor.execute,RawSQL</td>
</tr>
<tr>
<td>Инъекция команд</td>
<td>os.system,subprocess.run,eval,exec</td>
</tr>
<tr>
<td>Обход пути (Path Traversal)</td>
<td>open,os.path.join,send_file</td>
</tr>
<tr>
<td>XSS</td>
<td>mark_safe,HttpResponse</td>
</tr>
<tr>
<td>Десериализация</td>
<td>pickle.loads,yaml.load,marshal.loads</td>
</tr>
</tbody>
</table></div>
<h4 id="ispolzovanie_1">Использование<a class="heading-anchor" href="#ispolzovanie_1" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.taint_verified_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">TaintVerifiedScanner</span>

<span class="n">scanner</span> <span class="o">=</span> <span class="n">TaintVerifiedScanner</span><span class="p">(</span><span class="n">duckdb_path</span><span class="o">=</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>

<span class="c1"># Проверка результатов, связанных с SQL-инъекцией {#verify-sql-injection-findings}</span>
<span class="n">verified</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">verify_sql_injection_findings</span><span class="p">(</span><span class="n">raw_findings</span><span class="p">)</span>

<span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">verified</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Подтверждено: </span><span class="si">{</span><span class="n">finding</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Путь заражения: </span><span class="si">{</span><span class="n">finding</span><span class="p">[</span><span class="s1">&#39;taint_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="7-mitre-d3fend-hardening-checks">7. Проверки усиления безопасности по MITRE D3FEND<a class="heading-anchor" href="#7-mitre-d3fend-hardening-checks" title="Link to this section">&para;</a></h3>
<p>Реализует все методы усиления безопасности исходного кода из MITRE D3FEND.</p>
<h4 id="podderzhivaemye-proverki">Поддерживаемые проверки<a class="heading-anchor" href="#podderzhivaemye-proverki" title="Link to this section">&para;</a></h4>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>D3FEND ID</th>
<th>Название</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>D3-VI</td>
<td>Инициализация переменных</td>
<td>Обнаружение неинициализированных переменных</td>
</tr>
<tr>
<td>D3-CS</td>
<td>Очистка учётных данных</td>
<td>Гарантия удаления учётных данных из памяти</td>
</tr>
<tr>
<td>D3-IRV</td>
<td>Проверка диапазона целых чисел</td>
<td>Проверка рисков переполнения целых чисел</td>
</tr>
<tr>
<td>D3-RN</td>
<td>Обнуление ссылок</td>
<td>Проверка очистки указателей после освобождения памяти</td>
</tr>
<tr>
<td>D3-TL</td>
<td>Проверка доверенных библиотек</td>
<td>Проверка использования безопасных функций библиотек</td>
</tr>
<tr>
<td>D3-VTV</td>
<td>Проверка типов переменных</td>
<td>Проверка безопасности типов</td>
</tr>
<tr>
<td>D3-MBSV</td>
<td>Проверка начала блока памяти</td>
<td>Проверка границ блоков памяти</td>
</tr>
<tr>
<td>D3-NPC</td>
<td>Проверка на null-указатели</td>
<td>Обнаружение отсутствующих проверок на null</td>
</tr>
<tr>
<td>D3-DLV</td>
<td>Проверка бизнес-логики</td>
<td>Проверка валидации бизнес-логики</td>
</tr>
<tr>
<td>D3-OLV</td>
<td>Проверка операционной логики</td>
<td>Проверка операционных ограничений</td>
</tr>
</tbody>
</table></div>
<h4 id="ispolzovanie_2">Использование<a class="heading-anchor" href="#ispolzovanie_2" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hardening</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardeningScanner</span>

<span class="n">scanner</span> <span class="o">=</span> <span class="n">HardeningScanner</span><span class="p">(</span><span class="n">duckdb_path</span><span class="o">=</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">run_all_checks</span><span class="p">()</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">check</span><span class="o">.</span><span class="n">d3fend_id</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">check</span><span class="o">.</span><span class="n">d3fend_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Нарушения: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">violations</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Рекомендации: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">check</span><span class="o">.</span><span class="n">remediation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="konfiguratsiya">Конфигурация<a class="heading-anchor" href="#konfiguratsiya" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">security</span><span class="o">:</span>
<span class="w">  </span><span class="n">hardening</span><span class="o">:</span>
<span class="w">    </span><span class="n">enabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="n">checks</span><span class="o">:</span>
<span class="w">      </span><span class="n">D3</span><span class="o">-</span><span class="n">VI</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">Инициализация</span><span class="w"> </span><span class="err">переменных</span>
<span class="w">      </span><span class="n">D3</span><span class="o">-</span><span class="n">CS</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">Очистка</span><span class="w"> </span><span class="err">учётных</span><span class="w"> </span><span class="err">данных</span>
<span class="w">      </span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="err">Проверка</span><span class="w"> </span><span class="err">на</span><span class="w"> </span><span class="kc">null</span><span class="o">-</span><span class="err">указатели</span>
<span class="w">    </span><span class="n">severity_threshold</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Пропускать</span><span class="w"> </span><span class="err">низкий</span><span class="w"> </span><span class="err">уровень</span><span class="w"> </span><span class="err">угроз</span>
</code></pre></div>

<h3 id="8-sast-comparison">8. Сравнение с SAST-инструментами<a class="heading-anchor" href="#8-sast-comparison" title="Link to this section">&para;</a></h3>
<p>Сравнение результатов CodeGraph с внешними SAST-инструментами для проверки точности.</p>
<h4 id="podderzhivaemye-instrumenty">Поддерживаемые инструменты<a class="heading-anchor" href="#podderzhivaemye-instrumenty" title="Link to this section">&para;</a></h4>
<ul>
<li><strong>Bandit</strong> — анализатор безопасности для Python</li>
<li><strong>Semgrep</strong> — статический анализатор для нескольких языков</li>
</ul>
<h4 id="ispolzovanie_3">Использование<a class="heading-anchor" href="#ispolzovanie_3" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.sast_comparison</span><span class="w"> </span><span class="kn">import</span> <span class="n">SASTComparison</span>

<span class="n">comparison</span> <span class="o">=</span> <span class="n">SASTComparison</span><span class="p">(</span><span class="n">project_path</span><span class="o">=</span><span class="s2">&quot;./myproject&quot;</span><span class="p">)</span>

<span class="c1"># Сравнение с Bandit {#compare-with-bandit}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">comparison</span><span class="o">.</span><span class="n">compare_with_bandit</span><span class="p">(</span><span class="n">our_findings</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Точность: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">precision</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Полнота: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">recall</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-мера: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">f1_score</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Уникальные для нас: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">only_ours</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Пропущенные нами: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">only_theirs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="ispolzovanie-cherez-cli_1">Использование через CLI<a class="heading-anchor" href="#ispolzovanie-cherez-cli_1" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Сравнение с Bandit {#compare-with-bandit}
python -m src.cli.security_audit full --path ./myproject --compare bandit

<span class="gh">#</span> Сравнение с Semgrep {#compare-with-semgrep}
python -m src.cli.security_audit full --path ./myproject --compare semgrep
</code></pre></div>

<h3 id="9-generator-otchyotov-po-bezopasnosti">9. Генератор отчётов по безопасности<a class="heading-anchor" href="#9-generator-otchyotov-po-bezopasnosti" title="Link to this section">&para;</a></h3>
<p>Генерация комплексных отчётов по безопасности в различных форматах.</p>
<h4 id="podderzhivaemye-formaty">Поддерживаемые форматы<a class="heading-anchor" href="#podderzhivaemye-formaty" title="Link to this section">&para;</a></h4>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Формат</th>
<th>Назначение</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON</td>
<td>Интеграция в CI/CD, программный доступ</td>
</tr>
<tr>
<td>Markdown</td>
<td>Документация, ручной анализ</td>
</tr>
<tr>
<td>SARIF</td>
<td>Оповещения безопасности GitHub, интеграция в IDE</td>
</tr>
</tbody>
</table></div>
<h4 id="yazyki">Языки<a class="heading-anchor" href="#yazyki" title="Link to this section">&para;</a></h4>
<p>Поддержка локализации отчётов:
- Английский (<code>en</code>)
- Русский (<code>ru</code>)</p>
<h4 id="ispolzovanie_4">Использование<a class="heading-anchor" href="#ispolzovanie_4" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.report_generator</span><span class="w"> </span><span class="kn">import</span> <span class="n">SecurityReportGenerator</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">SecurityReportGenerator</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">)</span>

<span class="c1"># Генерация отчёта на основе результатов сканирования {#generate-report-from-scan-results}</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;MyProject&quot;</span><span class="p">,</span>
    <span class="n">project_path</span><span class="o">=</span><span class="s2">&quot;./myproject&quot;</span><span class="p">,</span>
    <span class="n">file_findings</span><span class="o">=</span><span class="n">file_scan</span><span class="o">.</span><span class="n">findings</span><span class="p">,</span>
    <span class="n">cpg_findings</span><span class="o">=</span><span class="n">cpg_scan</span><span class="o">.</span><span class="n">findings</span><span class="p">,</span>
    <span class="n">hardening_findings</span><span class="o">=</span><span class="n">hardening_results</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Экспорт в разные форматы {#export-to-different-formats}</span>
<span class="n">generator</span><span class="o">.</span><span class="n">export_json</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="s2">&quot;report.json&quot;</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">export_markdown</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="s2">&quot;report.md&quot;</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">export_sarif</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="s2">&quot;report.sarif&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="razdely-otchyota">Разделы отчёта<a class="heading-anchor" href="#razdely-otchyota" title="Link to this section">&para;</a></h4>
<ol>
<li><strong>Резюме</strong> — общее количество выявленных проблем</li>
<li><strong>Критические уязвимости</strong> — требуют немедленного устранения</li>
<li><strong>Высокий уровень угроз</strong> — необходимо устранить до развёртывания</li>
<li><strong>Соответствие D3FEND</strong> — результаты проверок усиления безопасности</li>
<li><strong>Подробные уязвимости</strong> — полный список с рекомендациями по устранению</li>
<li><strong>Метрики</strong> — покрытие, точность, полнота</li>
</ol>
<h3 id="10-cpg-context-resolver">10. Резолвер контекста CPG<a class="heading-anchor" href="#10-cpg-context-resolver" title="Link to this section">&para;</a></h3>
<p>Обогащает результаты анализа безопасности контекстом CPG для лучшего понимания.</p>
<h4 id="vozmozhnosti">Возможности<a class="heading-anchor" href="#vozmozhnosti" title="Link to this section">&para;</a></h4>
<ul>
<li>Контекст вызовов (вызывающие/вызываемые функции)</li>
<li>Пути потока данных</li>
<li>Анализ потока управления</li>
<li>Границы модулей</li>
</ul>
<h4 id="ispolzovanie_5">Использование<a class="heading-anchor" href="#ispolzovanie_5" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.cpg_context_resolver</span><span class="w"> </span><span class="kn">import</span> <span class="n">CPGContextResolver</span>

<span class="n">resolver</span> <span class="o">=</span> <span class="n">CPGContextResolver</span><span class="p">(</span><span class="n">duckdb_path</span><span class="o">=</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>

<span class="c1"># Обогащение результата контекстом {#enrich-finding-with-context}</span>
<span class="n">enriched</span> <span class="o">=</span> <span class="n">resolver</span><span class="o">.</span><span class="n">enrich_finding</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Вызывающие: </span><span class="si">{</span><span class="n">enriched</span><span class="p">[</span><span class="s1">&#39;callers&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Поток данных: </span><span class="si">{</span><span class="n">enriched</span><span class="p">[</span><span class="s1">&#39;data_flow_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Модуль: </span><span class="si">{</span><span class="n">enriched</span><span class="p">[</span><span class="s1">&#39;module&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="security-module-structure">Структура модуля безопасности<a class="heading-anchor" href="#security-module-structure" title="Link to this section">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">src</span><span class="o">/</span><span class="n">security</span><span class="o">/</span>
<span class="err">├──</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span>          <span class="o">#</span> <span class="err">Экспорты</span> <span class="err">модуля</span>
<span class="err">├──</span> <span class="n">_base</span><span class="p">.</span><span class="n">py</span>             <span class="o">#</span> <span class="err">Базовые</span> <span class="err">классы</span> <span class="p">(</span><span class="n">Severity</span><span class="p">,</span> <span class="n">Category</span><span class="p">)</span>
<span class="err">├──</span> <span class="n">config</span><span class="p">.</span><span class="n">py</span>            <span class="o">#</span> <span class="err">Конфигурация</span> <span class="err">безопасности</span>
<span class="err">│</span>
<span class="err">├──</span> <span class="n">dlp</span><span class="o">/</span>                 <span class="o">#</span> <span class="err">Предотвращение</span> <span class="err">утечки</span> <span class="err">данных</span> <span class="p">(</span><span class="n">DLP</span><span class="p">)</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">patterns</span><span class="p">.</span><span class="n">py</span>      <span class="o">#</span> <span class="err">Шаблоны</span> <span class="n">DLP</span> <span class="p">(</span><span class="err">учетные</span> <span class="err">данные</span><span class="p">,</span> <span class="err">персональные</span> <span class="err">данные</span><span class="p">)</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">scanner</span><span class="p">.</span><span class="n">py</span>       <span class="o">#</span> <span class="err">Сканер</span> <span class="err">содержимого</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">actions</span><span class="p">.</span><span class="n">py</span>       <span class="o">#</span> <span class="err">Действия</span> <span class="n">DLP</span> <span class="p">(</span><span class="n">BLOCK</span><span class="p">,</span> <span class="n">MASK</span><span class="p">,</span> <span class="n">WARN</span><span class="p">)</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">webhook</span><span class="p">.</span><span class="n">py</span>       <span class="o">#</span> <span class="err">Вебхуки</span> <span class="err">оповещений</span>
<span class="err">│</span>
<span class="err">├──</span> <span class="n">siem</span><span class="o">/</span>                <span class="o">#</span> <span class="err">Интеграция</span> <span class="err">с</span> <span class="n">SIEM</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">base_handler</span><span class="p">.</span><span class="n">py</span>  <span class="o">#</span> <span class="err">Базовый</span> <span class="err">класс</span> <span class="err">обработчика</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">syslog_handler</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">cef_handler</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">leef_handler</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">buffer</span><span class="p">.</span><span class="n">py</span>        <span class="o">#</span> <span class="err">Буферизация</span> <span class="err">событий</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">dispatcher</span><span class="p">.</span><span class="n">py</span>    <span class="o">#</span> <span class="err">Диспетчеризация</span> <span class="err">между</span> <span class="err">несколькими</span> <span class="err">обработчиками</span>
<span class="err">│</span>
<span class="err">├──</span> <span class="n">vault</span><span class="o">/</span>               <span class="o">#</span> <span class="n">HashiCorp</span> <span class="n">Vault</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">client</span><span class="p">.</span><span class="n">py</span>        <span class="o">#</span> <span class="err">Клиент</span> <span class="n">API</span> <span class="n">Vault</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">secret_manager</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>
<span class="err">├──</span> <span class="n">llm</span><span class="o">/</span>                 <span class="o">#</span> <span class="err">Безопасность</span> <span class="n">LLM</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">secure_provider</span><span class="p">.</span><span class="n">py</span>  <span class="o">#</span> <span class="err">Обёртка</span> <span class="n">SecureLLMProvider</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">request_logger</span><span class="p">.</span><span class="n">py</span>   <span class="o">#</span> <span class="err">Аудит</span> <span class="err">и</span> <span class="err">логирование</span> <span class="err">запросов</span>
<span class="err">│</span>
<span class="err">├──</span> <span class="n">hardening</span><span class="o">/</span>           <span class="o">#</span> <span class="err">Усиление</span> <span class="err">безопасности</span> <span class="p">(</span><span class="n">D3FEND</span><span class="p">)</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">base</span><span class="p">.</span><span class="n">py</span>          <span class="o">#</span> <span class="err">Определения</span> <span class="err">проверок</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">d3fend_checks</span><span class="p">.</span><span class="n">py</span> <span class="o">#</span> <span class="err">Все</span> <span class="err">проверки</span> <span class="n">D3FEND</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">hardening_scanner</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>
<span class="err">├──</span> <span class="n">patterns</span><span class="o">/</span>            <span class="o">#</span> <span class="err">Шаблоны</span> <span class="err">уязвимостей</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">injection</span><span class="p">.</span><span class="n">py</span>     <span class="o">#</span> <span class="err">Инъекции</span> <span class="n">SQL</span><span class="o">/</span><span class="err">команд</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">memory</span><span class="p">.</span><span class="n">py</span>        <span class="o">#</span> <span class="err">Безопасность</span> <span class="err">работы</span> <span class="err">с</span> <span class="err">памятью</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">crypto</span><span class="p">.</span><span class="n">py</span>        <span class="o">#</span> <span class="err">Криптографические</span> <span class="err">проблемы</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">auth</span><span class="p">.</span><span class="n">py</span>          <span class="o">#</span> <span class="err">Ошибки</span> <span class="err">аутентификации</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">concurrency</span><span class="p">.</span><span class="n">py</span>   <span class="o">#</span> <span class="err">Гонки</span> <span class="err">данных</span> <span class="p">(</span><span class="n">race</span> <span class="n">conditions</span><span class="p">)</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">python_django</span><span class="p">.</span><span class="n">py</span> <span class="o">#</span> <span class="err">Специфичные</span> <span class="err">для</span> <span class="n">Python</span><span class="o">/</span><span class="n">Django</span>
<span class="err">│</span>
<span class="err">├──</span> <span class="n">file_scanner</span><span class="p">.</span><span class="n">py</span>      <span class="o">#</span> <span class="err">Сканирование</span> <span class="err">на</span> <span class="err">основе</span> <span class="err">файлов</span>
<span class="err">├──</span> <span class="n">taint_verified_scanner</span><span class="p">.</span><span class="n">py</span>  <span class="o">#</span> <span class="err">Анализ</span> <span class="err">загрязнения</span> <span class="p">(</span><span class="n">taint</span> <span class="n">analysis</span><span class="p">)</span>
<span class="err">├──</span> <span class="n">cpg_context_resolver</span><span class="p">.</span><span class="n">py</span>    <span class="o">#</span> <span class="err">Обогащение</span> <span class="n">CPG</span>
<span class="err">├──</span> <span class="n">sast_comparison</span><span class="p">.</span><span class="n">py</span>   <span class="o">#</span> <span class="err">Сравнение</span> <span class="err">инструментов</span> <span class="n">SAST</span>
<span class="err">├──</span> <span class="n">report_generator</span><span class="p">.</span><span class="n">py</span>  <span class="o">#</span> <span class="err">Генерация</span> <span class="err">отчётов</span>
<span class="err">└──</span> <span class="n">report_localizer</span><span class="p">.</span><span class="n">py</span>  <span class="o">#</span> <span class="err">Поддержка</span> <span class="err">интернационализации</span> <span class="p">(</span><span class="n">i18n</span><span class="p">)</span>
</code></pre></div>

<h2 id="quick-start-guide">Краткое руководство по началу работы<a class="heading-anchor" href="#quick-start-guide" title="Link to this section">&para;</a></h2>
<h3 id="1-enable-security-features">1. Включение функций безопасности<a class="heading-anchor" href="#1-enable-security-features" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Переменные окружения {#environment-variables}</span>
<span class="k">export</span><span class="w"> </span><span class="n">SECURITY_ENABLED</span><span class="o">=</span><span class="bp">true</span>
<span class="k">export</span><span class="w"> </span><span class="n">DLP_ENABLED</span><span class="o">=</span><span class="bp">true</span>
<span class="k">export</span><span class="w"> </span><span class="n">SIEM_ENABLED</span><span class="o">=</span><span class="bp">true</span>
</code></pre></div>

<h3 id="2-run-security-audit">2. Запуск аудита безопасности<a class="heading-anchor" href="#2-run-security-audit" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Полный аудит со всеми проверками {#full-audit-with-all-checks}
python -m src.cli.security_audit full \
    --path ./myproject \
    --format all \
    --verbose
</code></pre></div>

<h3 id="3-prosmotr-otchyotov">3. Просмотр отчётов<a class="heading-anchor" href="#3-prosmotr-otchyotov" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Отчёты сохраняются в ./security_reports/ {#reports-are-saved-to-security-reports}
ls security_reports/
<span class="gh">#</span> security_audit_20241209_103000.json {#security-audit-20241209-103000json}
<span class="gh">#</span> security_audit_20241209_103000.md {#security-audit-20241209-103000md}
<span class="gh">#</span> security_audit_20241209_103000.sarif {#security-audit-20241209-103000sarif}
</code></pre></div>

<h3 id="4-integrate-with-cicd">4. Интеграция с CI/CD<a class="heading-anchor" href="#4-integrate-with-cicd" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .github/workflows/security.yml {#githubworkflowssecurityyml}</span>
<span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">Security</span><span class="w"> </span><span class="n">Audit</span>
<span class="w">  </span><span class="n">run</span><span class="p">:</span><span class="w"> </span><span class="o">|</span>
<span class="w">    </span><span class="n">python</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">src</span><span class="o">.</span><span class="n">cli</span><span class="o">.</span><span class="n">security_audit</span><span class="w"> </span><span class="n">full</span><span class="w"> </span>\
<span class="w">      </span><span class="o">--</span><span class="n">path</span><span class="w"> </span><span class="o">.</span><span class="w"> </span>\
<span class="w">      </span><span class="o">--</span><span class="n">format</span><span class="w"> </span><span class="n">sarif</span><span class="w"> </span>\
<span class="w">      </span><span class="o">--</span><span class="n">output</span><span class="w"> </span><span class="n">security</span><span class="o">.</span><span class="n">sarif</span>

<span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">Upload</span><span class="w"> </span><span class="n">SARIF</span>
<span class="w">  </span><span class="n">uses</span><span class="p">:</span><span class="w"> </span><span class="n">github</span><span class="o">/</span><span class="n">codeql</span><span class="o">-</span><span class="n">action</span><span class="o">/</span><span class="n">upload</span><span class="o">-</span><span class="n">sarif</span><span class="err">@</span><span class="n">v2</span>
<span class="w">  </span><span class="n">with</span><span class="p">:</span>
<span class="w">    </span><span class="n">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="n">security</span><span class="o">.</span><span class="n">sarif</span>
</code></pre></div>

<h2 id="smotrite-takzhe">Смотрите также<a class="heading-anchor" href="#smotrite-takzhe" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="../guides/CLI_GUIDE.html">Руководство по CLI</a> — использование CLI для аудита безопасности</li>
<li><a href="../guides/TUI_USER_GUIDE.html">Руководство пользователя TUI</a> — интерактивный сценарий безопасности</li>
<li><a href="../api/REST_API.html">Документация по API</a> — конечные точки безопасности</li>
</ul>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="ANALYSIS_MODULES.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Назад</span>
        <span class="doc-page-nav-title">Справочник модулей анализа</span>
      </a>

      <a href="../enterprise/index.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Вперед</span>
        <span class="doc-page-nav-title">Enterprise</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Обновлено: 2025-12-28</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/reference/SECURITY.md" target="_blank" rel="noopener">Редактировать на GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">На этой странице</div>
      <ul class="doc-toc-list">
        <li><a href="#modul-korporativnoy-bezopasnosti" class="level-1">Модуль корпоративной безопасности</a></li>
<li><a href="#soderzhanie" class="level-2">Содержание</a></li>
<li><a href="#obzor" class="level-2">Обзор</a></li>
<li><a href="#vozmozhnosti" class="level-2">Возможности</a></li>
<li><a href="#1-zhurnalirovanie-zaprosov-i-otvetov-llm" class="level-3">1. Журналирование запросов и ответов LLM</a></li>
<li><a href="#2-integratsiya-s-siem" class="level-3">2. Интеграция с SIEM</a></li>
<li><a href="#3-dlp-predotvraschenie-utechki-dannyh" class="level-3">3. DLP (предотвращение утечки данных)</a></li>
<li><a href="#4-integratsiya-s-hashicorp-vault" class="level-3">4. Интеграция с HashiCorp Vault</a></li>
<li><a href="#arhitektura" class="level-2">Архитектура</a></li>
<li><a href="#konfiguratsiya" class="level-2">Конфигурация</a></li>
<li><a href="#vklyuchenie-modulya-bezopasnosti" class="level-3">Включение модуля безопасности</a></li>
<li><a href="#polnaya-konfiguratsiya-configyaml" class="level-3">Полная конфигурация (config.yaml)</a></li>
<li><a href="#peremennye-okruzheniya" class="level-3">Переменные окружения</a></li>
<li><a href="#primery-ispolzovaniya" class="level-2">Примеры использования</a></li>
<li><a href="#bazovoe-ispolzovanie-avtomaticheskoe" class="level-3">Базовое использование (автоматическое)</a></li>
<li><a href="#postavschik-avtomaticheski-oborachivaetsya-v-zaschitnyy-sloy" class="level-1">Поставщик автоматически оборачивается в защитный слой</a></li>
<li><a href="#teper-vse-zaprosy-filtruyutsya-i-zapisyvayutsya-v-log" class="level-1">Теперь все запросы фильтруются и записываются в лог</a></li>
<li><a href="#ruchnaya-obertka-bezopasnosti" class="level-3">Ручная обертка безопасности</a></li>
<li><a href="#sozdanie-bazovogo-postavschika" class="level-1">Создание базового поставщика</a></li>
<li><a href="#oborachivanie-v-zaschitnyy-sloy" class="level-1">Оборачивание в защитный слой</a></li>
<li><a href="#ispolzovanie-zaschischyonnogo-postavschika" class="level-1">Использование защищённого поставщика</a></li>
<li><a href="#tolko-skanirovanie-dlp" class="level-3">Только сканирование DLP</a></li>
<li><a href="#skanirovanie-soderzhimogo" class="level-1">Сканирование содержимого</a></li>
<li><a href="#otpravka-sobytiy-v-siem" class="level-3">Отправка событий в SIEM</a></li>
<li><a href="#initsializatsiya-dispetchera" class="level-1">Инициализация диспетчера</a></li>
<li><a href="#sozdanie-i-otpravka-sobytiya" class="level-1">Создание и отправка события</a></li>
<li><a href="#shablony-dlp" class="level-2">Шаблоны DLP</a></li>
<li><a href="#vstroennye-shablony" class="level-3">Встроенные шаблоны</a></li>
<li><a href="#polzovatelskie-shablony" class="level-3">Пользовательские шаблоны</a></li>
<li><a href="#tablitsy-bazy-dannyh" class="level-2">Таблицы базы данных</a></li>
<li><a href="#llm-audit-log" class="level-3">llm_audit_log</a></li>
<li><a href="#dlp-events" class="level-3">dlp_events</a></li>
<li><a href="#formaty-sobytiy-siem" class="level-2">Форматы событий SIEM</a></li>
<li><a href="#syslog-rfc-5424" class="level-3">SysLog (RFC 5424)</a></li>
<li><a href="#cef" class="level-3">CEF</a></li>
<li><a href="#leef" class="level-3">LEEF</a></li>
<li><a href="#integratsiya-cherez-vebhuk" class="level-2">Интеграция через вебхук</a></li>
<li><a href="#rekomendatsii-po-obespecheniyu-bezopasnosti" class="level-2">Рекомендации по обеспечению безопасности</a></li>
<li><a href="#sootvetstvie-trebovaniyam" class="level-2">Соответствие требованиям</a></li>
<li><a href="#rasshirennye-funktsii-bezopasnosti" class="level-2">Расширенные функции безопасности</a></li>
<li><a href="#5-skaner-bezopasnosti-na-osnove-faylov" class="level-3">5. Сканер безопасности на основе файлов</a></li>
<li><a href="#bystroe-skanirovanie" class="level-1">Быстрое сканирование</a></li>
<li><a href="#polnoe-skanirovanie-s-otchyotom" class="level-1">Полное сканирование с отчётом</a></li>
<li><a href="#6-skaner-s-proverkoy-zarazheniya-dannyh-taint-verified-scanner" class="level-3">6. Сканер с проверкой заражения данных (Taint-Verified Scanner)</a></li>
<li><a href="#dannye-zaprosa-django" class="level-1">Данные запроса Django</a></li>
<li><a href="#dannye-zaprosa-flask" class="level-1">Данные запроса Flask</a></li>
<li><a href="#obychnyy-vvod" class="level-1">Обычный ввод</a></li>
<li><a href="#vvod-iz-faylov-ili-seti" class="level-1">Ввод из файлов или сети</a></li>
<li><a href="#proverka-rezultatov-svyazannyh-s-sql-inektsiey" class="level-1">Проверка результатов, связанных с SQL-инъекцией</a></li>
<li><a href="#7-proverki-usileniya-bezopasnosti-po-mitre-d3fend" class="level-3">7. Проверки усиления безопасности по MITRE D3FEND</a></li>
<li><a href="#8-sravnenie-s-sast-instrumentami" class="level-3">8. Сравнение с SAST-инструментами</a></li>
<li><a href="#sravnenie-s-bandit" class="level-1">Сравнение с Bandit</a></li>
<li><a href="#sravnenie-s-bandit" class="level-1">Сравнение с Bandit</a></li>
<li><a href="#sravnenie-s-semgrep" class="level-1">Сравнение с Semgrep</a></li>
<li><a href="#9-generator-otchyotov-po-bezopasnosti" class="level-3">9. Генератор отчётов по безопасности</a></li>
<li><a href="#generatsiya-otchyota-na-osnove-rezultatov-skanirovaniya" class="level-1">Генерация отчёта на основе результатов сканирования</a></li>
<li><a href="#eksport-v-raznye-formaty" class="level-1">Экспорт в разные форматы</a></li>
<li><a href="#10-rezolver-konteksta-cpg" class="level-3">10. Резолвер контекста CPG</a></li>
<li><a href="#obogaschenie-rezultata-kontekstom" class="level-1">Обогащение результата контекстом</a></li>
<li><a href="#struktura-modulya-bezopasnosti" class="level-2">Структура модуля безопасности</a></li>
<li><a href="#kratkoe-rukovodstvo-po-nachalu-raboty" class="level-2">Краткое руководство по началу работы</a></li>
<li><a href="#1-vklyuchenie-funktsiy-bezopasnosti" class="level-3">1. Включение функций безопасности</a></li>
<li><a href="#peremennye-okruzheniya" class="level-1">Переменные окружения</a></li>
<li><a href="#2-zapusk-audita-bezopasnosti" class="level-3">2. Запуск аудита безопасности</a></li>
<li><a href="#polnyy-audit-so-vsemi-proverkami" class="level-1">Полный аудит со всеми проверками</a></li>
<li><a href="#3-prosmotr-otchyotov" class="level-3">3. Просмотр отчётов</a></li>
<li><a href="#otchyoty-sohranyayutsya-v-security-reports" class="level-1">Отчёты сохраняются в ./security_reports/</a></li>
<li><a href="#security-audit-20241209-103000json" class="level-1">security_audit_20241209_103000.json</a></li>
<li><a href="#security-audit-20241209-103000md" class="level-1">security_audit_20241209_103000.md</a></li>
<li><a href="#security-audit-20241209-103000sarif" class="level-1">security_audit_20241209_103000.sarif</a></li>
<li><a href="#4-integratsiya-s-cicd" class="level-3">4. Интеграция с CI/CD</a></li>
<li><a href="#githubworkflowssecurityyml" class="level-1">.github/workflows/security.yml</a></li>
<li><a href="#smotrite-takzhe" class="level-2">Смотрите также</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI-копилот для анализа исходного кода</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Продукт</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Возможности</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Интеграции</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Документация</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Начало работы</a></li>
              <li><a href="../guides/index.html" class="footer-link">Руководства</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Ресурсы</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Контакты</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. Все права защищены.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
