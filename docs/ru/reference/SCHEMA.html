<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: Дизайн схемы DuckDB CPG (CPG Spec v1.1)">
  <meta name="keywords" content="CodeGraph, documentation, reference">

  <meta property="og:title" content="Дизайн схемы DuckDB CPG (CPG Spec v1.1) - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: Дизайн схемы DuckDB CPG (CPG Spec v1.1)">
  <meta property="og:type" content="article">

  <title>Дизайн схемы DuckDB CPG (CPG Spec v1.1) - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="nav-link active">Документация</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/reference/SCHEMA.html" class="">EN</a>
          <a href="../../ru/reference/SCHEMA.html" class="active">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Переключить тему">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Запросить демо</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Документация</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Запросить демо</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Начало работы</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Обзор</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Руководство по настройке</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Руководство по установке</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Руководства</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../guides/index.html">Обзор</a></li>
        <li><a href="../guides/BENCHMARK_GUIDE.html">Руководство по тестовой платформе</a></li>
        <li><a href="../guides/CLI_GUIDE.html">Руководство по CLI</a></li>
        <li><a href="../guides/CODE_REVIEW.html">Автоматический код-ревью</a></li>
        <li><a href="../guides/CPG_EXPORT.html">Руководство по экспорту CPG</a></li>
        <li><a href="../guides/MONITORING.html">Руководство по мониторингу</a></li>
        <li><a href="../guides/PROGRAMMATIC_GUIDE.html">Руководство пользователя</a></li>
        <li><a href="../guides/PROJECT_IMPORT.html">Импорт новой кодовой базы</a></li>
        <li><a href="../guides/QUICK_REFERENCE.html">Краткое руководство по CodeGraph</a></li>
        <li><a href="../guides/REFACTORING.html">Руководство по анализу рефакторинга</a></li>
        <li><a href="../guides/SCENARIOS.html">Руководство по сценариям рабочих процессов</a></li>
        <li><a href="../guides/TROUBLESHOOTING.html">Руководство по устранению неполадок</a></li>
        <li><a href="../guides/TUI_USER_GUIDE.html">Руководство пользователя CodeGraph</a></li>
        <li><a href="../guides/01-onboarding.html">Сценарий 01: Ввод нового разработчика</a></li>
        <li><a href="../guides/02-security-audit.html">Сценарий 02: Аудит безопасности</a></li>
        <li><a href="../guides/03-documentation.html">Сценарий 03: Генерация документации</a></li>
        <li><a href="../guides/04-feature-development.html">Сценарий 04: Разработка функций</a></li>
        <li><a href="../guides/05-refactoring.html">Сценарий 05: Рефакторинг</a></li>
        <li><a href="../guides/06-performance.html">Сценарий 06: Анализ производительности</a></li>
        <li><a href="../guides/07-test-coverage.html">Сценарий 07: Покрытие тестами</a></li>
        <li><a href="../guides/08-compliance.html">Сценарий 08: Проверка соответствия требованиям</a></li>
        <li><a href="../guides/09-code-review.html">Сценарий 09: Код-ревью</a></li>
        <li><a href="../guides/10-cross-repo.html">Сценарий 10: Анализ между репозиториями</a></li>
        <li><a href="../guides/11-architecture.html">Сценарий 11: Анализ архитектуры</a></li>
        <li><a href="../guides/12-tech-debt.html">Сценарий 12: Оценка технического долга</a></li>
        <li><a href="../guides/13-mass-refactoring.html">Сценарий 13: Массовая рефакторизация</a></li>
        <li><a href="../guides/14-incident-response.html">Сценарий 14: Реагирование на инциденты безопасности</a></li>
        <li><a href="../guides/15-debugging.html">Сценарий 15: Помощь в отладке</a></li>
        <li><a href="../guides/16-entry-points.html">Сценарий 16: Обнаружение точки входа</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Документация</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Обзор</a></li>
        <li><a href="../api/ACP_INTEGRATION.html">Интеграция Agent Client Protocol (ACP)</a></li>
        <li><a href="../api/REST_API.html">Документация по REST API CodeGraph</a></li>
        <li><a href="../api/WEBSOCKET_API.html">Справочная документация по WebSocket API</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Интеграции</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Обзор</a></li>
        <li><a href="../integrations/GIGACHAT.html">Руководство по интеграции GigaChat</a></li>
        <li><a href="../integrations/YANDEX_AI_STUDIO.html">Руководство по интеграции Yandex AI Studio</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Справочник</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Обзор</a></li>
        <li><a href="AGENTS.html">Справочник агентов</a></li>
        <li><a href="ANALYSIS_MODULES.html">Справочник модулей анализа</a></li>
        <li><a href="API.html">Справочник API</a></li>
        <li><a href="HYPOTHESIS_SYSTEM.html">Справочная система гипотез</a></li>
        <li><a href="SCHEMA.html" class="active">Дизайн схемы DuckDB CPG (CPG Spec v1.1)</a></li>
        <li><a href="SECURITY.html">Модуль корпоративной безопасности</a></li>
        <li><a href="SQL_QUERY_COOKBOOK.html">Кулинарная книга SQL-запросов для DuckDB CPG</a></li>
        <li><a href="WORKFLOWS.html">Справочник по рабочим процессам</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Обзор</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Документация</a>
        <span>/</span>
        <a href="index.html">Справочник</a>
        <span>/</span>
        <span>Дизайн схемы DuckDB CPG (CPG Spec v1.1)</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>Дизайн схемы DuckDB CPG (CPG Spec v1.1)</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="dizayn-shemy-duckdb-cpg-cpg-spec-v11">Дизайн схемы DuckDB CPG (CPG Spec v1.1)<a class="heading-anchor" href="#dizayn-shemy-duckdb-cpg-cpg-spec-v11" title="Link to this section">&para;</a></h1>
<h2 id="table-of-contents">Содержание<a class="heading-anchor" href="#table-of-contents" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="#table-of-contents">Содержание</a></li>
<li><a href="#overview">Обзор</a></li>
<li><a href="#core-design-principles">Основные принципы проектирования</a></li>
<li><a href="#node-tables">Таблицы узлов</a></li>
<li><a href="#nodes_method">nodes_method</a></li>
<li><a href="#nodes_call">nodes_call</a></li>
<li><a href="#nodes_identifier">nodes_identifier</a></li>
<li><a href="#nodes_field_identifier">nodes_field_identifier</a></li>
<li><a href="#nodes_literal">nodes_literal</a></li>
<li><a href="#nodes_local">nodes_local</a></li>
<li><a href="#nodes_param">nodes_param</a></li>
<li><a href="#nodes_param_out">nodes_param_out</a></li>
<li><a href="#nodes_method_return">nodes_method_return</a></li>
<li><a href="#nodes_return">nodes_return</a></li>
<li><a href="#nodes_block">nodes_block</a></li>
<li><a href="#nodes_control_structure">nodes_control_structure</a></li>
<li><a href="#nodes_member">nodes_member</a></li>
<li><a href="#nodes_type_decl">nodes_type_decl</a></li>
<li><a href="#nodes_metadata">nodes_metadata</a></li>
<li><a href="#nodes_file">nodes_file</a></li>
<li><a href="#nodes_namespace_block">nodes_namespace_block</a></li>
<li><a href="#nodes_method_ref">nodes_method_ref</a></li>
<li><a href="#nodes_type_ref">nodes_type_ref</a></li>
<li><a href="#nodes_unknown">nodes_unknown</a></li>
<li><a href="#nodes_jump_target">nodes_jump_target</a></li>
<li><a href="#nodes_type_parameter">nodes_type_parameter</a></li>
<li><a href="#nodes_type_argument">nodes_type_argument</a></li>
<li><a href="#nodes_binding">nodes_binding</a></li>
<li><a href="#nodes_closure_binding">nodes_closure_binding</a></li>
<li><a href="#nodes_comment">nodes_comment</a></li>
<li><a href="#edge-tables">Таблицы рёбер</a></li>
<li><a href="#edges_ast">edges_ast</a></li>
<li><a href="#edges_cfg">edges_cfg</a></li>
<li><a href="#edges_call">edges_call</a></li>
<li><a href="#edges_ref">edges_ref</a></li>
<li><a href="#edges_reaching_def">edges_reaching_def</a></li>
<li><a href="#edges_argument">edges_argument</a></li>
<li><a href="#edges_receiver">edges_receiver</a></li>
<li><a href="#edges_condition">edges_condition</a></li>
<li><a href="#edges_dominate">edges_dominate</a></li>
<li><a href="#edges_post_dominate">edges_post_dominate</a></li>
<li><a href="#edges_cdg">edges_cdg</a></li>
<li><a href="#edges_binds">edges_binds</a></li>
<li><a href="#edges_binds_to">edges_binds_to</a></li>
<li><a href="#edges_source_file">edges_source_file</a></li>
<li><a href="#edges_alias_of">edges_alias_of</a></li>
<li><a href="#edges_inherits_from">edges_inherits_from</a></li>
<li><a href="#edges_capture">edges_capture</a></li>
<li><a href="#edges_captured_by">edges_captured_by</a></li>
<li><a href="#property-graph-definition">Определение графа свойств</a></li>
<li><a href="#step-1-create-materialized-unified-nodes-table">Шаг 1: Создание материализованной объединённой таблицы узлов</a></li>
<li><a href="#step-2-create-comprehensive-property-graph">Шаг 2: Создание комплексного графа свойств</a></li>
<li><a href="#example-queries">Примеры запросов</a></li>
<li><a href="#standard-sql-query-find-all-calls-to-a-specific-method">Стандартный SQL-запрос: Поиск всех вызовов определённого метода</a></li>
<li><a href="#duckdb-pgq-query-find-direct-call-chains-caller---callee">DuckDB PGQ-запрос: Поиск прямых цепочек вызовов (вызывающий -&gt; вызываемый)</a></li>
<li><a href="#duckdb-pgq-query-find-methods-and-their-ast-children">DuckDB PGQ-запрос: Поиск методов и их дочерних элементов в AST</a></li>
<li><a href="#duckdb-pgq-query-data-flow-paths-using-reaching_def">DuckDB PGQ-запрос: Пути потока данных с использованием REACHING_DEF</a></li>
<li><a href="#duckdb-pgq-query-cfg-paths-control-flow">DuckDB PGQ-запрос: Пути CFG (управляющий поток)</a></li>
<li><a href="#duckdb-pgq-query-find-all-identifiers-and-their-references">DuckDB PGQ-запрос: Поиск всех идентификаторов и их ссылок</a></li>
<li><a href="#duckdb-pgq-query-type-hierarchy-inheritance">DuckDB PGQ-запрос: Иерархия типов (наследование)</a></li>
<li><a href="#combined-query-methods-with-most-incoming-calls">Комбинированный запрос: Методы с наибольшим количеством входящих вызовов</a></li>
<li><a href="#migration-from-joern">Миграция с Joern</a></li>
<li><a href="#phase-1-critical---completed-">Этап 1 (КРИТИЧЕСКИЙ) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#phase-2-oop-support---completed-">Этап 2 (ПОДДЕРЖКА ООП) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#phase-3-namespace-and-file-support---completed-">Этап 3 (ПОДДЕРЖКА ПРОСТРАНСТВ ИМЁН И ФАЙЛОВ) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#phase-4-remaining-features---completed-">Этап 4 (ОСТАВШИЕСЯ ФУНКЦИИ) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#performance-considerations">Соображения по производительности</a></li>
<li><a href="#schema-version">Версия схемы</a></li>
<li><a href="#changelog">Журнал изменений</a></li>
<li><a href="#v50-2025-11-16---phase-4-complete-compliance">v5.0 (2025-11-16) — Полное соответствие Этапу 4</a></li>
<li><a href="#v40-2025-11-16---phase-3-namespace-and-file-support">v4.0 (2025-11-16) — Поддержка пространств имён и файлов (Этап 3)</a></li>
<li><a href="#v30-2025-11-16---phase-2-oop-support">v3.0 (2025-11-16) — Поддержка ООП (Этап 2)</a></li>
<li><a href="#v20-2025-11-16---phase-1-critical-updates">v2.0 (2025-11-16) — Критические обновления (Этап 1)</a></li>
<li><a href="#v10-2025-11-15---initial-release">v1.0 (2025-11-15) — Первоначальный выпуск</a></li>
<li><a href="#extension-semantic-tag-system">Расширение: Система семантических меток</a></li>
<li><a href="#overview">Обзор</a></li>
<li><a href="#nodes_tag">nodes_tag</a></li>
<li><a href="#edges_tagged_by">edges_tagged_by</a></li>
<li><a href="#tag-categories">Категории меток</a></li>
<li><a href="#example-tag-queries">Примеры запросов с метками</a></li>
<li><a href="#tag-statistics">Статистика по меткам</a></li>
<li><a href="#integration-notes">Примечания по интеграции</a></li>
</ul>
<h2 id="overview">Обзор<a class="heading-anchor" href="#overview" title="Link to this section">&para;</a></h2>
<p>Эта схема реализует спецификацию Code Property Graph версии 1.1 в DuckDB с использованием расширения duckpgq для эффективного выполнения запросов к графам свойств.</p>
<h2 id="core-design-principles">Основные принципы проектирования<a class="heading-anchor" href="#core-design-principles" title="Link to this section">&para;</a></h2>
<ol>
<li><strong>Таблицы узлов</strong>: Отдельные таблицы для каждого основного типа узлов (METHOD, CALL, IDENTIFIER и т.д.)</li>
<li><strong>Таблицы рёбер</strong>: Отдельные таблицы для каждого типа рёбер (AST, CFG, CALL, REF, REACHING_DEF и т.д.)</li>
<li><strong>Граф свойств</strong>: Использование команды CREATE PROPERTY GRAPH из duckpgq для объединённых графовых запросов</li>
<li><strong>Эффективное индексирование</strong>: Индексы B-дерева по полям id, full_name и другим часто используемым свойствам</li>
<li><strong>Пакетная обработка</strong>: Поддержка массового импорта CPG (50K+ методов)</li>
</ol>
<h2 id="node-tables">Таблицы узлов<a class="heading-anchor" href="#node-tables" title="Link to this section">&para;</a></h2>
<h3 id="nodes-method">nodes_method<a class="heading-anchor" href="#nodes-method" title="Link to this section">&para;</a></h3>
<p>Основная таблица для объявлений функций/методов.</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_method</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">signature</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">filename</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number_end</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number_end</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">offset</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">          </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Байтовое</span><span class="w"> </span><span class="nx">смещение</span><span class="w"> </span><span class="nx">в</span><span class="w"> </span><span class="nx">файле</span><span class="w"> </span><span class="p">(</span><span class="nx">Фаза</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="nx">offset_end</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">      </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Конечное</span><span class="w"> </span><span class="nx">байтовое</span><span class="w"> </span><span class="nx">смещение</span><span class="w"> </span><span class="p">(</span><span class="nx">Фаза</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">is_external</span><span class="w"> </span><span class="nx">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="nx">ast_parent_type</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">ast_parent_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">hash</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">modifier</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">[]</span><span class="w">       </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Модификаторы</span><span class="w"> </span><span class="nx">доступа</span><span class="w"> </span><span class="p">(</span><span class="nx">Фаза</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="p">);</span>

<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_method_full_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_method</span><span class="p">(</span><span class="nx">full_name</span><span class="p">);</span>
<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_method_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_method</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_method_filename</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_method</span><span class="p">(</span><span class="nx">filename</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- FULL_NAME, NAME, SIGNATURE: Идентификация метода
- IS_EXTERNAL: Определён ли в исходном коде
- AST_PARENT_FULL_NAME, AST_PARENT_TYPE: Контекст типа
- FILENAME, LINE_NUMBER, COLUMN_NUMBER: Расположение в исходном коде
- OFFSET, OFFSET_END: Точное расположение на уровне байтов (Фаза 2 - НОВОЕ!)
- CODE: Исходный код метода
- HASH: Сводный хеш
- MODIFIER: Модификаторы доступа (Фаза 2 - НОВОЕ!)
  - Значения: STATIC, PUBLIC, PROTECTED, PRIVATE, ABSTRACT, NATIVE, CONSTRUCTOR, VIRTUAL, INTERNAL, FINAL, READONLY, MODULE</p>
<p><strong>Примеры модификаторов:</strong>
- <code>public void foo()</code> → modifier=[“PUBLIC”]
- <code>private static int bar()</code> → modifier=[“PRIVATE”, “STATIC”]
- <code>abstract void baz()</code> → modifier=[“ABSTRACT”]</p>
<h3 id="nodes-call">nodes_call<a class="heading-anchor" href="#nodes-call" title="Link to this section">&para;</a></h3>
<p>Представляет вызовы функций/методов.</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_call</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">method_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">signature</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">dispatch_type</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">argument_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">filename</span><span class="w"> </span><span class="nx">VARCHAR</span>
<span class="p">);</span>

<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_call_method_full_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_call</span><span class="p">(</span><span class="nx">method_full_name</span><span class="p">);</span>
<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_call_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_call</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- METHOD_FULL_NAME: Целевой метод
- DISPATCH_TYPE: Механизм вызова (STATIC_DISPATCH, DYNAMIC_DISPATCH)
- TYPE_FULL_NAME: Возвращаемый тип
- SIGNATURE: Типы параметров</p>
<h3 id="nodes-identifier">nodes_identifier<a class="heading-anchor" href="#nodes-identifier" title="Link to this section">&para;</a></h3>
<p>Имена переменных и ссылок.</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_identifier</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">offset</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">           </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Байтовое</span><span class="w"> </span><span class="nx">смещение</span><span class="w"> </span><span class="nx">в</span><span class="w"> </span><span class="nx">файле</span>
<span class="w">    </span><span class="nx">offset_end</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">       </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Конечное</span><span class="w"> </span><span class="nx">байтовое</span><span class="w"> </span><span class="nx">смещение</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">argument_index</span><span class="w"> </span><span class="nx">INTEGER</span>
<span class="p">);</span>

<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_identifier_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_identifier</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- NAME: Идентификатор переменной
- TYPE_FULL_NAME: Тип переменной
- OFFSET/OFFSET_END: Точное расположение в исходном коде (Фаза 2)</p>
<h3 id="nodes-field-identifier">nodes_field_identifier<a class="heading-anchor" href="#nodes-field-identifier" title="Link to this section">&para;</a></h3>
<p>Идентификаторы доступа к полям (ООП — например, obj.field).</p>
<div class="highlight"><pre><span></span><code>CREATE TABLE nodes_field_identifier (
    id BIGINT PRIMARY KEY,
    canonical_name VARCHAR,  -- Нормализованное имя поля
    code TEXT,               -- Как отображается в коде
    line_number INTEGER,
    column_number INTEGER,
    offset INTEGER,
    offset_end INTEGER,
    order_index INTEGER,
    argument_index INTEGER
);

CREATE INDEX idx_field_identifier_canonical ON nodes_field_identifier(canonical_name);
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- CANONICAL_NAME: Нормализованное имя (например, “myField” для a.myField и b.myField)
- CODE: Доступ к полю в исходном виде (например, “obj.field”)
- Назначение: Определение обращений к полям в ООП-коде (критично для анализа псевдонимов)</p>
<p><strong>Пример:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">struct</span><span class="w"> </span><span class="n">Point</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="p">};</span>
<span class="n">Point</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="n">p.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="w"> </span>—<span class="w"> </span><span class="n">FIELD_IDENTIFIER</span><span class="w"> </span>с<span class="w"> </span><span class="n">canonical_name</span><span class="o">=</span><span class="s">&quot;x&quot;</span>
</code></pre></div>

<h3 id="nodes-literal">nodes_literal<a class="heading-anchor" href="#nodes-literal" title="Link to this section">&para;</a></h3>
<p>Константные значения.</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_literal</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">argument_index</span><span class="w"> </span><span class="nx">INTEGER</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- TYPE_FULL_NAME: Тип литерала
- CODE: Значение литерала</p>
<h3 id="nodes-local">nodes_local<a class="heading-anchor" href="#nodes-local" title="Link to this section">&para;</a></h3>
<p>Объявления локальных переменных.</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_local</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="kt">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="kt">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="kt">INTEGER</span>
<span class="p">);</span>

<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_local_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="nx">nodes_local</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- NAME: Имя локальной переменной
- TYPE_FULL_NAME: Объявленный тип</p>
<h3 id="nodes-param">nodes_param<a class="heading-anchor" href="#nodes-param" title="Link to this section">&para;</a></h3>
<p>Параметры метода (формальные параметры).</p>
<div class="highlight"><pre><span></span><code><span class="n">CREATE</span><span class="w"> </span><span class="n">TABLE</span><span class="w"> </span><span class="n">nodes_param</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">BIGINT</span><span class="w"> </span><span class="n">PRIMARY</span><span class="w"> </span><span class="n">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="n">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">index</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_variadic</span><span class="w"> </span><span class="n">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="n">evaluation_strategy</span><span class="w"> </span><span class="n">VARCHAR</span>
<span class="p">);</span>

<span class="n">CREATE</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="n">idx_param_name</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">nodes_param</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- INDEX: Позиция параметра
- IS_VARIADIC: Параметр переменной длины
- EVALUATION_STRATEGY: BY_VALUE, BY_REFERENCE, BY_SHARING</p>
<h3 id="nodes-param-out">nodes_param_out<a class="heading-anchor" href="#nodes-param-out" title="Link to this section">&para;</a></h3>
<p>Выходные параметры метода (для анализа SSA/потока данных).</p>
<div class="highlight"><pre><span></span><code><span class="n">CREATE</span><span class="w"> </span><span class="n">TABLE</span><span class="w"> </span><span class="n">nodes_param_out</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">BIGINT</span><span class="w"> </span><span class="n">PRIMARY</span><span class="w"> </span><span class="n">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">type_full_name</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="n">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">line_number</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">column_number</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">index</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_variadic</span><span class="w"> </span><span class="n">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="n">evaluation_strategy</span><span class="w"> </span><span class="n">VARCHAR</span>
<span class="p">);</span>

<span class="n">CREATE</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="n">idx_param_out_name</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">nodes_param_out</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Соответствует METHOD_PARAMETER_IN для анализа потока данных
- INDEX: Позиция параметра (совпадает с входным параметром)
- EVALUATION_STRATEGY: BY_VALUE, BY_REFERENCE, BY_SHARING
- Требуется для анализа SSA (Static Single Assignment)</p>
<h3 id="nodes-method-return">nodes_method_return<a class="heading-anchor" href="#nodes-method-return" title="Link to this section">&para;</a></h3>
<p>Параметр возврата метода (формальный возврат).</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_method_return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">evaluation_strategy</span><span class="w"> </span><span class="nx">VARCHAR</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- TYPE_FULL_NAME: Тип возврата
- CODE: Обычно “RET” или пусто
- EVALUATION_STRATEGY: Способ передачи возвращаемого значения
- Один на метод (формальный параметр возврата, не оператор return)</p>
<h3 id="nodes-return">nodes_return<a class="heading-anchor" href="#nodes-return" title="Link to this section">&para;</a></h3>
<p>Операторы возврата (фактический return в коде).</p>
<div class="highlight"><pre><span></span><code>CREATE TABLE nodes_return (
    id BIGINT PRIMARY KEY,
    code TEXT,
    line_number INTEGER,
    column_number INTEGER,
    order_index INTEGER,
    argument_index INTEGER
);
</code></pre></div>

<p><strong>Примечание:</strong> Это узел оператора RETURN. Отличается от METHOD_RETURN, который является формальным параметром возврата.</p>
<h3 id="nodes-block">nodes_block<a class="heading-anchor" href="#nodes-block" title="Link to this section">&para;</a></h3>
<p>Составные операторы (блоки кода).</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_block</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">argument_index</span><span class="w"> </span><span class="nx">INTEGER</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="nodes-control-structure">nodes_control_structure<a class="heading-anchor" href="#nodes-control-structure" title="Link to this section">&para;</a></h3>
<p>Конструкции управления потоком (if, while, for и т.д.).</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_control_structure</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">control_structure_type</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="nx">IF</span><span class="p">,</span><span class="w"> </span><span class="nx">WHILE</span><span class="p">,</span><span class="w"> </span><span class="nx">FOR</span><span class="p">,</span><span class="w"> </span><span class="nx">SWITCH</span><span class="p">,</span><span class="w"> </span><span class="nx">TRY</span><span class="w"> </span><span class="nx">и</span><span class="w"> </span><span class="nx">т</span><span class="p">.</span><span class="nx">д</span><span class="p">.</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">parser_type_name</span><span class="w"> </span><span class="nx">VARCHAR</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- CONTROL_STRUCTURE_TYPE: BREAK, CONTINUE, DO, WHILE, FOR, GOTO, IF, ELSE, TRY, THROW, SWITCH</p>
<h3 id="nodes-member">nodes_member<a class="heading-anchor" href="#nodes-member" title="Link to this section">&para;</a></h3>
<p>Члены типов (поля классов/структур).</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_member</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="w"> </span><span class="nx">Тип</span><span class="w"> </span><span class="nx">поля</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span><span class="w">               </span><span class="o">--</span><span class="w"> </span><span class="nx">Код</span><span class="w"> </span><span class="nx">объявления</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">offset</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">          </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Байтовое</span><span class="w"> </span><span class="nx">смещение</span>
<span class="w">    </span><span class="nx">offset_end</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">      </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Конечное</span><span class="w"> </span><span class="nx">байтовое</span><span class="w"> </span><span class="nx">смещение</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">ast_parent_type</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="nx">Обычно</span><span class="w"> </span><span class="s">&quot;TYPE_DECL&quot;</span>
<span class="w">    </span><span class="nx">ast_parent_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span>
<span class="p">);</span>

<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_member_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_member</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_member_parent</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_member</span><span class="p">(</span><span class="nx">ast_parent_full_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- NAME: Имя члена (например, “x”, “y”)
- TYPE_FULL_NAME: Тип члена (например, “int”, “std::string”)
- AST_PARENT_FULL_NAME: Содержащий тип
- Назначение: Представление полей/членов классов/структур</p>
<p><strong>Пример:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">struct</span><span class="w"> </span><span class="n">Point</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">     </span><span class="o">//</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">MEMBER</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">type_full_name</span><span class="o">=</span><span class="s">&quot;int&quot;</span>
<span class="w">    </span><span class="n">int</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">     </span><span class="o">//</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">MEMBER</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">type_full_name</span><span class="o">=</span><span class="s">&quot;int&quot;</span>
<span class="p">};</span>
</code></pre></div>

<h3 id="nodes-type-decl">nodes_type_decl<a class="heading-anchor" href="#nodes-type-decl" title="Link to this section">&para;</a></h3>
<p>Объявления типов (классы, структуры).</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_type_decl</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">is_external</span><span class="w"> </span><span class="nx">BOOLEAN</span><span class="p">,</span>
<span class="w">    </span><span class="nx">inherits_from_type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">alias_type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">filename</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">offset</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">          </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Байтовое</span><span class="w"> </span><span class="nx">смещение</span>
<span class="w">    </span><span class="nx">offset_end</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span><span class="w">      </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Конечное</span><span class="w"> </span><span class="nx">байтовое</span><span class="w"> </span><span class="nx">смещение</span>
<span class="w">    </span><span class="nx">ast_parent_type</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">ast_parent_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="nx">modifier</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">[]</span><span class="w">       </span><span class="o">--</span><span class="w"> </span><span class="nx">НОВОЕ</span><span class="p">:</span><span class="w"> </span><span class="nx">Модификаторы</span><span class="w"> </span><span class="nx">доступа</span><span class="w"> </span><span class="p">(</span><span class="nx">PUBLIC</span><span class="p">,</span><span class="w"> </span><span class="nx">PRIVATE</span><span class="w"> </span><span class="nx">и</span><span class="w"> </span><span class="nx">т</span><span class="p">.</span><span class="nx">д</span><span class="p">.)</span>
<span class="p">);</span>

<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_type_decl_full_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_type_decl</span><span class="p">(</span><span class="nx">full_name</span><span class="p">);</span>
<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_type_decl_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_type_decl</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- FULL_NAME, NAME: Идентификация типа
- IS_EXTERNAL: Определён ли в исходном коде
- INHERITS_FROM_TYPE_FULL_NAME: Базовые типы (массив)
- ALIAS_TYPE_FULL_NAME: Псевдоним типа
- MODIFIER: Модификаторы доступа (Фаза 2 - НОВОЕ!)
  - Значения: STATIC, PUBLIC, PROTECTED, PRIVATE, ABSTRACT, NATIVE, CONSTRUCTOR, VIRTUAL, INTERNAL, FINAL, READONLY, MODULE</p>
<p><strong>Примеры модификаторов:</strong>
- <code>public class Foo</code> → modifier=[“PUBLIC”]
- <code>private static class Bar</code> → modifier=[“PRIVATE”, “STATIC”]
- <code>abstract class Baz</code> → modifier=[“ABSTRACT”]</p>
<h3 id="nodes-metadata">nodes_metadata<a class="heading-anchor" href="#nodes-metadata" title="Link to this section">&para;</a></h3>
<p>Метаданные CPG (требуются спецификацией).</p>
<div class="highlight"><pre><span></span><code>CREATE TABLE nodes_metadata (
    id BIGINT PRIMARY KEY,
    language VARCHAR,
    version VARCHAR, -- &quot;1.1&quot;
    overlays VARCHAR[],
    root VARCHAR
);
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- LANGUAGE: Язык исходного кода
- VERSION: Версия спецификации CPG
- OVERLAYS: Применённые оверлеи
- ROOT: Корневой путь</p>
<h3 id="nodes-file">nodes_file<a class="heading-anchor" href="#nodes-file" title="Link to this section">&para;</a></h3>
<p>Узлы исходных файлов (требуются спецификацией).</p>
<div class="highlight"><pre><span></span><code><span class="nt">CREATE</span><span class="w"> </span><span class="nt">TABLE</span><span class="w"> </span><span class="nt">nodes_file</span><span class="w"> </span><span class="o">(</span>
<span class="w">    </span><span class="nt">id</span><span class="w"> </span><span class="nt">BIGINT</span><span class="w"> </span><span class="nt">PRIMARY</span><span class="w"> </span><span class="nt">KEY</span><span class="o">,</span>
<span class="w">    </span><span class="nt">name</span><span class="w"> </span><span class="nt">VARCHAR</span><span class="o">,</span><span class="w">           </span><span class="nt">--</span><span class="w"> </span><span class="nt">Путь</span><span class="w"> </span><span class="nt">к</span><span class="w"> </span><span class="nt">файлу</span><span class="w"> </span><span class="o">(</span><span class="nt">относительно</span><span class="w"> </span><span class="nt">корня</span><span class="o">)</span>
<span class="w">    </span><span class="nt">hash</span><span class="w"> </span><span class="nt">VARCHAR</span><span class="o">,</span><span class="w">           </span><span class="nt">--</span><span class="w"> </span><span class="nt">Хеш</span><span class="w"> </span><span class="nt">содержимого</span><span class="w"> </span><span class="nt">файла</span>
<span class="w">    </span><span class="nt">content</span><span class="w"> </span><span class="nt">TEXT</span><span class="o">,</span><span class="w">           </span><span class="nt">--</span><span class="w"> </span><span class="nt">Опционально</span><span class="o">:</span><span class="w"> </span><span class="nt">исходный</span><span class="w"> </span><span class="nt">код</span><span class="w"> </span><span class="nt">файла</span>
<span class="w">    </span><span class="nt">order_index</span><span class="w"> </span><span class="nt">INTEGER</span>
<span class="o">);</span>

<span class="nt">CREATE</span><span class="w"> </span><span class="nt">INDEX</span><span class="w"> </span><span class="nt">idx_file_name</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">nodes_file</span><span class="o">(</span><span class="nt">name</span><span class="o">);</span>
<span class="nt">CREATE</span><span class="w"> </span><span class="nt">INDEX</span><span class="w"> </span><span class="nt">idx_file_hash</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">nodes_file</span><span class="o">(</span><span class="nt">hash</span><span class="o">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- NAME: Путь к файлу относительно корня (из METADATA.ROOT)
- HASH: Хеш SHA-256 или MD5 содержимого файла
- CONTENT: Опционально — полный исходный код файла
- ORDER_INDEX: Всегда 0 (у файлов нет соседей)</p>
<p><strong>Назначение:</strong>
- Индекс для поиска всех элементов кода по файлу
- Корневые узлы деревьев синтаксического анализа (AST)
- Хранение метаданных исходных файлов
- Требуется для рёбер SOURCE_FILE</p>
<p><strong>Пример:</strong></p>
<div class="highlight"><pre><span></span><code>name=&quot;src/main.c&quot;, hash=&quot;abc123...&quot;, order_index=0
</code></pre></div>

<p><strong>Примечание:</strong> Каждый исходный файл ДОЛЖЕН иметь ровно один узел FILE. Узлы FILE служат корнями AST и позволяют переходить от файла ко всем содержащимся в нём элементам кода.</p>
<h3 id="nodes-namespace-block">nodes_namespace_block<a class="heading-anchor" href="#nodes-namespace-block" title="Link to this section">&para;</a></h3>
<p>Узлы блоков пространств имён (области видимости пространств имён).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="k">name</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span><span class="w">           </span><span class="c1">-- Имя пространства имён (с точками)</span>
<span class="w">    </span><span class="n">full_name</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span><span class="w">      </span><span class="c1">-- Уникальный идентификатор (файл + пространство имён)</span>
<span class="w">    </span><span class="n">filename</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span><span class="w">       </span><span class="c1">-- Содержащий файл</span>
<span class="w">    </span><span class="n">order_index</span><span class="w"> </span><span class="n">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_namespace_block_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="p">(</span><span class="k">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_namespace_block_full_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="p">(</span><span class="n">full_name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_namespace_block_filename</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_namespace_block</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- NAME: Человекочитаемое имя пространства имён (например, “foo.bar”)
  - С точками: “foo.bar” означает пространство имён “bar” внутри “foo”
- FULL_NAME: Уникальный идентификатор, объединяющий файл и пространство имён
  - Должен включать информацию о файле для обеспечения уникальности
- FILENAME: Исходный файл, содержащий этот блок пространства имён
- ORDER_INDEX: Позиция в родительском AST</p>
<p><strong>Назначение:</strong>
- Представление блоков пространств имён (C++ <code>namespace{}</code>, Java <code>package</code>)
- Структурирование кода на логические единицы
- Возможность запросов к коду по пространству имён
- Поддержка анализа многокомпонентных пространств имён</p>
<p><strong>Примеры:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// C++:</span>
<span class="kn">namespace</span><span class="w"> </span><span class="nx">foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">namespace</span><span class="w"> </span><span class="nx">bar</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// код</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// NAME=&quot;foo.bar&quot;, FULL_NAME=&quot;main.cpp:foo.bar&quot;</span>

<span class="c1">// Java:</span>
<span class="kn">package</span><span class="w"> </span><span class="nx">com</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">myapp</span><span class="p">;</span>
<span class="c1">// NAME=&quot;com.example.myapp&quot;, FULL_NAME=&quot;Main.java:com.example.myapp&quot;</span>
</code></pre></div>

<p><strong>Примечание:</strong> Узлы NAMESPACE (индексы) автоматически генерируются из узлов NAMESPACE_BLOCK при загрузке CPG.</p>
<h3 id="nodes-method-ref">nodes_method_ref<a class="heading-anchor" href="#nodes-method-ref" title="Link to this section">&para;</a></h3>
<p>Узлы ссылок на методы (метод как значение).</p>
<div class="highlight"><pre><span></span><code><span class="nx">CREATE</span><span class="w"> </span><span class="nx">TABLE</span><span class="w"> </span><span class="nx">nodes_method_ref</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">id</span><span class="w"> </span><span class="nx">BIGINT</span><span class="w"> </span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="nx">method_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="w"> </span><span class="nx">Полное</span><span class="w"> </span><span class="nx">имя</span><span class="w"> </span><span class="nx">ссылочного</span><span class="w"> </span><span class="nx">метода</span>
<span class="w">    </span><span class="nx">type_full_name</span><span class="w"> </span><span class="nx">VARCHAR</span><span class="p">,</span><span class="w">    </span><span class="o">--</span><span class="w"> </span><span class="nx">Тип</span><span class="w"> </span><span class="nx">метода</span><span class="w"> </span><span class="p">(</span><span class="nx">тип</span><span class="w"> </span><span class="nx">указателя</span><span class="w"> </span><span class="nx">на</span><span class="w"> </span><span class="nx">функцию</span><span class="p">)</span>
<span class="w">    </span><span class="nx">code</span><span class="w"> </span><span class="nx">TEXT</span><span class="p">,</span><span class="w">                 </span><span class="o">--</span><span class="w"> </span><span class="nx">Как</span><span class="w"> </span><span class="nx">отображается</span><span class="w"> </span><span class="nx">в</span><span class="w"> </span><span class="nx">коде</span>
<span class="w">    </span><span class="nx">line_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">column_number</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;offset&quot;</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;offset_end&quot;</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">order_index</span><span class="w"> </span><span class="nx">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="nx">argument_index</span><span class="w"> </span><span class="nx">INTEGER</span>
<span class="p">);</span>

<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_method_ref_method_full_name</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_method_ref</span><span class="p">(</span><span class="nx">method_full_name</span><span class="p">);</span>
<span class="nx">CREATE</span><span class="w"> </span><span class="nx">INDEX</span><span class="w"> </span><span class="nx">idx_method_ref_type</span><span class="w"> </span><span class="nx">ON</span><span class="w"> </span><span class="nx">nodes_method_ref</span><span class="p">(</span><span class="nx">type_full_name</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- METHOD_FULL_NAME: Полное имя ссылочного метода
- TYPE_FULL_NAME: Тип метода (например, “int(*)(int, int)” в C)
- CODE: Как ссылка отображается в исходном коде
- OFFSET/OFFSET_END: Точное расположение в исходном коде</p>
<p><strong>Назначение:</strong>
- Представление методов, передаваемых как аргументы (функции высшего порядка)
- Указ</p>
<h2 id="edge-tables">Таблицы рёбер<a class="heading-anchor" href="#edge-tables" title="Link to this section">&para;</a></h2>
<h3 id="edges-ast">edges_ast<a class="heading-anchor" href="#edges-ast" title="Link to this section">&para;</a></h3>
<p>Рёбра дерева абстрактного синтаксиса (отношения «родитель-потомок»).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_ast</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ast_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ast</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ast_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ast</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-cfg">edges_cfg<a class="heading-anchor" href="#edges-cfg" title="Link to this section">&para;</a></h3>
<p>Рёбра графа потока управления (Control Flow Graph).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_cfg</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cfg_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cfg</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cfg_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cfg</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-call">edges_call<a class="heading-anchor" href="#edges-call" title="Link to this section">&para;</a></h3>
<p>Рёбра от вызова метода к его объявлению.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_call</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла CALL</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла METHOD</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_call_edge_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_call</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_call_edge_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_call</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-ref">edges_ref<a class="heading-anchor" href="#edges-ref" title="Link to this section">&para;</a></h3>
<p>Рёбра ссылок (идентификатор → объявление).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_ref</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла IDENTIFIER/CALL</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла DECLARATION (LOCAL, PARAM, METHOD, TYPE_DECL)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ref_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ref</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_ref_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_ref</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-reaching-def">edges_reaching_def<a class="heading-anchor" href="#edges-reaching-def" title="Link to this section">&para;</a></h3>
<p>Рёбра потока данных (достижимые определения).</p>
<div class="highlight"><pre><span></span><code><span class="n">CREATE</span><span class="w"> </span><span class="n">TABLE</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">variable</span><span class="w"> </span><span class="n">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="err">Имя</span><span class="w"> </span><span class="err">переменной</span>
<span class="w">    </span><span class="n">PRIMARY</span><span class="w"> </span><span class="n">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">CREATE</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="n">idx_reaching_def_src</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="n">CREATE</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="n">idx_reaching_def_dst</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
<span class="n">CREATE</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="n">idx_reaching_def_variable</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">edges_reaching_def</span><span class="p">(</span><span class="n">variable</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- VARIABLE: имя отслеживаемой переменной</p>
<h3 id="edges-argument">edges_argument<a class="heading-anchor" href="#edges-argument" title="Link to this section">&para;</a></h3>
<p>Рёбра аргументов (вызов → выражения аргументов, возврат → возвращаемое выражение).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_argument</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_argument_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_argument</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_argument_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_argument</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-receiver">edges_receiver<a class="heading-anchor" href="#edges-receiver" title="Link to this section">&para;</a></h3>
<p>Рёбра получателя (вызов → выражение-получатель).</p>
<div class="highlight"><pre><span></span><code>CREATE TABLE edges_receiver (
    src BIGINT, -- ID узла CALL
    dst BIGINT, -- ID выражения-получателя
    PRIMARY KEY (src, dst)
);
</code></pre></div>

<h3 id="edges-condition">edges_condition<a class="heading-anchor" href="#edges-condition" title="Link to this section">&para;</a></h3>
<p>Рёбра условия (управляющая структура → условное выражение).</p>
<div class="highlight"><pre><span></span><code>CREATE TABLE edges_condition (
    src BIGINT, -- ID узла CONTROL_STRUCTURE
    dst BIGINT, -- ID узла выражения
    PRIMARY KEY (src, dst)
);
</code></pre></div>

<h3 id="edges-dominate">edges_dominate<a class="heading-anchor" href="#edges-dominate" title="Link to this section">&para;</a></h3>
<p>Рёбра непосредственного доминирования (доминирование в потоке управления).</p>
<div class="highlight"><pre><span></span><code>CREATE TABLE edges_dominate (
    src BIGINT,
    dst BIGINT,
    PRIMARY KEY (src, dst)
);
</code></pre></div>

<h3 id="edges-post-dominate">edges_post_dominate<a class="heading-anchor" href="#edges-post-dominate" title="Link to this section">&para;</a></h3>
<p>Рёбра пост-доминирования.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_post_dominate</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_post_dominate_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_post_dominate</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_post_dominate_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_post_dominate</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<h3 id="edges-cdg">edges_cdg<a class="heading-anchor" href="#edges-cdg" title="Link to this section">&para;</a></h3>
<p>Рёбра графа управляющих зависимостей (CRITICAL для PDG).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_cdg</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла управляющей структуры (условие/ветвление)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID зависимого узла (кода, зависящего от условия)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cdg_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cdg</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cdg_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_cdg</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Ребро CDG означает: dst зависит от src по управлению
- Критически важно для построения графа зависимостей программы (PDG = DDG + CDG)
- Используется для срезов программы, анализа безопасности, оптимизаций компилятора
- Пример: операторы внутри блока IF зависят по управлению от условия IF</p>
<h3 id="edges-binds">edges_binds<a class="heading-anchor" href="#edges-binds" title="Link to this section">&para;</a></h3>
<p>Рёбра привязки имён (связывание имён).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_binds</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла BINDING</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла METHOD или TYPE_DECL</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Связывает узлы BINDING с их объявлениями
- Используется для разрешения имён переменных и функций
- Пример: оператор import связывает имя с фактическим определением</p>
<h3 id="edges-binds-to">edges_binds_to<a class="heading-anchor" href="#edges-binds-to" title="Link to this section">&para;</a></h3>
<p>Обратные рёбра привязки (использование имён).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_binds_to</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла ссылки на переменную/функцию</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID узла BINDING</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_to_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds_to</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_binds_to_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_binds_to</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Обратное ребро к ребру BINDS
- Связывает использование имён с их привязками
- Пример: ссылка на переменную → привязка → объявление</p>
<p><strong>Последовательность BINDS:</strong></p>
<div class="highlight"><pre><span></span><code>Объявление (METHOD/TYPE_DECL)
     ↑
   BINDS
     |
  Узел BINDING (оператор import/using)
     ↑
 BINDS_TO
     |
Ссылка (IDENTIFIER/CALL)
</code></pre></div>

<h3 id="edges-source-file">edges_source_file<a class="heading-anchor" href="#edges-source-file" title="Link to this section">&para;</a></h3>
<p>Рёбра исходного файла (сопоставление узлов с файлом).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_source_file</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- ID любого узла AST</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- ID узла FILE</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_source_file_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_source_file</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_source_file_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_source_file</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Связывает узлы с их исходным файлом FILE
- Создаётся автоматически на основе свойства FILENAME
- <strong>НЕ ДОЛЖНО создаваться языковым фронтендом</strong> — создаётся автоматически
- Отношение один к одному: каждый узел имеет ровно один исходный файл</p>
<p><strong>Назначение:</strong>
- Сопоставление любого элемента кода с его исходным файлом
- Навигация от FILE ко всем содержащимся элементам
- Поддержка запросов и анализа на уровне файлов
- Реализация функции IDE «перейти к файлу»</p>
<p><strong>Пример:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nx">Узел</span><span class="w"> </span><span class="nx">METHOD</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">SOURCE_FILE</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">Узел</span><span class="w"> </span><span class="nx">FILE</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">=</span><span class="s">&quot;main.c&quot;</span><span class="p">)</span>
<span class="nx">Узел</span><span class="w"> </span><span class="nx">CALL</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">SOURCE_FILE</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">Узел</span><span class="w"> </span><span class="nx">FILE</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">=</span><span class="s">&quot;main.c&quot;</span><span class="p">)</span>
<span class="nx">Узел</span><span class="w"> </span><span class="nx">TYPE_DECL</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">300</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">SOURCE_FILE</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nx">Узел</span><span class="w"> </span><span class="nx">FILE</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">=</span><span class="s">&quot;types.h&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Логика автоматического создания:</strong>
1. Фронтенд устанавливает свойство FILENAME на узлах (METHOD, TYPE_DECL и т.д.)
2. Загрузчик CPG создаёт узлы FILE для уникальных имён файлов
3. Загрузчик CPG создаёт рёбра SOURCE_FILE от узлов к узлам FILE
4. Результат — полное сопоставление файл → код</p>
<h3 id="edges-alias-of">edges_alias_of<a class="heading-anchor" href="#edges-alias-of" title="Link to this section">&para;</a></h3>
<p>Рёбра псевдонимов типов.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_alias_of</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел TYPE_DECL (псевдоним)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел TYPE (фактический тип)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_alias_of_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_alias_of</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_alias_of_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_alias_of</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Связывает TYPE_DECL (псевдоним) с TYPE (фактическим типом)
- <strong>НЕ ДОЛЖНО создаваться фронтендом</strong> — создаётся автоматически из ALIAS_TYPE_FULL_NAME
- Отношение один к одному</p>
<p><strong>Назначение:</strong>
- Представление псевдонимов типов (typedef в C, using, type aliases)
- Поддержка разрешения псевдонимов
- Анализ синонимов типов</p>
<p><strong>Примеры:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// typedef в C:</span>
<span class="nx">typedef</span><span class="w"> </span><span class="nx">int</span><span class="w"> </span><span class="nx">Integer</span><span class="p">;</span>
<span class="c1">// TYPE_DECL &quot;Integer&quot; --ALIAS_OF--&gt; TYPE &quot;int&quot;</span>

<span class="c1">// using в C++:</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">String</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">std</span><span class="o">::</span><span class="kt">string</span><span class="p">;</span>
<span class="c1">// TYPE_DECL &quot;String&quot; --ALIAS_OF--&gt; TYPE &quot;std::string&quot;</span>

<span class="c1">// Псевдоним типа в Rust:</span>
<span class="k">type</span><span class="w"> </span><span class="nx">Result</span><span class="p">&lt;</span><span class="nx">T</span><span class="p">&gt;</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">std</span><span class="o">::</span><span class="nx">result</span><span class="o">::</span><span class="nx">Result</span><span class="p">&lt;</span><span class="nx">T</span><span class="p">,</span><span class="w"> </span><span class="nx">Error</span><span class="p">&gt;;</span>
<span class="c1">// TYPE_DECL &quot;Result&quot; --ALIAS_OF--&gt; TYPE &quot;std::result::Result&quot;</span>
</code></pre></div>

<p><strong>Примечание:</strong> Автоматически генерируется при загрузке CPG на основе свойства ALIAS_TYPE_FULL_NAME.</p>
<h3 id="edges-inherits-from">edges_inherits_from<a class="heading-anchor" href="#edges-inherits-from" title="Link to this section">&para;</a></h3>
<p>Рёбра наследования типов.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_inherits_from</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел TYPE_DECL (производный)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел TYPE (базовый)</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_inherits_from_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_inherits_from</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_inherits_from_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_inherits_from</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Связывает TYPE_DECL (производный) с TYPE (базовым)
- <strong>НЕ ДОЛЖНО создаваться фронтендом</strong> — создаётся автоматически из INHERITS_FROM_TYPE_FULL_NAME
- Отношение один ко многим (поддерживается множественное наследование)</p>
<p><strong>Назначение:</strong>
- Представление наследования классов/интерфейсов
- Поддержка анализа полиморфизма
- Запросы к иерархии типов
- Отслеживание цепочек наследования</p>
<p><strong>Примеры:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">Одиночное</span><span class="w"> </span><span class="err">наследование</span><span class="w"> </span><span class="err">в</span><span class="w"> </span><span class="n">Java</span><span class="p">:</span>
<span class="k">class</span><span class="w"> </span><span class="n">Dog</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">Comparable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">...</span>
<span class="p">}</span>
<span class="o">//</span><span class="w"> </span><span class="n">TYPE_DECL</span><span class="w"> </span><span class="s2">&quot;Dog&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">INHERITS_FROM</span><span class="o">--&gt;</span><span class="w"> </span><span class="n">TYPE</span><span class="w"> </span><span class="s2">&quot;Animal&quot;</span>
<span class="o">//</span><span class="w"> </span><span class="n">TYPE_DECL</span><span class="w"> </span><span class="s2">&quot;Dog&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">INHERITS_FROM</span><span class="o">--&gt;</span><span class="w"> </span><span class="n">TYPE</span><span class="w"> </span><span class="s2">&quot;Comparable&quot;</span>

<span class="o">//</span><span class="w"> </span><span class="err">Множественное</span><span class="w"> </span><span class="err">наследование</span><span class="w"> </span><span class="err">в</span><span class="w"> </span><span class="n">C</span><span class="o">++</span><span class="p">:</span>
<span class="k">class</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
<span class="o">//</span><span class="w"> </span><span class="n">TYPE_DECL</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">INHERITS_FROM</span><span class="o">--&gt;</span><span class="w"> </span><span class="n">TYPE</span><span class="w"> </span><span class="s2">&quot;A&quot;</span>
<span class="o">//</span><span class="w"> </span><span class="n">TYPE_DECL</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">INHERITS_FROM</span><span class="o">--&gt;</span><span class="w"> </span><span class="n">TYPE</span><span class="w"> </span><span class="s2">&quot;B&quot;</span>
</code></pre></div>

<p><strong>Примечание:</strong> Автоматически генерируется при загрузке CPG на основе массива INHERITS_FROM_TYPE_FULL_NAME.</p>
<h3 id="edges-capture">edges_capture<a class="heading-anchor" href="#edges-capture" title="Link to this section">&para;</a></h3>
<p>Рёбра захвата замыканий.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_capture</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел METHOD_REF или TYPE_REF</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел CLOSURE_BINDING</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_capture_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_capture</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_capture_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_capture</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Связывает METHOD_REF/TYPE_REF с CLOSURE_BINDING
- Представляет захват переменных в замыкании/лямбде
- Отношение один ко многим (замыкание может захватывать несколько переменных)</p>
<p><strong>Назначение:</strong>
- Отслеживание переменных, захваченных замыканиями
- Поддержка анализа выхода за пределы области видимости (escape analysis)
- Оптимизация замыканий
- Определение времени жизни захваченных переменных</p>
<p><strong>Примеры:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kr">function</span><span class="w"> </span><span class="kr">outer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="kr">function</span><span class="w"> </span><span class="n">inner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">  </span><span class="c1">// захватывает x и y</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
<span class="c1">// METHOD_REF &quot;inner&quot; --CAPTURE--&gt; CLOSURE_BINDING для x</span>
<span class="c1">// METHOD_REF &quot;inner&quot; --CAPTURE--&gt; CLOSURE_BINDING для y</span>
</code></pre></div>

<p><strong>Примечание:</strong> Ребро CAPTURE связывает замыкание с захваченными переменными.</p>
<h3 id="edges-captured-by">edges_captured_by<a class="heading-anchor" href="#edges-captured-by" title="Link to this section">&para;</a></h3>
<p>Обратные рёбра захвата замыканий.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_captured_by</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел LOCAL или METHOD_PARAMETER_IN</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Узел CLOSURE_BINDING</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_captured_by_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_captured_by</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_captured_by_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_captured_by</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства</strong> (из спецификации CPG):
- Связывает LOCAL/METHOD_PARAMETER_IN с CLOSURE_BINDING
- Обратное ребро к CAPTURE
- Указывает, какие замыкания захватывают данную переменную</p>
<p><strong>Назначение:</strong>
- Отслеживание замыканий, захватывающих переменную
- Определение переменных, выходящих за пределы области видимости
- Анализ времени жизни переменных
- Поддержка рефакторинга, связанного с замыканиями</p>
<p><strong>Примеры:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">make_counter</span><span class="p">()</span><span class="o">:</span>
<span class="w">    </span><span class="nf">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="kr">LOCAL</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">increment</span><span class="p">()</span><span class="o">:</span>
<span class="w">        </span><span class="n">nonlocal</span><span class="w"> </span><span class="nf">count</span>
<span class="w">        </span><span class="nf">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="nf">count</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">increment</span>
<span class="cp"># LOCAL &quot;count&quot; --CAPTURED_BY--&gt; CLOSURE_BINDING {#local-count---captured-by---closure-binding}</span>
</code></pre></div>

<p><strong>Последовательность для замыканий:</strong></p>
<div class="highlight"><pre><span></span><code>LOCAL/PARAM &quot;x&quot;
     |
CAPTURED_BY
     ↓
CLOSURE_BINDING
     ↑
  CAPTURE
     |
METHOD_REF (замыкание/лямбда)
</code></pre></div>

<p><strong>Примечание:</strong> CAPTURED_BY связывает захваченную переменную с привязкой замыкания.</p>
<h2 id="property-graph-definition">Определение графа свойств<a class="heading-anchor" href="#property-graph-definition" title="Link to this section">&para;</a></h2>
<p>Использование duckpgq для создания объединённого графа свойств с полной поддержкой схемы CPG.</p>
<p><strong>КЛЮЧЕВАЯ ИДЕЯ</strong>: DuckDB PGQ не поддерживает представления (views) в вершинных таблицах (VERTEX TABLES), но мы можем использовать <strong>материализованные таблицы</strong> вместо них! Это позволяет полностью поддерживать полиморфные рёбра.</p>
<h3 id="step-1-create-materialized-unified-nodes-table">Шаг 1: Создание материализованной объединённой таблицы узлов<a class="heading-anchor" href="#step-1-create-materialized-unified-nodes-table" title="Link to this section">&para;</a></h3>
<p><strong>Важно</strong>: Используйте <code>CREATE TABLE</code> (а не <code>CREATE VIEW</code>), чтобы материализовать объединённый набор узлов.</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Создание материализованной объединённой таблицы всех узлов CPG для поддержки полиморфных рёбер</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="p">;</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="k">AS</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FILE&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">node_type</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_file</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NAMESPACE_BLOCK&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_namespace_block</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;METHOD&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;METHOD_REF&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method_ref</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CALL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_call</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;IDENTIFIER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_identifier</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FIELD_IDENTIFIER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_field_identifier</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LITERAL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_literal</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LOCAL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_local</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PARAM&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_param</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PARAM_OUT&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_param_out</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;METHOD_RETURN&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method_return</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;RETURN&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_return</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BLOCK&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_block</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONTROL_STRUCTURE&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_control_structure</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MEMBER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_member</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_DECL&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_decl</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_REF&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_ref</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_PARAMETER&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_parameter</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TYPE_ARGUMENT&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_type_argument</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;UNKNOWN&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_unknown</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JUMP_TARGET&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_jump_target</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BINDING&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_binding</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CLOSURE_BINDING&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_closure_binding</span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;COMMENT&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nodes_comment</span><span class="p">;</span>

<span class="c1">-- Добавление первичного ключа и индексов</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cpg_nodes_type</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="p">(</span><span class="n">node_type</span><span class="p">);</span>
</code></pre></div>

<h3 id="step-2-create-comprehensive-property-graph">Шаг 2: Создание комплексного графа свойств<a class="heading-anchor" href="#step-2-create-comprehensive-property-graph" title="Link to this section">&para;</a></h3>
<p><strong>Полная реализация</strong> (со всеми типами рёбер, включая полиморфные):</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">PROPERTY</span><span class="w"> </span><span class="k">GRAPH</span><span class="w"> </span><span class="n">cpg</span>
<span class="n">VERTEX</span><span class="w"> </span><span class="k">TABLES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- Материализованная объединённая таблица узлов для поддержки полиморфных рёбер</span>
<span class="w">    </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CPG_NODE</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- Отдельные типизированные таблицы узлов для специфических запросов</span>
<span class="w">    </span><span class="n">nodes_file</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">FILE_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_namespace_block</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">NAMESPACE_BLOCK</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_method</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">METHOD</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_method_ref</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">METHOD_REF</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_call</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CALL_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_identifier</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">IDENTIFIER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_field_identifier</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">FIELD_IDENTIFIER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_literal</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">LITERAL</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_local</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">LOCAL</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_param</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">PARAM</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_param_out</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">PARAM_OUT</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_method_return</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">METHOD_RETURN</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_return</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">RETURN_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_block</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_control_structure</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CONTROL_STRUCTURE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_member</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">MEMBER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_decl</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">TYPE_DECL</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_ref</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">TYPE_REF</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_parameter</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">TYPE_PARAMETER</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_type_argument</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">TYPE_ARGUMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_unknown</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="no">UNKNOWN</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_jump_target</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">JUMP_TARGET</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_binding</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">BINDING</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_closure_binding</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CLOSURE_BINDING</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_comment</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="n">COMMENT_NODE</span><span class="p">,</span>
<span class="w">    </span><span class="n">nodes_metadata</span><span class="w"> </span><span class="k">LABEL</span><span class="w"> </span><span class="k">METADATA</span>
<span class="p">)</span>
<span class="k">EDGE</span><span class="w"> </span><span class="k">TABLES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- ========================================</span>
<span class="w">    </span><span class="c1">-- ПОЛИМОРФНЫЕ РЁБРА (через таблицу cpg_nodes)</span>
<span class="w">    </span><span class="c1">-- ========================================</span>

<span class="w">    </span><span class="n">edges_ast</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">AST</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_cfg</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CFG</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_ref</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">REF</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_reaching_def</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">REACHING_DEF</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_argument</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">ARGUMENT</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_dominate</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">DOMINATE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_post_dominate</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">POST_DOMINATE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_cdg</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CDG</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_binds</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">BINDS</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_binds_to</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">BINDS_TO</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- ========================================</span>
<span class="w">    </span><span class="c1">-- ТИПИЗИРОВАННЫЕ РЁБРА (конкретные источники/назначения)</span>
<span class="w">    </span><span class="c1">-- ========================================</span>

<span class="w">    </span><span class="n">edges_call</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CALLS</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_receiver</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_call</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">RECEIVER</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_condition</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_control_structure</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CONDITION</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_source_file</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_file</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">SOURCE_FILE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_alias_of</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_type_decl</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">ALIAS_OF</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_inherits_from</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_type_decl</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">INHERITS_FROM</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_capture</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_closure_binding</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CAPTURE</span><span class="p">,</span>

<span class="w">    </span><span class="n">edges_captured_by</span>
<span class="w">        </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">cpg_nodes</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">DESTINATION</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dst</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">nodes_closure_binding</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="k">LABEL</span><span class="w"> </span><span class="n">CAPTURED_BY</span>
<span class="p">);</span>
</code></pre></div>

<p><strong>Ключевые особенности</strong>:
- ✅ <strong>Полная поддержка схемы CPG</strong> со всеми типами рёбер
- ✅ <strong>Полиморфные рёбра</strong> (AST, CFG, REF и т.д.) через материализованную таблицу <code>cpg_nodes</code>
- ✅ <strong>Типизированные вершины</strong> для эффективных целевых запросов
- ✅ <strong>Совместимо с DuckDB PGQ</strong> (используются таблицы, а не представления)
- ✅ <strong>Полное соответствие спецификации Joern CPG v1.1</strong></p>
<h2 id="example-queries">Примеры запросов<a class="heading-anchor" href="#example-queries" title="Link to this section">&para;</a></h2>
<h3 id="standartnyy-sql-zapros-nayti-vse-vyzovy-opredelyonnogo-metoda">Стандартный SQL-запрос: Найти все вызовы определённого метода<a class="heading-anchor" href="#standartnyy-sql-zapros-nayti-vse-vyzovy-opredelyonnogo-metoda" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">SELECT</span><span class="w"> </span><span class="nt">c</span><span class="o">.*,</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">name</span><span class="o">,</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">filename</span><span class="o">,</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">line_number</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">nodes_call</span><span class="w"> </span><span class="nt">c</span>
<span class="nt">JOIN</span><span class="w"> </span><span class="nt">edges_call</span><span class="w"> </span><span class="nt">ec</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">ec</span><span class="p">.</span><span class="nc">src</span>
<span class="nt">JOIN</span><span class="w"> </span><span class="nt">nodes_method</span><span class="w"> </span><span class="nt">m</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">ec</span><span class="p">.</span><span class="nc">dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">id</span>
<span class="nt">WHERE</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">full_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;com.example.MyClass.myMethod:void()&#39;</span><span class="o">;</span>
</code></pre></div>

<h3 id="duckdb-pgq-zapros-nayti-pryamye-tsepochki-vyzovov-vyzyvayuschiy-vyzyvaemyy">DuckDB PGQ-запрос: Найти прямые цепочки вызовов (вызывающий -&gt; вызываемый)<a class="heading-anchor" href="#duckdb-pgq-zapros-nayti-pryamye-tsepochki-vyzovov-vyzyvayuschiy-vyzyvaemyy" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">GRAPH_TABLE</span><span class="o">(</span><span class="nt">cpg</span>
<span class="w">    </span><span class="nt">MATCH</span><span class="w"> </span><span class="o">(</span><span class="nt">caller</span><span class="p">:</span><span class="nd">METHOD</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">CALLS</span><span class="cp">]</span><span class="nt">-</span><span class="o">(</span><span class="nt">call</span><span class="p">:</span><span class="nd">CALL_NODE</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">CALLS</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">callee</span><span class="p">:</span><span class="nd">METHOD</span><span class="o">)</span>
<span class="w">    </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">caller</span><span class="p">.</span><span class="nc">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;main&#39;</span>
<span class="w">    </span><span class="nt">COLUMNS</span><span class="w"> </span><span class="o">(</span><span class="nt">caller</span><span class="p">.</span><span class="nc">full_name</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">caller_name</span><span class="o">,</span><span class="w"> </span><span class="nt">callee</span><span class="p">.</span><span class="nc">full_name</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">callee_name</span><span class="o">)</span>
<span class="o">);</span>
</code></pre></div>

<h3 id="duckdb-pgq-zapros-nayti-metody-i-ih-dochernie-uzly-ast">DuckDB PGQ-запрос: Найти методы и их дочерние узлы AST<a class="heading-anchor" href="#duckdb-pgq-zapros-nayti-metody-i-ih-dochernie-uzly-ast" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">GRAPH_TABLE</span><span class="o">(</span><span class="nt">cpg</span>
<span class="w">    </span><span class="nt">MATCH</span><span class="w"> </span><span class="o">(</span><span class="nt">m</span><span class="p">:</span><span class="nd">METHOD</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">AST</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">child</span><span class="p">:</span><span class="nd">CPG_NODE</span><span class="o">)</span>
<span class="w">    </span><span class="nt">COLUMNS</span><span class="w"> </span><span class="o">(</span><span class="nt">m</span><span class="p">.</span><span class="nc">full_name</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">method</span><span class="o">,</span><span class="w"> </span><span class="nt">child</span><span class="p">.</span><span class="nc">id</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">child_id</span><span class="o">)</span>
<span class="o">);</span>
</code></pre></div>

<h3 id="duckdb-pgq-zapros-puti-potoka-dannyh-s-ispolzovaniem-reaching-def">DuckDB PGQ-запрос: Пути потока данных с использованием REACHING_DEF<a class="heading-anchor" href="#duckdb-pgq-zapros-puti-potoka-dannyh-s-ispolzovaniem-reaching-def" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">GRAPH_TABLE</span><span class="o">(</span><span class="nt">cpg</span>
<span class="w">    </span><span class="nt">MATCH</span><span class="w"> </span><span class="o">(</span><span class="nt">source</span><span class="p">:</span><span class="nd">CPG_NODE</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">REACHING_DEF</span><span class="o">*</span><span class="mi">1</span><span class="nx">..5</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">sink</span><span class="p">:</span><span class="nd">CPG_NODE</span><span class="o">)</span>
<span class="w">    </span><span class="nt">COLUMNS</span><span class="w"> </span><span class="o">(</span><span class="nt">source</span><span class="p">.</span><span class="nc">id</span><span class="o">,</span><span class="w"> </span><span class="nt">sink</span><span class="p">.</span><span class="nc">id</span><span class="o">)</span>
<span class="o">)</span>
<span class="nt">LIMIT</span><span class="w"> </span><span class="nt">100</span><span class="o">;</span>
</code></pre></div>

<h3 id="duckdb-pgq-zapros-puti-cfg-upravlenie-vypolneniem">DuckDB PGQ-запрос: Пути CFG (управление выполнением)<a class="heading-anchor" href="#duckdb-pgq-zapros-puti-cfg-upravlenie-vypolneniem" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">GRAPH_TABLE</span><span class="o">(</span><span class="nt">cpg</span>
<span class="w">    </span><span class="nt">MATCH</span><span class="w"> </span><span class="o">(</span><span class="nt">start</span><span class="p">:</span><span class="nd">CPG_NODE</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">CFG</span><span class="o">*</span><span class="mi">1</span><span class="nx">..3</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">end</span><span class="p">:</span><span class="nd">CPG_NODE</span><span class="o">)</span>
<span class="w">    </span><span class="nt">COLUMNS</span><span class="w"> </span><span class="o">(</span><span class="nt">start</span><span class="p">.</span><span class="nc">id</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">start_node</span><span class="o">,</span><span class="w"> </span><span class="nt">end</span><span class="p">.</span><span class="nc">id</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">end_node</span><span class="o">)</span>
<span class="o">)</span>
<span class="nt">LIMIT</span><span class="w"> </span><span class="nt">100</span><span class="o">;</span>
</code></pre></div>

<h3 id="duckdb-pgq-zapros-nayti-vse-identifikatory-i-ih-ssylki">DuckDB PGQ-запрос: Найти все идентификаторы и их ссылки<a class="heading-anchor" href="#duckdb-pgq-zapros-nayti-vse-identifikatory-i-ih-ssylki" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">GRAPH_TABLE</span><span class="o">(</span><span class="nt">cpg</span>
<span class="w">    </span><span class="nt">MATCH</span><span class="w"> </span><span class="o">(</span><span class="nt">id</span><span class="p">:</span><span class="nd">IDENTIFIER</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">REF</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">decl</span><span class="p">:</span><span class="nd">CPG_NODE</span><span class="o">)</span>
<span class="w">    </span><span class="nt">COLUMNS</span><span class="w"> </span><span class="o">(</span><span class="nt">id</span><span class="p">.</span><span class="nc">name</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">identifier_name</span><span class="o">,</span><span class="w"> </span><span class="nt">decl</span><span class="p">.</span><span class="nc">id</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">declaration_id</span><span class="o">)</span>
<span class="o">);</span>
</code></pre></div>

<h3 id="duckdb-pgq-query-type-hierarchy-inheritance">DuckDB PGQ-запрос: Иерархия типов (наследование)<a class="heading-anchor" href="#duckdb-pgq-query-type-hierarchy-inheritance" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="nx">FROM</span><span class="w"> </span><span class="nx">GRAPH_TABLE</span><span class="p">(</span><span class="nx">cpg</span>
<span class="w">    </span><span class="nx">MATCH</span><span class="w"> </span><span class="p">(</span><span class="nx">derived</span><span class="p">:</span><span class="nx">TYPE_DECL</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="nx">INHERITS_FROM</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="kd">base</span><span class="p">:</span><span class="nx">CPG_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="nx">COLUMNS</span><span class="w"> </span><span class="p">(</span><span class="nx">derived</span><span class="p">.</span><span class="nx">full_name</span><span class="w"> </span><span class="nx">AS</span><span class="w"> </span><span class="nx">derived_type</span><span class="p">,</span><span class="w"> </span><span class="kd">base</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="nx">AS</span><span class="w"> </span><span class="nx">base_type</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="combined-query-methods-with-most-incoming-calls">Комбинированный запрос: Методы с наибольшим количеством входящих вызовов<a class="heading-anchor" href="#combined-query-methods-with-most-incoming-calls" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">SELECT</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">full_name</span><span class="o">,</span><span class="w"> </span><span class="nt">COUNT</span><span class="o">(*)</span><span class="w"> </span><span class="nt">as</span><span class="w"> </span><span class="nt">call_count</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">GRAPH_TABLE</span><span class="o">(</span><span class="nt">cpg</span>
<span class="w">    </span><span class="nt">MATCH</span><span class="w"> </span><span class="o">(</span><span class="nt">c</span><span class="p">:</span><span class="nd">CALL_NODE</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">CALLS</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">m</span><span class="p">:</span><span class="nd">METHOD</span><span class="o">)</span>
<span class="w">    </span><span class="nt">COLUMNS</span><span class="w"> </span><span class="o">(</span><span class="nt">m</span><span class="p">.</span><span class="nc">full_name</span><span class="o">,</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">id</span><span class="o">)</span>
<span class="o">)</span>
<span class="nt">GROUP</span><span class="w"> </span><span class="nt">BY</span><span class="w"> </span><span class="nt">m</span><span class="p">.</span><span class="nc">full_name</span>
<span class="nt">ORDER</span><span class="w"> </span><span class="nt">BY</span><span class="w"> </span><span class="nt">call_count</span><span class="w"> </span><span class="nt">DESC</span>
<span class="nt">LIMIT</span><span class="w"> </span><span class="nt">10</span><span class="o">;</span>
</code></pre></div>

<h2 id="migration-from-joern">Миграция с Joern<a class="heading-anchor" href="#migration-from-joern" title="Link to this section">&para;</a></h2>
<h3 id="phase-1-critical---completed-">Этап 1 (КРИТИЧЕСКИЙ) — ЗАВЕРШЁН ✓<a class="heading-anchor" href="#phase-1-critical---completed-" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ nodes_method (со всеми свойствами)</li>
<li>✓ nodes_call (с method_full_name, name, signature)</li>
<li>✓ edges_call (от места вызова к методу)</li>
<li>✓ nodes_param_out (METHOD_PARAMETER_OUT) — НОВОЕ!</li>
<li>✓ nodes_method_return (METHOD_RETURN) — НОВОЕ!</li>
<li>✓ edges_cdg (граф управляющих зависимостей, Control Dependence Graph) — НОВОЕ!</li>
</ul>
<h3 id="phase-2-oop-support---completed-">Этап 2 (ПОДДЕРЖКА ООП) — ЗАВЕРШЁН ✓<a class="heading-anchor" href="#phase-2-oop-support---completed-" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ nodes_field_identifier (FIELD_IDENTIFIER) — НОВОЕ!</li>
<li>✓ nodes_member (MEMBER) — НОВОЕ!</li>
<li>✓ свойства OFFSET/OFFSET_END для METHOD, TYPE_DECL, IDENTIFIER — НОВОЕ!</li>
<li>✓ свойство MODIFIER для METHOD, TYPE_DECL — НОВОЕ!</li>
<li>✓ edges_binds (BINDS) — НОВОЕ!</li>
<li>✓ edges_binds_to (BINDS_TO) — НОВОЕ!</li>
</ul>
<h3 id="phase-3-namespace-and-file-support---completed-">Этап 3 (ПОДДЕРЖКА ПРОСТРАНСТВ ИМЁН И ФАЙЛОВ) — ЗАВЕРШЁН ✓<a class="heading-anchor" href="#phase-3-namespace-and-file-support---completed-" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ nodes_file (FILE) — НОВОЕ!</li>
<li>✓ nodes_namespace_block (NAMESPACE_BLOCK) — НОВОЕ!</li>
<li>✓ nodes_method_ref (METHOD_REF) — НОВОЕ!</li>
<li>✓ nodes_type_ref (TYPE_REF) — НОВОЕ!</li>
<li>✓ edges_source_file (SOURCE_FILE) — НОВОЕ!</li>
</ul>
<h3 id="phase-4-remaining-features---completed-">Этап 4 (ОСТАВШИЕСЯ ФУНКЦИИ) — ЗАВЕРШЁН ✓<a class="heading-anchor" href="#phase-4-remaining-features---completed-" title="Link to this section">&para;</a></h3>
<ul>
<li>✓ Экспорт рёбер AST</li>
<li>✓ Экспорт рёбер CFG</li>
<li>✓ Экспорт рёбер REF, REACHING_DEF</li>
<li>✓ Экспорт дополнительных типов узлов (UNKNOWN, JUMP_TARGET, TYPE_PARAMETER, TYPE_ARGUMENT, BINDING, CLOSURE_BINDING, COMMENT)</li>
<li>✓ Экспорт оставшихся рёбер (ALIAS_OF, INHERITS_FROM, CAPTURE, CAPTURED_BY)</li>
</ul>
<h2 id="rekomendatsii-po-proizvoditelnosti">Рекомендации по производительности<a class="heading-anchor" href="#rekomendatsii-po-proizvoditelnosti" title="Link to this section">&para;</a></h2>
<ol>
<li><strong>Пакетная обработка</strong>: Используйте пакеты по 10 000 строк для операций INSERT</li>
<li><strong>Индексирование</strong>: Создавайте индексы после массовой загрузки для ускорения импорта</li>
<li><strong>Разделение на секции</strong>: Рассмотрите возможность секционирования по имени файла для крупных кодовых баз</li>
<li><strong>Сжатие</strong>: Используйте автоматическое сжатие DuckDB для столбцов типа TEXT</li>
<li><strong>Память</strong>: Настройте лимит памяти DuckDB в зависимости от размера CPG</li>
</ol>
<h2 id="schema-version">Версия схемы<a class="heading-anchor" href="#schema-version" title="Link to this section">&para;</a></h2>
<ul>
<li>Спецификация CPG: v1.1</li>
<li>DuckDB: 1.1.3+</li>
<li>duckpgq: Последняя стабильная версия</li>
<li>Версия схемы: 5.0 (Завершена полная совместимость с фазой 4)</li>
<li>Последнее обновление: 2025-11-16</li>
</ul>
<h2 id="changelog">Журнал изменений<a class="heading-anchor" href="#changelog" title="Link to this section">&para;</a></h2>
<h3 id="v50-2025-11-16---phase-4-complete-compliance">v5.0 (2025-11-16) — Завершение четвёртого этапа: полное соответствие схеме<a class="heading-anchor" href="#v50-2025-11-16---phase-4-complete-compliance" title="Link to this section">&para;</a></h3>
<p><strong>КРУПНОЕ ОБНОВЛЕНИЕ: Достигнуто 100% соответствие схеме Joern со всеми оставшимися функциями</strong></p>
<p><strong>Новые типы узлов:</strong>
- <code>nodes_unknown</code> (UNKNOWN) — универсальный тип для неподдерживаемых конструкций AST
- <code>nodes_jump_target</code> (JUMP_TARGET) — метки для операторов goto/break/continue
- <code>nodes_type_parameter</code> (TYPE_PARAMETER) — формальные параметры шаблонов/дженериков
- <code>nodes_type_argument</code> (TYPE_ARGUMENT) — фактические аргументы шаблонов/дженериков
- <code>nodes_binding</code> (BINDING) — привязки для разрешения методов
- <code>nodes_closure_binding</code> (CLOSURE_BINDING) — захват переменных в замыканиях
- <code>nodes_comment</code> (COMMENT) — комментарии в исходном коде</p>
<p><strong>Новые типы рёбер:</strong>
- <code>edges_alias_of</code> (ALIAS_OF) — связи псевдонимов типов
- <code>edges_inherits_from</code> (INHERITS_FROM) — связи наследования типов
- <code>edges_capture</code> (CAPTURE) — захват переменных в замыканиях
- <code>edges_captured_by</code> (CAPTURED_BY) — обратные связи захвата в замыканиях</p>
<p><strong>Влияние:</strong>
- <strong>Достигнуто 100% соответствие схеме Joern</strong>
- Полное покрытие AST с использованием узлов UNKNOWN
- Полная поддержка дженериков и шаблонов
- Включён анализ замыканий и лямбд
- Поддержка разрешения псевдонимов и наследования типов
- Сохранение комментариев для документации
- Полноценные возможности анализа программ</p>
<p><strong>Соответствие:</strong> ~95% → <strong>100% схеме Joern</strong></p>
<h3 id="v40-2025-11-16-tretiy-etap-podderzhka-prostranstv-imyon-i-faylov">v4.0 (2025-11-16) — Третий этап: поддержка пространств имён и файлов<a class="heading-anchor" href="#v40-2025-11-16-tretiy-etap-podderzhka-prostranstv-imyon-i-faylov" title="Link to this section">&para;</a></h3>
<p><strong>КРУПНОЕ ОБНОВЛЕНИЕ: Добавлено сопоставление с файлами, поддержка пространств имён и ссылок на методы/типы</strong></p>
<p><strong>Новые типы узлов:</strong>
- <code>nodes_file</code> (FILE) — узлы исходных файлов для индексации по файлам
- <code>nodes_namespace_block</code> (NAMESPACE_BLOCK) — блоки пространств имён (C++ namespace, Java package)
- <code>nodes_method_ref</code> (METHOD_REF) — ссылки на методы (функции высшего порядка, указатели на функции)
- <code>nodes_type_ref</code> (TYPE_REF) — ссылки на типы (рефлексия, приведение типов, дженерики)</p>
<p><strong>Новые типы рёбер:</strong>
- <code>edges_source_file</code> (SOURCE_FILE) — сопоставление узлов с файлами (создаётся автоматически из FILENAME)</p>
<p><strong>Влияние:</strong>
- Включена навигация по коду на уровне файлов
- Поддержка анализа с учётом пространств имён
- Отслеживание функций высшего порядка (колбэки, делегаты)
- Поддержка рефлексии и дженериков
- Полное сопоставление с исходными файлами (готово к интеграции с IDE)
- Улучшен анализ межфайловых зависимостей</p>
<p><strong>Соответствие:</strong> ~90% → ~95% схеме Joern</p>
<h3 id="v30-2025-11-16-vtoroy-etap-podderzhka-oop">v3.0 (2025-11-16) — Второй этап: поддержка ООП<a class="heading-anchor" href="#v30-2025-11-16-vtoroy-etap-podderzhka-oop" title="Link to this section">&para;</a></h3>
<p><strong>КРУПНОЕ ОБНОВЛЕНИЕ: Добавлена поддержка анализа ООП и точное сопоставление с исходным кодом</strong></p>
<p><strong>Новые типы узлов:</strong>
- <code>nodes_field_identifier</code> (FIELD_IDENTIFIER) — узлы доступа к полям для ООП
- <code>nodes_member</code> (MEMBER) — объявления полей классов/структур</p>
<p><strong>Новые типы рёбер:</strong>
- <code>edges_binds</code> (BINDS) — рёбра привязки имён (операторы import/using)
- <code>edges_binds_to</code> (BINDS_TO) — обратные рёбра привязки (разрешение имён)</p>
<p><strong>Новые свойства:</strong>
- OFFSET, OFFSET_END: точное сопоставление по байтам (добавлено к METHOD, TYPE_DECL, IDENTIFIER, FIELD_IDENTIFIER, MEMBER)
- MODIFIER: массив модификаторов доступа (добавлено к METHOD, TYPE_DECL)
- CANONICAL_NAME: нормализованное имя идентификатора (добавлено к FIELD_IDENTIFIER)</p>
<p><strong>Влияние:</strong>
- Полная поддержка анализа ООП-кода (отслеживание доступа к полям)
- Точное сопоставление с местоположением в исходном коде (на уровне байтов)
- Включён анализ видимости (PUBLIC, PRIVATE, STATIC и т.д.)
- Улучшено разрешение имён переменных и функций
- Включён анализ псевдонимов (канонические имена)</p>
<p><strong>Соответствие:</strong> ~80% → ~90% схеме Joern</p>
<h3 id="v20-2025-11-16-pervyy-etap-kriticheskie-obnovleniya">v2.0 (2025-11-16) — Первый этап: критические обновления<a class="heading-anchor" href="#v20-2025-11-16-pervyy-etap-kriticheskie-obnovleniya" title="Link to this section">&para;</a></h3>
<p><strong>КРУПНОЕ ОБНОВЛЕНИЕ: Добавлены критически важные компоненты для анализа PDG и SSA</strong></p>
<p><strong>Новые типы узлов:</strong>
- <code>nodes_param_out</code> (METHOD_PARAMETER_OUT) — выходные параметры для анализа SSA
- <code>nodes_method_return</code> (METHOD_RETURN) — формальный параметр возврата</p>
<p><strong>Новые типы рёбер:</strong>
- <code>edges_cdg</code> (Control Dependence Graph) — критически важен для PDG!</p>
<p><strong>Влияние:</strong>
- Граф зависимостей программы (PDG) теперь полный (DDG + CDG)
- Теперь возможен анализ SSA
- Включено программное срезание (program slicing)
- Улучшен анализ утечки данных (taint analysis)</p>
<p><strong>Соответствие:</strong> ~70% → ~80% схеме Joern</p>
<h3 id="v10-2025-11-15---initial-release">v1.0 (2025-11-15) — Первоначальный выпуск<a class="heading-anchor" href="#v10-2025-11-15---initial-release" title="Link to this section">&para;</a></h3>
<ul>
<li>11 типов узлов (METHOD, CALL, IDENTIFIER, LITERAL, LOCAL, PARAM, RETURN, BLOCK, CONTROL_STRUCTURE, TYPE_DECL, METADATA)</li>
<li>10 типов рёбер (AST, CFG, CALL, REF, REACHING_DEF, ARGUMENT, RECEIVER, CONDITION, DOMINATE, POST_DOMINATE)</li>
</ul>
<hr />
<h2 id="extension-semantic-tag-system">Расширение: Система семантических тегов<a class="heading-anchor" href="#extension-semantic-tag-system" title="Link to this section">&para;</a></h2>
<h3 id="obzor">Обзор<a class="heading-anchor" href="#obzor" title="Link to this section">&para;</a></h3>
<p>Система тегов расширяет CPG за счёт семантических аннотаций для методов и других элементов кода. Теги — это пользовательские расширения (не входящие в спецификацию CPG v1.1), которые позволяют выполнять семантический поиск, классификацию кода и интеллектуальный анализ.</p>
<h3 id="nodes-tag">nodes_tag<a class="heading-anchor" href="#nodes-tag" title="Link to this section">&para;</a></h3>
<p>Хранит определения тегов (семантические метки для элементов кода).</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="k">name</span><span class="w"> </span><span class="n">VARCHAR</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="no">NULL</span><span class="p">,</span><span class="w">     </span><span class="c1">-- Категория тега (например, &#39;subsystem-name&#39;, &#39;security-risk&#39;)</span>
<span class="w">    </span><span class="k">value</span><span class="w"> </span><span class="n">VARCHAR</span><span class="w">              </span><span class="c1">-- Значение тега (например, &#39;executor&#39;, &#39;high&#39;)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tag_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_tag</span><span class="p">(</span><span class="k">name</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tag_value</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">nodes_tag</span><span class="p">(</span><span class="k">value</span><span class="p">);</span>
</code></pre></div>

<p><strong>Свойства:</strong>
- NAME: Идентификатор категории тега (уникальное семантическое измерение)
- VALUE: Значение тега в рамках этой категории</p>
<h3 id="edges-tagged-by">edges_tagged_by<a class="heading-anchor" href="#edges-tagged-by" title="Link to this section">&para;</a></h3>
<p>Связывает элементы кода с их семантическими тегами.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">src</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">                </span><span class="c1">-- Идентификатор исходного узла (обычно METHOD)</span>
<span class="w">    </span><span class="n">dst</span><span class="w"> </span><span class="n">BIGINT</span><span class="p">,</span><span class="w">                </span><span class="c1">-- Идентификатор узла тега</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tagged_by_src</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_tagged_by_dst</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
</code></pre></div>

<p><strong>Связь:</strong>
- Источник: любой узел CPG (обычно nodes_method)
- Назначение: запись в nodes_tag</p>
<h3 id="kategorii-tegov">Категории тегов<a class="heading-anchor" href="#kategorii-tegov" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Категория</th>
<th>Описание</th>
<th>Примеры значений</th>
</tr>
</thead>
<tbody>
<tr>
<td>subsystem-name</td>
<td>Организационная единица кода</td>
<td>‘executor’, ‘planner’, ‘parser’, ‘storage’</td>
</tr>
<tr>
<td>security-risk</td>
<td>Классификация по уровню угрозы безопасности</td>
<td>‘critical’, ‘high’, ‘medium’, ‘low’</td>
</tr>
<tr>
<td>taint-source</td>
<td>Точка входа недоверённых данных</td>
<td>Булева разметка</td>
</tr>
<tr>
<td>taint-sink</td>
<td>Выход, чувствительный к вопросам безопасности</td>
<td>Булева разметка</td>
</tr>
<tr>
<td>perf-hotspot</td>
<td>Участки кода, критичные к производительности</td>
<td>Булева разметка</td>
</tr>
<tr>
<td>allocation-heavy</td>
<td>Методы, интенсивно использующие память</td>
<td>Булева разметка</td>
</tr>
<tr>
<td>test-coverage</td>
<td>Наличие связанных тестов</td>
<td>Булева разметка</td>
</tr>
<tr>
<td>cyclomatic-complexity</td>
<td>Метрика сложности кода</td>
<td>Числовые значения (например, ‘15’, ‘25’)</td>
</tr>
<tr>
<td>function-purpose</td>
<td>Семантическое описание</td>
<td>Произвольный текст описания</td>
</tr>
<tr>
<td>entry-point</td>
<td>Точка входа в систему</td>
<td>Булева разметка</td>
</tr>
</tbody>
</table></div>
<h3 id="primery-zaprosov-k-tegam">Примеры запросов к тегам<a class="heading-anchor" href="#primery-zaprosov-k-tegam" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Найти все методы с критическим уровнем угрозы безопасности</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="err">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">m</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">src</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s1">&#39;security-risk&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s1">&#39;critical&#39;</span><span class="p">;</span>

<span class="c1">-- Вывести все подсистемы</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">subsystem</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s1">&#39;subsystem-name&#39;</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">value</span><span class="p">;</span>

<span class="c1">-- Найти методы в определённой подсистеме</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">line_number</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">m</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">src</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s1">&#39;subsystem-name&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s1">&#39;executor&#39;</span><span class="p">;</span>

<span class="c1">-- Найти участки с высокой сложностью</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">full_name</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">complexity</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_method</span><span class="w"> </span><span class="n">m</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">src</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s1">&#39;cyclomatic-complexity&#39;</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="mi">20</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">INTEGER</span><span class="p">)</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- Подсчитать количество тегов по категориям</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="nf">COUNT</span><span class="p">(</span><span class="err">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">count</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nodes_tag</span><span class="w"> </span><span class="n">t</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">edges_tagged_by</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dst</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="k">name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>

<h3 id="statistika-po-tegam">Статистика по тегам<a class="heading-anchor" href="#statistika-po-tegam" title="Link to this section">&para;</a></h3>
<p>В текущей базе данных содержится приблизительно:
- <strong>15,68 млн тегов</strong> в рамках <strong>98 категорий</strong>
- Основные категории: subsystem-name, security-risk, function-purpose
- Теги позволяют выполнять семантический поиск по коду и интеллектуальный анализ</p>
<h3 id="integration-notes">Примечания по интеграции<a class="heading-anchor" href="#integration-notes" title="Link to this section">&para;</a></h3>
<p>Теги добавляются после генерации CPG с помощью:
1. <strong>Статического анализа</strong>: Запросы тегов в Joern (<code>cpg.method.tag.name(...)</code>)
2. <strong>Обогащения с помощью ИИ</strong>: Генерация описаний назначения функций с помощью LLM
3. <strong>Вычисляемых метрик</strong>: Цикломатическая сложность, полученная из анализа CFG
4. <strong>Ручной аннотации</strong>: Результаты аудита безопасности</p>
<p>Теги расширяют CPG без изменения основной схемы, обеспечивая совместимость со стандартными инструментами CPG и позволяя выполнять расширенный семантический анализ.</p>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="index.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Назад</span>
        <span class="doc-page-nav-title">Обзор</span>
      </a>

      <a href="SQL_QUERY_COOKBOOK.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Вперед</span>
        <span class="doc-page-nav-title">Кулинарная книга SQL-запросов для DuckDB CPG</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Обновлено: 2025-12-28</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/reference/SCHEMA.md" target="_blank" rel="noopener">Редактировать на GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">На этой странице</div>
      <ul class="doc-toc-list">
        <li><a href="#dizayn-shemy-duckdb-cpg-cpg-spec-v11" class="level-1">Дизайн схемы DuckDB CPG (CPG Spec v1.1)</a></li>
<li><a href="#soderzhanie" class="level-2">Содержание</a></li>
<li><a href="#obzor" class="level-2">Обзор</a></li>
<li><a href="#osnovnye-printsipy-proektirovaniya" class="level-2">Основные принципы проектирования</a></li>
<li><a href="#tablitsy-uzlov" class="level-2">Таблицы узлов</a></li>
<li><a href="#nodes-method" class="level-3">nodes_method</a></li>
<li><a href="#nodes-call" class="level-3">nodes_call</a></li>
<li><a href="#nodes-identifier" class="level-3">nodes_identifier</a></li>
<li><a href="#nodes-field-identifier" class="level-3">nodes_field_identifier</a></li>
<li><a href="#nodes-literal" class="level-3">nodes_literal</a></li>
<li><a href="#nodes-local" class="level-3">nodes_local</a></li>
<li><a href="#nodes-param" class="level-3">nodes_param</a></li>
<li><a href="#nodes-param-out" class="level-3">nodes_param_out</a></li>
<li><a href="#nodes-method-return" class="level-3">nodes_method_return</a></li>
<li><a href="#nodes-return" class="level-3">nodes_return</a></li>
<li><a href="#nodes-block" class="level-3">nodes_block</a></li>
<li><a href="#nodes-control-structure" class="level-3">nodes_control_structure</a></li>
<li><a href="#nodes-member" class="level-3">nodes_member</a></li>
<li><a href="#nodes-type-decl" class="level-3">nodes_type_decl</a></li>
<li><a href="#nodes-metadata" class="level-3">nodes_metadata</a></li>
<li><a href="#nodes-file" class="level-3">nodes_file</a></li>
<li><a href="#nodes-namespace-block" class="level-3">nodes_namespace_block</a></li>
<li><a href="#nodes-method-ref" class="level-3">nodes_method_ref</a></li>
<li><a href="#tablitsy-ryober" class="level-2">Таблицы рёбер</a></li>
<li><a href="#edges-ast" class="level-3">edges_ast</a></li>
<li><a href="#edges-cfg" class="level-3">edges_cfg</a></li>
<li><a href="#edges-call" class="level-3">edges_call</a></li>
<li><a href="#edges-ref" class="level-3">edges_ref</a></li>
<li><a href="#edges-reaching-def" class="level-3">edges_reaching_def</a></li>
<li><a href="#edges-argument" class="level-3">edges_argument</a></li>
<li><a href="#edges-receiver" class="level-3">edges_receiver</a></li>
<li><a href="#edges-condition" class="level-3">edges_condition</a></li>
<li><a href="#edges-dominate" class="level-3">edges_dominate</a></li>
<li><a href="#edges-post-dominate" class="level-3">edges_post_dominate</a></li>
<li><a href="#edges-cdg" class="level-3">edges_cdg</a></li>
<li><a href="#edges-binds" class="level-3">edges_binds</a></li>
<li><a href="#edges-binds-to" class="level-3">edges_binds_to</a></li>
<li><a href="#edges-source-file" class="level-3">edges_source_file</a></li>
<li><a href="#edges-alias-of" class="level-3">edges_alias_of</a></li>
<li><a href="#edges-inherits-from" class="level-3">edges_inherits_from</a></li>
<li><a href="#edges-capture" class="level-3">edges_capture</a></li>
<li><a href="#edges-captured-by" class="level-3">edges_captured_by</a></li>
<li><a href="#local-count-captured-by-closure-binding" class="level-1">LOCAL "count" --CAPTURED_BY--> CLOSURE_BINDING</a></li>
<li><a href="#opredelenie-grafa-svoystv" class="level-2">Определение графа свойств</a></li>
<li><a href="#shag-1-sozdanie-materializovannoy-obedinyonnoy-tablitsy-uzlov" class="level-3">Шаг 1: Создание материализованной объединённой таблицы узлов</a></li>
<li><a href="#shag-2-sozdanie-kompleksnogo-grafa-svoystv" class="level-3">Шаг 2: Создание комплексного графа свойств</a></li>
<li><a href="#primery-zaprosov" class="level-2">Примеры запросов</a></li>
<li><a href="#standartnyy-sql-zapros-nayti-vse-vyzovy-opredelyonnogo-metoda" class="level-3">Стандартный SQL-запрос: Найти все вызовы определённого метода</a></li>
<li><a href="#duckdb-pgq-zapros-nayti-pryamye-tsepochki-vyzovov-vyzyvayuschiy-vyzyvaemyy" class="level-3">DuckDB PGQ-запрос: Найти прямые цепочки вызовов (вызывающий -> вызываемый)</a></li>
<li><a href="#duckdb-pgq-zapros-nayti-metody-i-ih-dochernie-uzly-ast" class="level-3">DuckDB PGQ-запрос: Найти методы и их дочерние узлы AST</a></li>
<li><a href="#duckdb-pgq-zapros-puti-potoka-dannyh-s-ispolzovaniem-reaching-def" class="level-3">DuckDB PGQ-запрос: Пути потока данных с использованием REACHING_DEF</a></li>
<li><a href="#duckdb-pgq-zapros-puti-cfg-upravlenie-vypolneniem" class="level-3">DuckDB PGQ-запрос: Пути CFG (управление выполнением)</a></li>
<li><a href="#duckdb-pgq-zapros-nayti-vse-identifikatory-i-ih-ssylki" class="level-3">DuckDB PGQ-запрос: Найти все идентификаторы и их ссылки</a></li>
<li><a href="#duckdb-pgq-zapros-ierarhiya-tipov-nasledovanie" class="level-3">DuckDB PGQ-запрос: Иерархия типов (наследование)</a></li>
<li><a href="#kombinirovannyy-zapros-metody-s-naibolshim-kolichestvom-vhodyaschih-vyzovov" class="level-3">Комбинированный запрос: Методы с наибольшим количеством входящих вызовов</a></li>
<li><a href="#migratsiya-s-joern" class="level-2">Миграция с Joern</a></li>
<li><a href="#etap-1-kriticheskiy-zavershyon" class="level-3">Этап 1 (КРИТИЧЕСКИЙ) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#etap-2-podderzhka-oop-zavershyon" class="level-3">Этап 2 (ПОДДЕРЖКА ООП) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#etap-3-podderzhka-prostranstv-imyon-i-faylov-zavershyon" class="level-3">Этап 3 (ПОДДЕРЖКА ПРОСТРАНСТВ ИМЁН И ФАЙЛОВ) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#etap-4-ostavshiesya-funktsii-zavershyon" class="level-3">Этап 4 (ОСТАВШИЕСЯ ФУНКЦИИ) — ЗАВЕРШЁН ✓</a></li>
<li><a href="#rekomendatsii-po-proizvoditelnosti" class="level-2">Рекомендации по производительности</a></li>
<li><a href="#versiya-shemy" class="level-2">Версия схемы</a></li>
<li><a href="#zhurnal-izmeneniy" class="level-2">Журнал изменений</a></li>
<li><a href="#v50-2025-11-16-zavershenie-chetvyortogo-etapa-polnoe-sootvetstvie-sheme" class="level-3">v5.0 (2025-11-16) — Завершение четвёртого этапа: полное соответствие схеме</a></li>
<li><a href="#v40-2025-11-16-tretiy-etap-podderzhka-prostranstv-imyon-i-faylov" class="level-3">v4.0 (2025-11-16) — Третий этап: поддержка пространств имён и файлов</a></li>
<li><a href="#v30-2025-11-16-vtoroy-etap-podderzhka-oop" class="level-3">v3.0 (2025-11-16) — Второй этап: поддержка ООП</a></li>
<li><a href="#v20-2025-11-16-pervyy-etap-kriticheskie-obnovleniya" class="level-3">v2.0 (2025-11-16) — Первый этап: критические обновления</a></li>
<li><a href="#v10-2025-11-15-pervonachalnyy-vypusk" class="level-3">v1.0 (2025-11-15) — Первоначальный выпуск</a></li>
<li><a href="#rasshirenie-sistema-semanticheskih-tegov" class="level-2">Расширение: Система семантических тегов</a></li>
<li><a href="#obzor" class="level-3">Обзор</a></li>
<li><a href="#nodes-tag" class="level-3">nodes_tag</a></li>
<li><a href="#edges-tagged-by" class="level-3">edges_tagged_by</a></li>
<li><a href="#kategorii-tegov" class="level-3">Категории тегов</a></li>
<li><a href="#primery-zaprosov-k-tegam" class="level-3">Примеры запросов к тегам</a></li>
<li><a href="#statistika-po-tegam" class="level-3">Статистика по тегам</a></li>
<li><a href="#primechaniya-po-integratsii" class="level-3">Примечания по интеграции</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI-копилот для анализа исходного кода</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Продукт</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Возможности</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Интеграции</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Документация</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Начало работы</a></li>
              <li><a href="../guides/index.html" class="footer-link">Руководства</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Ресурсы</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Контакты</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. Все права защищены.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
