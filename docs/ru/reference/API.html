<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: Справочник API">
  <meta name="keywords" content="CodeGraph, documentation, reference">

  <meta property="og:title" content="Справочник API - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: Справочник API">
  <meta property="og:type" content="article">

  <title>Справочник API - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="nav-link active">Документация</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/reference/API.html" class="">EN</a>
          <a href="../../ru/reference/API.html" class="active">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Переключить тему">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Запросить демо</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Документация</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Запросить демо</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Начало работы</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Обзор</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Руководство по настройке</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Руководство по установке</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Руководства</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../guides/index.html">Обзор</a></li>
        <li><a href="../guides/BENCHMARK_GUIDE.html">Руководство по тестовой платформе</a></li>
        <li><a href="../guides/CLI_GUIDE.html">Руководство по CLI</a></li>
        <li><a href="../guides/CODE_REVIEW.html">Система автоматического код-ревью на основе патчей</a></li>
        <li><a href="../guides/CPG_EXPORT.html">Руководство по экспорту CPG</a></li>
        <li><a href="../guides/MONITORING.html">Руководство по мониторингу</a></li>
        <li><a href="../guides/PROGRAMMATIC_GUIDE.html">Руководство пользователя</a></li>
        <li><a href="../guides/PROJECT_IMPORT.html">Импорт новой кодовой базы</a></li>
        <li><a href="../guides/QUICK_REFERENCE.html">Краткое руководство по CodeGraph</a></li>
        <li><a href="../guides/REFACTORING.html">Руководство по анализу рефакторинга</a></li>
        <li><a href="../guides/SCENARIOS.html">Руководство по сценариям рабочих процессов</a></li>
        <li><a href="../guides/TROUBLESHOOTING.html">Руководство по устранению неполадок</a></li>
        <li><a href="../guides/TUI_USER_GUIDE.html">Руководство пользователя CodeGraph</a></li>
        <li><a href="../guides/01-onboarding.html">Сценарий 01: Ввод нового разработчика</a></li>
        <li><a href="../guides/02-security-audit.html">Сценарий 02: Аудит безопасности</a></li>
        <li><a href="../guides/03-documentation.html">Сценарий 03: Генерация документации</a></li>
        <li><a href="../guides/04-feature-development.html">Сценарий 04: Разработка функций</a></li>
        <li><a href="../guides/05-refactoring.html">Сценарий 05: Рефакторинг</a></li>
        <li><a href="../guides/06-performance.html">Сценарий 06: Анализ производительности</a></li>
        <li><a href="../guides/07-test-coverage.html">Сценарий 07: Покрытие тестами</a></li>
        <li><a href="../guides/08-compliance.html">Сценарий 08: Проверка соответствия требованиям</a></li>
        <li><a href="../guides/09-code-review.html">Сценарий 09: Код-ревью</a></li>
        <li><a href="../guides/10-cross-repo.html">Сценарий 10: Анализ между репозиториями</a></li>
        <li><a href="../guides/11-architecture.html">Сценарий 11: Анализ архитектуры</a></li>
        <li><a href="../guides/12-tech-debt.html">Сценарий 12: Оценка технического долга</a></li>
        <li><a href="../guides/13-mass-refactoring.html">Сценарий 13: Массовая рефакторизация</a></li>
        <li><a href="../guides/14-incident-response.html">Сценарий 14: Реагирование на инциденты безопасности</a></li>
        <li><a href="../guides/15-debugging.html">Сценарий 15: Помощь в отладке</a></li>
        <li><a href="../guides/16-entry-points.html">Сценарий 16: Обнаружение точки входа</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Документация</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Обзор</a></li>
        <li><a href="../api/REST_API.html">Документация по REST API CodeGraph</a></li>
        <li><a href="../api/WEBSOCKET_API.html">Справочная документация по WebSocket API</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Интеграции</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Обзор</a></li>
        <li><a href="../integrations/GIGACHAT.html">Руководство по интеграции GigaChat</a></li>
        <li><a href="../integrations/YANDEX_AI_STUDIO.html">Руководство по интеграции Yandex AI Studio</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Справочник</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Обзор</a></li>
        <li><a href="AGENTS.html">Справочник агентов</a></li>
        <li><a href="ANALYSIS_MODULES.html">Справочник модулей анализа</a></li>
        <li><a href="API.html" class="active">Справочник API</a></li>
        <li><a href="HYPOTHESIS_SYSTEM.html">Справочная система гипотез</a></li>
        <li><a href="SCHEMA.html">Дизайн схемы DuckDB CPG (CPG Spec v1.1)</a></li>
        <li><a href="SECURITY.html">Модуль корпоративной безопасности</a></li>
        <li><a href="SQL_QUERY_COOKBOOK.html">Кулинарная книга SQL-запросов для DuckDB CPG</a></li>
        <li><a href="WORKFLOWS.html">Справочник по рабочим процессам</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Обзор</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Документация</a>
        <span>/</span>
        <a href="index.html">Справочник</a>
        <span>/</span>
        <span>Справочник API</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>Справочник API</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="spravochnik-api">Справочник API<a class="heading-anchor" href="#spravochnik-api" title="Link to this section">&para;</a></h1>
<p>Полная документация по API для CodeGraph.</p>
<blockquote class="callout">
<p><strong>Ищете документацию по REST API?</strong> См. <a href="../api/REST_API.html">Документация по REST API</a> для получения информации о HTTP-эндпоинтах, аутентификации и примерах использования.</p>
</blockquote>
<h2 id="soderzhanie">Содержание<a class="heading-anchor" href="#soderzhanie" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="#core-services">Основные сервисы</a></li>
<li><a href="#cpgqueryservice">CPGQueryService</a></li>
<li><a href="#vectorstorereal">VectorStoreReal</a></li>
<li><a href="#hybridretriever">HybridRetriever</a></li>
<li><a href="#agent-classes">Классы агентов</a></li>
<li><a href="#analyzeragent">AnalyzerAgent</a></li>
<li><a href="#retrieveragent">RetrieverAgent</a></li>
<li><a href="#enrichmentagent">EnrichmentAgent</a></li>
<li><a href="#generatoragent">GeneratorAgent</a></li>
<li><a href="#interpreteragent">InterpreterAgent</a></li>
<li><a href="#workflow-classes">Классы рабочих процессов</a></li>
<li><a href="#langgraphworkflow">LangGraphWorkflow</a></li>
<li><a href="#multiscenarioworkflow">MultiScenarioWorkflow</a></li>
<li><a href="#configuration-classes">Классы конфигурации</a></li>
<li><a href="#cpgconfig">CPGConfig</a></li>
<li><a href="#domainregistry">DomainRegistry</a></li>
<li><a href="#data-types">Типы данных</a></li>
<li><a href="#relevancescore">RelevanceScore</a></li>
<li><a href="#workflowstate">WorkflowState</a></li>
<li><a href="#security-hardening-classes">Классы усиления безопасности</a></li>
<li><a href="#hardeningscanner">HardeningScanner</a></li>
<li><a href="#hardeningcategory">HardeningCategory</a></li>
<li><a href="#hardeningseverity">HardeningSeverity</a></li>
<li><a href="#hardeningcheck">HardeningCheck</a></li>
<li><a href="#hardeningfinding">HardeningFinding</a></li>
<li><a href="#hardening-utility-functions">Вспомогательные функции для усиления безопасности</a></li>
<li><a href="#error-handling">Обработка ошибок</a></li>
<li><a href="#common-exceptions">Общие исключения</a></li>
<li><a href="#error-handling-pattern">Шаблон обработки ошибок</a></li>
<li><a href="#next-steps">Дальнейшие шаги</a></li>
</ul>
<h2 id="core-services">Основные сервисы<a class="heading-anchor" href="#core-services" title="Link to this section">&para;</a></h2>
<h3 id="cpgqueryservice">CPGQueryService<a class="heading-anchor" href="#cpgqueryservice" title="Link to this section">&para;</a></h3>
<p>Сервис выполнения запросов к базе данных.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.services.cpg_query_service</span><span class="w"> </span><span class="kn">import</span> <span class="n">CPGQueryService</span>

<span class="n">service</span> <span class="o">=</span> <span class="n">CPGQueryService</span><span class="p">(</span><span class="n">db_path</span><span class="o">=</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="metody">Методы<a class="heading-anchor" href="#metody" title="Link to this section">&para;</a></h4>
<h5 id="find-methodname-str-listdict">find_method(name: str) -&gt; List[Dict]<a class="heading-anchor" href="#find-methodname-str-listdict" title="Link to this section">&para;</a></h5>
<p>Поиск методов по имени.</p>
<div class="highlight"><pre><span></span><code>methods = service.find_method(&quot;CommitTransaction&quot;)
<span class="gh">#</span> Возвращает: [{&#39;node_id&#39;: 123, &#39;name&#39;: &#39;CommitTransaction&#39;, &#39;file&#39;: &#39;xact.c&#39;, ...}] {#returns-node-id-123-name-committransaction-file-xactc}
</code></pre></div>

<h5 id="find-calleesmethod-name-str-listdict">find_callees(method_name: str) -&gt; List[Dict]<a class="heading-anchor" href="#find-calleesmethod-name-str-listdict" title="Link to this section">&para;</a></h5>
<p>Поиск методов, вызываемых указанным методом.</p>
<div class="highlight"><pre><span></span><code>callees = service.find_callees(&quot;CommitTransaction&quot;)
<span class="gh">#</span> Возвращает: [{&#39;name&#39;: &#39;MarkBufferDirty&#39;, &#39;file&#39;: &#39;bufmgr.c&#39;, ...}] {#returns-name-markbufferdirty-file-bufmgrc}
</code></pre></div>

<h5 id="find-callersmethod-name-str-listdict">find_callers(method_name: str) -&gt; List[Dict]<a class="heading-anchor" href="#find-callersmethod-name-str-listdict" title="Link to this section">&para;</a></h5>
<p>Поиск методов, которые вызывают указанный метод.</p>
<div class="highlight"><pre><span></span><code>callers = service.find_callers(&quot;LWLockAcquire&quot;)
<span class="gh">#</span> Возвращает: [{&#39;name&#39;: &#39;heap_insert&#39;, &#39;file&#39;: &#39;heapam.c&#39;, ...}] {#returns-name-heap-insert-file-heapamc}
</code></pre></div>

<h5 id="execute-sqlquery-str-listdict">execute_sql(query: str) -&gt; List[Dict]<a class="heading-anchor" href="#execute-sqlquery-str-listdict" title="Link to this section">&para;</a></h5>
<p>Выполнение произвольного SQL-запроса.</p>
<div class="highlight"><pre><span></span><code>results = service.execute_sql(&quot;SELECT * FROM nodes_method LIMIT 10&quot;)
</code></pre></div>

<h5 id="count-methods-int">count_methods() -&gt; int<a class="heading-anchor" href="#count-methods-int" title="Link to this section">&para;</a></h5>
<p>Получить общее количество методов.</p>
<div class="highlight"><pre><span></span><code>count = service.count_methods()
<span class="gh">#</span> Возвращает: 52303 {#returns-52303}
</code></pre></div>

<hr />
<h3 id="vectorstorereal">VectorStoreReal<a class="heading-anchor" href="#vectorstorereal" title="Link to this section">&para;</a></h3>
<p>Интерфейс семантического поиска по векторам.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.retrieval.vector_store_real</span><span class="w"> </span><span class="kn">import</span> <span class="n">VectorStoreReal</span>

<span class="n">store</span> <span class="o">=</span> <span class="n">VectorStoreReal</span><span class="p">(</span><span class="n">persist_directory</span><span class="o">=</span><span class="s2">&quot;chromadb_storage&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="atributy">Атрибуты<a class="heading-anchor" href="#atributy" title="Link to this section">&para;</a></h4>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Атрибут</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>qa_collection</td>
<td>Collection</td>
<td>Пара вопросы-ответы (23K документов)</td>
</tr>
<tr>
<td>examples_collection</td>
<td>Collection</td>
<td>Примеры запросов (1K документов)</td>
</tr>
<tr>
<td>cfg_patterns</td>
<td>Collection</td>
<td>Шаблоны управления потоком выполнения (54K документов)</td>
</tr>
<tr>
<td>ddg_patterns_enriched</td>
<td>Collection</td>
<td>Шаблоны потока данных (169K документов)</td>
</tr>
<tr>
<td>documentation</td>
<td>Collection</td>
<td>Документация по методам (638 документов)</td>
</tr>
</tbody>
</table></div>
<h4 id="metody_1">Методы<a class="heading-anchor" href="#metody_1" title="Link to this section">&para;</a></h4>
<h5 id="search-qaquery-str-top-k-int-5-listdict">search_qa(query: str, top_k: int = 5) -&gt; List[Dict]<a class="heading-anchor" href="#search-qaquery-str-top-k-int-5-listdict" title="Link to this section">&para;</a></h5>
<p>Поиск в коллекции вопросов и ответов.</p>
<div class="highlight"><pre><span></span><code>results = store.search_qa(&quot;Как работает фиксация транзакции?&quot;, top_k=3)
<span class="gh">#</span> Возвращает: [{&#39;question&#39;: &#39;...&#39;, &#39;answer&#39;: &#39;...&#39;, &#39;score&#39;: 0.85}] {#returns-question-answer-score-085}
</code></pre></div>

<h5 id="search-examplesquery-str-top-k-int-5-listdict">search_examples(query: str, top_k: int = 5) -&gt; List[Dict]<a class="heading-anchor" href="#search-examplesquery-str-top-k-int-5-listdict" title="Link to this section">&para;</a></h5>
<p>Поиск примеров SQL-запросов.</p>
<div class="highlight"><pre><span></span><code>examples = store.search_examples(&quot;найти вызывающие методы&quot;, top_k=3)
<span class="gh">#</span> Возвращает: [{&#39;query&#39;: &#39;SELECT ...&#39;, &#39;description&#39;: &#39;...&#39;}] {#returns-query-select-description}
</code></pre></div>

<h5 id="search-documentationquery-str-top-k-int-5-listdict">search_documentation(query: str, top_k: int = 5) -&gt; List[Dict]<a class="heading-anchor" href="#search-documentationquery-str-top-k-int-5-listdict" title="Link to this section">&para;</a></h5>
<p>Поиск документации по методам.</p>
<div class="highlight"><pre><span></span><code>docs = store.search_documentation(&quot;менеджер буферов&quot;, top_k=5)
</code></pre></div>

<hr />
<h3 id="hybridretriever">HybridRetriever<a class="heading-anchor" href="#hybridretriever" title="Link to this section">&para;</a></h3>
<p>Параллельный гибридный поиск, объединяющий векторный и графовый подходы.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.retrieval.hybrid_retriever</span><span class="w"> </span><span class="kn">import</span> <span class="n">HybridRetriever</span><span class="p">,</span> <span class="n">HybridRetrievalConfig</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">HybridRetrievalConfig</span><span class="p">(</span>
    <span class="n">vector_weight</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">graph_weight</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">final_top_k</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="n">retriever</span> <span class="o">=</span> <span class="n">HybridRetriever</span><span class="p">(</span>
    <span class="n">vector_store</span><span class="o">=</span><span class="n">vector_store</span><span class="p">,</span>
    <span class="n">cpg_service</span><span class="o">=</span><span class="n">cpg_service</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="metody_2">Методы<a class="heading-anchor" href="#metody_2" title="Link to this section">&para;</a></h4>
<h5 id="async-retrievequery-str-mode-str-query-type-str-listretrievalresult">async retrieve(query: str, mode: str, query_type: str) -&gt; List[RetrievalResult]<a class="heading-anchor" href="#async-retrievequery-str-mode-str-query-type-str-listretrievalresult" title="Link to this section">&para;</a></h5>
<p>Выполнить гибридный поиск.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">retriever</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="s2">&quot;обработка фиксации транзакции&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;hybrid&quot;</span><span class="p">,</span>  <span class="c1"># &quot;hybrid&quot;, &quot;vector_only&quot;, &quot;graph_only&quot;</span>
    <span class="n">query_type</span><span class="o">=</span><span class="s2">&quot;semantic&quot;</span>  <span class="c1"># &quot;semantic&quot;, &quot;structural&quot;, &quot;security&quot;</span>
<span class="p">))</span>
</code></pre></div>

<h4 id="retrievalresult">RetrievalResult<a class="heading-anchor" href="#retrievalresult" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">RetrievalResult</span><span class="p">:</span>
<span class="w">    </span><span class="nl">content</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="n">Найденное</span><span class="w"> </span><span class="n">содержимое</span>
<span class="w">    </span><span class="nl">score</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="n">Оценка</span><span class="w"> </span><span class="n">релевантности</span>
<span class="w">    </span><span class="nl">source</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">           </span><span class="err">#</span><span class="w"> </span><span class="ss">&quot;vector&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;graph&quot;</span><span class="w"> </span><span class="n">или</span><span class="w"> </span><span class="ss">&quot;hybrid&quot;</span>
<span class="w">    </span><span class="nl">node_id</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span>
<span class="w">    </span><span class="nl">metadata</span><span class="p">:</span><span class="w"> </span><span class="n">Dict</span>
</code></pre></div>

<h2 id="agent-classes">Классы агентов<a class="heading-anchor" href="#agent-classes" title="Link to this section">&para;</a></h2>
<h3 id="analyzeragent">AnalyzerAgent<a class="heading-anchor" href="#analyzeragent" title="Link to this section">&para;</a></h3>
<p>Понимание вопросов и извлечение намерений.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.agents.analyzer_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnalyzerAgent</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">AnalyzerAgent</span><span class="p">(</span><span class="n">vector_store</span><span class="o">=</span><span class="n">vector_store</span><span class="p">)</span>
</code></pre></div>

<h4 id="metody_3">Методы<a class="heading-anchor" href="#metody_3" title="Link to this section">&para;</a></h4>
<h5 id="analyzequestion-str-dict">analyze(question: str) -&gt; Dict<a class="heading-anchor" href="#analyzequestion-str-dict" title="Link to this section">&para;</a></h5>
<p>Анализирует вопрос для извлечения намерения и ключевых слов.</p>
<div class="highlight"><pre><span></span><code><span class="nx">analysis</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">analyzer</span><span class="p">.</span><span class="nx">analyze</span><span class="p">(</span><span class="s">&quot;Какие методы обрабатывают фиксацию транзакций?&quot;</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Возвращает</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">returns</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">intent</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">find_methods</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">intent</span><span class="o">-</span><span class="nx">find</span><span class="o">-</span><span class="nx">methods</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">domain</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">transaction</span><span class="o">-</span><span class="nx">manager</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">domain</span><span class="o">-</span><span class="nx">transaction</span><span class="o">-</span><span class="nx">manager</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">keywords</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="nx">transaction</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">commit</span><span class="err">&#39;</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">keywords</span><span class="o">-</span><span class="nx">transaction</span><span class="o">-</span><span class="nx">commit</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">query_type</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">semantic</span><span class="err">&#39;</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">query</span><span class="o">-</span><span class="k">type</span><span class="o">-</span><span class="nx">semantic</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>

<hr />
<h3 id="retrieveragent">RetrieverAgent<a class="heading-anchor" href="#retrieveragent" title="Link to this section">&para;</a></h3>
<p>Гибридное извлечение с ранжированием.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.agents.retriever_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">RetrieverAgent</span>

<span class="n">retriever</span> <span class="o">=</span> <span class="n">RetrieverAgent</span><span class="p">(</span>
    <span class="n">vector_store</span><span class="o">=</span><span class="n">vector_store</span><span class="p">,</span>
    <span class="n">analyzer_agent</span><span class="o">=</span><span class="n">analyzer</span><span class="p">,</span>
    <span class="n">cpg_service</span><span class="o">=</span><span class="n">cpg_service</span><span class="p">,</span>
    <span class="n">enable_hybrid</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="metody_4">Методы<a class="heading-anchor" href="#metody_4" title="Link to this section">&para;</a></h4>
<h5 id="retrieve-hybridquestion-str-mode-str-query-type-str-top-k-int-use-ranker-bool-dict">retrieve_hybrid(question: str, mode: str, query_type: str, top_k: int, use_ranker: bool) -&gt; Dict<a class="heading-anchor" href="#retrieve-hybridquestion-str-mode-str-query-type-str-top-k-int-use-ranker-bool-dict" title="Link to this section">&para;</a></h5>
<p>Выполняет извлечение с опциональным ранжированием.</p>
<div class="highlight"><pre><span></span><code><span class="nx">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">retriever</span><span class="p">.</span><span class="nx">retrieve_hybrid</span><span class="p">(</span>
<span class="w">    </span><span class="nx">question</span><span class="p">=</span><span class="s">&quot;Найти шаблоны выделения памяти&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">mode</span><span class="p">=</span><span class="s">&quot;hybrid&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">query_type</span><span class="p">=</span><span class="s">&quot;structural&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">top_k</span><span class="p">=</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nx">use_ranker</span><span class="p">=</span><span class="nx">True</span>
<span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Возвращает</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">returns</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">results</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">results</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">ranked_results</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">ranked</span><span class="o">-</span><span class="nx">results</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">retrieval_stats</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="o">...</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">retrieval</span><span class="o">-</span><span class="nx">stats</span><span class="p">}</span>
<span class="err">#</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>

<hr />
<h3 id="enrichmentagent">EnrichmentAgent<a class="heading-anchor" href="#enrichmentagent" title="Link to this section">&para;</a></h3>
<p>Семантическое обогащение узлов CPG.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.agents.enrichment_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">EnrichmentAgent</span>

<span class="n">enrichment</span> <span class="o">=</span> <span class="n">EnrichmentAgent</span><span class="p">()</span>
</code></pre></div>

<h4 id="metody_5">Методы<a class="heading-anchor" href="#metody_5" title="Link to this section">&para;</a></h4>
<h5 id="enrich-methodmethod-data-dict-dict">enrich_method(method_data: Dict) -&gt; Dict<a class="heading-anchor" href="#enrich-methodmethod-data-dict-dict" title="Link to this section">&para;</a></h5>
<p>Добавляет семантические теги к методу.</p>
<div class="highlight"><pre><span></span><code>enriched = enrichment.enrich_method({
    &#39;name&#39;: &#39;LWLockAcquire&#39;,
    &#39;file&#39;: &#39;lwlock.c&#39;
})
<span class="gh">#</span> Возвращает: {&#39;tags&#39;: [&#39;concurrency&#39;, &#39;lock-acquire&#39;], ...} {#returns-tags-concurrency-lock-acquire}
</code></pre></div>

<hr />
<h3 id="generatoragent">GeneratorAgent<a class="heading-anchor" href="#generatoragent" title="Link to this section">&para;</a></h3>
<p>Генерация запросов из естественного языка.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.agents.generator_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeneratorAgent</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">GeneratorAgent</span><span class="p">(</span><span class="n">vector_store</span><span class="o">=</span><span class="n">vector_store</span><span class="p">)</span>
</code></pre></div>

<h4 id="metody_6">Методы<a class="heading-anchor" href="#metody_6" title="Link to this section">&para;</a></h4>
<h5 id="generate-queryquestion-str-analysis-dict-examples-list-str">generate_query(question: str, analysis: Dict, examples: List) -&gt; str<a class="heading-anchor" href="#generate-queryquestion-str-analysis-dict-examples-list-str" title="Link to this section">&para;</a></h5>
<p>Генерирует SQL-запрос к базе данных CPG.</p>
<div class="highlight"><pre><span></span><code>query = generator.generate_query(
    question=&quot;Найти вызывающие метод CommitTransaction&quot;,
    analysis={&#39;intent&#39;: &#39;find_callers&#39;},
    examples=[...]
)
<span class="gh">#</span> Возвращает: &quot;SELECT * FROM nodes_method WHERE...&quot; {#returns-select-from-nodes-method-where}
</code></pre></div>

<hr />
<h3 id="interpreteragent">InterpreterAgent<a class="heading-anchor" href="#interpreteragent" title="Link to this section">&para;</a></h3>
<p>Интерпретация результатов и формирование ответа.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.agents.interpreter_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterpreterAgent</span>

<span class="n">interpreter</span> <span class="o">=</span> <span class="n">InterpreterAgent</span><span class="p">()</span>
</code></pre></div>

<h4 id="metody_7">Методы<a class="heading-anchor" href="#metody_7" title="Link to this section">&para;</a></h4>
<h5 id="interpretquestion-str-results-list-query-str-dict">interpret(question: str, results: List, query: str) -&gt; Dict<a class="heading-anchor" href="#interpretquestion-str-results-list-query-str-dict" title="Link to this section">&para;</a></h5>
<p>Формирует ответ на естественном языке.</p>
<div class="highlight"><pre><span></span><code>answer = interpreter.interpret(
    question=&quot;Какие методы вызывают LWLockAcquire?&quot;,
    results=[...],
    query=&quot;...&quot;
)
# Возвращает: { {#returns}
# &#39;answer&#39;: &#39;Следующие 15 методов вызывают LWLockAcquire...&#39;, {#answer-the-following-15-methods-call-lwlockacquire}
# &#39;confidence&#39;: 0.85, {#confidence-085}
# &#39;sources&#39;: [...] {#sources}
# }
</code></pre></div>

<h2 id="workflow-classes">Классы рабочих процессов<a class="heading-anchor" href="#workflow-classes" title="Link to this section">&para;</a></h2>
<h3 id="langgraphworkflow">LangGraphWorkflow<a class="heading-anchor" href="#langgraphworkflow" title="Link to this section">&para;</a></h3>
<p>Основная оркестровка рабочего процесса.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.workflow.langgraph_workflow_simple</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_workflow</span><span class="p">,</span> <span class="n">run_workflow</span>
</code></pre></div>

<h4 id="hardening-utility-functions">Функции<a class="heading-anchor" href="#hardening-utility-functions" title="Link to this section">&para;</a></h4>
<h5 id="run-workflowquestion-str-dict">run_workflow(question: str) -&gt; Dict<a class="heading-anchor" href="#run-workflowquestion-str-dict" title="Link to this section">&para;</a></h5>
<p>Запускает полный анализ рабочего процесса.</p>
<div class="highlight"><pre><span></span><code>result = run_workflow(&quot;Найти уязвимости к SQL-инъекциям&quot;)
<span class="gh">#</span> Возвращает: { {#returns}
<span class="gh">#</span> &#39;answer&#39;: &#39;...&#39;, {#answer}
<span class="gh">#</span> &#39;confidence&#39;: 0.85, {#confidence-085}
<span class="gh">#</span> &#39;query_used&#39;: &#39;...&#39;, {#query-used}
<span class="gh">#</span> &#39;execution_time_ms&#39;: 1500 {#execution-time-ms-1500}
<span class="gh">#</span> }
</code></pre></div>

<hr />
<h3 id="multiscenarioworkflow">MultiScenarioWorkflow<a class="heading-anchor" href="#multiscenarioworkflow" title="Link to this section">&para;</a></h3>
<p>Анализ на основе сценариев.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.workflow.multi_scenario_workflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_workflow</span>
</code></pre></div>

<h4 id="funktsii">Функции<a class="heading-anchor" href="#funktsii" title="Link to this section">&para;</a></h4>
<h5 id="create-workflowscenario-str-workflow">create_workflow(scenario: str) -&gt; Workflow<a class="heading-anchor" href="#create-workflowscenario-str-workflow" title="Link to this section">&para;</a></h5>
<p>Создаёт рабочий процесс для определённого сценария.</p>
<div class="highlight"><pre><span></span><code>workflow = create_workflow(scenario=&quot;vulnerability_detection&quot;)
result = workflow.run(&quot;Найти риски переполнения буфера&quot;)
</code></pre></div>

<p>Доступные сценарии:
- <code>definition_search</code>
- <code>call_graph</code>
- <code>data_flow</code>
- <code>vulnerability_detection</code>
- <code>dead_code</code>
- <code>performance</code>
- <code>duplication</code>
- <code>entry_points</code>
- <code>concurrency</code>
- <code>dependencies</code>
- <code>documentation</code>
- <code>tech_debt</code>
- <code>security_incident</code>
- <code>refactoring</code>
- <code>code_review</code>
- <code>architecture</code></p>
<hr />
<h2 id="configuration-classes">Классы конфигурации<a class="heading-anchor" href="#configuration-classes" title="Link to this section">&para;</a></h2>
<h3 id="cpgconfig">CPGConfig<a class="heading-anchor" href="#cpgconfig" title="Link to this section">&para;</a></h3>
<p>Конфигурация домена и языковой модели (LLM).</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">CPGConfig</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">CPGConfig</span><span class="p">()</span>
</code></pre></div>

<h4 id="metody_8">Методы<a class="heading-anchor" href="#metody_8" title="Link to this section">&para;</a></h4>
<h5 id="set-cpg-typedomain-str">set_cpg_type(domain: str)<a class="heading-anchor" href="#set-cpg-typedomain-str" title="Link to this section">&para;</a></h5>
<p>Установить активный домен.</p>
<div class="highlight"><pre><span></span><code><span class="nx">config</span><span class="p">.</span><span class="nx">set_cpg_type</span><span class="p">(</span><span class="s">&quot;postgresql&quot;</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nx">или</span><span class="w"> </span><span class="s">&quot;linux_kernel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;llvm&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;generic&quot;</span>
</code></pre></div>

<h5 id="get-code-analyst-title-str">get_code_analyst_title() -&gt; str<a class="heading-anchor" href="#get-code-analyst-title-str" title="Link to this section">&para;</a></h5>
<p>Получить название аналитика, специфичное для домена.</p>
<div class="highlight"><pre><span></span><code>title = config.get_code_analyst_title()
<span class="gh">#</span> Возвращает: &quot;PostgreSQL 17.6 expert&quot; {#returns-postgresql-176-expert}
</code></pre></div>

<hr />
<h3 id="domainregistry">DomainRegistry<a class="heading-anchor" href="#domainregistry" title="Link to this section">&para;</a></h3>
<p>Управление плагинами доменов.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.domains</span><span class="w"> </span><span class="kn">import</span> <span class="n">DomainRegistry</span><span class="p">,</span> <span class="n">get_active_domain</span>
</code></pre></div>

<h4 id="metody_9">Методы<a class="heading-anchor" href="#metody_9" title="Link to this section">&para;</a></h4>
<h5 id="activatedomain-name-str">activate(domain_name: str)<a class="heading-anchor" href="#activatedomain-name-str" title="Link to this section">&para;</a></h5>
<p>Активировать плагин домена.</p>
<div class="highlight"><pre><span></span><code>DomainRegistry.activate(&quot;postgresql&quot;)
</code></pre></div>

<h5 id="get-active-or-none-optionaldomainplugin">get_active_or_none() -&gt; Optional[DomainPlugin]<a class="heading-anchor" href="#get-active-or-none-optionaldomainplugin" title="Link to this section">&para;</a></h5>
<p>Получить текущий активный домен.</p>
<div class="highlight"><pre><span></span><code>domain = DomainRegistry.get_active_or_none()
if domain:
    print(f&quot;Активен: {domain.name}&quot;)
</code></pre></div>

<hr />
<h2 id="data-types">Типы данных<a class="heading-anchor" href="#data-types" title="Link to this section">&para;</a></h2>
<h3 id="relevancescore">RelevanceScore<a class="heading-anchor" href="#relevancescore" title="Link to this section">&para;</a></h3>
<p>Рейтинговая оценка с детализацией.</p>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">RelevanceScore</span><span class="p">:</span>
<span class="w">    </span><span class="nl">total_score</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span>
<span class="w">    </span><span class="nl">breakdown</span><span class="p">:</span><span class="w"> </span><span class="n">Dict</span><span class="o">[</span><span class="n">str, float</span><span class="o">]</span>
<span class="w">    </span><span class="nl">metadata</span><span class="p">:</span><span class="w"> </span><span class="n">Dict</span>
</code></pre></div>

<h3 id="workflowstate">WorkflowState<a class="heading-anchor" href="#workflowstate" title="Link to this section">&para;</a></h3>
<p>Состояние выполнения рабочего процесса.</p>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">WorkflowState</span><span class="p">:</span>
<span class="w">    </span><span class="nl">question</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">analysis</span><span class="p">:</span><span class="w"> </span><span class="n">Dict</span>
<span class="w">    </span><span class="nl">retrieval_results</span><span class="p">:</span><span class="w"> </span><span class="n">List</span>
<span class="w">    </span><span class="nl">query</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">execution_results</span><span class="p">:</span><span class="w"> </span><span class="n">List</span>
<span class="w">    </span><span class="nl">answer</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">confidence</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span>
<span class="w">    </span><span class="nl">errors</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>
</code></pre></div>

<hr />
<h2 id="security-hardening-classes">Классы усиления безопасности<a class="heading-anchor" href="#security-hardening-classes" title="Link to this section">&para;</a></h2>
<h3 id="hardeningscanner">HardeningScanner<a class="heading-anchor" href="#hardeningscanner" title="Link to this section">&para;</a></h3>
<p>Сканер соответствия усилению безопасности исходного кода D3FEND.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardeningScanner</span><span class="p">,</span> <span class="n">HardeningCategory</span><span class="p">,</span> <span class="n">HardeningSeverity</span>

<span class="n">scanner</span> <span class="o">=</span> <span class="n">HardeningScanner</span><span class="p">(</span><span class="n">cpg_service</span><span class="o">=</span><span class="n">cpg_service</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="metody_10">Методы<a class="heading-anchor" href="#metody_10" title="Link to this section">&para;</a></h4>
<h5 id="hardeningfinding">scan_all(limit_per_check: int = 50) -&gt; List[HardeningFinding]<a class="heading-anchor" href="#hardeningfinding" title="Link to this section">&para;</a></h5>
<p>Запускает все применимые проверки усиления безопасности.</p>
<div class="highlight"><pre><span></span><code>findings = scanner.scan_all(limit_per_check=50)
<span class="gh">#</span> Возвращает: [HardeningFinding(d3fend_id=&#39;D3-VI&#39;, severity=&#39;high&#39;, ...)] {#returns-hardeningfindingd3fend-idd3-vi-severityhigh}
</code></pre></div>

<h5 id="scan-by-d3fend-idd3fend-ids-liststr-limit-int-50-listhardeningfinding">scan_by_d3fend_id(d3fend_ids: List[str], limit: int = 50) -&gt; List[HardeningFinding]<a class="heading-anchor" href="#scan-by-d3fend-idd3fend-ids-liststr-limit-int-50-listhardeningfinding" title="Link to this section">&para;</a></h5>
<p>Запускает проверки для конкретных идентификаторов техник D3FEND.</p>
<div class="highlight"><pre><span></span><code><span class="n">findings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scanner</span><span class="o">.</span><span class="n">scan_by_d3fend_id</span><span class="p">([</span><span class="s2">&quot;D3-VI&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;D3-NPC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;D3-TL&quot;</span><span class="p">])</span>
<span class="c1"># Возвращает: Результаты для инициализации переменных, проверки нулевых указателей, доверенных библиотек {#returns-findings-for-variable-initialization-null-pointer-checking-trusted-library}</span>
</code></pre></div>

<h5 id="hardeningcategory">scan_by_category(category: HardeningCategory, limit: int = 50) -&gt; List[HardeningFinding]<a class="heading-anchor" href="#hardeningcategory" title="Link to this section">&para;</a></h5>
<p>Запускает проверки для конкретной категории.</p>
<div class="highlight"><pre><span></span><code>findings = scanner.scan_by_category(HardeningCategory.MEMORY_SAFETY)
<span class="gh">#</span> Возвращает: Результаты для всех проверок безопасности памяти {#returns-findings-for-all-memory-safety-checks}
</code></pre></div>

<h5 id="hardeningseverity">scan_by_severity(min_severity: HardeningSeverity, limit: int = 50) -&gt; List[HardeningFinding]<a class="heading-anchor" href="#hardeningseverity" title="Link to this section">&para;</a></h5>
<p>Запускает проверки с уровнем серьёзности не ниже заданного.</p>
<div class="highlight"><pre><span></span><code>findings = scanner.scan_by_severity(HardeningSeverity.HIGH)
<span class="gh">#</span> Возвращает: Результаты с серьёзностью CRITICAL или HIGH {#returns-findings-with-critical-or-high-severity}
</code></pre></div>

<h5 id="get-compliance-scorefindings-listhardeningfinding-dict">get_compliance_score(findings: List[HardeningFinding]) -&gt; Dict<a class="heading-anchor" href="#get-compliance-scorefindings-listhardeningfinding-dict" title="Link to this section">&para;</a></h5>
<p>Рассчитывает показатели соответствия на основе результатов.</p>
<div class="highlight"><pre><span></span><code>scores = scanner.get_compliance_score(findings)
<span class="gh">#</span> Возвращает: { {#returns}
<span class="gh">#</span> &#39;overall_score&#39;: 85.3, {#overall-score-853}
<span class="gh">#</span> &#39;total_findings&#39;: 12, {#total-findings-12}
<span class="gh">#</span> &#39;by_category&#39;: {&#39;initialization&#39;: 3, &#39;pointer_safety&#39;: 5, ...}, {#by-category-initialization-3-pointer-safety-5}
<span class="gh">#</span> &#39;by_d3fend&#39;: {&#39;D3-VI&#39;: 3, &#39;D3-NPC&#39;: 5, ...}, {#by-d3fend-d3-vi-3-d3-npc-5}
<span class="gh">#</span> &#39;by_severity&#39;: {&#39;high&#39;: 2, &#39;medium&#39;: 6, &#39;low&#39;: 4}, {#by-severity-high-2-medium-6-low-4}
<span class="gh">#</span> &#39;category_scores&#39;: {&#39;initialization&#39;: 70, &#39;pointer_safety&#39;: 50, ...}, {#category-scores-initialization-70-pointer-safety-50}
<span class="gh">#</span> &#39;d3fend_scores&#39;: {&#39;D3-VI&#39;: 70, &#39;D3-NPC&#39;: 50, ...} {#d3fend-scores-d3-vi-70-d3-npc-50}
<span class="gh">#</span> }
</code></pre></div>

<h5 id="get-remediation-reportfindings-listhardeningfinding-str">get_remediation_report(findings: List[HardeningFinding]) -&gt; str<a class="heading-anchor" href="#get-remediation-reportfindings-listhardeningfinding-str" title="Link to this section">&para;</a></h5>
<p>Генерирует отчёт по устранению проблем в формате Markdown.</p>
<div class="highlight"><pre><span></span><code><span class="n">report</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="n">get_remediation_report</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span>
<span class="n">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
<span class="o">#</span> <span class="o">#</span> <span class="err">Отчёт</span> <span class="err">по</span> <span class="err">усилению</span> <span class="err">безопасности</span> <span class="err">исходного</span> <span class="err">кода</span> <span class="n">D3FEND</span> <span class="p">{</span><span class="o">#</span><span class="n">d3fend</span><span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">code</span><span class="o">-</span><span class="n">hardening</span><span class="o">-</span><span class="n">report</span><span class="p">}</span>
<span class="o">#</span> <span class="o">##</span> <span class="err">Сводка</span> <span class="p">{</span><span class="o">#</span><span class="n">summary</span><span class="p">}</span>
<span class="o">#</span> <span class="o">-</span> <span class="o">**</span><span class="err">Общий</span> <span class="err">показатель</span> <span class="err">соответствия</span><span class="o">**</span><span class="p">:</span> <span class="mf">85.3</span><span class="err">%</span> <span class="p">{</span><span class="o">#</span><span class="n">overall</span><span class="o">-</span><span class="n">compliance</span><span class="o">-</span><span class="n">score</span><span class="o">-</span><span class="mi">853</span><span class="p">}</span>
<span class="o">#</span> <span class="o">-</span> <span class="o">**</span><span class="err">Общее</span> <span class="err">количество</span> <span class="err">проблем</span><span class="o">**</span><span class="p">:</span> <span class="mi">12</span> <span class="p">{</span><span class="o">#</span><span class="n">total</span><span class="o">-</span><span class="n">findings</span><span class="o">-</span><span class="mi">12</span><span class="p">}</span>
<span class="o">#</span> <span class="p">...</span>
</code></pre></div>

<h5 id="get-checks-summary-dict">get_checks_summary() -&gt; Dict<a class="heading-anchor" href="#get-checks-summary-dict" title="Link to this section">&para;</a></h5>
<p>Получает сводку по доступным проверкам.</p>
<div class="highlight"><pre><span></span><code>summary = scanner.get_checks_summary()
<span class="gh">#</span> Возвращает: { {#returns}
<span class="gh">#</span> &#39;total_checks&#39;: 22, {#total-checks-22}
<span class="gh">#</span> &#39;language&#39;: &#39;c&#39;, {#language-c}
<span class="gh">#</span> &#39;by_category&#39;: {...}, {#by-category}
<span class="gh">#</span> &#39;by_d3fend&#39;: {...}, {#by-d3fend}
<span class="gh">#</span> &#39;domain_checks&#39;: 10 {#domain-checks-10}
<span class="gh">#</span> }
</code></pre></div>

<hr />
<h3 id="hardeningcategory_1">HardeningCategory<a class="heading-anchor" href="#hardeningcategory_1" title="Link to this section">&para;</a></h3>
<p>Перечисление категорий усиления безопасности, соответствующих D3FEND.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardeningCategory</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HardeningCategory</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">INITIALIZATION</span> <span class="o">=</span> <span class="s2">&quot;initialization&quot;</span>           <span class="c1"># D3-VI</span>
    <span class="n">CREDENTIAL_MANAGEMENT</span> <span class="o">=</span> <span class="s2">&quot;credential_mgmt&quot;</span>   <span class="c1"># D3-CS</span>
    <span class="n">INTEGER_SAFETY</span> <span class="o">=</span> <span class="s2">&quot;integer_safety&quot;</span>           <span class="c1"># D3-IRV</span>
    <span class="n">POINTER_SAFETY</span> <span class="o">=</span> <span class="s2">&quot;pointer_safety&quot;</span>           <span class="c1"># D3-PV, D3-NPC, D3-MBSV</span>
    <span class="n">MEMORY_SAFETY</span> <span class="o">=</span> <span class="s2">&quot;memory_safety&quot;</span>             <span class="c1"># D3-RN</span>
    <span class="n">LIBRARY_SAFETY</span> <span class="o">=</span> <span class="s2">&quot;library_safety&quot;</span>           <span class="c1"># D3-TL</span>
    <span class="n">TYPE_SAFETY</span> <span class="o">=</span> <span class="s2">&quot;type_safety&quot;</span>                 <span class="c1"># D3-VTV</span>
    <span class="n">DOMAIN_VALIDATION</span> <span class="o">=</span> <span class="s2">&quot;domain_validation&quot;</span>     <span class="c1"># D3-DLV</span>
    <span class="n">OPERATIONAL_VALIDATION</span> <span class="o">=</span> <span class="s2">&quot;operational&quot;</span>      <span class="c1"># D3-OLV</span>
</code></pre></div>

<hr />
<h3 id="hardeningseverity_1">HardeningSeverity<a class="heading-anchor" href="#hardeningseverity_1" title="Link to this section">&para;</a></h3>
<p>Перечисление уровней серьёзности.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardeningSeverity</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HardeningSeverity</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s2">&quot;critical&quot;</span>  <span class="c1"># Подвержено прямой эксплуатации</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>          <span class="c1"># Значительный риск безопасности</span>
    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span>      <span class="c1"># Умеренный риск безопасности</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>            <span class="c1"># Незначительная проблема безопасности</span>
    <span class="n">INFO</span> <span class="o">=</span> <span class="s2">&quot;info&quot;</span>          <span class="c1"># Рекомендация по лучшим практикам</span>
</code></pre></div>

<hr />
<h3 id="hardeningcheck">HardeningCheck<a class="heading-anchor" href="#hardeningcheck" title="Link to this section">&para;</a></h3>
<p>Определение проверки усиления безопасности.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardeningCheck</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HardeningCheck</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>                    <span class="c1"># &quot;D3-VI-001&quot;</span>
    <span class="n">d3fend_id</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># &quot;D3-VI&quot;</span>
    <span class="n">d3fend_name</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># &quot;Variable Initialization&quot;</span>
    <span class="n">category</span><span class="p">:</span> <span class="n">HardeningCategory</span>
    <span class="n">severity</span><span class="p">:</span> <span class="n">HardeningSeverity</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">sql_query</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># SQL-запрос к базе данных CPG</span>
    <span class="n">cwe_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>         <span class="c1"># [&quot;CWE-457&quot;]</span>
    <span class="n">language_scope</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># [&quot;c&quot;, &quot;cpp&quot;] или [&quot;*&quot;]</span>
    <span class="n">indicators</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">good_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">remediation</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">example_code</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">confidence_weight</span><span class="p">:</span> <span class="nb">float</span>   <span class="c1"># 0.0-1.0</span>
</code></pre></div>

<h4 id="metody_11">Методы<a class="heading-anchor" href="#metody_11" title="Link to this section">&para;</a></h4>
<h5 id="applies-to-languagelanguage-str-bool">applies_to_language(language: str) -&gt; bool<a class="heading-anchor" href="#applies-to-languagelanguage-str-bool" title="Link to this section">&para;</a></h5>
<p>Проверяет, применима ли данная проверка к указанному языку.</p>
<div class="highlight"><pre><span></span><code>check = get_check_by_id(&quot;D3-VI-001&quot;)
if check.applies_to_language(&quot;c&quot;):
    print(&quot;Применимо к коду на C&quot;)
</code></pre></div>

<hr />
<h3 id="hardeningfinding_1">HardeningFinding<a class="heading-anchor" href="#hardeningfinding_1" title="Link to this section">&para;</a></h3>
<p>Результат выполнения проверки усиления безопасности.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardeningFinding</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HardeningFinding</span><span class="p">:</span>
    <span class="n">finding_id</span><span class="p">:</span> <span class="nb">str</span>      <span class="c1"># Уникальный идентификатор</span>
    <span class="n">check_id</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># &quot;D3-VI-001&quot;</span>
    <span class="n">d3fend_id</span><span class="p">:</span> <span class="nb">str</span>       <span class="c1"># &quot;D3-VI&quot;</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># &quot;initialization&quot;</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># &quot;high&quot;</span>
    <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span>     <span class="c1"># &quot;process_input&quot;</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># &quot;src/input.c&quot;</span>
    <span class="n">line_number</span><span class="p">:</span> <span class="nb">int</span>     <span class="c1"># 142</span>
    <span class="n">code_snippet</span><span class="p">:</span> <span class="nb">str</span>    <span class="c1"># &quot;int x; use(x);&quot;</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">cwe_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">remediation</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>    <span class="c1"># 0.0-1.0</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span>
</code></pre></div>

<h4 id="metody_12">Методы<a class="heading-anchor" href="#metody_12" title="Link to this section">&para;</a></h4>
<h5 id="to-dict-dict">to_dict() -&gt; Dict<a class="heading-anchor" href="#to-dict-dict" title="Link to this section">&para;</a></h5>
<p>Преобразует результат в словарь для сериализации.</p>
<div class="highlight"><pre><span></span><code>finding_dict = finding.to_dict()
<span class="gh">#</span> Возвращает: {&#39;finding_id&#39;: &#39;a1b2c3&#39;, &#39;d3fend_id&#39;: &#39;D3-VI&#39;, ...} {#returns-finding-id-a1b2c3-d3fend-id-d3-vi}
</code></pre></div>

<h5 id="from-check-and-rowcheck-row-confidence-hardeningfinding">from_check_and_row(check, row, confidence) -&gt; HardeningFinding<a class="heading-anchor" href="#from-check-and-rowcheck-row-confidence-hardeningfinding" title="Link to this section">&para;</a></h5>
<p>Создаёт результат на основе определения проверки и строки результата запроса.</p>
<div class="highlight"><pre><span></span><code>finding = HardeningFinding.from_check_and_row(check, row, confidence=0.9)
</code></pre></div>

<hr />
<h3 id="vspomogatelnye-funktsii-usileniya-bezopasnosti">Вспомогательные функции усиления безопасности<a class="heading-anchor" href="#vspomogatelnye-funktsii-usileniya-bezopasnosti" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_check_by_id</span><span class="p">,</span>
    <span class="n">get_checks_by_category</span><span class="p">,</span>
    <span class="n">get_checks_by_d3fend_id</span><span class="p">,</span>
    <span class="n">get_all_checks</span><span class="p">,</span>
    <span class="n">get_checks_for_language</span><span class="p">,</span>
    <span class="n">D3FEND_TECHNIQUES</span><span class="p">,</span>
    <span class="n">D3FEND_TECHNIQUE_IDS</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<h5 id="get-check-by-idcheck-id-str-optionalhardeningcheck">get_check_by_id(check_id: str) -&gt; Optional[HardeningCheck]<a class="heading-anchor" href="#get-check-by-idcheck-id-str-optionalhardeningcheck" title="Link to this section">&para;</a></h5>
<p>Получает проверку по её идентификатору.</p>
<div class="highlight"><pre><span></span><code>check = get_check_by_id(&quot;D3-VI-001&quot;)
</code></pre></div>

<h5 id="get-checks-by-categorycategory-hardeningcategory-listhardeningcheck">get_checks_by_category(category: HardeningCategory) -&gt; List[HardeningCheck]<a class="heading-anchor" href="#get-checks-by-categorycategory-hardeningcategory-listhardeningcheck" title="Link to this section">&para;</a></h5>
<p>Получает все проверки в указанной категории.</p>
<div class="highlight"><pre><span></span><code>memory_checks = get_checks_by_category(HardeningCategory.MEMORY_SAFETY)
</code></pre></div>

<h5 id="get-checks-by-d3fend-idd3fend-id-str-listhardeningcheck">get_checks_by_d3fend_id(d3fend_id: str) -&gt; List[HardeningCheck]<a class="heading-anchor" href="#get-checks-by-d3fend-idd3fend-id-str-listhardeningcheck" title="Link to this section">&para;</a></h5>
<p>Получает все проверки для техники D3FEND.</p>
<div class="highlight"><pre><span></span><code>null_checks = get_checks_by_d3fend_id(&quot;D3-NPC&quot;)
</code></pre></div>

<h5 id="get-all-checks-listhardeningcheck">get_all_checks() -&gt; List[HardeningCheck]<a class="heading-anchor" href="#get-all-checks-listhardeningcheck" title="Link to this section">&para;</a></h5>
<p>Получает все зарегистрированные проверки усиления безопасности.</p>
<div class="highlight"><pre><span></span><code>all_checks = get_all_checks()
print(f&quot;Общее количество проверок: {len(all_checks)}&quot;)
</code></pre></div>

<h5 id="get-checks-for-languagelanguage-str-listhardeningcheck">get_checks_for_language(language: str) -&gt; List[HardeningCheck]<a class="heading-anchor" href="#get-checks-for-languagelanguage-str-listhardeningcheck" title="Link to this section">&para;</a></h5>
<p>Получает проверки, применимые к конкретному языку.</p>
<div class="highlight"><pre><span></span><code>c_checks = get_checks_for_language(&quot;c&quot;)
</code></pre></div>

<h4 id="konstanty-d3fend">Константы D3FEND<a class="heading-anchor" href="#konstanty-d3fend" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="err">Доступные</span> <span class="err">идентификаторы</span> <span class="err">техник</span> <span class="n">D3FEND</span> <span class="p">{</span><span class="o">#</span><span class="n">available</span><span class="o">-</span><span class="n">d3fend</span><span class="o">-</span><span class="n">technique</span><span class="o">-</span><span class="n">ids</span><span class="p">}</span>
<span class="n">D3FEND_TECHNIQUE_IDS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&quot;D3-VI&quot;</span><span class="p">,</span>   <span class="o">#</span> <span class="err">Инициализация</span> <span class="err">переменных</span>
    <span class="s">&quot;D3-CS&quot;</span><span class="p">,</span>   <span class="o">#</span> <span class="err">Очистка</span> <span class="err">учётных</span> <span class="err">данных</span>
    <span class="s">&quot;D3-IRV&quot;</span><span class="p">,</span>  <span class="o">#</span> <span class="err">Проверка</span> <span class="err">диапазона</span> <span class="err">целых</span> <span class="err">чисел</span>
    <span class="s">&quot;D3-PV&quot;</span><span class="p">,</span>   <span class="o">#</span> <span class="err">Проверка</span> <span class="err">указателей</span>
    <span class="s">&quot;D3-RN&quot;</span><span class="p">,</span>   <span class="o">#</span> <span class="err">Обнуление</span> <span class="err">ссылок</span>
    <span class="s">&quot;D3-TL&quot;</span><span class="p">,</span>   <span class="o">#</span> <span class="err">Доверенная</span> <span class="err">библиотека</span>
    <span class="s">&quot;D3-VTV&quot;</span><span class="p">,</span>  <span class="o">#</span> <span class="err">Проверка</span> <span class="err">типа</span> <span class="err">переменных</span>
    <span class="s">&quot;D3-MBSV&quot;</span><span class="p">,</span> <span class="o">#</span> <span class="err">Проверка</span> <span class="err">начала</span> <span class="err">блока</span> <span class="err">памяти</span>
    <span class="s">&quot;D3-NPC&quot;</span><span class="p">,</span>  <span class="o">#</span> <span class="err">Проверка</span> <span class="err">нулевых</span> <span class="err">указателей</span>
    <span class="s">&quot;D3-DLV&quot;</span><span class="p">,</span>  <span class="o">#</span> <span class="err">Проверка</span> <span class="err">логики</span> <span class="err">домена</span>
    <span class="s">&quot;D3-OLV&quot;</span><span class="p">,</span>  <span class="o">#</span> <span class="err">Проверка</span> <span class="err">операционной</span> <span class="err">логики</span>
<span class="p">]</span>

<span class="o">#</span> <span class="err">Метаданные</span> <span class="err">техник</span> <span class="n">D3FEND</span> <span class="p">{</span><span class="o">#</span><span class="n">d3fend</span><span class="o">-</span><span class="n">technique</span><span class="o">-</span><span class="n">metadata</span><span class="p">}</span>
<span class="n">D3FEND_TECHNIQUES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;D3-VI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Инициализация переменных&quot;</span><span class="p">,</span>
        <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Присвоение переменным известного значения до использования&quot;</span><span class="p">,</span>
        <span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="s">&quot;https://next.d3fend.mitre.org/technique/d3f:VariableInitialization&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="o">#</span> <span class="p">...</span> <span class="err">другие</span> <span class="err">техники</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="error-handling">Обработка ошибок<a class="heading-anchor" href="#error-handling" title="Link to this section">&para;</a></h2>
<h3 id="rasprostranyonnye-isklyucheniya">Распространённые исключения<a class="heading-anchor" href="#rasprostranyonnye-isklyucheniya" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Исключение</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPGQueryError</td>
<td>Ошибка выполнения запроса к базе данных</td>
</tr>
<tr>
<td>VectorStoreError</td>
<td>Ошибка векторного поиска</td>
</tr>
<tr>
<td>LLMError</td>
<td>Ошибка генерации модели LLM</td>
</tr>
<tr>
<td>WorkflowError</td>
<td>Ошибка выполнения рабочего процесса</td>
</tr>
</tbody>
</table></div>
<h3 id="error-handling-pattern">Шаблон обработки ошибок<a class="heading-anchor" href="#error-handling-pattern" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">run_workflow</span><span class="o">(</span><span class="n">question</span><span class="o">)</span>
<span class="n">except</span><span class="w"> </span><span class="n">CPGQueryError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="n">print</span><span class="o">(</span><span class="n">f</span><span class="s2">&quot;Ошибка базы данных: {e}&quot;</span><span class="o">)</span>
<span class="n">except</span><span class="w"> </span><span class="n">LLMError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="n">print</span><span class="o">(</span><span class="n">f</span><span class="s2">&quot;Ошибка LLM: {e}&quot;</span><span class="o">)</span>
<span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="n">print</span><span class="o">(</span><span class="n">f</span><span class="s2">&quot;Неожиданная ошибка: {e}&quot;</span><span class="o">)</span>
</code></pre></div>

<h2 id="next-steps">Дальнейшие шаги<a class="heading-anchor" href="#next-steps" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="AGENTS.html">Справочник агентов</a> — подробная документация по агентам</li>
<li><a href="WORKFLOWS.html">Справочник рабочих процессов</a> — система рабочих процессов</li>
<li><a href="../guides/TUI_USER_GUIDE.html">Руководство пользователя TUI</a> — примеры использования</li>
</ul>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="HYPOTHESIS_SYSTEM.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Назад</span>
        <span class="doc-page-nav-title">Справочная система гипотез</span>
      </a>

      <a href="ANALYSIS_MODULES.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Вперед</span>
        <span class="doc-page-nav-title">Справочник модулей анализа</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Обновлено: 2025-12-25</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/reference/API.md" target="_blank" rel="noopener">Редактировать на GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">На этой странице</div>
      <ul class="doc-toc-list">
        <li><a href="#spravochnik-api" class="level-1">Справочник API</a></li>
<li><a href="#soderzhanie" class="level-2">Содержание</a></li>
<li><a href="#osnovnye-servisy" class="level-2">Основные сервисы</a></li>
<li><a href="#cpgqueryservice" class="level-3">CPGQueryService</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает: [</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает: [</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает: [</a></li>
<li><a href="#vozvraschaet-52303" class="level-1">Возвращает: 52303</a></li>
<li><a href="#vectorstorereal" class="level-3">VectorStoreReal</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает: [</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает: [</a></li>
<li><a href="#hybridretriever" class="level-3">HybridRetriever</a></li>
<li><a href="#klassy-agentov" class="level-2">Классы агентов</a></li>
<li><a href="#analyzeragent" class="level-3">AnalyzerAgent</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#intent-find-methods" class="level-1">'intent': 'find_methods',</a></li>
<li><a href="#domain-transaction-manager" class="level-1">'domain': 'transaction-manager',</a></li>
<li><a href="#keywords-transaction-commit" class="level-1">'keywords': ['transaction', 'commit'],</a></li>
<li><a href="#query-type-semantic" class="level-1">'query_type': 'semantic'</a></li>
<li><a href="#" class="level-1">}</a></li>
<li><a href="#retrieveragent" class="level-3">RetrieverAgent</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#results" class="level-1">'results': [...],</a></li>
<li><a href="#ranked-results" class="level-1">'ranked_results': [...],</a></li>
<li><a href="#retrieval-stats" class="level-1">'retrieval_stats':</a></li>
<li><a href="#" class="level-1">}</a></li>
<li><a href="#enrichmentagent" class="level-3">EnrichmentAgent</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#generatoragent" class="level-3">GeneratorAgent</a></li>
<li><a href="#vozvraschaet-select-from-nodes-method-where" class="level-1">Возвращает: "SELECT * FROM nodes_method WHERE..."</a></li>
<li><a href="#interpreteragent" class="level-3">InterpreterAgent</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#answer-sleduyuschie-15-metodov-vyzyvayut-lwlockacquire" class="level-1">'answer': 'Следующие 15 методов вызывают LWLockAcquire...',</a></li>
<li><a href="#confidence-085" class="level-1">'confidence': 0.85,</a></li>
<li><a href="#sources" class="level-1">'sources': [...]</a></li>
<li><a href="#" class="level-1">}</a></li>
<li><a href="#klassy-rabochih-protsessov" class="level-2">Классы рабочих процессов</a></li>
<li><a href="#langgraphworkflow" class="level-3">LangGraphWorkflow</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#answer" class="level-1">'answer': '...',</a></li>
<li><a href="#confidence-085" class="level-1">'confidence': 0.85,</a></li>
<li><a href="#query-used" class="level-1">'query_used': '...',</a></li>
<li><a href="#execution-time-ms-1500" class="level-1">'execution_time_ms': 1500</a></li>
<li><a href="#" class="level-1">}</a></li>
<li><a href="#multiscenarioworkflow" class="level-3">MultiScenarioWorkflow</a></li>
<li><a href="#klassy-konfiguratsii" class="level-2">Классы конфигурации</a></li>
<li><a href="#cpgconfig" class="level-3">CPGConfig</a></li>
<li><a href="#vozvraschaet-postgresql-176-expert" class="level-1">Возвращает: "PostgreSQL 17.6 expert"</a></li>
<li><a href="#domainregistry" class="level-3">DomainRegistry</a></li>
<li><a href="#tipy-dannyh" class="level-2">Типы данных</a></li>
<li><a href="#relevancescore" class="level-3">RelevanceScore</a></li>
<li><a href="#workflowstate" class="level-3">WorkflowState</a></li>
<li><a href="#klassy-usileniya-bezopasnosti" class="level-2">Классы усиления безопасности</a></li>
<li><a href="#hardeningscanner" class="level-3">HardeningScanner</a></li>
<li><a href="#vozvraschaet-hardeningfindingd3fend-idd3-vi-severityhigh" class="level-1">Возвращает: [HardeningFinding(d3fend_id='D3-VI', severity='high', ...)]</a></li>
<li><a href="#vozvraschaet-rezultaty-dlya-initsializatsii-peremennyh-proverki-nulevyh-ukazateley-doverennyh-bibliotek" class="level-1">Возвращает: Результаты для инициализации переменных, проверки нулевых указателей, доверенных библиотек</a></li>
<li><a href="#vozvraschaet-rezultaty-dlya-vseh-proverok-bezopasnosti-pamyati" class="level-1">Возвращает: Результаты для всех проверок безопасности памяти</a></li>
<li><a href="#vozvraschaet-rezultaty-s-seryoznostyu-critical-ili-high" class="level-1">Возвращает: Результаты с серьёзностью CRITICAL или HIGH</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#overall-score-853" class="level-1">'overall_score': 85.3,</a></li>
<li><a href="#total-findings-12" class="level-1">'total_findings': 12,</a></li>
<li><a href="#by-category" class="level-1">'by_category':</a></li>
<li><a href="#by-d3fend" class="level-1">'by_d3fend':</a></li>
<li><a href="#by-severity" class="level-1">'by_severity':</a></li>
<li><a href="#category-scores" class="level-1">'category_scores':</a></li>
<li><a href="#d3fend-scores" class="level-1">'d3fend_scores':</a></li>
<li><a href="#" class="level-1">}</a></li>
<li><a href="#otchyot-po-usileniyu-bezopasnosti-ishodnogo-koda-d3fend" class="level-1"># Отчёт по усилению безопасности исходного кода D3FEND</a></li>
<li><a href="#svodka" class="level-1">## Сводка</a></li>
<li><a href="#obschiy-pokazatel-sootvetstviya-853" class="level-1">- **Общий показатель соответствия**: 85.3%</a></li>
<li><a href="#obschee-kolichestvo-problem-12" class="level-1">- **Общее количество проблем**: 12</a></li>
<li><a href="#" class="level-1">...</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#total-checks-22" class="level-1">'total_checks': 22,</a></li>
<li><a href="#language-c" class="level-1">'language': 'c',</a></li>
<li><a href="#by-category" class="level-1">'by_category':</a></li>
<li><a href="#by-d3fend" class="level-1">'by_d3fend':</a></li>
<li><a href="#domain-checks-10" class="level-1">'domain_checks': 10</a></li>
<li><a href="#" class="level-1">}</a></li>
<li><a href="#hardeningcategory" class="level-3">HardeningCategory</a></li>
<li><a href="#hardeningseverity" class="level-3">HardeningSeverity</a></li>
<li><a href="#hardeningcheck" class="level-3">HardeningCheck</a></li>
<li><a href="#hardeningfinding" class="level-3">HardeningFinding</a></li>
<li><a href="#vozvraschaet" class="level-1">Возвращает:</a></li>
<li><a href="#vspomogatelnye-funktsii-usileniya-bezopasnosti" class="level-3">Вспомогательные функции усиления безопасности</a></li>
<li><a href="#dostupnye-identifikatory-tehnik-d3fend" class="level-1">Доступные идентификаторы техник D3FEND</a></li>
<li><a href="#metadannye-tehnik-d3fend" class="level-1">Метаданные техник D3FEND</a></li>
<li><a href="#obrabotka-oshibok" class="level-2">Обработка ошибок</a></li>
<li><a href="#rasprostranyonnye-isklyucheniya" class="level-3">Распространённые исключения</a></li>
<li><a href="#shablon-obrabotki-oshibok" class="level-3">Шаблон обработки ошибок</a></li>
<li><a href="#dalneyshie-shagi" class="level-2">Дальнейшие шаги</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI-копилот для анализа исходного кода</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Продукт</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Возможности</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Интеграции</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Документация</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Начало работы</a></li>
              <li><a href="../guides/index.html" class="footer-link">Руководства</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Ресурсы</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Контакты</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. Все права защищены.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
