<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: Справочник модулей анализа">
  <meta name="keywords" content="CodeGraph, documentation, reference">

  <meta property="og:title" content="Справочник модулей анализа - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: Справочник модулей анализа">
  <meta property="og:type" content="article">

  <title>Справочник модулей анализа - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="nav-link active">Документация</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/reference/ANALYSIS_MODULES.html" class="">EN</a>
          <a href="../../ru/reference/ANALYSIS_MODULES.html" class="active">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Переключить тему">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Запросить демо</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Документация</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Запросить демо</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Начало работы</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Обзор</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Руководство по настройке</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Руководство по установке</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Руководства</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../guides/index.html">Обзор</a></li>
        <li><a href="../guides/BENCHMARK_GUIDE.html">Руководство по тестовой платформе</a></li>
        <li><a href="../guides/CLI_GUIDE.html">Руководство по CLI</a></li>
        <li><a href="../guides/CODE_REVIEW.html">Система автоматического код-ревью на основе патчей</a></li>
        <li><a href="../guides/CPG_EXPORT.html">Руководство по экспорту CPG</a></li>
        <li><a href="../guides/MONITORING.html">Руководство по мониторингу</a></li>
        <li><a href="../guides/PROGRAMMATIC_GUIDE.html">Руководство пользователя</a></li>
        <li><a href="../guides/PROJECT_IMPORT.html">Импорт новой кодовой базы</a></li>
        <li><a href="../guides/QUICK_REFERENCE.html">Краткое руководство по CodeGraph</a></li>
        <li><a href="../guides/REFACTORING.html">Руководство по анализу рефакторинга</a></li>
        <li><a href="../guides/SCENARIOS.html">Руководство по сценариям рабочих процессов</a></li>
        <li><a href="../guides/TROUBLESHOOTING.html">Руководство по устранению неполадок</a></li>
        <li><a href="../guides/TUI_USER_GUIDE.html">Руководство пользователя CodeGraph</a></li>
        <li><a href="../guides/01-onboarding.html">Сценарий 01: Ввод нового разработчика</a></li>
        <li><a href="../guides/02-security-audit.html">Сценарий 02: Аудит безопасности</a></li>
        <li><a href="../guides/03-documentation.html">Сценарий 03: Генерация документации</a></li>
        <li><a href="../guides/04-feature-development.html">Сценарий 04: Разработка функций</a></li>
        <li><a href="../guides/05-refactoring.html">Сценарий 05: Рефакторинг</a></li>
        <li><a href="../guides/06-performance.html">Сценарий 06: Анализ производительности</a></li>
        <li><a href="../guides/07-test-coverage.html">Сценарий 07: Покрытие тестами</a></li>
        <li><a href="../guides/08-compliance.html">Сценарий 08: Проверка соответствия требованиям</a></li>
        <li><a href="../guides/09-code-review.html">Сценарий 09: Код-ревью</a></li>
        <li><a href="../guides/10-cross-repo.html">Сценарий 10: Анализ между репозиториями</a></li>
        <li><a href="../guides/11-architecture.html">Сценарий 11: Анализ архитектуры</a></li>
        <li><a href="../guides/12-tech-debt.html">Сценарий 12: Оценка технического долга</a></li>
        <li><a href="../guides/13-mass-refactoring.html">Сценарий 13: Массовая рефакторизация</a></li>
        <li><a href="../guides/14-incident-response.html">Сценарий 14: Реагирование на инциденты безопасности</a></li>
        <li><a href="../guides/15-debugging.html">Сценарий 15: Помощь в отладке</a></li>
        <li><a href="../guides/16-entry-points.html">Сценарий 16: Обнаружение точки входа</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Документация</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Обзор</a></li>
        <li><a href="../api/REST_API.html">Документация по REST API CodeGraph</a></li>
        <li><a href="../api/WEBSOCKET_API.html">Справочная документация по WebSocket API</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Интеграции</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Обзор</a></li>
        <li><a href="../integrations/GIGACHAT.html">Руководство по интеграции GigaChat</a></li>
        <li><a href="../integrations/YANDEX_AI_STUDIO.html">Руководство по интеграции Yandex AI Studio</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Справочник</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Обзор</a></li>
        <li><a href="AGENTS.html">Справочник агентов</a></li>
        <li><a href="ANALYSIS_MODULES.html" class="active">Справочник модулей анализа</a></li>
        <li><a href="API.html">Справочник API</a></li>
        <li><a href="HYPOTHESIS_SYSTEM.html">Справочная система гипотез</a></li>
        <li><a href="SCHEMA.html">Дизайн схемы DuckDB CPG (CPG Spec v1.1)</a></li>
        <li><a href="SECURITY.html">Модуль корпоративной безопасности</a></li>
        <li><a href="SQL_QUERY_COOKBOOK.html">Кулинарная книга SQL-запросов для DuckDB CPG</a></li>
        <li><a href="WORKFLOWS.html">Справочник по рабочим процессам</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Обзор</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Документация</a>
        <span>/</span>
        <a href="index.html">Справочник</a>
        <span>/</span>
        <span>Справочник модулей анализа</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>Справочник модулей анализа</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="spravochnik-moduley-analiza">Справочник модулей анализа<a class="heading-anchor" href="#spravochnik-moduley-analiza" title="Link to this section">&para;</a></h1>
<p>Полная документация по модулям анализа кода в <code>src/analysis/</code>.</p>
<h2 id="soderzhanie">Содержание<a class="heading-anchor" href="#soderzhanie" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="#overview">Обзор</a></li>
<li><a href="#cfganalyzer">CFGAnalyzer</a></li>
<li><a href="#features">Возможности</a></li>
<li><a href="#key-classes">Ключевые классы</a></li>
<li><a href="#api-reference">Справочник API</a></li>
<li><a href="#database-tables-used">Используемые таблицы базы данных</a></li>
<li><a href="#fieldsensitivetracer">FieldSensitiveTracer</a></li>
<li><a href="#features">Возможности</a></li>
<li><a href="#key-classes">Ключевые классы</a></li>
<li><a href="#api-reference">Справочник API</a></li>
<li><a href="#sensitive-field-categories">Категории чувствительных полей</a></li>
<li><a href="#database-tables-used">Используемые таблицы базы данных</a></li>
<li><a href="#dataflowtracer">DataFlowTracer</a></li>
<li><a href="#integration-methods">Методы интеграции</a></li>
<li><a href="#controlflowanalyzer-patch-review">ControlFlowAnalyzer (Проверка патчей)</a></li>
<li><a href="#features">Возможности</a></li>
<li><a href="#integration-with-cfganalyzer">Интеграция с CFGAnalyzer</a></li>
<li><a href="#loop-severity-classification">Классификация критичности циклов</a></li>
<li><a href="#usage-examples">Примеры использования</a></li>
<li><a href="#security-audit-scenario-2">Аудит безопасности (Сценарий 2)</a></li>
<li><a href="#complexity-analysis-scenario-56">Анализ сложности (Сценарий 5/6)</a></li>
<li><a href="#patch-review-scenario-9">Проверка патчей (Сценарий 9)</a></li>
<li><a href="#database-schema-reference">Справочник схемы базы данных</a></li>
<li><a href="#key-tables-for-analysis">Ключевые таблицы для анализа</a></li>
<li><a href="#edge-types-for-dataflow">Типы рёбер для потока данных</a></li>
<li><a href="#troubleshooting">Устранение неполадок</a></li>
<li><a href="#method-not-found">“Метод не найден”</a></li>
<li><a href="#no-cfg-data-found">“Данные CFG не найдены”</a></li>
<li><a href="#no-field-accesses-found">“Доступы к полям не найдены”</a></li>
<li><a href="#performance-considerations">Соображения по производительности</a></li>
<li><a href="#see-also">См. также</a></li>
</ul>
<h2 id="overview">Обзор<a class="heading-anchor" href="#overview" title="Link to this section">&para;</a></h2>
<p>Модули анализа обеспечивают расширенные возможности статического анализа на основе CPG (графа свойств кода), хранящегося в DuckDB:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Модуль</th>
<th>Назначение</th>
<th>Ключевые сценарии</th>
</tr>
</thead>
<tbody>
<tr>
<td>CFGAnalyzer</td>
<td>Анализ графа потока управления, метрики сложности</td>
<td>5, 6, 13 (рефакторинг, производительность)</td>
</tr>
<tr>
<td>FieldSensitiveTracer</td>
<td>Отслеживание загрязнения с учётом полей объектов</td>
<td>2, 8, 14 (безопасность, соответствие требованиям, расследование инцидентов)</td>
</tr>
<tr>
<td>DataFlowTracer</td>
<td>Универсальный интерфейс для анализа потоков данных</td>
<td>2, 14 (безопасность, реагирование на инциденты)</td>
</tr>
<tr>
<td>CallGraphAnalyzer</td>
<td>Обход графа вызовов</td>
<td>1, 12 (ввод в систему, пересечение репозиториев)</td>
</tr>
<tr>
<td>ConcurrencyAnalyzer</td>
<td>Обнаружение шаблонов блокировок/mutex’ов</td>
<td>16 (параллелизм)</td>
</tr>
<tr>
<td>CloneDetector</td>
<td>Обнаружение дублированного кода</td>
<td>7, 13 (рефакторинг)</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="cfganalyzer">CFGAnalyzer<a class="heading-anchor" href="#cfganalyzer" title="Link to this section">&para;</a></h2>
<p><strong>Файл:</strong> <code>src/analysis/cfg_analyzer.py</code></p>
<p>Анализ на основе графа потока управления (CFG) с использованием таблицы <code>edges_cfg</code> для точного анализа потока управления.</p>
<h3 id="features">Возможности<a class="heading-anchor" href="#features" title="Link to this section">&para;</a></h3>
<ul>
<li><strong>Цикломатическая сложность</strong>: Сложность Маккейба по формуле <code>M = E - N + 2</code></li>
<li><strong>Перечисление путей</strong>: Поиск путей выполнения на основе DFS с обнаружением циклов</li>
<li><strong>Анализ доминаторов</strong>: Построение деревьев доминаторов и пост-доминаторов</li>
<li><strong>Извлечение структуры CFG</strong>: Получение узлов, рёбер, точек входа и выхода</li>
</ul>
<h3 id="osnovnye-klassy">Основные классы<a class="heading-anchor" href="#osnovnye-klassy" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">CFGStructure</span><span class="p">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Описывает структуру CFG метода&quot;&quot;&quot;</span>
<span class="w">    </span><span class="nl">method_name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">method_full_name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">nodes</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">int</span><span class="o">]</span>
<span class="w">    </span><span class="nl">edges</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">Tuple[int, int</span><span class="o">]</span><span class="err">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">пары</span><span class="w"> </span><span class="p">(</span><span class="n">источник</span><span class="p">,</span><span class="w"> </span><span class="n">назначение</span><span class="p">)</span>
<span class="w">    </span><span class="nl">entry_nodes</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">int</span><span class="o">]</span>
<span class="w">    </span><span class="nl">exit_nodes</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">int</span><span class="o">]</span>
<span class="w">    </span><span class="nl">node_count</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">edge_count</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>

<span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">CFGPath</span><span class="p">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Описывает путь выполнения в CFG&quot;&quot;&quot;</span>
<span class="w">    </span><span class="nl">path_id</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">nodes</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">int</span><span class="o">]</span>
<span class="w">    </span><span class="nl">length</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">has_loop</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span>
</code></pre></div>

<h3 id="api-reference">Справочник API<a class="heading-anchor" href="#api-reference" title="Link to this section">&para;</a></h3>
<h4 id="cfganalyzercpg-service">CFGAnalyzer(cpg_service)<a class="heading-anchor" href="#cfganalyzercpg-service" title="Link to this section">&para;</a></h4>
<p>Инициализация с экземпляром CPGQueryService или подключением DuckDB.</p>
<h4 id="get-method-cfgmethod-name-str-optionalcfgstructure">get_method_cfg(method_name: str) -&gt; Optional[CFGStructure]<a class="heading-anchor" href="#get-method-cfgmethod-name-str-optionalcfgstructure" title="Link to this section">&para;</a></h4>
<p>Получить структуру CFG для метода.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.analysis.cfg_analyzer</span><span class="w"> </span><span class="kn">import</span> <span class="n">CFGAnalyzer</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">CFGAnalyzer</span><span class="p">(</span><span class="n">cpg_service</span><span class="p">)</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_method_cfg</span><span class="p">(</span><span class="s2">&quot;heap_insert&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Узлы: </span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">node_count</span><span class="si">}</span><span class="s2">, Рёбра: </span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">edge_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="compute-cyclomatic-complexitymethod-name-str-int">compute_cyclomatic_complexity(method_name: str) -&gt; int<a class="heading-anchor" href="#compute-cyclomatic-complexitymethod-name-str-int" title="Link to this section">&para;</a></h4>
<p>Вычислить цикломатическую сложность Маккейба: <code>M = E - N + 2</code></p>
<div class="highlight"><pre><span></span><code>complexity = analyzer.compute_cyclomatic_complexity(&quot;heap_insert&quot;)
print(f&quot;Сложность: {complexity}&quot;)  # например, 15
</code></pre></div>

<h4 id="enumerate-pathsmethod-name-str-max-paths-int-100-listcfgpath">enumerate_paths(method_name: str, max_paths: int = 100) -&gt; List[CFGPath]<a class="heading-anchor" href="#enumerate-pathsmethod-name-str-max-paths-int-100-listcfgpath" title="Link to this section">&para;</a></h4>
<p>Найти пути выполнения в CFG с обнаружением циклов.</p>
<div class="highlight"><pre><span></span><code><span class="n">paths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analyzer</span><span class="o">.</span><span class="n">enumerate_paths</span><span class="p">(</span><span class="s2">&quot;process_query&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">max_paths</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">paths</span><span class="p">:</span>
<span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Путь {path.path_id}: {path.length} узлов, цикл={path.has_loop}&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="find-dominatorsmethod-name-str-dictint-setint">find_dominators(method_name: str) -&gt; Dict[int, Set[int]]<a class="heading-anchor" href="#find-dominatorsmethod-name-str-dictint-setint" title="Link to this section">&para;</a></h4>
<p>Построить дерево доминаторов с использованием таблицы <code>edges_dominate</code>.</p>
<h4 id="find-post-dominatorsmethod-name-str-dictint-setint">find_post_dominators(method_name: str) -&gt; Dict[int, Set[int]]<a class="heading-anchor" href="#find-post-dominatorsmethod-name-str-dictint-setint" title="Link to this section">&para;</a></h4>
<p>Построить дерево пост-доминаторов с использованием таблицы <code>edges_post_dominate</code>.</p>
<h4 id="analyze-complexity-distribution-dictstr-any">analyze_complexity_distribution() -&gt; Dict[str, Any]<a class="heading-anchor" href="#analyze-complexity-distribution-dictstr-any" title="Link to this section">&para;</a></h4>
<p>Проанализировать распределение сложности по всем методам в кодовой базе.</p>
<div class="highlight"><pre><span></span><code>dist = analyzer.analyze_complexity_distribution()
print(f&quot;Средняя сложность: {dist[&#39;average&#39;]}&quot;)
print(f&quot;Методы с высокой сложностью: {dist[&#39;high_complexity_methods&#39;]}&quot;)
</code></pre></div>

<h3 id="database-tables-used">Используемые таблицы базы данных<a class="heading-anchor" href="#database-tables-used" title="Link to this section">&para;</a></h3>
<ul>
<li><code>nodes_method</code> — Метаданные методов</li>
<li><code>edges_contains</code> — Связи методов с узлами</li>
<li><code>edges_cfg</code> — Рёбра графа потока управления (CFG) между узлами</li>
<li><code>edges_dominate</code> — Отношения доминирования</li>
<li><code>edges_post_dominate</code> — Отношения пост-доминирования</li>
</ul>
<hr />
<h2 id="fieldsensitivetracer">FieldSensitiveTracer<a class="heading-anchor" href="#fieldsensitivetracer" title="Link to this section">&para;</a></h2>
<p><strong>Файл:</strong> <code>src/analysis/field_sensitive_tracer.py</code></p>
<p>Отслеживание путей полей для точного анализа заражения (taint analysis), с различением различных полей одного и того же объекта.</p>
<h3 id="vozmozhnosti">Возможности<a class="heading-anchor" href="#vozmozhnosti" title="Link to this section">&para;</a></h3>
<ul>
<li><strong>Разбор путей к полям</strong>: Обработка цепочек вида <code>obj.field1.field2</code> и <code>obj-&gt;field-&gt;data</code></li>
<li><strong>Отслеживание доступа к полям</strong>: Поиск всех чтений/записей в конкретные поля</li>
<li><strong>Распространение заражения</strong>: Отслеживание заражённых данных через доступ к полям</li>
<li><strong>Обнаружение чувствительных полей</strong>: Выявление потоков данных из чувствительных полей (пароль, токен и т.д.)</li>
</ul>
<h3 id="osnovnye-klassy_1">Основные классы<a class="heading-anchor" href="#osnovnye-klassy_1" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">FieldPath</span><span class="p">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Представляет путь доступа к полю, например obj.field1.field2&quot;&quot;&quot;</span>
<span class="w">    </span><span class="nl">base_variable</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">field_chain</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>
<span class="w">    </span><span class="nl">full_path</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">node_ids</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">int</span><span class="o">]</span>
<span class="w">    </span><span class="nl">type_full_name</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>

<span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">FieldAccess</span><span class="p">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Представляет один доступ к полю в коде&quot;&quot;&quot;</span>
<span class="w">    </span><span class="nl">node_id</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">base_variable</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">field_name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">access_code</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">line_number</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">filename</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">access_type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="s1">&#39;read&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;call&#39;</span>
<span class="w">    </span><span class="nl">containing_method</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>

<span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">FieldSensitiveFlow</span><span class="p">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Путь передачи данных с учётом полей&quot;&quot;&quot;</span>
<span class="w">    </span><span class="nl">source_path</span><span class="p">:</span><span class="w"> </span><span class="n">FieldPath</span>
<span class="w">    </span><span class="nl">sink_path</span><span class="p">:</span><span class="w"> </span><span class="n">FieldPath</span>
<span class="w">    </span><span class="nl">intermediate_fields</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">FieldPath</span><span class="o">]</span>
<span class="w">    </span><span class="nl">is_tainted</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span>
<span class="w">    </span><span class="nl">relationship</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="s1">&#39;exact&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;prefix&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;suffix&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;propagated&#39;</span>
<span class="w">    </span><span class="nl">confidence</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span>
</code></pre></div>

<h3 id="spravochnik-api">Справочник API<a class="heading-anchor" href="#spravochnik-api" title="Link to this section">&para;</a></h3>
<h4 id="fieldsensitivetracercpg-service">FieldSensitiveTracer(cpg_service)<a class="heading-anchor" href="#fieldsensitivetracercpg-service" title="Link to this section">&para;</a></h4>
<p>Инициализация с CPGQueryService или подключением DuckDB.</p>
<h4 id="parse-field-pathcode-str-fieldpath">parse_field_path(code: str) -&gt; FieldPath<a class="heading-anchor" href="#parse-field-pathcode-str-fieldpath" title="Link to this section">&para;</a></h4>
<p>Разбирает строку доступа к полю в структурированный объект <code>FieldPath</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.analysis.field_sensitive_tracer</span><span class="w"> </span><span class="kn">import</span> <span class="n">FieldSensitiveTracer</span>

<span class="n">tracer</span> <span class="o">=</span> <span class="n">FieldSensitiveTracer</span><span class="p">(</span><span class="n">cpg_service</span><span class="p">)</span>

<span class="c1"># Разбор нотации указателей {#parse-pointer-notation}</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">tracer</span><span class="o">.</span><span class="n">parse_field_path</span><span class="p">(</span><span class="s2">&quot;user-&gt;password&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">base_variable</span><span class="p">)</span>  <span class="c1"># &quot;user&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">field_chain</span><span class="p">)</span>    <span class="c1"># [&quot;password&quot;]</span>

<span class="c1"># Разбор нотации через точку {#parse-dot-notation}</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">tracer</span><span class="o">.</span><span class="n">parse_field_path</span><span class="p">(</span><span class="s2">&quot;request.data.buffer&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">full_path</span><span class="p">)</span>  <span class="c1"># &quot;request.data.buffer&quot;</span>
</code></pre></div>

<h4 id="get-struct-fieldsstruct-name-str-listdict">get_struct_fields(struct_name: str) -&gt; List[Dict]<a class="heading-anchor" href="#get-struct-fieldsstruct-name-str-listdict" title="Link to this section">&para;</a></h4>
<p>Получает поля, определённые в структуре, с информацией о типах.</p>
<div class="highlight"><pre><span></span><code><span class="nx">fields</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">tracer</span><span class="p">.</span><span class="nx">get_struct_fields</span><span class="p">(</span><span class="s">&quot;UserData&quot;</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="nx">field</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">fields</span><span class="p">:</span>
<span class="w">    </span><span class="nx">print</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;{field[&#39;name&#39;]}: {field[&#39;type&#39;]}&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="find-field-accessesbase-var-str-field-name-str-listfieldaccess">find_field_accesses(base_var: str, field_name: str) -&gt; List[FieldAccess]<a class="heading-anchor" href="#find-field-accessesbase-var-str-field-name-str-listfieldaccess" title="Link to this section">&para;</a></h4>
<p>Находит все обращения к конкретному полю.</p>
<div class="highlight"><pre><span></span><code><span class="nx">accesses</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">tracer</span><span class="p">.</span><span class="nx">find_field_accesses</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;password&quot;</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="nx">access</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">accesses</span><span class="p">:</span>
<span class="w">    </span><span class="nx">print</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;{access.filename}:{access.line_number} - {access.access_type}&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="trace-field-taintsource-field-str-sink-functions-liststr-listfieldsensitiveflow">trace_field_taint(source_field: str, sink_functions: List[str]) -&gt; List[FieldSensitiveFlow]<a class="heading-anchor" href="#trace-field-taintsource-field-str-sink-functions-liststr-listfieldsensitiveflow" title="Link to this section">&para;</a></h4>
<p>Отслеживает заражение от исходного поля до функций-приёмников (sinks).</p>
<div class="highlight"><pre><span></span><code><span class="n">flows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tracer</span><span class="p">.</span><span class="n">trace_field_taint</span><span class="p">(</span>
<span class="w">    </span><span class="n">source_field</span><span class="o">=</span><span class="s">&quot;credentials-&gt;password&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">sink_functions</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;printf&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;log&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;send&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">for</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">flows</span><span class="o">:</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Заражённый поток: {flow.source_path} -&gt; {flow.sink_path}&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="find-sensitive-field-flowssensitive-fields-liststr-none-sink-functions-liststr-none-listfieldsensitiveflow">find_sensitive_field_flows(sensitive_fields: List[str] = None, sink_functions: List[str] = None) -&gt; List[FieldSensitiveFlow]<a class="heading-anchor" href="#find-sensitive-field-flowssensitive-fields-liststr-none-sink-functions-liststr-none-listfieldsensitiveflow" title="Link to this section">&para;</a></h4>
<p>Находит потоки данных из чувствительных полей в опасные приёмники.</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Чувствительные поля по умолчанию: password, token, secret, private_key, credential, auth {#default-sensitive-fields-password-token-secret-private-key-credential-auth}
flows = tracer.find_sensitive_field_flows()
print(f&quot;Найдено {len(flows)} потенциальных утечек чувствительных данных&quot;)
</code></pre></div>

<h3 id="sensitive-field-categories">Категории чувствительных полей<a class="heading-anchor" href="#sensitive-field-categories" title="Link to this section">&para;</a></h3>
<p>Чувствительные поля, отслеживаемые по умолчанию:
- <code>password</code>, <code>passwd</code>, <code>pwd</code>
- <code>token</code>, <code>auth_token</code>, <code>access_token</code>
- <code>secret</code>, <code>api_secret</code>, <code>client_secret</code>
- <code>private_key</code>, <code>secret_key</code>
- <code>credential</code>, <code>credentials</code>
- <code>auth</code>, <code>authorization</code></p>
<h3 id="ispolzuemye-tablitsy-bazy-dannyh">Используемые таблицы базы данных<a class="heading-anchor" href="#ispolzuemye-tablitsy-bazy-dannyh" title="Link to this section">&para;</a></h3>
<ul>
<li><code>nodes_field_identifier</code> — узлы доступа к полям</li>
<li><code>nodes_identifier</code> — идентификаторы переменных</li>
<li><code>nodes_member</code> — определения полей структур</li>
<li><code>edges_reaching_def</code> — рёбра достижимых определений</li>
<li><code>edges_argument</code> — рёбра аргументов функций</li>
</ul>
<hr />
<h2 id="dataflowtracer">DataFlowTracer<a class="heading-anchor" href="#dataflowtracer" title="Link to this section">&para;</a></h2>
<p><strong>Файл:</strong> <code>src/analysis/dataflow_tracer.py</code></p>
<p>Фасадный модуль, предоставляющий единый интерфейс к возможностям анализа потоков данных.</p>
<h3 id="integration-methods">Методы интеграции<a class="heading-anchor" href="#integration-methods" title="Link to this section">&para;</a></h3>
<p>DataFlowTracer обеспечивает интеграцию базового анализа потоков данных и анализа с учётом полей:</p>
<h4 id="find-taint-paths-field-sensitivesource-functions-sink-functions-track-fieldstrue-max-depth10-listdataflowpath">find_taint_paths_field_sensitive(source_functions, sink_functions, track_fields=True, max_depth=10) -&gt; List[DataFlowPath]<a class="heading-anchor" href="#find-taint-paths-field-sensitivesource-functions-sink-functions-track-fieldstrue-max-depth10-listdataflowpath" title="Link to this section">&para;</a></h4>
<p>Расширенный анализ заражения (taint analysis) с опциональным отслеживанием полей.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.analysis.dataflow_tracer</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFlowTracer</span>

<span class="n">tracer</span> <span class="o">=</span> <span class="n">DataFlowTracer</span><span class="p">(</span><span class="n">cpg_service</span><span class="p">)</span>

<span class="c1"># Поиск путей заражения с учётом полей {#find-taint-paths-with-field-sensitivity}</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">tracer</span><span class="o">.</span><span class="n">find_taint_paths_field_sensitive</span><span class="p">(</span>
    <span class="n">source_functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;getenv&quot;</span><span class="p">,</span> <span class="s2">&quot;fgets&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">],</span>
    <span class="n">sink_functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="s2">&quot;popen&quot;</span><span class="p">],</span>
    <span class="n">track_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Источник: </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">source</span><span class="si">}</span><span class="s2"> -&gt; Приёмник: </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">sink</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Обращения к полям: </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">field_accesses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="find-sensitive-data-flowssensitive-fieldsnone-sink-functionsnone-listdict">find_sensitive_data_flows(sensitive_fields=None, sink_functions=None) -&gt; List[Dict]<a class="heading-anchor" href="#find-sensitive-data-flowssensitive-fieldsnone-sink-functionsnone-listdict" title="Link to this section">&para;</a></h4>
<p>Обёртка вокруг FieldSensitiveTracer для типовых задач анализа безопасности.</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Использование значений по умолчанию для распространённых шаблонов {#use-defaults-for-common-patterns}
flows = tracer.find_sensitive_data_flows()

<span class="gh">#</span> Или с настройкой под задачу {#or-customize}
flows = tracer.find_sensitive_data_flows(
    sensitive_fields=[&quot;api_key&quot;, &quot;bearer_token&quot;],
    sink_functions=[&quot;http_request&quot;, &quot;socket_send&quot;]
)
</code></pre></div>

<hr />
<h2 id="controlflowanalyzer-prosmotr-izmeneniy">ControlFlowAnalyzer (Просмотр изменений)<a class="heading-anchor" href="#controlflowanalyzer-prosmotr-izmeneniy" title="Link to this section">&para;</a></h2>
<p><strong>Файл:</strong> <code>src/patch_review/analyzers/control_flow_analyzer.py</code></p>
<p>Анализирует влияние изменений на поток управления, теперь с использованием CFGAnalyzer для точного расчёта метрик.</p>
<h3 id="vozmozhnosti_1">Возможности<a class="heading-anchor" href="#vozmozhnosti_1" title="Link to this section">&para;</a></h3>
<ul>
<li>Расчёт дельты сложности (до/после внесения изменений)</li>
<li>Обнаружение новых циклов с классификацией рисков</li>
<li>Отслеживание изменений в обработке ошибок</li>
<li>Оценка влияния на покрытие ветвлений</li>
</ul>
<h3 id="integration-with-cfganalyzer">Интеграция с CFGAnalyzer<a class="heading-anchor" href="#integration-with-cfganalyzer" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.patch_review.analyzers.control_flow_analyzer</span><span class="w"> </span><span class="kn">import</span> <span class="n">PatchControlFlowAnalyzer</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">PatchControlFlowAnalyzer</span><span class="p">(</span><span class="n">cpg_service</span><span class="p">)</span>

<span class="c1"># Анализ влияния изменений {#analyze-patch-impact}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_control_flow_changes</span><span class="p">(</span><span class="n">patch_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Дельта сложности: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">complexity_delta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Новые циклы: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">new_loops</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Изменения в обработке ошибок: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">error_handling_changes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="klassifikatsiya-seryoznosti-tsiklov">Классификация серьёзности циклов<a class="heading-anchor" href="#klassifikatsiya-seryoznosti-tsiklov" title="Link to this section">&para;</a></h3>
<p>Новые циклы классифицируются по уровню риска:
- <strong>HIGH</strong> (Высокий): Вложенные циклы, циклы с операциями ввода-вывода, неограниченные циклы
- <strong>MEDIUM</strong> (Средний): Циклы с внешними вызовами
- <strong>LOW</strong> (Низкий): Простые ограниченные циклы</p>
<hr />
<h2 id="usage-examples">Примеры использования<a class="heading-anchor" href="#usage-examples" title="Link to this section">&para;</a></h2>
<h3 id="security-audit-scenario-2">Аудит безопасности (Сценарий 2)<a class="heading-anchor" href="#security-audit-scenario-2" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.analysis.field_sensitive_tracer</span><span class="w"> </span><span class="kn">import</span> <span class="n">FieldSensitiveTracer</span>

<span class="n">tracer</span> <span class="o">=</span> <span class="n">FieldSensitiveTracer</span><span class="p">(</span><span class="n">cpg_service</span><span class="p">)</span>

<span class="c1"># Поиск утечек паролей {#find-password-leaks}</span>
<span class="n">flows</span> <span class="o">=</span> <span class="n">tracer</span><span class="o">.</span><span class="n">find_sensitive_field_flows</span><span class="p">(</span>
    <span class="n">sensitive_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span><span class="p">],</span>
    <span class="n">sink_functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;printf&quot;</span><span class="p">,</span> <span class="s2">&quot;fprintf&quot;</span><span class="p">,</span> <span class="s2">&quot;syslog&quot;</span><span class="p">,</span> <span class="s2">&quot;elog&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="n">flows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ОПАСНО: </span><span class="si">{</span><span class="n">flow</span><span class="o">.</span><span class="n">source_path</span><span class="si">}</span><span class="s2"> попадает в </span><span class="si">{</span><span class="n">flow</span><span class="o">.</span><span class="n">sink_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="complexity-analysis-scenario-56">Анализ сложности (Сценарий 5/6)<a class="heading-anchor" href="#complexity-analysis-scenario-56" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.analysis.cfg_analyzer</span><span class="w"> </span><span class="kn">import</span> <span class="n">CFGAnalyzer</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">CFGAnalyzer</span><span class="p">(</span><span class="n">cpg_service</span><span class="p">)</span>

<span class="c1"># Анализ всех методов {#analyze-all-methods}</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_complexity_distribution</span><span class="p">()</span>

<span class="c1"># Поиск кандидатов на рефакторинг {#find-refactoring-candidates}</span>
<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">dist</span><span class="p">[</span><span class="s1">&#39;high_complexity_methods&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Кандидат на рефакторинг: </span><span class="si">{</span><span class="n">method</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (сложность=</span><span class="si">{</span><span class="n">method</span><span class="p">[</span><span class="s1">&#39;complexity&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="proverka-patcha-stsenariy-9">Проверка патча (Сценарий 9)<a class="heading-anchor" href="#proverka-patcha-stsenariy-9" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.patch_review.analyzers.control_flow_analyzer</span><span class="w"> </span><span class="kn">import</span> <span class="n">PatchControlFlowAnalyzer</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">PatchControlFlowAnalyzer</span><span class="p">(</span><span class="n">cpg_service</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_control_flow_changes</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">complexity_delta</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ВНИМАНИЕ: Значительное увеличение сложности&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">loop</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">new_loops</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">loop</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ОПАСНО: Цикл высокого риска в методе </span><span class="si">{</span><span class="n">loop</span><span class="o">.</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="database-schema-reference">Справочник по схеме базы данных<a class="heading-anchor" href="#database-schema-reference" title="Link to this section">&para;</a></h2>
<h3 id="key-tables-for-analysis">Основные таблицы для анализа<a class="heading-anchor" href="#key-tables-for-analysis" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Таблица</th>
<th>Назначение</th>
</tr>
</thead>
<tbody>
<tr>
<td>nodes_method</td>
<td>Определения методов</td>
</tr>
<tr>
<td>nodes_control_structure</td>
<td>Структуры управления потоком выполнения (if, for, while)</td>
</tr>
<tr>
<td>nodes_field_identifier</td>
<td>Выражения доступа к полям</td>
</tr>
<tr>
<td>nodes_identifier</td>
<td>Ссылки на переменные</td>
</tr>
<tr>
<td>edges_cfg</td>
<td>Рёбра графа потока управления</td>
</tr>
<tr>
<td>edges_contains</td>
<td>Отношения вложенности (содержимое)</td>
</tr>
<tr>
<td>edges_dominate</td>
<td>Отношения доминирования</td>
</tr>
<tr>
<td>edges_reaching_def</td>
<td>Рёбра достижимых определений</td>
</tr>
<tr>
<td>edges_argument</td>
<td>Рёбра аргументов функций</td>
</tr>
</tbody>
</table></div>
<h3 id="edge-types-for-dataflow">Типы рёбер для анализа потока данных<a class="heading-anchor" href="#edge-types-for-dataflow" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Тип ребра</th>
<th>Таблица</th>
<th>Назначение</th>
</tr>
</thead>
<tbody>
<tr>
<td>CFG</td>
<td>edges_cfg</td>
<td>Поток управления между операторами</td>
</tr>
<tr>
<td>REACHING_DEF</td>
<td>edges_reaching_def</td>
<td>Цепочки «определение — использование»</td>
</tr>
<tr>
<td>ARGUMENT</td>
<td>edges_argument</td>
<td>Аргументы вызова функций</td>
</tr>
<tr>
<td>CONTAINS</td>
<td>edges_contains</td>
<td>Вложенность областей видимости</td>
</tr>
</tbody>
</table></div>
<h2 id="troubleshooting">Устранение неполадок<a class="heading-anchor" href="#troubleshooting" title="Link to this section">&para;</a></h2>
<h3 id="method-not-found">“Метод не найден”<a class="heading-anchor" href="#method-not-found" title="Link to this section">&para;</a></h3>
<p>Имя метода должно совпадать точно (с учетом регистра). Используйте простое имя, а не полное квалифицированное.</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Правильно {#correct}
cfg = analyzer.get_method_cfg(&quot;heap_insert&quot;)

<span class="gh">#</span> Неправильно {#incorrect}
cfg = analyzer.get_method_cfg(&quot;heap_insert(Relation, HeapTuple)&quot;)
</code></pre></div>

<h3 id="no-cfg-data-found">“Данные CFG не найдены”<a class="heading-anchor" href="#no-cfg-data-found" title="Link to this section">&para;</a></h3>
<p>Убедитесь, что экспорт CPG включал ребра CFG. Проверьте, есть ли данные в таблице <code>edges_cfg</code>:</p>
<div class="highlight"><pre><span></span><code>SELECT COUNT(*) FROM edges_cfg;
</code></pre></div>

<h3 id="obrascheniya-k-polyam-ne-naydeny">“Обращения к полям не найдены”<a class="heading-anchor" href="#obrascheniya-k-polyam-ne-naydeny" title="Link to this section">&para;</a></h3>
<p>Для отслеживания обращений к полям необходимы данные <code>nodes_field_identifier</code>:</p>
<div class="highlight"><pre><span></span><code>SELECT COUNT(*) FROM nodes_field_identifier;
</code></pre></div>

<h3 id="rekomendatsii-po-proizvoditelnosti">Рекомендации по производительности<a class="heading-anchor" href="#rekomendatsii-po-proizvoditelnosti" title="Link to this section">&para;</a></h3>
<ul>
<li>Перечисление путей ограничено параметром <code>max_paths</code>, чтобы предотвратить экспоненциальный рост</li>
<li>Используйте <code>max_depth</code> для ограничения глубины отслеживания передачи зараженных данных (taint)</li>
<li>В больших методах может быть очень много путей; рассмотрите возможность выборки</li>
</ul>
<h2 id="smotrite-takzhe">Смотрите также<a class="heading-anchor" href="#smotrite-takzhe" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="SCHEMA.html">Справочник по схеме</a> — Полная схема базы данных</li>
<li><a href="SQL_QUERY_COOKBOOK.html">Кулинарная книга SQL-запросов</a> — Примеры запросов</li>
<li><a href="AGENTS.html">Справочник по агентам</a> — Конвейер агентов</li>
<li><a href="../guides/SCENARIOS.html">Руководство по сценариям</a> — Сценарии использования</li>
</ul>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="API.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Назад</span>
        <span class="doc-page-nav-title">Справочник API</span>
      </a>

      <a href="SECURITY.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Вперед</span>
        <span class="doc-page-nav-title">Модуль корпоративной безопасности</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Обновлено: 2025-12-25</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/reference/ANALYSIS_MODULES.md" target="_blank" rel="noopener">Редактировать на GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">На этой странице</div>
      <ul class="doc-toc-list">
        <li><a href="#spravochnik-moduley-analiza" class="level-1">Справочник модулей анализа</a></li>
<li><a href="#soderzhanie" class="level-2">Содержание</a></li>
<li><a href="#obzor" class="level-2">Обзор</a></li>
<li><a href="#cfganalyzer" class="level-2">CFGAnalyzer</a></li>
<li><a href="#vozmozhnosti" class="level-3">Возможности</a></li>
<li><a href="#osnovnye-klassy" class="level-3">Основные классы</a></li>
<li><a href="#spravochnik-api" class="level-3">Справочник API</a></li>
<li><a href="#ispolzuemye-tablitsy-bazy-dannyh" class="level-3">Используемые таблицы базы данных</a></li>
<li><a href="#fieldsensitivetracer" class="level-2">FieldSensitiveTracer</a></li>
<li><a href="#vozmozhnosti" class="level-3">Возможности</a></li>
<li><a href="#osnovnye-klassy" class="level-3">Основные классы</a></li>
<li><a href="#spravochnik-api" class="level-3">Справочник API</a></li>
<li><a href="#razbor-notatsii-ukazateley" class="level-1">Разбор нотации указателей</a></li>
<li><a href="#razbor-notatsii-cherez-tochku" class="level-1">Разбор нотации через точку</a></li>
<li><a href="#chuvstvitelnye-polya-po-umolchaniyu-password-token-secret-private-key-credential-auth" class="level-1">Чувствительные поля по умолчанию: password, token, secret, private_key, credential, auth</a></li>
<li><a href="#kategorii-chuvstvitelnyh-poley" class="level-3">Категории чувствительных полей</a></li>
<li><a href="#ispolzuemye-tablitsy-bazy-dannyh" class="level-3">Используемые таблицы базы данных</a></li>
<li><a href="#dataflowtracer" class="level-2">DataFlowTracer</a></li>
<li><a href="#metody-integratsii" class="level-3">Методы интеграции</a></li>
<li><a href="#poisk-putey-zarazheniya-s-uchyotom-poley" class="level-1">Поиск путей заражения с учётом полей</a></li>
<li><a href="#ispolzovanie-znacheniy-po-umolchaniyu-dlya-rasprostranyonnyh-shablonov" class="level-1">Использование значений по умолчанию для распространённых шаблонов</a></li>
<li><a href="#ili-s-nastroykoy-pod-zadachu" class="level-1">Или с настройкой под задачу</a></li>
<li><a href="#controlflowanalyzer-prosmotr-izmeneniy" class="level-2">ControlFlowAnalyzer (Просмотр изменений)</a></li>
<li><a href="#vozmozhnosti" class="level-3">Возможности</a></li>
<li><a href="#integratsiya-s-cfganalyzer" class="level-3">Интеграция с CFGAnalyzer</a></li>
<li><a href="#analiz-vliyaniya-izmeneniy" class="level-1">Анализ влияния изменений</a></li>
<li><a href="#klassifikatsiya-seryoznosti-tsiklov" class="level-3">Классификация серьёзности циклов</a></li>
<li><a href="#primery-ispolzovaniya" class="level-2">Примеры использования</a></li>
<li><a href="#audit-bezopasnosti-stsenariy-2" class="level-3">Аудит безопасности (Сценарий 2)</a></li>
<li><a href="#poisk-utechek-paroley" class="level-1">Поиск утечек паролей</a></li>
<li><a href="#analiz-slozhnosti-stsenariy-56" class="level-3">Анализ сложности (Сценарий 5/6)</a></li>
<li><a href="#analiz-vseh-metodov" class="level-1">Анализ всех методов</a></li>
<li><a href="#poisk-kandidatov-na-refaktoring" class="level-1">Поиск кандидатов на рефакторинг</a></li>
<li><a href="#proverka-patcha-stsenariy-9" class="level-3">Проверка патча (Сценарий 9)</a></li>
<li><a href="#spravochnik-po-sheme-bazy-dannyh" class="level-2">Справочник по схеме базы данных</a></li>
<li><a href="#osnovnye-tablitsy-dlya-analiza" class="level-3">Основные таблицы для анализа</a></li>
<li><a href="#tipy-ryober-dlya-analiza-potoka-dannyh" class="level-3">Типы рёбер для анализа потока данных</a></li>
<li><a href="#ustranenie-nepoladok" class="level-2">Устранение неполадок</a></li>
<li><a href="#metod-ne-nayden" class="level-3">“Метод не найден”</a></li>
<li><a href="#pravilno" class="level-1">Правильно</a></li>
<li><a href="#nepravilno" class="level-1">Неправильно</a></li>
<li><a href="#dannye-cfg-ne-naydeny" class="level-3">“Данные CFG не найдены”</a></li>
<li><a href="#obrascheniya-k-polyam-ne-naydeny" class="level-3">“Обращения к полям не найдены”</a></li>
<li><a href="#rekomendatsii-po-proizvoditelnosti" class="level-3">Рекомендации по производительности</a></li>
<li><a href="#smotrite-takzhe" class="level-2">Смотрите также</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI-копилот для анализа исходного кода</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Продукт</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Возможности</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Интеграции</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Документация</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Начало работы</a></li>
              <li><a href="../guides/index.html" class="footer-link">Руководства</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Ресурсы</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Контакты</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. Все права защищены.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
