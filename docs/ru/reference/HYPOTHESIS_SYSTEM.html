<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: Справочная система гипотез">
  <meta name="keywords" content="CodeGraph, documentation, reference">

  <meta property="og:title" content="Справочная система гипотез - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: Справочная система гипотез">
  <meta property="og:type" content="article">

  <title>Справочная система гипотез - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="nav-link active">Документация</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/reference/HYPOTHESIS_SYSTEM.html" class="">EN</a>
          <a href="../../ru/reference/HYPOTHESIS_SYSTEM.html" class="active">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Переключить тему">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Запросить демо</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Документация</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Запросить демо</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Начало работы</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Обзор</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Руководство по настройке</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Руководство по установке</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Руководства</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../guides/index.html">Обзор</a></li>
        <li><a href="../guides/BENCHMARK_GUIDE.html">Руководство по тестовой платформе</a></li>
        <li><a href="../guides/CLI_GUIDE.html">Руководство по CLI</a></li>
        <li><a href="../guides/CODE_REVIEW.html">Автоматический код-ревью</a></li>
        <li><a href="../guides/CPG_EXPORT.html">Руководство по экспорту CPG</a></li>
        <li><a href="../guides/MONITORING.html">Руководство по мониторингу</a></li>
        <li><a href="../guides/PROGRAMMATIC_GUIDE.html">Руководство пользователя</a></li>
        <li><a href="../guides/PROJECT_IMPORT.html">Импорт новой кодовой базы</a></li>
        <li><a href="../guides/QUICK_REFERENCE.html">Краткое руководство по CodeGraph</a></li>
        <li><a href="../guides/REFACTORING.html">Руководство по анализу рефакторинга</a></li>
        <li><a href="../guides/SCENARIOS.html">Руководство по сценариям рабочих процессов</a></li>
        <li><a href="../guides/TROUBLESHOOTING.html">Руководство по устранению неполадок</a></li>
        <li><a href="../guides/TUI_USER_GUIDE.html">Руководство пользователя CodeGraph</a></li>
        <li><a href="../guides/01-onboarding.html">Сценарий 01: Ввод нового разработчика</a></li>
        <li><a href="../guides/02-security-audit.html">Сценарий 02: Аудит безопасности</a></li>
        <li><a href="../guides/03-documentation.html">Сценарий 03: Генерация документации</a></li>
        <li><a href="../guides/04-feature-development.html">Сценарий 04: Разработка функций</a></li>
        <li><a href="../guides/05-refactoring.html">Сценарий 05: Рефакторинг</a></li>
        <li><a href="../guides/06-performance.html">Сценарий 06: Анализ производительности</a></li>
        <li><a href="../guides/07-test-coverage.html">Сценарий 07: Покрытие тестами</a></li>
        <li><a href="../guides/08-compliance.html">Сценарий 08: Проверка соответствия требованиям</a></li>
        <li><a href="../guides/09-code-review.html">Сценарий 09: Код-ревью</a></li>
        <li><a href="../guides/10-cross-repo.html">Сценарий 10: Анализ между репозиториями</a></li>
        <li><a href="../guides/11-architecture.html">Сценарий 11: Анализ архитектуры</a></li>
        <li><a href="../guides/12-tech-debt.html">Сценарий 12: Оценка технического долга</a></li>
        <li><a href="../guides/13-mass-refactoring.html">Сценарий 13: Массовая рефакторизация</a></li>
        <li><a href="../guides/14-incident-response.html">Сценарий 14: Реагирование на инциденты безопасности</a></li>
        <li><a href="../guides/15-debugging.html">Сценарий 15: Помощь в отладке</a></li>
        <li><a href="../guides/16-entry-points.html">Сценарий 16: Обнаружение точки входа</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Документация</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Обзор</a></li>
        <li><a href="../api/REST_API.html">Документация по REST API CodeGraph</a></li>
        <li><a href="../api/WEBSOCKET_API.html">Справочная документация по WebSocket API</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Интеграции</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Обзор</a></li>
        <li><a href="../integrations/GIGACHAT.html">Руководство по интеграции GigaChat</a></li>
        <li><a href="../integrations/YANDEX_AI_STUDIO.html">Руководство по интеграции Yandex AI Studio</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Справочник</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Обзор</a></li>
        <li><a href="AGENTS.html">Справочник агентов</a></li>
        <li><a href="ANALYSIS_MODULES.html">Справочник модулей анализа</a></li>
        <li><a href="API.html">Справочник API</a></li>
        <li><a href="HYPOTHESIS_SYSTEM.html" class="active">Справочная система гипотез</a></li>
        <li><a href="SCHEMA.html">Дизайн схемы DuckDB CPG (CPG Spec v1.1)</a></li>
        <li><a href="SECURITY.html">Модуль корпоративной безопасности</a></li>
        <li><a href="SQL_QUERY_COOKBOOK.html">Кулинарная книга SQL-запросов для DuckDB CPG</a></li>
        <li><a href="WORKFLOWS.html">Справочник по рабочим процессам</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Обзор</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Документация</a>
        <span>/</span>
        <a href="index.html">Справочник</a>
        <span>/</span>
        <span>Справочная система гипотез</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>Справочная система гипотез</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="spravochnaya-sistema-gipotez">Справочная система гипотез<a class="heading-anchor" href="#spravochnaya-sistema-gipotez" title="Link to this section">&para;</a></h1>
<p>В этом документе описывается многокритериальная система формирования и проверки гипотез безопасности, используемая для автоматического обнаружения уязвимостей в CodeGraph.</p>
<h2 id="soderzhanie">Содержание<a class="heading-anchor" href="#soderzhanie" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="#overview">Обзор</a></li>
<li><a href="#pipeline-architecture">Архитектура конвейера</a></li>
<li><a href="#core-data-models">Основные модели данных</a></li>
<li><a href="#securityhypothesis">SecurityHypothesis</a></li>
<li><a href="#evidence">Evidence</a></li>
<li><a href="#validationstatus">ValidationStatus</a></li>
<li><a href="#severity-levels">Уровни серьёзности</a></li>
<li><a href="#hypothesis-generation">Генерация гипотез</a></li>
<li><a href="#template-format">Формат шаблона</a></li>
<li><a href="#category-templates">Шаблоны категорий</a></li>
<li><a href="#generation-algorithm">Алгоритм генерации</a></li>
<li><a href="#cwe-category-mapping">Сопоставление категорий CWE</a></li>
<li><a href="#multi-criteria-scoring">Многокритериальная оценка</a></li>
<li><a href="#scoring-formula">Формула оценки</a></li>
<li><a href="#score-components">Компоненты оценки</a></li>
<li><a href="#bonus-multipliers">Множители бонусов</a></li>
<li><a href="#usage">Использование</a></li>
<li><a href="#query-synthesis">Синтез запросов</a></li>
<li><a href="#sql-templates">Шаблоны SQL</a></li>
<li><a href="#template-examples">Примеры шаблонов</a></li>
<li><a href="#hypothesis-execution">Выполнение гипотез</a></li>
<li><a href="#executor-usage">Использование исполнителя</a></li>
<li><a href="#evidence-collection">Сбор доказательств</a></li>
<li><a href="#validation">Проверка</a></li>
<li><a href="#validation-process">Процесс проверки</a></li>
<li><a href="#validation-results">Результаты проверки</a></li>
<li><a href="#knowledge-base">База знаний</a></li>
<li><a href="#cwe-database">База данных CWE</a></li>
<li><a href="#language-patterns">Языковые шаблоны</a></li>
<li><a href="#supported-cwes-partial-list">Поддерживаемые CWE (частичный список)</a></li>
<li><a href="#python-api">Python API</a></li>
<li><a href="#complete-example">Полный пример</a></li>
<li><a href="#performance">Производительность</a></li>
<li><a href="#benchmark-results">Результаты тестирования</a></li>
<li><a href="#validated-cves-postgresql-17">Проверенные CVE (PostgreSQL 17)</a></li>
<li><a href="#see-also">См. также</a></li>
</ul>
<h2 id="overview">Обзор<a class="heading-anchor" href="#overview" title="Link to this section">&para;</a></h2>
<p>Система гипотез формирует проверяемые гипотезы безопасности, комбинируя:</p>
<ul>
<li><strong>Шаблоны уязвимостей CWE</strong> (Common Weakness Enumeration — Перечень типовых уязвимостей)</li>
<li><strong>Шаблоны атак CAPEC</strong> (Common Attack Pattern Enumeration — Перечень типовых атак)</li>
<li><strong>Языковые шаблоны</strong> (стоки, источники, средства санации)</li>
<li><strong>Контекст кодовой базы</strong> (на основе анализа CPG)</li>
</ul>
<h3 id="pipeline-architecture">Архитектура конвейера<a class="heading-anchor" href="#pipeline-architecture" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>+-----------------------------------------------------------+
|                  КОНВЕЙЕР ГИПОТЕЗ                           |
+-----------------------------------------------------------+

1. ГЕНЕРАЦИЯ
   HypothesisGenerator.generate()
   +-- База данных CWE (более 120 шаблонов)
   +-- База данных CAPEC (более 50 шаблонов атак)
   +-- Языковые шаблоны (C, Python, Java)
   +-- Декартово произведение: CWE × CAPEC × шаблоны
   +-- Инстанцирование шаблонов
   +-- Результат: SecurityHypothesis[]

2. ОЦЕНКА
   MultiCriteriaScorer.score_batch()
   +-- Оценка частоты CWE (вес 0,40)
   +-- Оценка схожести атаки (вес 0,30)
   +-- Оценка экспозиции кодовой базы (вес 0,30)
   +-- Бонусы: наличие известных CVE, критическая серьёзность
   +-- Результат: приоритетные оценки [0,0–1,0]

3. СИНТЕЗ ЗАПРОСОВ
   QuerySynthesizer.synthesize()
   +-- Сопоставление гипотезы с шаблоном SQL
   +-- Подстановка параметров
   +-- Результат: SQL-запросы DuckDB / PGQ

4. ВЫПОЛНЕНИЕ
   HypothesisExecutor.execute()
   +-- Выполнение запросов к CPG
   +-- Сбор доказательств
   +-- Результат: Evidence[]

5. ВАЛИДАЦИЯ
   HypothesisValidator.validate()
   +-- Анализ доказательств
   +-- Обновление статуса гипотезы
   +-- Расчёт метрик
   +-- Результат: ValidationResults
</code></pre></div>

<h2 id="core-data-models">Основные модели данных<a class="heading-anchor" href="#core-data-models" title="Link to this section">&para;</a></h2>
<h3 id="securityhypothesis">SecurityHypothesis<a class="heading-anchor" href="#securityhypothesis" title="Link to this section">&para;</a></h3>
<p>Центральная структура данных для анализа безопасности на основе гипотез.</p>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">SecurityHypothesis</span><span class="p">:</span>
<span class="w">    </span><span class="nl">id</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">                          </span><span class="err">#</span><span class="w"> </span><span class="n">Уникальный</span><span class="w"> </span><span class="n">идентификатор</span>
<span class="w">    </span><span class="nl">hypothesis_text</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">             </span><span class="err">#</span><span class="w"> </span><span class="n">Читаемое</span><span class="w"> </span><span class="n">утверждение</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Классификация</span>
<span class="w">    </span><span class="nl">cwe_ids</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w">              </span><span class="err">#</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;CWE-120&quot;, &quot;CWE-119&quot;</span><span class="o">]</span>
<span class="w">    </span><span class="nl">capec_ids</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;CAPEC-100&quot;</span><span class="o">]</span>
<span class="w">    </span><span class="k">language</span><span class="err">:</span><span class="w"> </span><span class="nf">str</span><span class="w">                   </span><span class="err">#</span><span class="w"> </span><span class="ss">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Python&quot;</span><span class="w"> </span><span class="n">и</span><span class="w"> </span><span class="n">т</span><span class="p">.</span><span class="n">д</span><span class="p">.</span>
<span class="w">    </span><span class="nl">category</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">                   </span><span class="err">#</span><span class="w"> </span><span class="ss">&quot;buffer_overflow&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;injection&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Шаблоны</span><span class="w"> </span><span class="n">передачи</span><span class="w"> </span><span class="n">заражённых</span><span class="w"> </span><span class="n">данных</span><span class="w"> </span><span class="p">(</span><span class="n">taint</span><span class="p">)</span>
<span class="w">    </span><span class="nl">source_patterns</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;PQgetvalue&quot;, &quot;getenv&quot;</span><span class="o">]</span>
<span class="w">    </span><span class="nl">sink_patterns</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;strcpy&quot;, &quot;memcpy&quot;</span><span class="o">]</span>
<span class="w">    </span><span class="nl">sanitizer_patterns</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;strlcpy&quot;, &quot;sizeof&quot;</span><span class="o">]</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Оценки</span>
<span class="w">    </span><span class="nl">priority_score</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="w">           </span><span class="err">#</span><span class="w"> </span><span class="mf">0.0</span><span class="err">–</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">общая</span><span class="w"> </span><span class="n">важность</span>
<span class="w">    </span><span class="nl">confidence</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="w">               </span><span class="err">#</span><span class="w"> </span><span class="mf">0.0</span><span class="err">–</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">достоверность</span><span class="w"> </span><span class="n">гипотезы</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Детализация</span><span class="w"> </span><span class="n">по</span><span class="w"> </span><span class="n">нескольким</span><span class="w"> </span><span class="n">критериям</span>
<span class="w">    </span><span class="nl">cwe_frequency_score</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span>
<span class="w">    </span><span class="nl">attack_similarity_score</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span>
<span class="w">    </span><span class="nl">codebase_exposure_score</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Сгенерированный</span><span class="w"> </span><span class="k">SQL</span><span class="o">-</span><span class="n">запрос</span>
<span class="w">    </span><span class="nl">sql_query</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Подтверждение</span>
<span class="w">    </span><span class="nl">evidence</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">Evidence</span><span class="o">]</span>
<span class="w">    </span><span class="nl">validation_status</span><span class="p">:</span><span class="w"> </span><span class="n">ValidationStatus</span>
</code></pre></div>

<h3 id="evidence">Evidence<a class="heading-anchor" href="#evidence" title="Link to this section">&para;</a></h3>
<p>Содержит результаты запросов, подтверждающие или опровергающие гипотезу.</p>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">Evidence</span><span class="p">:</span>
<span class="w">    </span><span class="nl">id</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">hypothesis_id</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">query_executed</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w">             </span><span class="err">#</span><span class="w"> </span><span class="k">SQL</span><span class="o">-</span><span class="n">запрос</span><span class="p">,</span><span class="w"> </span><span class="n">который</span><span class="w"> </span><span class="n">нашёл</span><span class="w"> </span><span class="n">это</span>
<span class="w">    </span><span class="nl">result_count</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">findings</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">Dict[str, Any</span><span class="o">]</span><span class="err">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Результаты</span><span class="w"> </span><span class="n">запроса</span>
<span class="w">    </span><span class="nl">filename</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>
<span class="w">    </span><span class="nl">line_number</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span>
<span class="w">    </span><span class="nl">code_snippet</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>
<span class="w">    </span><span class="nl">confidence</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="w">               </span><span class="err">#</span><span class="w"> </span><span class="mf">0.0</span><span class="err">–</span><span class="mf">1.0</span>
</code></pre></div>

<h3 id="validationstatus">ValidationStatus<a class="heading-anchor" href="#validationstatus" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="n">ValidationStatus</span>(<span class="n">Enum</span>):
    <span class="n">PENDING</span> = <span class="s">&quot;pending&quot;</span>
    <span class="n">IN_PROGRESS</span> = <span class="s">&quot;in_progress&quot;</span>
    <span class="n">CONFIRMED</span> = <span class="s">&quot;confirmed&quot;</span>
    <span class="n">REJECTED</span> = <span class="s">&quot;rejected&quot;</span>
    <span class="n">INCONCLUSIVE</span> = <span class="s">&quot;inconclusive&quot;</span>
</code></pre></div>

<h3 id="severity-levels">Уровни серьёзности<a class="heading-anchor" href="#severity-levels" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="n">Severity</span>(<span class="n">Enum</span>):
    <span class="n">CRITICAL</span> = <span class="s">&quot;critical&quot;</span>
    <span class="n">HIGH</span> = <span class="s">&quot;high&quot;</span>
    <span class="n">MEDIUM</span> = <span class="s">&quot;medium&quot;</span>
    <span class="n">LOW</span> = <span class="s">&quot;low&quot;</span>
    <span class="n">INFO</span> = <span class="s">&quot;info&quot;</span>
</code></pre></div>

<hr />
<h2 id="hypothesis-generation">Генерация гипотез<a class="heading-anchor" href="#hypothesis-generation" title="Link to this section">&para;</a></h2>
<h3 id="template-format">Формат шаблона<a class="heading-anchor" href="#template-format" title="Link to this section">&para;</a></h3>
<p>Гипотезы следуют шаблону:</p>
<div class="highlight"><pre><span></span><code><span class="ss">&quot;Если [источник] передаёт данные в [приёмник] без [средства очистки], то [CWE] позволяет осуществить [атаку]&quot;</span>
</code></pre></div>

<h3 id="category-templates">Шаблоны категорий<a class="heading-anchor" href="#category-templates" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Категория</th>
<th>Шаблон</th>
</tr>
</thead>
<tbody>
<tr>
<td>buffer_overflow</td>
<td>“Если недоверённые данные из {sources} передаются в {sinks} без проверки границ через {sanitizers}, то {cwe} позволяет осуществить атаку {attack}, потенциально приводящую к повреждению памяти или выполнению кода.”</td>
</tr>
<tr>
<td>sql_injection</td>
<td>“Если пользовательский ввод из {sources} включается в SQL-запросы через {sinks} без параметризации ({sanitizers}), то {cwe} позволяет осуществить атаку {attack}.”</td>
</tr>
<tr>
<td>command_injection</td>
<td>“Если недоверённые данные из {sources} передаются в выполнение команд через {sinks} без надлежащего экранирования ({sanitizers}), то {cwe} позволяет осуществить атаку {attack}.”</td>
</tr>
<tr>
<td>information_disclosure</td>
<td>“Если к конфиденциальным данным осуществляется доступ через {sinks} без проверки авторизации ({sanitizers}), то {cwe} позволяет осуществить атаку {attack}.”</td>
</tr>
</tbody>
</table></div>
<h3 id="generation-algorithm">Алгоритм генерации<a class="heading-anchor" href="#generation-algorithm" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">HypothesisGenerator</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">HypothesisGenerator</span><span class="p">()</span>

<span class="c1"># Генерация для конкретного CWE {#generate-for-specific-cwe}</span>
<span class="n">hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">cwe_filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CWE-120&quot;</span><span class="p">,</span> <span class="s2">&quot;CWE-78&quot;</span><span class="p">],</span>
    <span class="n">max_hypotheses</span><span class="o">=</span><span class="mi">50</span>
<span class="p">)</span>

<span class="c1"># Генерация по категории {#generate-for-category}</span>
<span class="n">buffer_hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_by_category</span><span class="p">(</span><span class="s2">&quot;buffer_overflow&quot;</span><span class="p">)</span>

<span class="c1"># Полное перечисление {#full-enumeration}</span>
<span class="n">all_hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_all</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="cwe-category-mapping">Сопоставление CWE и категорий<a class="heading-anchor" href="#cwe-category-mapping" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>CWE</th>
<th>Категория</th>
</tr>
</thead>
<tbody>
<tr>
<td>CWE-120, CWE-119, CWE-787, CWE-125</td>
<td>buffer_overflow</td>
</tr>
<tr>
<td>CWE-78, CWE-77, CWE-88</td>
<td>command_injection</td>
</tr>
<tr>
<td>CWE-89</td>
<td>sql_injection</td>
</tr>
<tr>
<td>CWE-94, CWE-95</td>
<td>code_injection</td>
</tr>
<tr>
<td>CWE-134</td>
<td>format_string</td>
</tr>
<tr>
<td>CWE-200, CWE-209, CWE-862</td>
<td>information_disclosure</td>
</tr>
<tr>
<td>CWE-416</td>
<td>use_after_free</td>
</tr>
<tr>
<td>CWE-190, CWE-191</td>
<td>integer_overflow</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="multi-criteria-scoring">Многокритериальная оценка<a class="heading-anchor" href="#multi-criteria-scoring" title="Link to this section">&para;</a></h2>
<h3 id="scoring-formula">Формула оценки<a class="heading-anchor" href="#scoring-formula" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Приоритет = (Частота_CWE × 0.40)
          + (Схожесть_атаки × 0.30)
          + (Экспозиция_кода × 0.30)
</code></pre></div>

<h3 id="score-components">Компоненты оценки<a class="heading-anchor" href="#score-components" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Компонент</th>
<th>Вес</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Частота CWE</td>
<td>0.40</td>
<td>Насколько часто данный CWE встречается в базе CVE</td>
</tr>
<tr>
<td>Схожесть атаки</td>
<td>0.30</td>
<td>Насколько атака похожа на известные шаблоны атак</td>
</tr>
<tr>
<td>Экспозиция кодовой базы</td>
<td>0.30</td>
<td>Насколько широко кодовая база подвержена воздействию</td>
</tr>
</tbody>
</table></div>
<h3 id="bonusnye-mnozhiteli">Бонусные множители<a class="heading-anchor" href="#bonusnye-mnozhiteli" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Бонус</th>
<th>Множитель</th>
<th>Условие</th>
</tr>
</thead>
<tbody>
<tr>
<td>Известный CVE</td>
<td>1.20 (+20%)</td>
<td>Соответствует известному шаблону CVE</td>
</tr>
<tr>
<td>Критическая серьёзность</td>
<td>1.10 (+10%)</td>
<td>CWE критической степени серьёзности</td>
</tr>
<tr>
<td>Недавнее использование</td>
<td>1.15 (+15%)</td>
<td>Недавно использовался в реальных атаках</td>
</tr>
</tbody>
</table></div>
<h3 id="usage">Использование<a class="heading-anchor" href="#usage" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiCriteriaScorer</span><span class="p">,</span> <span class="n">CodebaseStats</span>

<span class="c1"># Сбор статистики по кодовой базе {#gather-codebase-statistics}</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">CodebaseStats</span><span class="p">(</span>
    <span class="n">total_methods</span><span class="o">=</span><span class="mi">52000</span><span class="p">,</span>
    <span class="n">total_calls</span><span class="o">=</span><span class="mi">110000</span><span class="p">,</span>
    <span class="n">sink_counts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;strcpy&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="s2">&quot;memcpy&quot;</span><span class="p">:</span> <span class="mi">800</span><span class="p">},</span>
    <span class="n">source_counts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;getenv&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;recv&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Оценка гипотез {#score-hypotheses}</span>
<span class="n">scorer</span> <span class="o">=</span> <span class="n">MultiCriteriaScorer</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;cwe_frequency&#39;</span><span class="p">:</span> <span class="mf">0.40</span><span class="p">,</span>
    <span class="s1">&#39;attack_similarity&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span>
    <span class="s1">&#39;codebase_exposure&#39;</span><span class="p">:</span> <span class="mf">0.30</span>
<span class="p">})</span>

<span class="n">scored_hypotheses</span> <span class="o">=</span> <span class="n">scorer</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

<span class="c1"># Получение наиболее приоритетных {#get-top-priority}</span>
<span class="n">top_10</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scored_hypotheses</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="n">h</span><span class="o">.</span><span class="n">priority_score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div>

<h2 id="query-synthesis">Синтез запросов<a class="heading-anchor" href="#query-synthesis" title="Link to this section">&para;</a></h2>
<h3 id="sql-templates">Шаблоны SQL<a class="heading-anchor" href="#sql-templates" title="Link to this section">&para;</a></h3>
<p>Система генерирует запросы DuckDB SQL для каждой категории гипотез:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuerySynthesizer</span>

<span class="n">synthesizer</span> <span class="o">=</span> <span class="n">QuerySynthesizer</span><span class="p">()</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">synthesizer</span><span class="o">.</span><span class="n">synthesize_query</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span>
</code></pre></div>

<h3 id="template-examples">Примеры шаблонов<a class="heading-anchor" href="#template-examples" title="Link to this section">&para;</a></h3>
<p><strong>Обнаружение переполнения буфера:</strong></p>
<div class="highlight"><pre><span></span><code>SELECT DISTINCT nc.id, nc.name AS sink_function, nc.code,
       nc.filename, nc.line_number
FROM nodes_call nc
WHERE nc.name IN (&#39;strcpy&#39;, &#39;strcat&#39;, &#39;sprintf&#39;, &#39;memcpy&#39;)
LIMIT 100;
</code></pre></div>

<p><strong>Обнаружение инъекции команд:</strong></p>
<div class="highlight"><pre><span></span><code>SELECT DISTINCT nc.id, nc.name AS sink_function, nc.code,
       nc.filename, nc.line_number
FROM nodes_call nc
WHERE nc.name IN (&#39;system&#39;, &#39;popen&#39;, &#39;execl&#39;, &#39;execv&#39;)
LIMIT 100;
</code></pre></div>

<p><strong>Анализ потока данных с использованием SQL/PGQ:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">FROM</span><span class="w"> </span><span class="n">GRAPH_TABLE</span><span class="p">(</span><span class="n">cpg</span>
<span class="w">    </span><span class="n">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">:</span><span class="n">IDENTIFIER</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">REACHING_DEF</span><span class="o">*</span><span class="mf">1.</span><span class="o">.</span><span class="mi">5</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">sink</span><span class="p">:</span><span class="n">CALL_NODE</span><span class="p">)</span>
<span class="w">    </span><span class="n">WHERE</span><span class="w"> </span><span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="n">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;request&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">AND</span><span class="w"> </span><span class="n">sink</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="n">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;execute&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="n">COLUMNS</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="n">AS</span><span class="w"> </span><span class="n">source_var</span><span class="p">,</span>
<span class="w">        </span><span class="n">sink</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="n">AS</span><span class="w"> </span><span class="n">sink_function</span><span class="p">,</span>
<span class="w">        </span><span class="n">sink</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
<span class="w">        </span><span class="n">sink</span><span class="o">.</span><span class="n">line_number</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">)</span>
<span class="n">LIMIT</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</code></pre></div>

<hr />
<h2 id="hypothesis-execution">Выполнение гипотезы<a class="heading-anchor" href="#hypothesis-execution" title="Link to this section">&para;</a></h2>
<h3 id="executor-usage">Использование исполнителя<a class="heading-anchor" href="#executor-usage" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">HypothesisExecutor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">HypothesisExecutor</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>

<span class="c1"># Выполнить одну гипотезу {#execute-single-hypothesis}</span>
<span class="n">evidence</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span>

<span class="c1"># Выполнить пакетно {#execute-batch}</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h3 id="evidence-collection">Сбор доказательств<a class="heading-anchor" href="#evidence-collection" title="Link to this section">&para;</a></h3>
<p>Для каждого выполняемого запроса:
1. Выполнить SQL-запрос к CPG
2. Зафиксировать количество результатов и найденные фрагменты
3. Извлечь имя файла, номер строки, фрагмент кода
4. Рассчитать уровень достоверности доказательства
5. Связать доказательства с гипотезой</p>
<hr />
<h2 id="validatsiya">Валидация<a class="heading-anchor" href="#validatsiya" title="Link to this section">&para;</a></h2>
<h3 id="protsess-validatsii">Процесс валидации<a class="heading-anchor" href="#protsess-validatsii" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">HypothesisValidator</span>

<span class="n">validator</span> <span class="o">=</span> <span class="n">HypothesisValidator</span><span class="p">()</span>

<span class="c1"># Валидация одной гипотезы {#validate-single-hypothesis}</span>
<span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span>

<span class="c1"># Валидация пакета {#validate-batch}</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">validate_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">)</span>
</code></pre></div>

<h3 id="rezultaty-validatsii">Результаты валидации<a class="heading-anchor" href="#rezultaty-validatsii" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nl">ValidationResults</span><span class="p">:</span>
<span class="w">    </span><span class="nl">batch_id</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>
<span class="w">    </span><span class="nl">total_hypotheses</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">executed_queries</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Метрики</span><span class="w"> </span><span class="n">обнаружения</span><span class="w"> </span><span class="n">CVE</span>
<span class="w">    </span><span class="nl">cves_found</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>
<span class="w">    </span><span class="nl">cves_missed</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Точность</span><span class="o">/</span><span class="n">полнота</span>
<span class="w">    </span><span class="nl">true_positives</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">false_positives</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">false_negatives</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Качество</span><span class="w"> </span><span class="n">гипотез</span>
<span class="w">    </span><span class="nl">confirmed_hypotheses</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">rejected_hypotheses</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>
<span class="w">    </span><span class="nl">inconclusive_hypotheses</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Вычисляемые</span><span class="w"> </span><span class="n">метрики</span>
<span class="w">    </span><span class="nv">@property</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">detection_rate</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">float</span><span class="err">:</span><span class="w"> </span><span class="p">...</span>
<span class="w">    </span><span class="nv">@property</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">precision</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">float</span><span class="err">:</span><span class="w"> </span><span class="p">...</span>
<span class="w">    </span><span class="nv">@property</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">recall</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">float</span><span class="err">:</span><span class="w"> </span><span class="p">...</span>
<span class="w">    </span><span class="nv">@property</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">f1_score</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">float</span><span class="err">:</span><span class="w"> </span><span class="p">...</span>
</code></pre></div>

<hr />
<h2 id="knowledge-base">База знаний<a class="heading-anchor" href="#knowledge-base" title="Link to this section">&para;</a></h2>
<h3 id="cwe-database">База данных CWE<a class="heading-anchor" href="#cwe-database" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_knowledge_base</span>

<span class="n">kb</span> <span class="o">=</span> <span class="n">get_knowledge_base</span><span class="p">()</span>

<span class="c1"># Получение записи CWE {#get-cwe-entry}</span>
<span class="n">cwe</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">get_cwe</span><span class="p">(</span><span class="s2">&quot;CWE-120&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Название: </span><span class="si">{</span><span class="n">cwe</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Серьёзность: </span><span class="si">{</span><span class="n">cwe</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CVSS: </span><span class="si">{</span><span class="n">cwe</span><span class="o">.</span><span class="n">cvss_base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Получение по категории {#get-by-category}</span>
<span class="n">memory_cwes</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">get_cwes_by_category</span><span class="p">(</span><span class="s2">&quot;memory&quot;</span><span class="p">)</span>

<span class="c1"># Получение связанных CAPEC {#get-related-capecs}</span>
<span class="n">capecs</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">get_capecs_for_cwe</span><span class="p">(</span><span class="s2">&quot;CWE-120&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="yazykovye-patterny">Языковые паттерны<a class="heading-anchor" href="#yazykovye-patterny" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Получение паттернов для C {#get-c-patterns}
c_patterns = kb.get_language_patterns(&quot;C&quot;)

for pattern in c_patterns:
    print(f&quot;Категория: {pattern.category}&quot;)
    print(f&quot;Приёмники: {pattern.sinks}&quot;)
    print(f&quot;Источники: {pattern.sources}&quot;)
    print(f&quot;Санитайзеры: {pattern.sanitizers}&quot;)
</code></pre></div>

<h3 id="supported-cwes-partial-list">Поддерживаемые CWE (частичный список)<a class="heading-anchor" href="#supported-cwes-partial-list" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>CWE ID</th>
<th>Название</th>
<th>Серьёзность</th>
<th>CVSS</th>
</tr>
</thead>
<tbody>
<tr>
<td>CWE-120</td>
<td>Копирование буфера без проверки размера</td>
<td>ВЫСОКАЯ</td>
<td>8.0</td>
</tr>
<tr>
<td>CWE-119</td>
<td>Недостаточное ограничение операций</td>
<td>ВЫСОКАЯ</td>
<td>8.0</td>
</tr>
<tr>
<td>CWE-78</td>
<td>Инъекция команд ОС</td>
<td>КРИТИЧЕСКАЯ</td>
<td>9.8</td>
</tr>
<tr>
<td>CWE-89</td>
<td>SQL-инъекция</td>
<td>КРИТИЧЕСКАЯ</td>
<td>9.8</td>
</tr>
<tr>
<td>CWE-200</td>
<td>Раскрытие конфиденциальной информации</td>
<td>СРЕДНЯЯ</td>
<td>5.3</td>
</tr>
<tr>
<td>CWE-416</td>
<td>Использование после освобождения</td>
<td>ВЫСОКАЯ</td>
<td>8.1</td>
</tr>
<tr>
<td>CWE-190</td>
<td>Переполнение целого числа</td>
<td>ВЫСОКАЯ</td>
<td>7.5</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="python-api">Python API<a class="heading-anchor" href="#python-api" title="Link to this section">&para;</a></h2>
<h3 id="complete-example">Полный пример<a class="heading-anchor" href="#complete-example" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.hypothesis</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">HypothesisGenerator</span><span class="p">,</span>
    <span class="n">MultiCriteriaScorer</span><span class="p">,</span>
    <span class="n">QuerySynthesizer</span><span class="p">,</span>
    <span class="n">HypothesisExecutor</span><span class="p">,</span>
    <span class="n">HypothesisValidator</span><span class="p">,</span>
    <span class="n">CodebaseStats</span>
<span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>

<span class="c1"># 1. Подключение к CPG {#1-connect-to-cpg}</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;cpg.duckdb&quot;</span><span class="p">)</span>

<span class="c1"># 2. Сбор статистики по кодовой базе {#2-gather-codebase-statistics}</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">CodebaseStats</span><span class="p">(</span>
    <span class="n">total_methods</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM nodes_method&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">total_calls</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM nodes_call&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># 3. Генерация гипотез {#3-generate-hypotheses}</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">HypothesisGenerator</span><span class="p">()</span>
<span class="n">hypotheses</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">max_hypotheses</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 4. Оценка и приоритизация {#4-score-and-prioritize}</span>
<span class="n">scorer</span> <span class="o">=</span> <span class="n">MultiCriteriaScorer</span><span class="p">()</span>
<span class="n">scored</span> <span class="o">=</span> <span class="n">scorer</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

<span class="c1"># 5. Генерация SQL-запросов {#5-synthesize-sql-queries}</span>
<span class="n">synthesizer</span> <span class="o">=</span> <span class="n">QuerySynthesizer</span><span class="p">()</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">scored</span><span class="p">:</span>
    <span class="n">h</span><span class="o">.</span><span class="n">sql_query</span> <span class="o">=</span> <span class="n">synthesizer</span><span class="o">.</span><span class="n">synthesize_query</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

<span class="c1"># 6. Выполнение запросов к CPG {#6-execute-against-cpg}</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">HypothesisExecutor</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">scored</span><span class="p">[:</span><span class="mi">20</span><span class="p">]:</span>  <span class="c1"># Топ-20</span>
    <span class="n">evidence</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">h</span><span class="o">.</span><span class="n">evidence</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">evidence</span><span class="p">)</span>

<span class="c1"># 7. Проверка и отчёт {#7-validate-and-report}</span>
<span class="n">validator</span> <span class="o">=</span> <span class="n">HypothesisValidator</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">validate_batch</span><span class="p">(</span><span class="n">scored</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Частота обнаружения: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">detection_rate</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Точность: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">precision</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Полнота: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">recall</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-мера: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">f1_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="performance">Производительность<a class="heading-anchor" href="#performance" title="Link to this section">&para;</a></h2>
<h3 id="benchmark-results">Результаты тестирования<a class="heading-anchor" href="#benchmark-results" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Метрика</th>
<th>Значение</th>
</tr>
</thead>
<tbody>
<tr>
<td>Уровень обнаружения уязвимостей CVE</td>
<td>100% (3 из 3 целевых CVE)</td>
</tr>
<tr>
<td>Уровень подтверждения гипотез</td>
<td>55%</td>
</tr>
<tr>
<td>Среднее время запроса</td>
<td>2–3 мс</td>
</tr>
<tr>
<td>Время генерации (100 гипотез)</td>
<td>&lt;1 с</td>
</tr>
<tr>
<td>Время выполнения (20 гипотез)</td>
<td>&lt;30 с</td>
</tr>
</tbody>
</table></div>
<h3 id="validated-cves-postgresql-17">Подтверждённые уязвимости CVE (PostgreSQL 17)<a class="heading-anchor" href="#validated-cves-postgresql-17" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>CVE</th>
<th>Тип</th>
<th>Метод обнаружения</th>
</tr>
</thead>
<tbody>
<tr>
<td>CVE-2025-8713</td>
<td>Раскрытие статистики</td>
<td>Гипотеза + метод</td>
</tr>
<tr>
<td>CVE-2025-8714</td>
<td>Инъекция в pg_dump</td>
<td>На основе метода</td>
</tr>
<tr>
<td>CVE-2025-8715</td>
<td>Инъекция символа новой строки</td>
<td>На основе метода</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="see-also">См. также<a class="heading-anchor" href="#see-also" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="../guides/CPG_EXPORT.html">Руководство по экспорту CPG</a> — экспорт CPG для анализа</li>
<li><a href="./SQL_QUERY_COOKBOOK.html">Кулинарная книга SQL-запросов</a> — примеры запросов</li>
<li><a href="./ANALYSIS_MODULES.html">Модули анализа</a> — документация по расширенному анализу</li>
<li><a href="https://cwe.mitre.org/">База данных CWE</a></li>
<li><a href="https://capec.mitre.org/">База данных CAPEC</a></li>
</ul>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="WORKFLOWS.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Назад</span>
        <span class="doc-page-nav-title">Справочник по рабочим процессам</span>
      </a>

      <a href="API.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Вперед</span>
        <span class="doc-page-nav-title">Справочник API</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Обновлено: 2025-12-27</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/reference/HYPOTHESIS_SYSTEM.md" target="_blank" rel="noopener">Редактировать на GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">На этой странице</div>
      <ul class="doc-toc-list">
        <li><a href="#spravochnaya-sistema-gipotez" class="level-1">Справочная система гипотез</a></li>
<li><a href="#soderzhanie" class="level-2">Содержание</a></li>
<li><a href="#obzor" class="level-2">Обзор</a></li>
<li><a href="#arhitektura-konveyera" class="level-3">Архитектура конвейера</a></li>
<li><a href="#osnovnye-modeli-dannyh" class="level-2">Основные модели данных</a></li>
<li><a href="#securityhypothesis" class="level-3">SecurityHypothesis</a></li>
<li><a href="#evidence" class="level-3">Evidence</a></li>
<li><a href="#validationstatus" class="level-3">ValidationStatus</a></li>
<li><a href="#urovni-seryoznosti" class="level-3">Уровни серьёзности</a></li>
<li><a href="#generatsiya-gipotez" class="level-2">Генерация гипотез</a></li>
<li><a href="#format-shablona" class="level-3">Формат шаблона</a></li>
<li><a href="#shablony-kategoriy" class="level-3">Шаблоны категорий</a></li>
<li><a href="#algoritm-generatsii" class="level-3">Алгоритм генерации</a></li>
<li><a href="#generatsiya-dlya-konkretnogo-cwe" class="level-1">Генерация для конкретного CWE</a></li>
<li><a href="#generatsiya-po-kategorii" class="level-1">Генерация по категории</a></li>
<li><a href="#polnoe-perechislenie" class="level-1">Полное перечисление</a></li>
<li><a href="#sopostavlenie-cwe-i-kategoriy" class="level-3">Сопоставление CWE и категорий</a></li>
<li><a href="#mnogokriterialnaya-otsenka" class="level-2">Многокритериальная оценка</a></li>
<li><a href="#formula-otsenki" class="level-3">Формула оценки</a></li>
<li><a href="#komponenty-otsenki" class="level-3">Компоненты оценки</a></li>
<li><a href="#bonusnye-mnozhiteli" class="level-3">Бонусные множители</a></li>
<li><a href="#ispolzovanie" class="level-3">Использование</a></li>
<li><a href="#sbor-statistiki-po-kodovoy-baze" class="level-1">Сбор статистики по кодовой базе</a></li>
<li><a href="#otsenka-gipotez" class="level-1">Оценка гипотез</a></li>
<li><a href="#poluchenie-naibolee-prioritetnyh" class="level-1">Получение наиболее приоритетных</a></li>
<li><a href="#sintez-zaprosov" class="level-2">Синтез запросов</a></li>
<li><a href="#shablony-sql" class="level-3">Шаблоны SQL</a></li>
<li><a href="#primery-shablonov" class="level-3">Примеры шаблонов</a></li>
<li><a href="#vypolnenie-gipotezy" class="level-2">Выполнение гипотезы</a></li>
<li><a href="#ispolzovanie-ispolnitelya" class="level-3">Использование исполнителя</a></li>
<li><a href="#vypolnit-odnu-gipotezu" class="level-1">Выполнить одну гипотезу</a></li>
<li><a href="#vypolnit-paketno" class="level-1">Выполнить пакетно</a></li>
<li><a href="#sbor-dokazatelstv" class="level-3">Сбор доказательств</a></li>
<li><a href="#validatsiya" class="level-2">Валидация</a></li>
<li><a href="#protsess-validatsii" class="level-3">Процесс валидации</a></li>
<li><a href="#validatsiya-odnoy-gipotezy" class="level-1">Валидация одной гипотезы</a></li>
<li><a href="#validatsiya-paketa" class="level-1">Валидация пакета</a></li>
<li><a href="#rezultaty-validatsii" class="level-3">Результаты валидации</a></li>
<li><a href="#baza-znaniy" class="level-2">База знаний</a></li>
<li><a href="#baza-dannyh-cwe" class="level-3">База данных CWE</a></li>
<li><a href="#poluchenie-zapisi-cwe" class="level-1">Получение записи CWE</a></li>
<li><a href="#poluchenie-po-kategorii" class="level-1">Получение по категории</a></li>
<li><a href="#poluchenie-svyazannyh-capec" class="level-1">Получение связанных CAPEC</a></li>
<li><a href="#yazykovye-patterny" class="level-3">Языковые паттерны</a></li>
<li><a href="#poluchenie-patternov-dlya-c" class="level-1">Получение паттернов для C</a></li>
<li><a href="#podderzhivaemye-cwe-chastichnyy-spisok" class="level-3">Поддерживаемые CWE (частичный список)</a></li>
<li><a href="#python-api" class="level-2">Python API</a></li>
<li><a href="#polnyy-primer" class="level-3">Полный пример</a></li>
<li><a href="#1-podklyuchenie-k-cpg" class="level-1">1. Подключение к CPG</a></li>
<li><a href="#2-sbor-statistiki-po-kodovoy-baze" class="level-1">2. Сбор статистики по кодовой базе</a></li>
<li><a href="#3-generatsiya-gipotez" class="level-1">3. Генерация гипотез</a></li>
<li><a href="#4-otsenka-i-prioritizatsiya" class="level-1">4. Оценка и приоритизация</a></li>
<li><a href="#5-generatsiya-sql-zaprosov" class="level-1">5. Генерация SQL-запросов</a></li>
<li><a href="#6-vypolnenie-zaprosov-k-cpg" class="level-1">6. Выполнение запросов к CPG</a></li>
<li><a href="#7-proverka-i-otchyot" class="level-1">7. Проверка и отчёт</a></li>
<li><a href="#proizvoditelnost" class="level-2">Производительность</a></li>
<li><a href="#rezultaty-testirovaniya" class="level-3">Результаты тестирования</a></li>
<li><a href="#podtverzhdyonnye-uyazvimosti-cve-postgresql-17" class="level-3">Подтверждённые уязвимости CVE (PostgreSQL 17)</a></li>
<li><a href="#sm-takzhe" class="level-2">См. также</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI-копилот для анализа исходного кода</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Продукт</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Возможности</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Интеграции</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Документация</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Начало работы</a></li>
              <li><a href="../guides/index.html" class="footer-link">Руководства</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Ресурсы</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Контакты</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. Все права защищены.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
