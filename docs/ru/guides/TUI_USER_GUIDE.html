<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeGraph documentation: Руководство пользователя CodeGraph">
  <meta name="keywords" content="CodeGraph, documentation, guides">

  <meta property="og:title" content="Руководство пользователя CodeGraph - CodeGraph">
  <meta property="og:description" content="CodeGraph documentation: Руководство пользователя CodeGraph">
  <meta property="og:type" content="article">

  <title>Руководство пользователя CodeGraph - CodeGraph Documentation</title>

  <link rel="icon" type="image/svg+xml" href="../../../assets/svg/logo-compact.svg">
  <link rel="stylesheet" href="../../../css/styles.css?v=2">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <nav class="nav container">
      <a href="../../../" class="logo">
        <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
      </a>

      <ul class="nav-list">
        <li><a href="../../../index.html#problems" class="nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="nav-link active">Документация</a></li>
        <li><a href="../../../index.html#faq" class="nav-link">FAQ</a></li>
      </ul>

      <div class="header-actions">
        <div class="lang-switcher">
          <a href="../../en/guides/TUI_USER_GUIDE.html" class="">EN</a>
          <a href="../../ru/guides/TUI_USER_GUIDE.html" class="active">RU</a>
        </div>
        <button class="theme-toggle" aria-label="Переключить тему">
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <a href="../../../index.html#demo" class="btn btn-primary">Запросить демо</a>
      </div>

      <button class="mobile-menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
      <ul class="mobile-nav-list">
        <li><a href="../../../index.html#problems" class="mobile-nav-link">Проблемы</a></li>
        <li><a href="../../../index.html#solution" class="mobile-nav-link">Решение</a></li>
        <li><a href="../../../index.html#features" class="mobile-nav-link">Возможности</a></li>
        <li><a href="../../../index.html#integrations" class="mobile-nav-link">Интеграции</a></li>
        <li><a href="../index.html" class="mobile-nav-link">Документация</a></li>
        <li><a href="../../../index.html#faq" class="mobile-nav-link">FAQ</a></li>
        <li><a href="../../../index.html#demo" class="btn btn-primary mobile-nav-demo-btn">Запросить демо</a></li>
      </ul>
    </nav>
  </header>

  <div class="doc-layout">
    <!-- Sidebar Navigation -->
    <aside class="doc-sidebar">
      
    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Начало работы</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../getting-started/index.html">Обзор</a></li>
        <li><a href="../getting-started/CONFIGURATION.html">Руководство по настройке</a></li>
        <li><a href="../getting-started/INSTALLATION.html">Руководство по установке</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Руководства</div>
      <ul class="doc-sidebar-nav">
        <li><a href="index.html">Обзор</a></li>
        <li><a href="BENCHMARK_GUIDE.html">Руководство по тестовой платформе</a></li>
        <li><a href="CLI_GUIDE.html">Руководство по CLI</a></li>
        <li><a href="CODE_REVIEW.html">Система автоматического код-ревью на основе патчей</a></li>
        <li><a href="CPG_EXPORT.html">Руководство по экспорту CPG</a></li>
        <li><a href="MONITORING.html">Руководство по мониторингу</a></li>
        <li><a href="PROGRAMMATIC_GUIDE.html">Руководство пользователя</a></li>
        <li><a href="PROJECT_IMPORT.html">Импорт новой кодовой базы</a></li>
        <li><a href="QUICK_REFERENCE.html">Краткое руководство по CodeGraph</a></li>
        <li><a href="REFACTORING.html">Руководство по анализу рефакторинга</a></li>
        <li><a href="SCENARIOS.html">Руководство по сценариям рабочих процессов</a></li>
        <li><a href="TROUBLESHOOTING.html">Руководство по устранению неполадок</a></li>
        <li><a href="TUI_USER_GUIDE.html" class="active">Руководство пользователя CodeGraph</a></li>
        <li><a href="01-onboarding.html">Сценарий 01: Ввод нового разработчика</a></li>
        <li><a href="02-security-audit.html">Сценарий 02: Аудит безопасности</a></li>
        <li><a href="03-documentation.html">Сценарий 03: Генерация документации</a></li>
        <li><a href="04-feature-development.html">Сценарий 04: Разработка функций</a></li>
        <li><a href="05-refactoring.html">Сценарий 05: Рефакторинг</a></li>
        <li><a href="06-performance.html">Сценарий 06: Анализ производительности</a></li>
        <li><a href="07-test-coverage.html">Сценарий 07: Покрытие тестами</a></li>
        <li><a href="08-compliance.html">Сценарий 08: Проверка соответствия требованиям</a></li>
        <li><a href="09-code-review.html">Сценарий 09: Код-ревью</a></li>
        <li><a href="10-cross-repo.html">Сценарий 10: Анализ между репозиториями</a></li>
        <li><a href="11-architecture.html">Сценарий 11: Анализ архитектуры</a></li>
        <li><a href="12-tech-debt.html">Сценарий 12: Оценка технического долга</a></li>
        <li><a href="13-mass-refactoring.html">Сценарий 13: Массовая рефакторизация</a></li>
        <li><a href="14-incident-response.html">Сценарий 14: Реагирование на инциденты безопасности</a></li>
        <li><a href="15-debugging.html">Сценарий 15: Помощь в отладке</a></li>
        <li><a href="16-entry-points.html">Сценарий 16: Обнаружение точки входа</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">API Документация</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../api/index.html">Обзор</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Интеграции</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../integrations/index.html">Обзор</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Справочник</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../reference/index.html">Обзор</a></li>
      </ul>
    </div>

    <div class="doc-sidebar-section">
      <div class="doc-sidebar-title">Enterprise</div>
      <ul class="doc-sidebar-nav">
        <li><a href="../enterprise/index.html">Обзор</a></li>
      </ul>
    </div>
    </aside>

    <!-- Main Content -->
    <main class="doc-main">
      <!-- Breadcrumb -->
      <nav class="doc-breadcrumb">
        <a href="../index.html">Документация</a>
        <span>/</span>
        <a href="index.html">Руководства</a>
        <span>/</span>
        <span>Руководство пользователя CodeGraph</span>
      </nav>

      <!-- Hero -->
      <div class="doc-hero">
        <h1>Руководство пользователя CodeGraph</h1>
        
      </div>

      <!-- Content -->
      <article class="doc-content">
        <h1 id="rukovodstvo-polzovatelya-codegraph">Руководство пользователя CodeGraph<a class="heading-anchor" href="#rukovodstvo-polzovatelya-codegraph" title="Link to this section">&para;</a></h1>
<blockquote class="callout">
<p>Комплексная документация по анализу кода с использованием графов свойств кода (Code Property Graphs)</p>
</blockquote>
<hr />
<h2 id="soderzhanie">Содержание<a class="heading-anchor" href="#soderzhanie" title="Link to this section">&para;</a></h2>
<ol>
<li><a href="#bystryy-start">Быстрый старт</a></li>
<li><a href="#stsenarii-dlya-razrabotchikov">Сценарии для разработчиков</a></li>
<li><a href="#stsenarii-dlya-spetsialistov-po-testirovaniyu-qa">Сценарии для специалистов по тестированию (QA)</a></li>
<li><a href="#stsenarii-dlya-spetsialistov-po-informatsionnoy-bezopasnosti">Сценарии для специалистов по информационной безопасности</a>
   - <a href="#ukreplenie-ishodnogo-koda-po-d3fend">Укрепление исходного кода по D3FEND</a></li>
<li><a href="#stsenarii-dlya-tehnicheskih-pisateley">Сценарии для технических писателей</a></li>
<li><a href="#spravochnik-komand-tui">Справочник команд TUI</a></li>
<li><a href="#rukovodstvo-po-nastroyke">Руководство по настройке</a></li>
<li><a href="#prilozhenie-vse-16-stsenariev">Приложение: все 16 сценариев</a></li>
<li><a href="#otchyoty-po-auditu-bezopasnosti-cli">Отчёты по аудиту безопасности (CLI)</a></li>
<li><a href="#tipovye-rabochie-protsessy">Типовые рабочие процессы</a></li>
<li><a href="#temy-oformleniya">Темы оформления</a></li>
<li><a href="#sessii">Сессии</a></li>
<li><a href="#sovety-i-hitrosti">Советы и хитрости</a></li>
<li><a href="#ustranenie-nepoladok">Устранение неполадок</a></li>
</ol>
<hr />
<h2 id="bystryy-start">Быстрый старт<a class="heading-anchor" href="#bystryy-start" title="Link to this section">&para;</a></h2>
<h3 id="ustanovka">Установка<a class="heading-anchor" href="#ustanovka" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Клонируйте репозиторий и установите зависимости</span>
<span class="n">cd</span><span class="w"> </span><span class="n">codegraph</span>
<span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># Настройте учетные данные API (выберите один вариант)</span>
<span class="k">export</span><span class="w"> </span><span class="n">GIGACHAT_AUTH_KEY</span><span class="o">=</span><span class="s2">&quot;ваш-ключ-здесь&quot;</span><span class="w">    </span><span class="c1"># GigaChat (Сбер)</span>
<span class="c1"># ИЛИ</span>
<span class="k">export</span><span class="w"> </span><span class="n">OPENAI_API_KEY</span><span class="o">=</span><span class="s2">&quot;ваш-ключ-здесь&quot;</span><span class="w">        </span><span class="c1"># OpenAI</span>
</code></pre></div>

<h3 id="zapusk-tui">Запуск TUI<a class="heading-anchor" href="#zapusk-tui" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>python -m src.tui.app
</code></pre></div>

<h3 id="vash-pervyy-zapros">Ваш первый запрос<a class="heading-anchor" href="#vash-pervyy-zapros" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>╭─────────────────────────────────────────────────────────╮
│  Интерактивная консоль CodeGraph                          │
│  Введите /help для получения списка команд, /exit для выхода │
╰─────────────────────────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Где определена функция heap_insert?</span>

╭─────────────── Ответ ────────────────╮
│ heap_insert определена в:            │
│   src/backend/access/heap/heapam.c    │
│   Строка: 2156                        │
│                                       │
│ Сигнатура:                            │
│   void heap_insert(Relation relation, │
│                    HeapTuple tup,     │
│                    CommandId cid,     │
│                    ...)               │
╰───────────────────────────────────────╯
</code></pre></div>

<h3 id="osnovnye-komandy">Основные команды<a class="heading-anchor" href="#osnovnye-komandy" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Команда</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>/help</td>
<td>Показать все доступные команды</td>
</tr>
<tr>
<td>/scenarios</td>
<td>Вывести список из 16 сценариев анализа</td>
</tr>
<tr>
<td>/select 02</td>
<td>Переключиться в режим аудита безопасности</td>
</tr>
<tr>
<td>/project</td>
<td>Переключение между проектами CPG</td>
</tr>
<tr>
<td>/review git</td>
<td>Просмотреть текущие изменения в коде</td>
</tr>
<tr>
<td>/stat</td>
<td>Показать статистику базы данных</td>
</tr>
<tr>
<td>/exit</td>
<td>Сохранить сессию и выйти</td>
</tr>
</tbody>
</table></div>
<hr />
<h2 id="stsenarii-dlya-razrabotchikov">Сценарии для разработчиков<a class="heading-anchor" href="#stsenarii-dlya-razrabotchikov" title="Link to this section">&para;</a></h2>
<h3 id="den-1-osvoenie-kodovoy-bazy">День 1: Освоение кодовой базы<a class="heading-anchor" href="#den-1-osvoenie-kodovoy-bazy" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Новый разработчик присоединяется к команде и должен быстро понять структуру кодовой базы.</p>
<h4 id="shag-1-vyberite-stsenariy-osvoeniya">Шаг 1: Выберите сценарий освоения<a class="heading-anchor" href="#shag-1-vyberite-stsenariy-osvoeniya" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 01
</code></pre></div>

<h4 id="shag-2-zadayte-obzornye-voprosy">Шаг 2: Задайте обзорные вопросы<a class="heading-anchor" href="#shag-2-zadayte-obzornye-voprosy" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&gt; Что такое подсистема исполнителя (executor)?

╭─────────────── Ответ ────────────────╮
│ Подсистема исполнителя отвечает за  │
│ выполнение планов запросов,          │
│ сгенерированных планировщиком.       │
│                                      │
│ Основные компоненты:                 │
│   - ExecutorStart: Инициализация     │
│   - ExecutorRun: Основной цикл       │
│   - ExecutorEnd: Освобождение ресурсов│
│                                      │
│ Точка входа: src/backend/executor/   │
│              execMain.c              │
╰──────────────────────────────────────╯

&gt; Каковы основные точки входа в исполнитель?

&gt; Покажите архитектуру выполнения запросов
</code></pre></div>

<h4 id="shag-3-pogruzites-v-detali">Шаг 3: Погрузитесь в детали<a class="heading-anchor" href="#shag-3-pogruzites-v-detali" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&gt; Что делает ExecProcNode?
&gt; Кто вызывает ExecutorRun?
&gt; Объясните связь между Plan и PlanState
</code></pre></div>

<h4 id="primer-iz-realnoy-praktiki-ponimanie-upravleniya-pamyatyu">Пример из реальной практики: Понимание управления памятью<a class="heading-anchor" href="#primer-iz-realnoy-praktiki-ponimanie-upravleniya-pamyatyu" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&gt; Как работает выделение памяти в PostgreSQL?

╭─────────────── Ответ ────────────────╮
│ PostgreSQL использует контексты      │
│ памяти для иерархического управления│
│ памятью:                             │
│                                      │
│ Основные функции:                    │
│   palloc()  - Выделить память        │
│   pfree()   - Освободить память      │
│   MemoryContextCreate() - Новый контекст│
│   MemoryContextReset()  - Массовое освобождение│
│                                      │
│ Основные контексты:                  │
│   TopMemoryContext - Корневой контекст│
│   CurrentMemoryContext - Текущий     │
│   MessageContext - На сообщение      │
╰──────────────────────────────────────╯
</code></pre></div>

<hr />
<h3 id="poisk-opredeleniy-funktsiy">Поиск определений функций<a class="heading-anchor" href="#poisk-opredeleniy-funktsiy" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Разработчику нужно найти реализации функций.</p>
<h4 id="bystryy-poisk-opredeleniya">Быстрый поиск определения<a class="heading-anchor" href="#bystryy-poisk-opredeleniya" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Где определена функция palloc?</span>

╭─────────────── Ответ ────────────────╮
│ palloc определена в:                 │
│   src/backend/utils/mmgr/mcxt.c:1089 │
│                                      │
│ Сигнатура:                           │
│   void *palloc(Size size)            │
│                                      │
│ Связанные функции:                   │
│   palloc0(), palloc_extended(),      │
│   repalloc(), pfree()                │
╰──────────────────────────────────────╯
</code></pre></div>

<h4 id="s-grafom-vyzovov">С графом вызовов<a class="heading-anchor" href="#s-grafom-vyzovov" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="err">Покажите</span><span class="w"> </span><span class="err">всех</span><span class="w"> </span><span class="err">вызывающих</span><span class="w"> </span><span class="n">palloc</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="err">Вызывающие</span><span class="w"> </span><span class="err">───────────╮</span>
<span class="err">│</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">heap_form_tuple</span><span class="p">()</span><span class="w">                 </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">ExecStoreTuple</span><span class="p">()</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">construct_array</span><span class="p">()</span><span class="w">                 </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">4.</span><span class="w"> </span><span class="n">pnstrdup</span><span class="p">()</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="n">SPI_connect</span><span class="p">()</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="p">(</span><span class="err">показано</span><span class="w"> </span><span class="err">первые</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">из</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">847</span><span class="p">)</span><span class="w">     </span><span class="err">│</span>
<span class="err">╰──────────────────────────────────────╯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="err">Какие</span><span class="w"> </span><span class="err">функции</span><span class="w"> </span><span class="err">вызывает</span><span class="w"> </span><span class="n">LWLockAcquire</span><span class="err">?</span>
</code></pre></div>

<h4 id="otslezhivanie-potoka-dannyh">Отслеживание потока данных<a class="heading-anchor" href="#otslezhivanie-potoka-dannyh" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Как проходят данные от pg_parse_query до исполнителя?</span>

╭─────────────── Поток данных ─────────╮
│ pg_parse_query()                     │
│     ↓                                │
│ pg_analyze_and_rewrite()             │
│     ↓                                │
│ pg_plan_queries()                    │
│     ↓                                │
│ PortalRun()                          │
│     ↓                                │
│ ExecutorRun()                        │
│     ↓                                │
│ ExecProcNode()                       │
╰──────────────────────────────────────╯
</code></pre></div>

<hr />
<h3 id="dobavlenie-novyh-funktsiy">Добавление новых функций<a class="heading-anchor" href="#dobavlenie-novyh-funktsiy" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Разработчику нужно добавить новый алгоритм соединения (join).</p>
<h4 id="shag-1-vyberite-stsenariy-razrabotki-funktsiy">Шаг 1: Выберите сценарий разработки функций<a class="heading-anchor" href="#shag-1-vyberite-stsenariy-razrabotki-funktsiy" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 04
</code></pre></div>

<h4 id="shag-2-naydite-tochki-integratsii">Шаг 2: Найдите точки интеграции<a class="heading-anchor" href="#shag-2-naydite-tochki-integratsii" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Где мне добавить новый алгоритм соединения?</span>

╭─────────────── Ответ ────────────────╮
│ Чтобы добавить новый алгоритм:       │
│                                      │
│ 1. Определите тип узла:              │
│    src/include/nodes/plannodes.h     │
│                                      │
│ 2. Добавьте поддержку в планировщик:│
│    src/backend/optimizer/path/       │
│    joinpath.c - add_xxx_path()       │
│                                      │
│ 3. Добавьте поддержку в исполнитель:│
│    src/backend/executor/             │
│    nodeXxxjoin.c - ExecXxxJoin()     │
│                                      │
│ 4. Зарегистрируйте в execProcnode.c  │
╰──────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Какие хуки существуют в исполнителе для пользовательских узлов плана?</span>

<span class="k">&gt; </span><span class="ge">Покажите, как hashjoin интегрируется с планировщиком</span>
</code></pre></div>

<h4 id="shag-3-otsenite-vliyanie-izmeneniy">Шаг 3: Оцените влияние изменений<a class="heading-anchor" href="#shag-3-otsenite-vliyanie-izmeneniy" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Что сломается, если я изменю add_path?</span>

╭──────────── Анализ влияния ──────────╮
│ Изменение add_path() повлияет на:   │
│                                      │
│ Прямые вызывающие (47):             │
│   - add_partial_path()               │
│   - add_partial_path_precheck()      │
│   - create_seqscan_path()            │
│   - create_index_path()              │
│   ...                                │
│                                      │
│ Риск: ВЫСОКИЙ — ядро выбора путей    │
│ Рекомендация: Добавьте новую функцию │
│ вместо изменения существующей        │
╰──────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Покажите зависимости create_hashjoin_path</span>
</code></pre></div>

<hr />
<h3 id="pomosch-pri-otladke">Помощь при отладке<a class="heading-anchor" href="#pomosch-pri-otladke" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Разработчик отлаживает сбой или неожиданное поведение.</p>
<h4 id="shag-1-vyberite-stsenariy-otladki">Шаг 1: Выберите сценарий отладки<a class="heading-anchor" href="#shag-1-vyberite-stsenariy-otladki" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 15
</code></pre></div>

<h4 id="shag-2-naydite-tochki-otladki">Шаг 2: Найдите точки отладки<a class="heading-anchor" href="#shag-2-naydite-tochki-otladki" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Где в исполнителе используются макросы утверждений (assert)?</span>

╭─────────────── Ответ ────────────────╮
│ Макросы утверждений в исполнителе:   │
│                                      │
│ Assert() - src/include/c.h:846       │
│ AssertArg() - Проверка аргументов    │
│ AssertState() - Проверка состояния   │
│                                      │
│ Использование в исполнителе:         │
│   execMain.c: 89 утверждений         │
│   execProcnode.c: 34 утверждения     │
│   execScan.c: 23 утверждения         │
╰──────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Найдите вызовы elog в heap_insert</span>

<span class="k">&gt; </span><span class="ge">Какие функции пишут в WAL?</span>
</code></pre></div>

<h4 id="shag-3-otsledite-vypolnenie">Шаг 3: Отследите выполнение<a class="heading-anchor" href="#shag-3-otsledite-vypolnenie" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Отследите выполнение от INSERT до heap_insert</span>

╭──────────── Трассировка выполнения ──╮
│ ProcessQuery()                       │
│   ↓                                  │
│ PortalRunMulti()                     │
│   ↓                                  │
│ ExecutorRun()                        │
│   ↓                                  │
│ ExecModifyTable()                    │
│   ↓                                  │
│ ExecInsert()                         │
│   ↓                                  │
│ table_tuple_insert()                 │
│   ↓                                  │
│ heap_insert()                        │
╰──────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Где поставить точки останова для фиксации транзакции?</span>
</code></pre></div>

<hr />
<h3 id="refaktoring-koda">Рефакторинг кода<a class="heading-anchor" href="#refaktoring-koda" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Разработчик устраняет технический долг во время спринта рефакторинга.</p>
<h4 id="shag-1-vyberite-stsenariy-refaktoringa">Шаг 1: Выберите сценарий рефакторинга<a class="heading-anchor" href="#shag-1-vyberite-stsenariy-refaktoringa" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 05
</code></pre></div>

<h4 id="shag-2-naydite-neispolzuemyy-kod">Шаг 2: Найдите неиспользуемый код<a class="heading-anchor" href="#shag-2-naydite-neispolzuemyy-kod" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Найдите неиспользуемые статические функции в исполнителе</span>

╭──────────── Неиспользуемый код ──────╮
│ Потенциально неиспользуемые функции: │
│                                      │
│ 1. execUtils.c:                      │
│    - old_get_typlenbyval() :234      │
│                                      │
│ 2. execTuples.c:                     │
│    - legacy_slot_init() :456         │
│                                      │
│ Всего: 12 кандидатов                 │
│ Подтверждено неиспользуемых: 8       │
╰──────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Покажите устаревшие функции, которые всё ещё используются</span>

<span class="k">&gt; </span><span class="ge">Найдите дублирующиеся шаблоны обработки ошибок</span>
</code></pre></div>

<h4 id="shag-3-planirovanie-refaktoringa">Шаг 3: Планирование рефакторинга<a class="heading-anchor" href="#shag-3-planirovanie-refaktoringa" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">От чего зависит ExecProcNode?</span>

╭──────────── Зависимости ─────────────╮
│ Прямые зависимости: 47               │
│ Транзитивные зависимости: 312        │
│                                      │
│ Ключевые вызывающие:                 │
│   - ExecutorRun()                    │
│   - ExecSubPlan()                    │
│   - ExecMaterial()                   │
│   - ExecSort()                       │
│                                      │
│ Риск рефакторинга: КРИТИЧЕСКИЙ       │
│ Рекомендация: Поэтапная миграция     │
╰──────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Влияние переименования heap_open в table_open</span>
</code></pre></div>

<h2 id="stsenarii-dlya-qatestirovschikov">Сценарии для QA/тестировщиков<a class="heading-anchor" href="#stsenarii-dlya-qatestirovschikov" title="Link to this section">&para;</a></h2>
<h3 id="analiz-pokrytiya-testami">Анализ покрытия тестами<a class="heading-anchor" href="#analiz-pokrytiya-testami" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Инженеру по тестированию необходимо выявить непротестированные участки кода.</p>
<h4 id="shag-1-vybor-stsenariya-analiza-pokrytiya-testami">Шаг 1: Выбор сценария анализа покрытия тестами<a class="heading-anchor" href="#shag-1-vybor-stsenariya-analiza-pokrytiya-testami" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 07
</code></pre></div>

<h4 id="shag-2-poisk-probelov-v-pokrytii">Шаг 2: Поиск пробелов в покрытии<a class="heading-anchor" href="#shag-2-poisk-probelov-v-pokrytii" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Какие функции не покрыты тестами?</span>

╭─────────────── Пробелы в покрытии ─────────╮
│ Функции без прямых тестов:                │
│                                           │
│ Критические (executor):                   │
│   - ExecParallelHashJoinNewBatch()        │
│   - ExecReScanGather()                    │
│                                           │
│ Высокий приоритет (storage):              │
│   - heap_lock_updated_tuple()             │
│   - heap_abort_speculative()              │
│                                           │
│ Всего непротестированных: 234 функции     │
│ Оценка покрытия: 78%                      │
╰───────────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Какие критические функции нужно протестировать в первую очередь?</span>

<span class="k">&gt; </span><span class="ge">Найти непротестированные пути обработки ошибок</span>
</code></pre></div>

<h4 id="shag-3-opredelenie-prioritetov-testirovaniya">Шаг 3: Определение приоритетов тестирования<a class="heading-anchor" href="#shag-3-opredelenie-prioritetov-testirovaniya" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Какие непротестированные функции имеют наибольшее влияние?</span>

╭─────────────── Список приоритетов ─────────╮
│ Высокое влияние + нет тестов:              │
│                                            │
│ 1. heap_lock_updated_tuple()               │
│    Влияние: Целостность транзакций         │
│    Количество вызовов: 23                  │
│                                            │
│ 2. ExecParallelHashJoinNewBatch()          │
│    Влияние: Корректность параллельных запросов │
│    Количество вызовов: 8                   │
│                                            │
│ 3. AtEOXact_RelationCache()                │
│    Влияние: Согласованность кэша           │
│    Количество вызовов: 4                   │
╰────────────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Показать точки входа без тестов</span>
</code></pre></div>

<hr />
<h3 id="pomosch-pri-kod-revyu">Помощь при код-ревью<a class="heading-anchor" href="#pomosch-pri-kod-revyu" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Ревьюеру необходимо проанализировать pull request на наличие проблем с качеством и безопасностью.</p>
<h4 id="variant-a-github-pr">Вариант A: GitHub PR<a class="heading-anchor" href="#variant-a-github-pr" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review github 123
</code></pre></div>

<h4 id="variant-b-gitlab-mr">Вариант B: GitLab MR<a class="heading-anchor" href="#variant-b-gitlab-mr" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review gitlab 456
</code></pre></div>

<h4 id="variant-c-lokalnye-izmeneniya-v-git">Вариант C: Локальные изменения в Git<a class="heading-anchor" href="#variant-c-lokalnye-izmeneniya-v-git" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review git
</code></pre></div>

<h4 id="variant-d-fayl-patcha">Вариант D: Файл патча<a class="heading-anchor" href="#variant-d-fayl-patcha" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/review file path/to/changes.patch
</code></pre></div>

<h4 id="ponimanie-rezultata">Понимание результата<a class="heading-anchor" href="#ponimanie-rezultata" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>╭─────────────── Результаты ревью ────────────────────────────╮
│                                                             │
│  Оценка: 72/100         Рекомендация: REQUEST_CHANGES        │
│                                                             │
│  ══════════════════════════════════════════════════════     │
│                                                             │
│  Найденные проблемы:                                        │
│                                                             │
│  🔴 КРИТИЧЕСКИЙ  Риск SQL-инъекции                           │
│     Местоположение: src/api/user_query.c:45                 │
│     Паттерн: Ввод пользователя вставляется в запрос напрямую │
│     Исправление: Использовать параметризованные запросы     │
│                                                             │
│  🟡 СРЕДНИЙ     Сложность по Маккейбу                       │
│     Местоположение: src/parser/gram.y:1234                  │
│     Значение: 47 (порог: 10)                                │
│     Исправление: Вынести вспомогательные функции             │
│                                                             │
│  🟢 НИЗКИЙ      Отсутствует проверка на NULL                │
│     Местоположение: src/utils/string.c:89                   │
│     Исправление: Добавить проверку указателя на NULL        │
│                                                             │
╰─────────────────────────────────────────────────────────────╯
</code></pre></div>

<h4 id="revyu-s-vstroennymi-kommentariyami">Ревью с встроенными комментариями<a class="heading-anchor" href="#revyu-s-vstroennymi-kommentariyami" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="nt">review</span><span class="w"> </span><span class="nt">git</span><span class="w"> </span><span class="nt">--format</span><span class="w"> </span><span class="nt">md</span><span class="w"> </span><span class="nt">--inline</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="nt">Встроенные</span><span class="w"> </span><span class="nt">комментарии</span><span class="w"> </span><span class="err">───────────────────────────╮</span>
<span class="err">│</span><span class="w">                                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">src</span><span class="o">/</span><span class="nt">api</span><span class="o">/</span><span class="nt">user_query</span><span class="p">.</span><span class="nc">c</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">─────────────────────</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">Строка</span><span class="w"> </span><span class="nt">45</span><span class="o">:</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="nt">sprintf</span><span class="o">(</span><span class="nt">query</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;SELECT * FROM users WHERE id=%s&quot;</span><span class="o">,</span><span class="w"> </span><span class="nt">id</span><span class="o">);</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">🔴</span><span class="w"> </span><span class="nt">SQL-инъекция</span><span class="o">:</span><span class="w"> </span><span class="nt">Используйте</span><span class="w"> </span><span class="nt">snprintf</span><span class="w"> </span><span class="nt">с</span><span class="w"> </span><span class="nt">правильным</span><span class="w"> </span><span class="nt">экранированием</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">Строка</span><span class="w"> </span><span class="nt">67</span><span class="o">:</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="nt">char</span><span class="w"> </span><span class="o">*</span><span class="nt">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">malloc</span><span class="o">(</span><span class="nt">len</span><span class="o">);</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">🟡</span><span class="w"> </span><span class="nt">Память</span><span class="o">:</span><span class="w"> </span><span class="nt">Проверьте</span><span class="w"> </span><span class="nt">возвращаемое</span><span class="w"> </span><span class="nt">значение</span><span class="w"> </span><span class="nt">malloc</span><span class="w"> </span><span class="nt">на</span><span class="w"> </span><span class="nt">NULL</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                   </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────────────────╯</span>
</code></pre></div>

<hr />
<h3 id="generatsiya-testovyh-stsenariev">Генерация тестовых сценариев<a class="heading-anchor" href="#generatsiya-testovyh-stsenariev" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> QA-инженеру необходимо создать комплексные тесты для функции.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="err">Сгенерируй</span><span class="w"> </span><span class="err">тестовые</span><span class="w"> </span><span class="err">сценарии</span><span class="w"> </span><span class="err">для</span><span class="w"> </span><span class="n">heap_insert</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="err">Тестовые</span><span class="w"> </span><span class="err">сценарии</span><span class="w"> </span><span class="err">────────────────────────────────╮</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="err">Функция</span><span class="p">:</span><span class="w"> </span><span class="n">heap_insert</span><span class="p">()</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="err">Файл</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">access</span><span class="o">/</span><span class="n">heap</span><span class="o">/</span><span class="n">heapam</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">2156</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="err">═════════════════════════════════════════════════════════</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="err">Обычная</span><span class="w"> </span><span class="err">вставка</span><span class="w">                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Входные</span><span class="w"> </span><span class="err">данные</span><span class="p">:</span><span class="w"> </span><span class="err">Корректная</span><span class="w"> </span><span class="err">таблица</span><span class="p">,</span><span class="w"> </span><span class="err">корректный</span><span class="w"> </span><span class="err">кортеж</span><span class="p">,</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                    </span><span class="err">корректный</span><span class="w"> </span><span class="n">CommandId</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Ожидаемое</span><span class="p">:</span><span class="w"> </span><span class="err">Возвращён</span><span class="w"> </span><span class="n">OID</span><span class="p">,</span><span class="w"> </span><span class="err">кортеж</span><span class="w"> </span><span class="err">виден</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="err">в</span><span class="w"> </span><span class="err">указателе</span><span class="w"> </span><span class="err">таблицы</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Входные</span><span class="w"> </span><span class="err">данные</span><span class="p">:</span><span class="w"> </span><span class="err">Указатель</span><span class="w"> </span><span class="err">таблицы</span><span class="w"> </span><span class="err">равен</span><span class="w"> </span><span class="n">NULL</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Ожидаемое</span><span class="p">:</span><span class="w"> </span><span class="err">Сбой</span><span class="w"> </span><span class="err">утверждения</span><span class="w"> </span><span class="err">или</span><span class="w"> </span><span class="err">корректное</span><span class="w"> </span><span class="err">сообщение</span><span class="w"> </span><span class="err">об</span><span class="w"> </span><span class="err">ошибке</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="err">Слишком</span><span class="w"> </span><span class="err">большой</span><span class="w"> </span><span class="err">кортеж</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Входные</span><span class="w"> </span><span class="err">данные</span><span class="p">:</span><span class="w"> </span><span class="err">Кортеж</span><span class="w"> </span><span class="err">больше</span><span class="w"> </span><span class="n">BLCKSZ</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Ожидаемое</span><span class="p">:</span><span class="w"> </span><span class="err">Ошибка</span><span class="w"> </span><span class="err">с</span><span class="w"> </span><span class="err">понятным</span><span class="w"> </span><span class="err">сообщением</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">4.</span><span class="w"> </span><span class="err">Параллельная</span><span class="w"> </span><span class="err">вставка</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Входные</span><span class="w"> </span><span class="err">данные</span><span class="p">:</span><span class="w"> </span><span class="err">Несколько</span><span class="w"> </span><span class="err">потоков</span><span class="w"> </span><span class="err">выполняют</span><span class="w"> </span><span class="err">вставку</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Ожидаемое</span><span class="p">:</span><span class="w"> </span><span class="err">Все</span><span class="w"> </span><span class="err">вставки</span><span class="w"> </span><span class="err">успешны</span><span class="p">,</span><span class="w"> </span><span class="err">без</span><span class="w"> </span><span class="err">повреждений</span><span class="w"> </span><span class="err">данных</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="err">Откат</span><span class="w"> </span><span class="err">транзакции</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Входные</span><span class="w"> </span><span class="err">данные</span><span class="p">:</span><span class="w"> </span><span class="err">Вставка</span><span class="p">,</span><span class="w"> </span><span class="err">за</span><span class="w"> </span><span class="err">которой</span><span class="w"> </span><span class="err">следует</span><span class="w"> </span><span class="n">ROLLBACK</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Ожидаемое</span><span class="p">:</span><span class="w"> </span><span class="err">Кортеж</span><span class="w"> </span><span class="err">не</span><span class="w"> </span><span class="err">виден</span><span class="w"> </span><span class="err">после</span><span class="w"> </span><span class="err">отката</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mf">6.</span><span class="w"> </span><span class="err">Требуется</span><span class="w"> </span><span class="n">TOAST</span><span class="w">                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Входные</span><span class="w"> </span><span class="err">данные</span><span class="p">:</span><span class="w"> </span><span class="err">Кортеж</span><span class="w"> </span><span class="err">с</span><span class="w"> </span><span class="err">большим</span><span class="w"> </span><span class="err">полем</span><span class="w"> </span><span class="n">varlena</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Ожидаемое</span><span class="p">:</span><span class="w"> </span><span class="n">TOAST</span><span class="o">-</span><span class="err">таблица</span><span class="w"> </span><span class="err">заполнена</span><span class="w"> </span><span class="err">корректно</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">╰──────────────────────────────────────────────────────────────────╯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="err">Какие</span><span class="w"> </span><span class="err">граничные</span><span class="w"> </span><span class="err">случаи</span><span class="w"> </span><span class="err">нужно</span><span class="w"> </span><span class="err">протестировать</span><span class="w"> </span><span class="err">в</span><span class="w"> </span><span class="n">LWLockAcquire</span><span class="err">?</span>

<span class="o">&gt;</span><span class="w"> </span><span class="err">Создай</span><span class="w"> </span><span class="err">тестовые</span><span class="w"> </span><span class="err">данные</span><span class="w"> </span><span class="err">для</span><span class="w"> </span><span class="err">сценариев</span><span class="w"> </span><span class="err">фиксации</span><span class="w"> </span><span class="err">транзакций</span>
</code></pre></div>

<h2 id="stsenarii-spetsialista-po-informatsionnoy-bezopasnosti">Сценарии специалиста по информационной безопасности<a class="heading-anchor" href="#stsenarii-spetsialista-po-informatsionnoy-bezopasnosti" title="Link to this section">&para;</a></h2>
<h3 id="skanirovanie-uyazvimostey">Сканирование уязвимостей<a class="heading-anchor" href="#skanirovanie-uyazvimostey" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Инженер по безопасности проводит аудит в рамках спринта.</p>
<h4 id="shag-1-vybor-stsenariya-bezopasnosti">Шаг 1: Выбор сценария безопасности<a class="heading-anchor" href="#shag-1-vybor-stsenariya-bezopasnosti" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>/select 02
</code></pre></div>

<h4 id="shag-2-poisk-uyazvimostey">Шаг 2: Поиск уязвимостей<a class="heading-anchor" href="#shag-2-poisk-uyazvimostey" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nt">Найти</span><span class="w"> </span><span class="nt">уязвимости</span><span class="w"> </span><span class="nt">типа</span><span class="w"> </span><span class="nt">SQL-инъекция</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="nt">Результаты</span><span class="w"> </span><span class="nt">проверки</span><span class="w"> </span><span class="nt">безопасности</span><span class="w"> </span><span class="err">─────────────────────────╮</span>
<span class="err">│</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">🔴</span><span class="w"> </span><span class="nt">КРИТИЧЕСКИЙ</span><span class="o">:</span><span class="w"> </span><span class="nt">SQL-инъекция</span><span class="w">                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">──────────────────────────────────────</span><span class="w">                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Расположение</span><span class="o">:</span><span class="w"> </span><span class="nt">src</span><span class="o">/</span><span class="nt">pl</span><span class="o">/</span><span class="nt">plpgsql</span><span class="o">/</span><span class="nt">src</span><span class="o">/</span><span class="nt">pl_exec</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">4567</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Паттерн</span><span class="o">:</span><span class="w"> </span><span class="nt">Динамический</span><span class="w"> </span><span class="nt">запрос</span><span class="w"> </span><span class="nt">с</span><span class="w"> </span><span class="nt">конкатенацией</span><span class="w"> </span><span class="nt">строк</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Код</span><span class="o">:</span><span class="w">                                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="nt">snprintf</span><span class="o">(</span><span class="nt">query</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;SELECT * FROM %s&quot;</span><span class="o">,</span><span class="w"> </span><span class="nt">table_name</span><span class="o">);</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Риск</span><span class="o">:</span><span class="w"> </span><span class="nt">Управляемое</span><span class="w"> </span><span class="nt">пользователем</span><span class="w"> </span><span class="nt">имя</span><span class="w"> </span><span class="nt">таблицы</span><span class="w"> </span><span class="nt">может</span><span class="w"> </span><span class="nt">внедрить</span><span class="w"> </span><span class="nt">SQL</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Исправление</span><span class="o">:</span><span class="w"> </span><span class="nt">Использовать</span><span class="w"> </span><span class="nt">quote_identifier</span><span class="o">()</span><span class="w"> </span><span class="nt">для</span><span class="w"> </span><span class="nt">имён</span><span class="w"> </span><span class="nt">таблиц</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">CWE</span><span class="o">:</span><span class="w"> </span><span class="nt">CWE-89</span><span class="w">                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">────────────────────────────────────────────────────────────────────────</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Расположение</span><span class="o">:</span><span class="w"> </span><span class="nt">src</span><span class="o">/</span><span class="nt">backend</span><span class="o">/</span><span class="nt">utils</span><span class="o">/</span><span class="nt">adt</span><span class="o">/</span><span class="nt">ruleutils</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">2341</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Паттерн</span><span class="o">:</span><span class="w"> </span><span class="nt">Строка</span><span class="w"> </span><span class="nt">формата</span><span class="w"> </span><span class="nt">с</span><span class="w"> </span><span class="nt">внешним</span><span class="w"> </span><span class="nt">вводом</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Риск</span><span class="o">:</span><span class="w"> </span><span class="nt">Потенциальная</span><span class="w"> </span><span class="nt">инъекция</span><span class="w"> </span><span class="nt">строки</span><span class="w"> </span><span class="nt">формата</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="nt">Исправление</span><span class="o">:</span><span class="w"> </span><span class="nt">Проверить</span><span class="w"> </span><span class="nt">спецификаторы</span><span class="w"> </span><span class="nt">формата</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">Всего</span><span class="w"> </span><span class="nt">найдено</span><span class="o">:</span><span class="w"> </span><span class="nt">7</span><span class="w"> </span><span class="nt">критических</span><span class="o">,</span><span class="w"> </span><span class="nt">12</span><span class="w"> </span><span class="nt">высоких</span><span class="o">,</span><span class="w"> </span><span class="nt">34</span><span class="w"> </span><span class="nt">средних</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────────────────────────╯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="nt">Найти</span><span class="w"> </span><span class="nt">риски</span><span class="w"> </span><span class="nt">переполнения</span><span class="w"> </span><span class="nt">буфера</span><span class="w"> </span><span class="nt">в</span><span class="w"> </span><span class="nt">строковых</span><span class="w"> </span><span class="nt">функциях</span>

<span class="o">&gt;</span><span class="w"> </span><span class="nt">Показать</span><span class="w"> </span><span class="nt">функции</span><span class="o">,</span><span class="w"> </span><span class="nt">использующие</span><span class="w"> </span><span class="nt">sprintf</span><span class="w"> </span><span class="nt">без</span><span class="w"> </span><span class="nt">проверки</span><span class="w"> </span><span class="nt">границ</span>
</code></pre></div>

<hr />
<h3 id="analiz-potoka-zarazhyonnyh-dannyh-taint-flow-analysis">Анализ потока заражённых данных (Taint Flow Analysis)<a class="heading-anchor" href="#analiz-potoka-zarazhyonnyh-dannyh-taint-flow-analysis" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Инженер по безопасности отслеживает ненадёжные данные через систему.</p>
<h4 id="shag-1-opredelenie-tochek-vhoda">Шаг 1: Определение точек входа<a class="heading-anchor" href="#shag-1-opredelenie-tochek-vhoda" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&gt;</span><span class="w"> </span><span class="nx">Найти</span><span class="w"> </span><span class="nx">все</span><span class="w"> </span><span class="nx">внешние</span><span class="w"> </span><span class="nx">точки</span><span class="w"> </span><span class="nx">входа</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="nx">Точки</span><span class="w"> </span><span class="nx">входа</span><span class="w"> </span><span class="err">──────────────────────────────╮</span>
<span class="err">│</span><span class="w">                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Сетевые</span><span class="w"> </span><span class="nx">точки</span><span class="w"> </span><span class="nx">входа</span><span class="p">:</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pq_getmsgstring</span><span class="p">()</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Чтение</span><span class="w"> </span><span class="nx">строки</span><span class="w"> </span><span class="nx">от</span><span class="w"> </span><span class="nx">клиента</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pq_getmsgint</span><span class="p">()</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nx">Чтение</span><span class="w"> </span><span class="nx">целого</span><span class="w"> </span><span class="nx">от</span><span class="w"> </span><span class="nx">клиента</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">ProcessClientRead</span><span class="p">()</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Прямое</span><span class="w"> </span><span class="nx">чтение</span><span class="w"> </span><span class="nx">из</span><span class="w"> </span><span class="nx">сокета</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Точки</span><span class="w"> </span><span class="nx">входа</span><span class="w"> </span><span class="nx">SQL</span><span class="p">:</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">exec_simple_query</span><span class="p">()</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Прямое</span><span class="w"> </span><span class="nx">выполнение</span><span class="w"> </span><span class="nx">SQL</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">exec_parse_message</span><span class="p">()</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Подготовленный</span><span class="w"> </span><span class="nx">оператор</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">exec_bind_message</span><span class="p">()</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Привязка</span><span class="w"> </span><span class="nx">параметров</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Файловые</span><span class="w"> </span><span class="nx">точки</span><span class="w"> </span><span class="nx">входа</span><span class="p">:</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pg_read_file</span><span class="p">()</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nx">Чтение</span><span class="w"> </span><span class="nx">произвольного</span><span class="w"> </span><span class="nx">файла</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">pg_ls_dir</span><span class="p">()</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="nx">Просмотр</span><span class="w"> </span><span class="nx">содержимого</span><span class="w"> </span><span class="nx">папки</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Всего</span><span class="p">:</span><span class="w"> </span><span class="nx">обнаружено</span><span class="w"> </span><span class="mi">47</span><span class="w"> </span><span class="nx">точек</span><span class="w"> </span><span class="nx">входа</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                           </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────────╯</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Показать</span><span class="w"> </span><span class="nx">обработчики</span><span class="w"> </span><span class="nx">сетевого</span><span class="w"> </span><span class="nx">ввода</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Перечислить</span><span class="w"> </span><span class="nx">функции</span><span class="w"> </span><span class="nx">ввода</span><span class="w"> </span><span class="nx">пользователя</span>
</code></pre></div>

<h4 id="shag-2-otslezhivanie-potoka-dannyh">Шаг 2: Отслеживание потока данных<a class="heading-anchor" href="#shag-2-otslezhivanie-potoka-dannyh" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">&gt;</span><span class="w"> </span><span class="nx">Отследить</span><span class="w"> </span><span class="nx">поток</span><span class="w"> </span><span class="nx">данных</span><span class="w"> </span><span class="nx">от</span><span class="w"> </span><span class="nx">PQgetvalue</span><span class="w"> </span><span class="nx">до</span><span class="w"> </span><span class="nx">выполнения</span><span class="w"> </span><span class="nx">SQL</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="nx">Поток</span><span class="w"> </span><span class="nx">заражённых</span><span class="w"> </span><span class="nx">данных</span><span class="w"> </span><span class="err">────────────────────────╮</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">ИСТОЧНИК</span><span class="p">:</span><span class="w"> </span><span class="nx">PQgetvalue</span><span class="p">()</span><span class="w"> </span><span class="p">[</span><span class="nx">Ввод</span><span class="w"> </span><span class="nx">клиента</span><span class="p">]</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">↓</span><span class="w">                                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">pq_getmsgstring</span><span class="p">()</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">↓</span><span class="w">                                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">exec_simple_query</span><span class="p">()</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">↓</span><span class="w">                                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">pg_parse_query</span><span class="p">()</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">↓</span><span class="w">                                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">СТОК</span><span class="p">:</span><span class="w"> </span><span class="nx">SPI_execute</span><span class="p">()</span><span class="w"> </span><span class="p">[</span><span class="nx">Выполнение</span><span class="w"> </span><span class="nx">SQL</span><span class="p">]</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">════════════════════════════════════════════════════</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Санация</span><span class="w"> </span><span class="nx">найдена</span><span class="p">:</span><span class="w"> </span><span class="nx">ДА</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Расположение</span><span class="p">:</span><span class="w"> </span><span class="nx">pg_parse_query</span><span class="p">()</span><span class="w"> </span><span class="nx">проверяет</span><span class="w"> </span><span class="nx">синтаксис</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">НО</span><span class="p">:</span><span class="w"> </span><span class="nx">Не</span><span class="w"> </span><span class="nx">предотвращает</span><span class="w"> </span><span class="nx">семантическую</span><span class="w"> </span><span class="nx">инъекцию</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Уровень</span><span class="w"> </span><span class="nx">риска</span><span class="p">:</span><span class="w"> </span><span class="nx">ВЫСОКИЙ</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nx">Рекомендация</span><span class="p">:</span><span class="w"> </span><span class="nx">Добавить</span><span class="w"> </span><span class="nx">проверку</span><span class="w"> </span><span class="nx">ввода</span><span class="w"> </span><span class="nx">на</span><span class="w"> </span><span class="nx">точке</span><span class="w"> </span><span class="nx">входа</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────────────╯</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Достигает</span><span class="w"> </span><span class="nx">ли</span><span class="w"> </span><span class="nx">ввод</span><span class="w"> </span><span class="nx">пользователя</span><span class="w"> </span><span class="nx">strcpy</span><span class="w"> </span><span class="nx">без</span><span class="w"> </span><span class="nx">проверки</span><span class="p">?</span>

<span class="p">&gt;</span><span class="w"> </span><span class="nx">Показать</span><span class="w"> </span><span class="nx">путь</span><span class="w"> </span><span class="nx">от</span><span class="w"> </span><span class="nx">чтения</span><span class="w"> </span><span class="nx">из</span><span class="w"> </span><span class="nx">сокета</span><span class="w"> </span><span class="nx">до</span><span class="w"> </span><span class="nx">выделения</span><span class="w"> </span><span class="nx">памяти</span>
</code></pre></div>

<h4 id="shag-3-poisk-sanatsii-dannyh">Шаг 3: Поиск санации данных<a class="heading-anchor" href="#shag-3-poisk-sanatsii-dannyh" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">Где ввод санируется перед выполнением запроса?</span>

╭─────────────── Точки санации данных ───────────────────────╮
│                                                           │
│  Обнаруженные средства санации:                            │
│                                                           │
│  1. quote_identifier()                                    │
│     Расположение: src/backend/utils/adt/ruleutils.c:10234 │
│     Назначение: Экранирование идентификаторов SQL         │
│     Охват: Частичный — не всегда используется             │
│                                                           │
│  2. quote_literal()                                       │
│     Расположение: src/backend/utils/adt/quote.c:45        │
│     Назначение: Экранирование литералов SQL               │
│     Охват: Хороший — широко используется                  │
│                                                           │
│  3. pg_parse_query()                                      │
│     Расположение: src/backend/tcop/postgres.c:645         │
│     Назначение: Проверка синтаксиса                       │
│     Охват: Все запросы                                    │
│                                                           │
│  Отсутствует санация в:                                   │
│    - Построение имён таблиц (12 мест)                     │
│    - Построение строк формата (5 мест)                    │
│                                                           │
╰───────────────────────────────────────────────────────────╯

<span class="k">&gt; </span><span class="ge">Найти все функции проверки в аутентификации</span>
</code></pre></div>

<hr />
<h3 id="ukreplenie-ishodnogo-koda-po-d3fend">Укрепление исходного кода по D3FEND<a class="heading-anchor" href="#ukreplenie-ishodnogo-koda-po-d3fend" title="Link to this section">&para;</a></h3>
<p><strong>Сценарий:</strong> Инженер по безопасности проверяет практики оборонительного программирования с использованием фреймворка MITRE D3FEND.</p>
<p>Модуль D3FEND анализирует код на соответствие 11 методикам укрепления исходного кода, определённым MITRE:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ID</th>
<th>Методика</th>
<th>Описание</th>
<th>CWE</th>
</tr>
</thead>
<tbody>
<tr>
<td>D3-VI</td>
<td>Инициализация переменных</td>
<td>Неинициализированные переменные</td>
<td>CWE-457</td>
</tr>
<tr>
<td>D3-CS</td>
<td>Очистка учётных данных</td>
<td>Жёстко заданные учётные данные</td>
<td>CWE-798</td>
</tr>
<tr>
<td>D3-IRV</td>
<td>Проверка диапазона целых</td>
<td>Риски переполнения целых</td>
<td>CWE-190</td>
</tr>
<tr>
<td>D3-PV</td>
<td>Проверка указателей</td>
<td>Разыменование указателя без проверки</td>
<td>CWE-476</td>
</tr>
<tr>
<td>D3-RN</td>
<td>Обнуление ссылок</td>
<td>Риски использования после освобождения</td>
<td>CWE-416</td>
</tr>
<tr>
<td>D3-TL</td>
<td>Надёжные библиотеки</td>
<td>Использование небезопасных функций</td>
<td>CWE-676</td>
</tr>
<tr>
<td>D3-VTV</td>
<td>Проверка типа переменных</td>
<td>Проблемы с типами</td>
<td>CWE-704</td>
</tr>
<tr>
<td>D3-MBSV</td>
<td>Проверка начала блока памяти</td>
<td>Выход за границы буфера</td>
<td>CWE-119</td>
</tr>
<tr>
<td>D3-NPC</td>
<td>Проверка на null-указатель</td>
<td>Отсутствие проверок NULL</td>
<td>CWE-476</td>
</tr>
<tr>
<td>D3-DLV</td>
<td>Проверка логики домена</td>
<td>Ошибки бизнес-логики</td>
<td>CWE-20</td>
</tr>
<tr>
<td>D3-OLV</td>
<td>Проверка операционной логики</td>
<td>Управление состоянием</td>
<td>CWE-754</td>
</tr>
</tbody>
</table></div>
<h4 id="primer-1-polnyy-audit-ukrepleniya">Пример 1: Полный аудит укрепления<a class="heading-anchor" href="#primer-1-polnyy-audit-ukrepleniya" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">select</span><span class="w"> </span><span class="mi">02</span>

<span class="o">&gt;</span><span class="w"> </span><span class="err">Выполнить</span><span class="w"> </span><span class="err">проверку</span><span class="w"> </span><span class="err">соответствия</span><span class="w"> </span><span class="n">D3FEND</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="err">Отчёт</span><span class="w"> </span><span class="err">о</span><span class="w"> </span><span class="err">соответствии</span><span class="w"> </span><span class="n">D3FEND</span><span class="w"> </span><span class="err">─────────────────────╮</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Общий</span><span class="w"> </span><span class="err">балл</span><span class="w"> </span><span class="err">соответствия</span><span class="p">:</span><span class="w"> </span><span class="mi">72</span><span class="p">,</span><span class="mi">5</span><span class="o">%</span><span class="w">                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">═══════════════════════════════════════════════════════════</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Найденные</span><span class="w"> </span><span class="err">проблемы</span><span class="w"> </span><span class="err">по</span><span class="w"> </span><span class="err">методикам</span><span class="p">:</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">VI</span><span class="w"> </span><span class="p">(</span><span class="err">Инициализация</span><span class="w"> </span><span class="err">переменных</span><span class="p">):</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="err">проблемы</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">palloc</span><span class="w"> </span><span class="err">без</span><span class="w"> </span><span class="n">palloc0</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="err">мест</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="err">Неинициализированные</span><span class="w"> </span><span class="err">поля</span><span class="w"> </span><span class="err">структур</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="err">мест</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="w"> </span><span class="p">(</span><span class="err">Надёжные</span><span class="w"> </span><span class="err">библиотеки</span><span class="p">):</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="err">проблем</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">─────────────────────────────────────────────────────</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">🔴</span><span class="w"> </span><span class="err">использование</span><span class="w"> </span><span class="n">strcpy</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">adt</span><span class="o">/</span><span class="n">varlena</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">234</span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">🔴</span><span class="w"> </span><span class="err">использование</span><span class="w"> </span><span class="n">sprintf</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">567</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">🟡</span><span class="w"> </span><span class="err">использование</span><span class="w"> </span><span class="n">strtok</span><span class="p">:</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">parser</span><span class="o">/</span><span class="n">gram</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">1234</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="w"> </span><span class="p">(</span><span class="err">Проверка</span><span class="w"> </span><span class="err">на</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="o">-</span><span class="err">указатель</span><span class="p">):</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="err">проблем</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">malloc</span><span class="w"> </span><span class="err">без</span><span class="w"> </span><span class="err">проверки</span><span class="w"> </span><span class="err">на</span><span class="w"> </span><span class="n">NULL</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">мест</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">palloc</span><span class="w"> </span><span class="err">без</span><span class="w"> </span><span class="err">проверки</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">места</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">D3</span><span class="o">-</span><span class="n">RN</span><span class="w"> </span><span class="p">(</span><span class="err">Обнуление</span><span class="w"> </span><span class="err">ссылок</span><span class="p">):</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">проблем</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">pfree</span><span class="w"> </span><span class="err">без</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">мест</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Баллы</span><span class="w"> </span><span class="err">по</span><span class="w"> </span><span class="err">категориям</span><span class="p">:</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Инициализация</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="o">%</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Безопасность</span><span class="w"> </span><span class="err">памяти</span><span class="p">:</span><span class="w"> </span><span class="mi">78</span><span class="o">%</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Безопасность</span><span class="w"> </span><span class="err">указателей</span><span class="p">:</span><span class="w"> </span><span class="mi">82</span><span class="o">%</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Безопасность</span><span class="w"> </span><span class="err">библиотек</span><span class="p">:</span><span class="w"> </span><span class="mi">58</span><span class="o">%</span><span class="w">                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────────────╯</span>
</code></pre></div>

<h4 id="primer-2-proverka-konkretnyh-metodik-d3fend">Пример 2: Проверка конкретных методик D3FEND<a class="heading-anchor" href="#primer-2-proverka-konkretnyh-metodik-d3fend" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="err">Проверить</span><span class="w"> </span><span class="err">использование</span><span class="w"> </span><span class="err">небезопасных</span><span class="w"> </span><span class="err">функций</span><span class="w"> </span><span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="w"> </span><span class="err">Надёжные</span><span class="w"> </span><span class="err">библиотеки</span><span class="p">)</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="n">TL</span><span class="p">:</span><span class="w"> </span><span class="err">Надёжные</span><span class="w"> </span><span class="err">библиотеки</span><span class="w"> </span><span class="err">───────────────────────╮</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Найдено</span><span class="w"> </span><span class="err">небезопасных</span><span class="w"> </span><span class="err">функций</span><span class="p">:</span><span class="w"> </span><span class="mi">47</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">🔴</span><span class="w"> </span><span class="err">КРИТИЧЕСКИЙ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">strcpy</span><span class="w"> </span><span class="p">(</span><span class="err">риск</span><span class="w"> </span><span class="err">переполнения</span><span class="w"> </span><span class="err">буфера</span><span class="p">):</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">adt</span><span class="o">/</span><span class="n">varlena</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">234</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">pqformat</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">567</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">pl</span><span class="o">/</span><span class="n">plpgsql</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pl_exec</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">1234</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">🔴</span><span class="w"> </span><span class="err">КРИТИЧЕСКИЙ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="p">(</span><span class="err">риск</span><span class="w"> </span><span class="err">строки</span><span class="w"> </span><span class="err">формата</span><span class="p">):</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">567</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">error</span><span class="o">/</span><span class="n">elog</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">890</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">🟡</span><span class="w"> </span><span class="err">ВЫСОКИЙ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="p">(</span><span class="err">устарела</span><span class="p">,</span><span class="w"> </span><span class="err">всегда</span><span class="w"> </span><span class="err">небезопасна</span><span class="p">):</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">Не</span><span class="w"> </span><span class="err">найдено</span><span class="w"> </span><span class="err">✓</span><span class="w">                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">🟡</span><span class="w"> </span><span class="err">ВЫСОКИЙ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rand</span><span class="w"> </span><span class="p">(</span><span class="err">слабый</span><span class="w"> </span><span class="err">генератор</span><span class="w"> </span><span class="err">случайных</span><span class="w"> </span><span class="err">чисел</span><span class="p">):</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">pg_random</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">45</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Рекомендации</span><span class="w"> </span><span class="err">по</span><span class="w"> </span><span class="err">исправлению</span><span class="p">:</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">strcpy</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">strncpy</span><span class="o">/</span><span class="n">strlcpy</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">snprintf</span><span class="w">                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">fgets</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">rand</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">pg_prng_</span><span class="o">*</span><span class="w"> </span><span class="err">или</span><span class="w"> </span><span class="n">arc4random</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────────────╯</span>

<span class="o">&gt;</span><span class="w"> </span><span class="err">Найти</span><span class="w"> </span><span class="err">уязвимости</span><span class="w"> </span><span class="err">из</span><span class="o">-</span><span class="err">за</span><span class="w"> </span><span class="err">отсутствия</span><span class="w"> </span><span class="err">проверки</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="o">-</span><span class="err">указателя</span><span class="w"> </span><span class="p">(</span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="p">)</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="n">D3</span><span class="o">-</span><span class="n">NPC</span><span class="p">:</span><span class="w"> </span><span class="err">Проверка</span><span class="w"> </span><span class="err">на</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="o">-</span><span class="err">указатель</span><span class="w"> </span><span class="err">────────────────╮</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Отсутствие</span><span class="w"> </span><span class="err">проверки</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="err">после</span><span class="w"> </span><span class="err">выделения</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">malloc</span><span class="w"> </span><span class="err">без</span><span class="w"> </span><span class="err">проверки</span><span class="p">:</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">─────────────────────</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">mmgr</span><span class="o">/</span><span class="n">aset</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">345</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w">                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="n">use</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="err">Нет</span><span class="w"> </span><span class="err">проверки</span><span class="w"> </span><span class="err">на</span><span class="w"> </span><span class="n">NULL</span><span class="o">!</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">palloc</span><span class="w"> </span><span class="err">без</span><span class="w"> </span><span class="err">проверки</span><span class="p">:</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">src</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">executor</span><span class="o">/</span><span class="n">execUtils</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">234</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="n">TupleTableSlot</span><span class="w"> </span><span class="o">*</span><span class="n">slot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="o">...</span><span class="p">));</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="n">slot</span><span class="o">-&gt;</span><span class="n">tts_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palloc</span><span class="p">(</span><span class="o">...</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="err">Нет</span><span class="w"> </span><span class="err">проверки</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Примечание</span><span class="w"> </span><span class="n">PostgreSQL</span><span class="p">:</span><span class="w"> </span><span class="n">palloc</span><span class="p">()</span><span class="w"> </span><span class="err">вызывает</span><span class="w"> </span><span class="n">ERROR</span><span class="w"> </span><span class="err">при</span><span class="w"> </span><span class="err">нехватке</span><span class="w"> </span><span class="err">памяти</span><span class="p">,</span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">но</span><span class="w"> </span><span class="err">явные</span><span class="w"> </span><span class="err">проверки</span><span class="w"> </span><span class="err">улучшают</span><span class="w"> </span><span class="err">читаемость</span><span class="w"> </span><span class="err">кода</span><span class="o">.</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">Пример</span><span class="w"> </span><span class="err">исправления</span><span class="p">:</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">─────────────────────</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">        </span><span class="n">ereport</span><span class="p">(</span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">errcode</span><span class="p">(</span><span class="n">ERRCODE_OUT_OF_MEMORY</span><span class="p">)));</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="p">}</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────────────╯</span>
</code></pre></div>

<h4 id="primer-3-proverka-bezopasnosti-pamyati-d3-rn-obnulenie-ssylok">Пример 3: Проверка безопасности памяти (D3-RN Обнуление ссылок)<a class="heading-anchor" href="#primer-3-proverka-bezopasnosti-pamyati-d3-rn-obnulenie-ssylok" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nt">Проверить</span><span class="w"> </span><span class="nt">риски</span><span class="w"> </span><span class="nt">использования</span><span class="w"> </span><span class="nt">после</span><span class="w"> </span><span class="nt">освобождения</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="nt">D3-RN</span><span class="o">:</span><span class="w"> </span><span class="nt">Обнуление</span><span class="w"> </span><span class="nt">ссылок</span><span class="w"> </span><span class="err">────────────────╮</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">Освобождение</span><span class="w"> </span><span class="nt">без</span><span class="w"> </span><span class="nt">обнуления</span><span class="o">:</span><span class="w"> </span><span class="nt">34</span><span class="w"> </span><span class="nt">места</span><span class="w">                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">pfree</span><span class="w"> </span><span class="nt">без</span><span class="w"> </span><span class="nt">присвоения</span><span class="w"> </span><span class="nt">NULL</span><span class="o">:</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="nt">src</span><span class="o">/</span><span class="nt">backend</span><span class="o">/</span><span class="nt">utils</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">relcache</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">567</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">─────────────────────────────────────</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">pfree</span><span class="o">(</span><span class="nt">rel-</span><span class="o">&gt;</span><span class="nt">rd_options</span><span class="o">);</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="nt">rel-</span><span class="o">&gt;</span><span class="nt">rd_options</span><span class="w"> </span><span class="nt">всё</span><span class="w"> </span><span class="nt">ещё</span><span class="w"> </span><span class="nt">указывает</span><span class="w"> </span><span class="nt">на</span><span class="w"> </span><span class="nt">освобождённую</span><span class="w"> </span><span class="nt">память</span><span class="o">!</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">✓</span><span class="w"> </span><span class="nt">ИСПРАВЛЕНИЕ</span><span class="o">:</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">pfree</span><span class="o">(</span><span class="nt">rel-</span><span class="o">&gt;</span><span class="nt">rd_options</span><span class="o">);</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">rel-</span><span class="o">&gt;</span><span class="nt">rd_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">NULL</span><span class="o">;</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="nt">src</span><span class="o">/</span><span class="nt">backend</span><span class="o">/</span><span class="nt">executor</span><span class="o">/</span><span class="nt">nodeHash</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">234</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">─────────────────────────────────</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">pfree</span><span class="o">(</span><span class="nt">hashtable-</span><span class="o">&gt;</span><span class="nt">buckets</span><span class="o">);</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="nt">Риск</span><span class="w"> </span><span class="nt">висячего</span><span class="w"> </span><span class="nt">указателя</span><span class="w"> </span><span class="nt">в</span><span class="w"> </span><span class="nt">путях</span><span class="w"> </span><span class="nt">обработки</span><span class="w"> </span><span class="nt">ошибок</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">MemoryContextDelete</span><span class="w"> </span><span class="nt">без</span><span class="w"> </span><span class="nt">обнуления</span><span class="o">:</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="nt">src</span><span class="o">/</span><span class="nt">backend</span><span class="o">/</span><span class="nt">utils</span><span class="o">/</span><span class="nt">mmgr</span><span class="o">/</span><span class="nt">mcxt</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">890</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">MemoryContextDelete</span><span class="o">(</span><span class="nt">ctx</span><span class="o">);</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="nt">ctx</span><span class="w"> </span><span class="nt">может</span><span class="w"> </span><span class="nt">быть</span><span class="w"> </span><span class="nt">использован</span><span class="w"> </span><span class="nt">позже</span><span class="o">!</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">Справка</span><span class="w"> </span><span class="nt">CWE</span><span class="o">:</span><span class="w"> </span><span class="nt">CWE-416</span><span class="w"> </span><span class="o">(</span><span class="nt">Использование</span><span class="w"> </span><span class="nt">после</span><span class="w"> </span><span class="nt">освобождения</span><span class="o">)</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">╰───────────────────────────────────────────────────────╯</span>
</code></pre></div>

<h4 id="primer-4-proverka-initsializatsii-peremennyh-d3-vi">Пример 4: Проверка инициализации переменных (D3-VI)<a class="heading-anchor" href="#primer-4-proverka-initsializatsii-peremennyh-d3-vi" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="nt">Найти</span><span class="w"> </span><span class="nt">неинициализированные</span><span class="w"> </span><span class="nt">переменные</span>

<span class="err">╭───────────────</span><span class="w"> </span><span class="nt">D3-VI</span><span class="o">:</span><span class="w"> </span><span class="nt">Инициализация</span><span class="w"> </span><span class="nt">переменных</span><span class="w"> </span><span class="err">───────────────╮</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">Найдено</span><span class="w"> </span><span class="nt">неинициализированных</span><span class="w"> </span><span class="nt">переменных</span><span class="o">:</span><span class="w"> </span><span class="nt">56</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">Локальные</span><span class="w"> </span><span class="nt">переменные</span><span class="w"> </span><span class="nt">без</span><span class="w"> </span><span class="nt">инициализации</span><span class="o">:</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────────────────────────────────────────────────────</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="nt">src</span><span class="o">/</span><span class="nt">backend</span><span class="o">/</span><span class="nt">executor</span><span class="o">/</span><span class="nt">execMain</span><span class="p">.</span><span class="nc">c</span><span class="p">:</span><span class="nd">456</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">─────────────────────────────────────</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">EState</span><span class="w"> </span><span class="o">*</span><span class="nt">estate</span><span class="o">;</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">Неинициализирована</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">QueryDesc</span><span class="w"> </span><span class="o">*</span><span class="nt">queryDesc</span><span class="o">;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">Неинициализирована</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">✓</span><span class="w"> </span><span class="nt">ИСПРАВЛЕНИЕ</span><span class="o">:</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nt">EState</span><span class="w"> </span><span class="o">*</span><span class="nt">estate</span><span class="w"> </span><span class="o">=</span>

<span class="err">##</span><span class="w"> </span><span class="nt">Сценарии</span><span class="w"> </span><span class="nt">для</span><span class="w"> </span><span class="nt">технического</span><span class="w"> </span><span class="nt">писателя</span>

<span class="err">###</span><span class="w"> </span><span class="nt">Генерация</span><span class="w"> </span><span class="nt">документации</span><span class="w"> </span><span class="nt">по</span><span class="w"> </span><span class="nt">API</span>

<span class="o">**</span><span class="nt">Сценарий</span><span class="o">:**</span><span class="w"> </span><span class="nt">Технический</span><span class="w"> </span><span class="nt">писатель</span><span class="w"> </span><span class="nt">документирует</span><span class="w"> </span><span class="nt">публичное</span><span class="w"> </span><span class="nt">API</span><span class="o">.</span>

<span class="err">####</span><span class="w"> </span><span class="nt">Шаг</span><span class="w"> </span><span class="nt">1</span><span class="o">:</span><span class="w"> </span><span class="nt">Выбор</span><span class="w"> </span><span class="nt">сценария</span><span class="w"> </span><span class="nt">документации</span>
</code></pre></div>

<p>/select 03</p>
<div class="highlight"><pre><span></span><code>#### Шаг 2: Генерация документации по функциям
</code></pre></div>

<blockquote class="callout">
<p>Создай документацию для heap_insert</p>
</blockquote>
<p>╭─────────────── Документация API ─────────────────────────╮
│                                                           │
│  ## heap_insert                                           │
│                                                           │
│  Вставляет кортеж в отношение кучи.                       │
│                                                           │
│  ### Сигнатура                                           │
│                                                           │
│</p>
<div class="highlight"><pre><span></span><code>c                                                     │
│  void heap_insert(Relation relation,                      │
│                   HeapTuple tup,                          │
│                   CommandId cid,                          │
│                   int options,                            │
│                   BulkInsertState bistate)                │
│
</code></pre></div>

<div class="highlight"><pre><span></span><code>                                                  │
</code></pre></div>

<p>│                                                           │
│  ### Параметры                                           │
│                                                           │
│  | Параметр  | Тип           | Описание                   │
│  |-----------|---------------|----------------------------│
│  | relation  | Relation      | Целевое отношение кучи    │
│  | tup       | HeapTuple     | Кортеж для вставки         │
│  | cid       | CommandId     | Идентификатор команды для MVCC │
│  | options   | int           | Флаги опций вставки        │
│  | bistate   | BulkInsertState | Состояние массовой вставки │
│                                                           │
│  ### Возвращаемое значение                                │
│                                                           │
│  void (кортеж модифицируется на месте, при необходимости с присвоением OID) │
│                                                           │
│  ### Пример                                               │
│                                                           │
│</p>
<div class="highlight"><pre><span></span><code>c                                                     │
│  HeapTuple tuple = heap_form_tuple(desc, values, nulls);  │
│  heap_insert(rel, tuple, GetCurrentCommandId(true),       │
│              0, NULL);                                    │
│
</code></pre></div>

<div class="highlight"><pre><span></span><code>                                                  │
</code></pre></div>

<p>│                                                           │
│  ### Смотрите также                                       │
│                                                           │
│  - heap_update() - Обновление существующего кортежа      │
│  - heap_delete() - Удаление кортежа                       │
│  - simple_heap_insert() - Упрощённая обёртка              │
│                                                           │
│  ### Исходный код                                         │
│                                                           │
│  src/backend/access/heap/heapam.c:2156                    │
│                                                           │
╰───────────────────────────────────────────────────────────╯</p>
<blockquote class="callout">
<p>Документируй функции интерфейса SPI</p>
<p>Создай справочник API для управления блокировками</p>
</blockquote>
<div class="highlight"><pre><span></span><code>---

<span class="gu">##</span># Понимание архитектуры модуля

**Сценарий:** Технический писатель документирует архитектуру системы.
</code></pre></div>

<blockquote class="callout">
<p>Объясни архитектуру модуля исполнителя (executor)</p>
</blockquote>
<p>╭─────────────── Архитектура ──────────────────────────────╮
│                                                           │
│  Архитектура модуля исполнителя (executor)                 │
│  ══════════════════════════════════════════                │
│                                                           │
│  Назначение: Выполнение планов запросов, созданных планировщиком │
│                                                           │
│  Каталог: src/backend/executor/                            │
│                                                           │
│  Основные компоненты:                                     │
│  ────────────────                                         │
│                                                           │
│  1. execMain.c - Основные точки входа исполнителя         │
│     - ExecutorStart(): Инициализация состояния выполнения  │
│     - ExecutorRun(): Основной цикл выполнения             │
│     - ExecutorEnd(): Очистка и завершение работы          │
│                                                           │
│  2. execProcnode.c - Диспетчер узлов                      │
│     - ExecProcNode(): Перенаправление на конкретные типы узлов │
│     - ExecInitNode(): Инициализация узлов плана           │
│     - ExecEndNode(): Очистка узлов плана                  │
│                                                           │
│  3. Исполнители, специфичные для узлов:                   │
│     - nodeSeqscan.c    - Последовательное сканирование    │
│     - nodeIndexscan.c  - Сканирование по индексу          │
│     - nodeHashjoin.c   - Хеш-соединение                   │
│     - nodeMergejoin.c  - Слияние соединений               │
│     - nodeAgg.c        - Агрегация                        │
│     - nodeSort.c       - Сортировка                       │
│                                                           │
│  Поток данных:                                            │
│  ──────────                                               │
│                                                           │
│  Дерево плана → Дерево состояния плана → Вывод кортежей   │
│                                                           │
│  Зависимости:                                             │
│  ─────────────                                            │
│    → access/    (уровень хранения)                        │
│    → utils/     (память, кэш)                             │
│    → nodes/     (определения узлов)                       │
│                                                           │
╰───────────────────────────────────────────────────────────╯</p>
<blockquote class="callout">
<p>Каковы основные компоненты WAL?</p>
<p>Как работает MVCC в PostgreSQL?</p>
</blockquote>
<div class="highlight"><pre><span></span><code>---

<span class="gu">##</span># Создание справочника функций

**Сценарий:** Технический писатель составляет индекс функций.
</code></pre></div>

<blockquote class="callout">
<p>Перечисли все публичные функции в модуле исполнителя</p>
</blockquote>
<p>╭─────────────── Справочник функций ────────────────────────╮
│                                                           │
│  Публичные функции исполнителя                            │
│  ════════════════════════════════                          │
│                                                           │
│  Точки входа:                                             │
│  ─────────────                                            │
│  ExecutorStart()      Инициализация выполнения            │
│  ExecutorRun()        Выполнение плана                    │
│  ExecutorFinish()     Обработка после выполнения          │
│  ExecutorEnd()        Очистка                             │
│                                                           │
│  Операции с узлами:                                       │
│  ────────────────                                         │
│  ExecProcNode()       Выполнить один узел                 │
│  ExecInitNode()       Инициализировать узел               │
│  ExecEndNode()        Очистить узел                       │
│  ExecReScan()         Сброс для повторного сканирования   │
│                                                           │
│  Операции с кортежами:                                    │
│  ─────────────────                                        │
│  ExecStoreTuple()     Сохранить кортеж в слоте            │
│  ExecClearTuple()     Очистить слот                       │
│  ExecCopySlot()       Скопировать содержимое слота        │
│                                                           │
│  Всего: 156 публичных функций                              │
│                                                           │
╰───────────────────────────────────────────────────────────╯</p>
<blockquote class="callout">
<p>Покажи все точки входа с их сигнатурами</p>
</blockquote>
<div class="highlight"><pre><span></span><code>#### Использование прямого SQL-запроса
</code></pre></div>

<p>/query SELECT name, signature, filename FROM nodes_method
       WHERE filename LIKE ‘%executor%’
       ORDER BY name
       LIMIT 20</p>
<p>╭─────────────── Результаты запроса ────────────────────────╮
│                                                           │
│  name              | signature              | filename    │
│  ──────────────────┼────────────────────────┼──────────   │
│  ExecAgg           | ExecAgg(PlanState*)    | nodeAgg.c   │
│  ExecAppend        | ExecAppend(…)        | nodeAppend  │
│  ExecBitmapAnd     | ExecBitmapAnd(…)     | nodeBitma   │
│  …               | …                    | …         │
│                                                           │
│  Возвращено 20 строк                                      │
│                                                           │
╰───────────────────────────────────────────────────────────╯</p>
<div class="highlight"><pre><span></span><code><span class="err">##</span><span class="w"> </span><span class="n">Справочник</span><span class="w"> </span><span class="n">команд</span><span class="w"> </span><span class="n">TUI</span>

<span class="err">###</span><span class="w"> </span><span class="n">Все</span><span class="w"> </span><span class="n">команды</span>

<span class="o">|</span><span class="w"> </span><span class="n">Команда</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Аргументы</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Описание</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="c1">--------|----------|--------|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">help</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">команда</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Показать</span><span class="w"> </span><span class="n">справку</span><span class="w"> </span><span class="n">по</span><span class="w"> </span><span class="n">всем</span><span class="w"> </span><span class="n">командам</span><span class="w"> </span><span class="n">или</span><span class="w"> </span><span class="n">по</span><span class="w"> </span><span class="n">конкретной</span><span class="w"> </span><span class="n">команде</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">scenarios</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">группа</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Список</span><span class="w"> </span><span class="n">доступных</span><span class="w"> </span><span class="n">сценариев</span><span class="p">,</span><span class="w"> </span><span class="n">с</span><span class="w"> </span><span class="n">опциональной</span><span class="w"> </span><span class="n">фильтрацией</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="k">select</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">&lt;</span><span class="n">номер</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Выбрать</span><span class="w"> </span><span class="n">сценарий</span><span class="w"> </span><span class="n">по</span><span class="w"> </span><span class="n">номеру</span><span class="w"> </span><span class="p">(</span><span class="mi">01</span><span class="err">–</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">history</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">количество</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Показать</span><span class="w"> </span><span class="n">историю</span><span class="w"> </span><span class="n">диалога</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="k">save</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">имя_файла</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Сохранить</span><span class="w"> </span><span class="n">текущую</span><span class="w"> </span><span class="n">сессию</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="k">load</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">&lt;</span><span class="n">имя_файла</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Загрузить</span><span class="w"> </span><span class="n">сохранённую</span><span class="w"> </span><span class="n">сессию</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">config</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">раздел</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">ключ</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">значение</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Просмотр</span><span class="w"> </span><span class="n">или</span><span class="w"> </span><span class="n">изменение</span><span class="w"> </span><span class="n">конфигурации</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">stat</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Показать</span><span class="w"> </span><span class="n">статистику</span><span class="w"> </span><span class="n">CPG</span><span class="w"> </span><span class="n">и</span><span class="w"> </span><span class="n">ChromaDB</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">query</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">&lt;</span><span class="k">SQL</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Выполнить</span><span class="w"> </span><span class="k">SQL</span><span class="o">-</span><span class="n">запрос</span><span class="w"> </span><span class="n">к</span><span class="w"> </span><span class="n">базе</span><span class="w"> </span><span class="n">данных</span><span class="w"> </span><span class="n">CPG</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">review</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">источник</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">id</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">--format</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">--inline</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Запустить</span><span class="w"> </span><span class="n">анализ</span><span class="w"> </span><span class="n">кода</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">demo</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">--scenarios N,N</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">--lang en\|ru</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Запустить</span><span class="w"> </span><span class="n">быстрое</span><span class="w"> </span><span class="n">тестирование</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">clear</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Очистить</span><span class="w"> </span><span class="n">экран</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="k">exit</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Выйти</span><span class="w"> </span><span class="n">из</span><span class="w"> </span><span class="n">приложения</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">project</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">`</span><span class="o">[</span><span class="n">list\|switch\|add</span><span class="o">]</span><span class="err">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Управление</span><span class="w"> </span><span class="n">проектами</span><span class="w"> </span><span class="n">CPG</span><span class="w"> </span><span class="o">|</span>

<span class="err">###</span><span class="w"> </span><span class="n">Подробное</span><span class="w"> </span><span class="n">описание</span><span class="w"> </span><span class="n">команд</span>

<span class="err">####</span><span class="w"> </span><span class="o">/</span><span class="n">project</span>

<span class="n">Управление</span><span class="w"> </span><span class="n">несколькими</span><span class="w"> </span><span class="n">проектами</span><span class="w"> </span><span class="n">CPG</span><span class="w"> </span><span class="p">(</span><span class="n">переключение</span><span class="w"> </span><span class="n">между</span><span class="w"> </span><span class="n">разными</span><span class="w"> </span><span class="n">кодовыми</span><span class="w"> </span><span class="n">базами</span><span class="p">).</span>

<span class="err">```</span><span class="n">bash</span>
<span class="err">#</span><span class="w"> </span><span class="n">Показать</span><span class="w"> </span><span class="n">информацию</span><span class="w"> </span><span class="n">о</span><span class="w"> </span><span class="n">текущем</span><span class="w"> </span><span class="n">проекте</span>
<span class="o">/</span><span class="n">project</span>

<span class="err">#</span><span class="w"> </span><span class="n">Список</span><span class="w"> </span><span class="n">всех</span><span class="w"> </span><span class="n">доступных</span><span class="w"> </span><span class="n">проектов</span>
<span class="o">/</span><span class="n">project</span><span class="w"> </span><span class="n">list</span>

<span class="err">#</span><span class="w"> </span><span class="n">Переключиться</span><span class="w"> </span><span class="n">на</span><span class="w"> </span><span class="n">другой</span><span class="w"> </span><span class="n">проект</span>
<span class="o">/</span><span class="n">project</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span><span class="n">fsin_module</span>
<span class="o">/</span><span class="n">project</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span><span class="n">postgresql</span>

<span class="err">#</span><span class="w"> </span><span class="n">Добавить</span><span class="w"> </span><span class="n">новый</span><span class="w"> </span><span class="n">проект</span>
<span class="o">/</span><span class="n">project</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">myproject</span><span class="w"> </span><span class="k">path</span><span class="o">/</span><span class="k">to</span><span class="o">/</span><span class="n">project</span><span class="p">.</span><span class="n">duckdb</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="ss">&quot;Мой Python-проект&quot;</span>
</code></pre></div>

<p><strong>Конфигурация проектов (projects.yaml):</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">projects</span><span class="o">:</span>
<span class="w">  </span><span class="n">postgresql</span><span class="o">:</span>
<span class="w">    </span><span class="n">db_path</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cpg.duckdb&quot;</span>
<span class="w">    </span><span class="n">language</span><span class="o">:</span><span class="w"> </span><span class="n">c</span>
<span class="w">    </span><span class="n">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Исходный код PostgreSQL 17&quot;</span>
<span class="w">  </span><span class="n">fsin_module</span><span class="o">:</span>
<span class="w">    </span><span class="n">db_path</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;workspace/fsin_module_v2.duckdb&quot;</span>
<span class="w">    </span><span class="n">language</span><span class="o">:</span><span class="w"> </span><span class="n">python</span>
<span class="w">    </span><span class="n">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Django-модуль FSIN&quot;</span>

<span class="n">active_project</span><span class="o">:</span><span class="w"> </span><span class="n">postgresql</span>
</code></pre></div>

<p><strong>Автоматическое переключение доменов:</strong></p>
<p>При смене проекта система автоматически активирует соответствующий доменный плагин:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Язык</th>
<th>Доменный плагин</th>
<th>Паттерны безопасности</th>
</tr>
</thead>
<tbody>
<tr>
<td>c, cpp</td>
<td>postgresql / generic_cpp</td>
<td>Безопасность памяти, переполнение буфера</td>
</tr>
<tr>
<td>python</td>
<td>python_django</td>
<td>SQL-инъекции, XSS, CSRF</td>
</tr>
</tbody>
</table></div>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Пример: переключение на проект Python/Django
/project switch fsin_module
<span class="gh">#</span> Вывод: Домен активирован: python_django

<span class="gh">#</span> Пример: возврат к проекту на C
/project switch postgresql
<span class="gh">#</span> Вывод: Домен активирован: postgresql
</code></pre></div>

<h4 id="scenarios">/scenarios<a class="heading-anchor" href="#scenarios" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code># Показать все сценарии
/scenarios

# Фильтрация по группе
/scenarios security    # Сценарии, связанные с безопасностью
/scenarios dev         # Сценарии разработки
/scenarios qa          # Сценарии обеспечения качества
</code></pre></div>

<h4 id="select">/select<a class="heading-anchor" href="#select" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code># Выбор по номеру
/select 1     # Онбординг
/select 02    # Аудит безопасности
/select 15    # Отладка
</code></pre></div>

<h4 id="config">/config<a class="heading-anchor" href="#config" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code># Показать все разделы конфигурации
/config

# Показать конкретный раздел
/config llm

# Установить значение
/config llm temperature 0.7
/config llm provider gigachat
</code></pre></div>

<h4 id="query">/query<a class="heading-anchor" href="#query" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Простые запросы
/query SELECT COUNT(*) FROM nodes_method
/query SELECT name, filename FROM nodes_method WHERE name LIKE &#39;heap%&#39;

<span class="gh">#</span> Описание таблиц
/query DESCRIBE nodes_method
/query SHOW TABLES

<span class="gh">#</span> Сложные запросы
/query SELECT caller.name, callee.name
       FROM edges_call e
       JOIN nodes_method caller ON e.src = caller.id
       JOIN nodes_method callee ON e.dst = callee.id
       WHERE callee.name = &#39;palloc&#39;
       LIMIT 10
</code></pre></div>

<h4 id="review">/review<a class="heading-anchor" href="#review" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code># Интерактивный режим (выбор источника)
/review

# GitHub PR
/review github 123
/review github 123 --format json

# GitLab MR
/review gitlab 456 --inline

# Локальные изменения в git
/review git
/review git --format yaml

# Файл патча
/review file changes.patch --format md --inline
</code></pre></div>

<h2 id="rukovodstvo-po-nastroyke">Руководство по настройке<a class="heading-anchor" href="#rukovodstvo-po-nastroyke" title="Link to this section">&para;</a></h2>
<h3 id="nastroyka-postavschika-llm">Настройка поставщика LLM<a class="heading-anchor" href="#nastroyka-postavschika-llm" title="Link to this section">&para;</a></h3>
<h4 id="gigachat-sber">GigaChat (Sber)<a class="heading-anchor" href="#gigachat-sber" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span>config.yaml
llm:
<span class="w">  </span>provider:<span class="w"> </span>&quot;gigachat&quot;
<span class="w">  </span>gigachat:
<span class="w">    </span>credentials:<span class="w"> </span><span class="cp">${</span><span class="n">GIGACHAT_AUTH_KEY</span><span class="cp">}</span>
<span class="w">    </span>model:<span class="w"> </span>&quot;GigaChat-2&quot;<span class="w">  </span>#<span class="w"> </span>или<span class="w"> </span>GigaChat-2-Pro,<span class="w"> </span>GigaChat-2-Max
<span class="w">    </span>temperature:<span class="w"> </span>0.7
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Переменная окружения</span>
<span class="k">export</span><span class="w"> </span><span class="n">GIGACHAT_AUTH_KEY</span><span class="o">=</span><span class="s2">&quot;ваш-ключ-в-base64&quot;</span>
</code></pre></div>

<h4 id="openai">OpenAI<a class="heading-anchor" href="#openai" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span>config.yaml
llm:
<span class="w">  </span>provider:<span class="w"> </span>&quot;openai&quot;
<span class="w">  </span>openai:
<span class="w">    </span>api_key:<span class="w"> </span><span class="cp">${</span><span class="n">OPENAI_API_KEY</span><span class="cp">}</span>
<span class="w">    </span>model:<span class="w"> </span>&quot;gpt-4&quot;
<span class="w">    </span>temperature:<span class="w"> </span>0.7
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Переменная окружения</span>
<span class="k">export</span><span class="w"> </span><span class="n">OPENAI_API_KEY</span><span class="o">=</span><span class="s2">&quot;sk-...&quot;</span>
</code></pre></div>

<h4 id="lokalnaya-model-llamacpp">Локальная модель (llama.cpp)<a class="heading-anchor" href="#lokalnaya-model-llamacpp" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span>config.yaml
llm:
<span class="w">  </span>provider:<span class="w"> </span>&quot;local&quot;
<span class="w">  </span>local:
<span class="w">    </span>model_path:<span class="w"> </span><span class="cp">${</span><span class="n">LLMXCPG_MODEL_PATH</span><span class="cp">}</span>
<span class="w">    </span>n_gpu_layers:<span class="w"> </span>-1<span class="w">  </span>#<span class="w"> </span>Все<span class="w"> </span>слои<span class="w"> </span>на<span class="w"> </span>GPU
<span class="w">    </span>n_ctx:<span class="w"> </span>8192
</code></pre></div>

<h3 id="nastroyki-poiska">Настройки поиска<a class="heading-anchor" href="#nastroyki-poiska" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">retrieval</span><span class="o">:</span>
<span class="w">  </span><span class="n">embedding_model</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;all-MiniLM-L6-v2&quot;</span>
<span class="w">  </span><span class="n">top_k_qa</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w">       </span><span class="err">#</span><span class="w"> </span><span class="err">Количество</span><span class="w"> </span><span class="err">извлекаемых</span><span class="w"> </span><span class="err">примеров</span><span class="w"> </span><span class="err">вопросов</span><span class="w"> </span><span class="err">и</span><span class="w"> </span><span class="err">ответов</span>
<span class="w">  </span><span class="n">max_results</span><span class="o">:</span><span class="w"> </span><span class="mi">50</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="err">Максимальное</span><span class="w"> </span><span class="err">количество</span><span class="w"> </span><span class="err">результатов</span><span class="w"> </span><span class="err">поиска</span>
</code></pre></div>

<h3 id="ogranicheniya-zaprosov">Ограничения запросов<a class="heading-anchor" href="#ogranicheniya-zaprosov" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">query</span><span class="o">:</span>
<span class="w">  </span><span class="n">default_limit</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Значение</span><span class="w"> </span><span class="n">LIMIT</span><span class="w"> </span><span class="err">по</span><span class="w"> </span><span class="err">умолчанию</span><span class="w"> </span><span class="err">для</span><span class="w"> </span><span class="n">SQL</span>
<span class="w">  </span><span class="n">max_limit</span><span class="o">:</span><span class="w"> </span><span class="mi">1000</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="err">Максимально</span><span class="w"> </span><span class="err">допустимое</span><span class="w"> </span><span class="err">значение</span><span class="w"> </span><span class="n">LIMIT</span>
</code></pre></div>

<hr />
<h2 id="prilozhenie-vse-16-stsenariev">Приложение: Все 16 сценариев<a class="heading-anchor" href="#prilozhenie-vse-16-stsenariev" title="Link to this section">&para;</a></h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>№</th>
<th>Название</th>
<th>Для кого подходит</th>
<th>Пример запроса</th>
</tr>
</thead>
<tbody>
<tr>
<td>01</td>
<td>Онбординг</td>
<td>Новые разработчики</td>
<td>“Где определена функция X?”</td>
</tr>
<tr>
<td>02</td>
<td>Аудит безопасности</td>
<td>Команда безопасности</td>
<td>“Найти уязвимости к SQL-инъекциям”</td>
</tr>
<tr>
<td>03</td>
<td>Документация</td>
<td>Технические писатели</td>
<td>“Создать документацию для функции X”</td>
</tr>
<tr>
<td>04</td>
<td>Разработка функций</td>
<td>Добавление новых возможностей</td>
<td>“Куда добавить новый хук?”</td>
</tr>
<tr>
<td>05</td>
<td>Рефакторинг</td>
<td>Очистка кода</td>
<td>“Найти неиспользуемый код в модуле X”</td>
</tr>
<tr>
<td>06</td>
<td>Производительность</td>
<td>Оптимизация</td>
<td>“Найти узкие места в производительности”</td>
</tr>
<tr>
<td>07</td>
<td>Покрытие тестами</td>
<td>Команда тестирования</td>
<td>“Какие функции не покрыты тестами?”</td>
</tr>
<tr>
<td>08</td>
<td>Соответствие требованиям</td>
<td>Аудиторы</td>
<td>“Проверить соответствие OWASP Top 10”</td>
</tr>
<tr>
<td>09</td>
<td>Код-ревью</td>
<td>Ревьюеры</td>
<td>“Проверить этот патч”</td>
</tr>
<tr>
<td>10</td>
<td>Межрепозиторные связи</td>
<td>Архитекторы</td>
<td>“Найти зависимости между репозиториями”</td>
</tr>
<tr>
<td>11</td>
<td>Архитектура</td>
<td>Архитекторы</td>
<td>“Найти нарушения уровневой архитектуры”</td>
</tr>
<tr>
<td>12</td>
<td>Технический долг</td>
<td>Менеджеры</td>
<td>“Оценить объём технического долга”</td>
</tr>
<tr>
<td>13</td>
<td>Массовый рефакторинг</td>
<td>Крупные изменения</td>
<td>“Переименовать все X в Y”</td>
</tr>
<tr>
<td>14</td>
<td>Реагирование на инциденты</td>
<td>Безопасность</td>
<td>“Отследить вектор атаки”</td>
</tr>
<tr>
<td>15</td>
<td>Отладка</td>
<td>Разработчики</td>
<td>“Найти точки для отладки”</td>
</tr>
<tr>
<td>16</td>
<td>Точки входа</td>
<td>Безопасность</td>
<td>“Перечислить все API-эндпоинты”</td>
</tr>
</tbody>
</table></div>
<h3 id="rukovodstvo-po-vyboru-stsenariev">Руководство по выбору сценариев<a class="heading-anchor" href="#rukovodstvo-po-vyboru-stsenariev" title="Link to this section">&para;</a></h3>
<p><strong>Для разработчиков:</strong>
- Первый день: Сценарий 01 (Онбординг)
- Разработка функций: Сценарий 04 (Разработка функций)
- Исправление ошибок: Сценарий 15 (Отладка)
- Очистка кода: Сценарий 05 (Рефакторинг)</p>
<p><strong>Для QA / тестировщиков:</strong>
- Пробелы в покрытии: Сценарий 07 (Покрытие тестами)
- Код-ревью: Сценарий 09 (Код-ревью)
- Метрики качества: Сценарий 12 (Технический долг)</p>
<p><strong>Для специалистов по безопасности:</strong>
- Поиск уязвимостей: Сценарий 02 (Аудит безопасности)
- Соответствие стандартам: Сценарий 08 (Соответствие требованиям)
- Инциденты: Сценарий 14 (Реагирование на инциденты)
- Атакуемая поверхность: Сценарий 16 (Точки входа)</p>
<p><strong>Для технических писателей:</strong>
- Документация API: Сценарий 03 (Документация)
- Архитектура: Сценарий 11 (Архитектура)
- Зависимости: Сценарий 10 (Межрепозиторные связи)</p>
<hr />
<h2 id="otchyoty-o-proverke-bezopasnosti-cli">Отчёты о проверке безопасности (CLI)<a class="heading-anchor" href="#otchyoty-o-proverke-bezopasnosti-cli" title="Link to this section">&para;</a></h2>
<h3 id="obzor">Обзор<a class="heading-anchor" href="#obzor" title="Link to this section">&para;</a></h3>
<p>CodeGraph предоставляет инструмент командной строки (CLI) для создания полных отчётов о проверке безопасности.</p>
<p>Отчёты могут быть сгенерированы в нескольких форматах (Markdown, JSON, SARIF) с поддержкой локализации (английский, русский).</p>
<h3 id="stsenariy-proverka-bezopasnosti-proekta-na-django">Сценарий: Проверка безопасности проекта на Django<a class="heading-anchor" href="#stsenariy-proverka-bezopasnosti-proekta-na-django" title="Link to this section">&para;</a></h3>
<p><strong>Ситуация:</strong> Инженеру по безопасности необходимо проверить проект на Django перед развертыванием в продакшене.</p>
<h4 id="shag-1-vypolnenie-polnogo-skanirovaniya-bezopasnosti">Шаг 1: Выполнение полного сканирования безопасности<a class="heading-anchor" href="#shag-1-vypolnenie-polnogo-skanirovaniya-bezopasnosti" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code>python -m src.cli.security_audit full \
  --path /path/to/django/project \
  --output-dir ./security_reports \
  --language ru
</code></pre></div>

<h4 id="shag-2-prosmotr-sgenerirovannogo-otchyota">Шаг 2: Просмотр сгенерированного отчёта<a class="heading-anchor" href="#shag-2-prosmotr-sgenerirovannogo-otchyota" title="Link to this section">&para;</a></h4>
<p>Инструмент создаёт три файла:</p>
<ul>
<li><code>security_report.md</code> — читаемый отчёт в формате Markdown</li>
<li><code>security_report.json</code> — машинно-читаемый JSON для CI/CD</li>
<li><code>security_report.sarif</code> — формат GitHub Security Alerts</li>
</ul>
<h4 id="primer-vyvoda-markdown">Пример вывода (Markdown)<a class="heading-anchor" href="#primer-vyvoda-markdown" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Отчёт по безопасности: My Django Project

**Путь к проекту:** <span class="sb">`/path/to/django/project`</span>
**Время аудита:** 2025-12-09 20:43:19
**Проанализировано файлов:** 88
</code></pre></div>

<h2 id="kratkoe-rezyume">Краткое резюме<a class="heading-anchor" href="#kratkoe-rezyume" title="Link to this section">&para;</a></h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Серьёзность</th>
<th>Количество</th>
</tr>
</thead>
<tbody>
<tr>
<td>🔴 КРИТИЧЕСКИЙ</td>
<td>2</td>
</tr>
<tr>
<td>🟠 ВЫСОКИЙ</td>
<td>6</td>
</tr>
<tr>
<td>🟡 СРЕДНИЙ</td>
<td>2</td>
</tr>
</tbody>
</table></div>
<h2 id="kriticheskiy-uroven-uyazvimosti-2">🔴 КРИТИЧЕСКИЙ уровень уязвимости (2)<a class="heading-anchor" href="#kriticheskiy-uroven-uyazvimosti-2" title="Link to this section">&para;</a></h2>
<h3 id="1-secret-key-s-rezervnym-znacheniem-skanirovanie-faylov">1. SECRET_KEY с резервным значением (сканирование файлов)<a class="heading-anchor" href="#1-secret-key-s-rezervnym-znacheniem-skanirovanie-faylov" title="Link to this section">&para;</a></h3>
<p><strong>Файл:</strong> <code>backend/settings.py:25</code></p>
<p><strong>CWE:</strong> CWE-798</p>
<p><strong>Описание:</strong> SECRET_KEY имеет небезопасное резервное (fallback) значение</p>
<p><strong>Уязвимый код:</strong></p>
<div class="highlight"><pre><span></span><code>SECRET_KEY = os.environ.get(&#39;SECRET_KEY&#39;, &#39;insecure-fallback&#39;)
</code></pre></div>

<p><strong>Рекомендация:</strong>
Удалите резервное значение: <code>SECRET_KEY = os.environ["SECRET_KEY"]</code></p>
<h3 id="stsenariy-bystraya-proverka-bezopasnosti">Сценарий: Быстрая проверка безопасности<a class="heading-anchor" href="#stsenariy-bystraya-proverka-bezopasnosti" title="Link to this section">&para;</a></h3>
<p><strong>Ситуация:</strong> Разработчик хочет выполнить быструю проверку на уязвимости перед коммитом.</p>
<div class="highlight"><pre><span></span><code>python -m src.cli.security_audit quick --path .

╭─────────────────── Результаты быстрой проверки ───────────────────╮
│                                                                 │
│  Проверено файлов: 45                                           │
│  Время: 0.3с                                                    │
│                                                                 │
│  Обнаружено:                                                    │
│    🔴 Критические: 0                                            │
│    🟠 Высокие: 2                                                │
│    🟡 Средние: 1                                                │
│                                                                 │
│  Запустите &#39;security-audit full&#39;, чтобы получить подробный отчёт │
│                                                                 │
╰─────────────────────────────────────────────────────────────────╯
</code></pre></div>

<h3 id="stsenariy-integratsiya-v-cicd">Сценарий: Интеграция в CI/CD<a class="heading-anchor" href="#stsenariy-integratsiya-v-cicd" title="Link to this section">&para;</a></h3>
<p><strong>Ситуация:</strong> Добавление проверок безопасности в пайплайн GitLab CI.</p>
<h4 id="gitlab-ciyml">.gitlab-ci.yml<a class="heading-anchor" href="#gitlab-ciyml" title="Link to this section">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nt">security-audit</span><span class="o">:</span>
<span class="w">  </span><span class="nt">stage</span><span class="o">:</span><span class="w"> </span><span class="nt">test</span>
<span class="w">  </span><span class="nt">script</span><span class="o">:</span>
<span class="w">    </span><span class="nt">-</span><span class="w"> </span><span class="nt">pip</span><span class="w"> </span><span class="nt">install</span><span class="w"> </span><span class="nt">-r</span><span class="w"> </span><span class="nt">requirements</span><span class="p">.</span><span class="nc">txt</span>
<span class="w">    </span><span class="nt">-</span><span class="w"> </span><span class="nt">python</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nt">src</span><span class="p">.</span><span class="nc">cli</span><span class="p">.</span><span class="nc">security_audit</span><span class="w"> </span><span class="nt">full</span><span class="w"> </span><span class="err">\</span>
<span class="w">        </span><span class="nt">--path</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="err">\</span>
<span class="w">        </span><span class="nt">--output-dir</span><span class="w"> </span><span class="o">./</span><span class="nt">security_reports</span><span class="w"> </span><span class="err">\</span>
<span class="w">        </span><span class="nt">--format</span><span class="w"> </span><span class="nt">json</span><span class="o">,</span><span class="nt">sarif</span>
<span class="w">    </span><span class="nt">-</span><span class="w"> </span><span class="o">|</span>
<span class="w">      </span><span class="nt">CRITICAL</span><span class="o">=$(</span><span class="nt">jq</span><span class="w"> </span><span class="s1">&#39;.summary.critical_issues&#39;</span><span class="w"> </span><span class="nt">security_reports</span><span class="o">/</span><span class="nt">security_report</span><span class="p">.</span><span class="nc">json</span><span class="o">)</span>
<span class="w">      </span><span class="nt">if</span><span class="w"> </span><span class="cp">[</span><span class="w"> </span><span class="s2">&quot;$CRITICAL&quot;</span><span class="w"> </span><span class="na">-gt</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="cp">]</span><span class="o">;</span><span class="w"> </span><span class="nt">then</span>
<span class="w">        </span><span class="nt">echo</span><span class="w"> </span><span class="s2">&quot;❌ Обнаружены критические уязвимости!&quot;</span>
<span class="w">        </span><span class="nt">exit</span><span class="w"> </span><span class="nt">1</span>
<span class="w">      </span><span class="nt">fi</span>
<span class="w">  </span><span class="nt">artifacts</span><span class="o">:</span>
<span class="w">    </span><span class="nt">paths</span><span class="o">:</span>
<span class="w">      </span><span class="nt">-</span><span class="w"> </span><span class="nt">security_reports</span><span class="o">/</span>
<span class="w">    </span><span class="nt">reports</span><span class="o">:</span>
<span class="w">      </span><span class="nt">sast</span><span class="o">:</span><span class="w"> </span><span class="nt">security_reports</span><span class="o">/</span><span class="nt">security_report</span><span class="p">.</span><span class="nc">sarif</span>
</code></pre></div>

<h3 id="programmnoe-ispolzovanie">Программное использование<a class="heading-anchor" href="#programmnoe-ispolzovanie" title="Link to this section">&para;</a></h3>
<p><strong>Ситуация:</strong> Генерация отчётов из кода на Python.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.security.file_scanner</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileSecurityScanner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.security.report_generator</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReportGenerator</span>

<span class="c1"># Инициализация сканера</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">FileSecurityScanner</span><span class="p">()</span>

<span class="c1"># Запуск сканирования</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan_project</span><span class="p">(</span><span class="s1">&#39;/path/to/project&#39;</span><span class="p">)</span>

<span class="c1"># Генерация отчёта</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">ReportGenerator</span><span class="p">()</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s1">&#39;My Project&#39;</span><span class="p">,</span>
    <span class="n">project_path</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span>
    <span class="n">scan_result</span><span class="o">=</span><span class="n">result</span>
<span class="p">)</span>

<span class="c1"># Сохранение в нескольких форматах</span>
<span class="n">output_files</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">save_report</span><span class="p">(</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;./reports&#39;</span><span class="p">,</span>
    <span class="n">formats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;markdown&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="s1">&#39;sarif&#39;</span><span class="p">],</span>
    <span class="n">language</span><span class="o">=</span><span class="s1">&#39;ru&#39;</span>  <span class="c1"># Локализация на русский язык</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Отчёт сохранён в: </span><span class="si">{</span><span class="n">output_files</span><span class="p">[</span><span class="s1">&#39;markdown&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="obnaruzhivaemye-shablony-uyazvimostey">Обнаруживаемые шаблоны уязвимостей<a class="heading-anchor" href="#obnaruzhivaemye-shablony-uyazvimostey" title="Link to this section">&para;</a></h3>
<p>Сканер безопасности выявляет шаблоны, специфичные для Django/Python:</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ID шаблона</th>
<th>Уровень серьёзности</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>FILE_SECRET_FALLBACK_001</td>
<td>Критический</td>
<td>SECRET_KEY с небезопасным резервным значением</td>
</tr>
<tr>
<td>FILE_DJANGO_DEBUG_001</td>
<td>Критический</td>
<td>DEBUG=True в продакшене</td>
</tr>
<tr>
<td>FILE_CORS_001</td>
<td>Высокий</td>
<td>CORS_ALLOW_ALL_ORIGINS=True</td>
</tr>
<tr>
<td>FILE_HOSTS_001</td>
<td>Высокий</td>
<td>ALLOWED_HOSTS=[‘*’]</td>
</tr>
<tr>
<td>FILE_DB_001</td>
<td>Высокий</td>
<td>Стандартный пароль базы данных</td>
</tr>
<tr>
<td>FILE_JWT_001</td>
<td>Высокий</td>
<td>Срок действия JWT-токена &gt; 24 часов</td>
</tr>
<tr>
<td>FILE_PATH_001</td>
<td>Высокий</td>
<td>Риск перехода по путям (path traversal)</td>
</tr>
<tr>
<td>FILE_DEBUG_PERM_001</td>
<td>Высокий</td>
<td>Права доступа зависят от DEBUG</td>
</tr>
<tr>
<td>FILE_TOOLBAR_001</td>
<td>Средний</td>
<td>Debug toolbar включён безусловно</td>
</tr>
<tr>
<td>FILE_PAGESIZE_001</td>
<td>Средний</td>
<td>PAGE_SIZE &gt; 1000 (риск DoS)</td>
</tr>
</tbody>
</table></div>
<h3 id="razdel-sootvetstviya-d3fend">Раздел соответствия D3FEND<a class="heading-anchor" href="#razdel-sootvetstviya-d3fend" title="Link to this section">&para;</a></h3>
<p>Отчёты включают соответствие стандарту MITRE D3FEND по повышению защищённости исходного кода:</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>

<h2 id="sootvetstvie-d3fend-ukrepleniyu-ishodnogo-koda">Соответствие D3FEND укреплению исходного кода<a class="heading-anchor" href="#sootvetstvie-d3fend-ukrepleniyu-ishodnogo-koda" title="Link to this section">&para;</a></h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Техника</th>
<th>Название</th>
<th>Статус</th>
<th>Применимость</th>
</tr>
</thead>
<tbody>
<tr>
<td>D3-CS</td>
<td>Очистка учётных данных</td>
<td>✅</td>
<td>Применимо для Python</td>
</tr>
<tr>
<td>D3-DLV</td>
<td>Валидация доменной логики</td>
<td>✅</td>
<td>Применимо для Python</td>
</tr>
<tr>
<td>D3-OLV</td>
<td>Валидация операционной логики</td>
<td>✅</td>
<td>Применимо для Python</td>
</tr>
<tr>
<td>D3-VI</td>
<td>Инициализация переменных</td>
<td>N/A</td>
<td>Только C/C++</td>
</tr>
</tbody>
</table></div>
<p><strong>Общий показатель соответствия:</strong> 100% (3/3 применимых техник)</p>
<h2 id="tipovye-rabochie-protsessy">Типовые рабочие процессы<a class="heading-anchor" href="#tipovye-rabochie-protsessy" title="Link to this section">&para;</a></h2>
<h3 id="ezhednevnaya-proverka-bezopasnosti">Ежедневная проверка безопасности<a class="heading-anchor" href="#ezhednevnaya-proverka-bezopasnosti" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span>Утренний<span class="w"> </span>анализ<span class="w"> </span>безопасности
<span class="o">/</span><span class="nv">select</span><span class="w"> </span><span class="mi">02</span>
<span class="o">&gt;</span><span class="w"> </span>Найти<span class="w"> </span>уязвимости<span class="w"> </span>в<span class="w"> </span>недавно<span class="w"> </span>изменённых<span class="w"> </span>файлах
<span class="o">/</span><span class="nv">review</span><span class="w"> </span><span class="nv">git</span>
<span class="o">/</span><span class="k">exit</span>
</code></pre></div>

<h3 id="ezhenedelnaya-proverka-kachestva-koda">Еженедельная проверка качества кода<a class="heading-anchor" href="#ezhenedelnaya-proverka-kachestva-koda" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code># Еженедельный анализ качества
/select 05
&gt; Найти неиспользуемый код, появившийся на этой неделе

/select 12
&gt; Показать сводку по техническому долгу

/select 07
&gt; Какие новые функции не покрыты тестами?
</code></pre></div>

<h3 id="audit-pered-relizom">Аудит перед релизом<a class="heading-anchor" href="#audit-pered-relizom" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Перед основным релизом
/select 08
<span class="k">&gt; </span><span class="ge">Сгенерировать отчёт о соответствии OWASP Top 10</span>

/select 02
<span class="k">&gt; </span><span class="ge">Найти все критические уязвимости</span>

/review git --format json &gt; audit_report.json
</code></pre></div>

<h3 id="onbording-novogo-razrabotchika">Онбординг нового разработчика<a class="heading-anchor" href="#onbording-novogo-razrabotchika" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Настройка первого дня
/select 01
<span class="k">&gt; </span><span class="ge">Объясни общую архитектуру</span>
<span class="k">&gt; </span><span class="ge">Какие основные подсистемы существуют?</span>
<span class="k">&gt; </span><span class="ge">С какого места лучше начать изучение кода?</span>

/save onboarding_session
</code></pre></div>

<hr />
<h2 id="temy">Темы<a class="heading-anchor" href="#temy" title="Link to this section">&para;</a></h2>
<h3 id="dostupnye-temy">Доступные темы<a class="heading-anchor" href="#dostupnye-temy" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Тема</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>default</td>
<td>Акценты бирюзового цвета, сбалансированный контраст</td>
</tr>
<tr>
<td>dark</td>
<td>Акценты пурпурного цвета, подходит для тёмного фона</td>
</tr>
<tr>
<td>light</td>
<td>Акценты синего цвета, подходит для светлого терминала</td>
</tr>
</tbody>
</table></div>
<h3 id="ispolzovanie-tem">Использование тем<a class="heading-anchor" href="#ispolzovanie-tem" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code># Через командную строку
python -m src.tui.app --theme dark

# В config.yaml
tui:
  theme: dark
</code></pre></div>

<h3 id="elementy-temy">Элементы темы<a class="heading-anchor" href="#elementy-temy" title="Link to this section">&para;</a></h3>
<p>Темы настраивают:
- Цвета заголовка и подзаголовка
- Цвета сообщений (пользователя, ассистента, системы, ошибки)
- Цвета рамок
- Индикаторы сценариев
- Подсветку кода
- Индикаторы выполнения</p>
<hr />
<h2 id="sessii">Сессии<a class="heading-anchor" href="#sessii" title="Link to this section">&para;</a></h2>
<h3 id="avtomaticheskoe-upravlenie-sessiyami">Автоматическое управление сессиями<a class="heading-anchor" href="#avtomaticheskoe-upravlenie-sessiyami" title="Link to this section">&para;</a></h3>
<p>Сессии автоматически:
- Создаются при запуске TUI
- Сохраняются периодически во время использования
- Сохраняются при выходе</p>
<h3 id="ruchnoe-upravlenie-sessiyami">Ручное управление сессиями<a class="heading-anchor" href="#ruchnoe-upravlenie-sessiyami" title="Link to this section">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">save</span><span class="w">              </span><span class="c1"># Сохранить текущую сессию</span>
<span class="o">/</span><span class="n">save</span><span class="w"> </span><span class="n">analysis_v2</span><span class="w">  </span><span class="c1"># Сохранить с указанием пользовательского имени</span>
<span class="o">/</span><span class="nb">load</span><span class="w">              </span><span class="c1"># Вывести список сессий</span>
<span class="o">/</span><span class="nb">load</span><span class="w"> </span><span class="n">analysis_v2</span><span class="w">  </span><span class="c1"># Загрузить конкретную сессию</span>
</code></pre></div>

<h3 id="soderzhimoe-sessii">Содержимое сессии<a class="heading-anchor" href="#soderzhimoe-sessii" title="Link to this section">&para;</a></h3>
<p>Сессии содержат:
- Историю диалога
- Текущий сценарий
- Состояние конфигурации
- Контекст проекта
- Метаданные (временные метки, количество сообщений)</p>
<h3 id="raspolozhenie-hranilischa-sessiy">Расположение хранилища сессий<a class="heading-anchor" href="#raspolozhenie-hranilischa-sessiy" title="Link to this section">&para;</a></h3>
<p>По умолчанию: <code>./sessions/</code></p>
<p>Пользовательский путь: <code>python -m src.tui.app --session-dir /путь/к/сессиям</code></p>
<hr />
<h2 id="sovety-i-rekomendatsii">Советы и рекомендации<a class="heading-anchor" href="#sovety-i-rekomendatsii" title="Link to this section">&para;</a></h2>
<h3 id="goryachie-klavishi">Горячие клавиши<a class="heading-anchor" href="#goryachie-klavishi" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Клавиша</th>
<th>Действие</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ctrl+C</td>
<td>Отменить текущий ввод</td>
</tr>
<tr>
<td>Ctrl+D</td>
<td>Выйти (с подтверждением)</td>
</tr>
<tr>
<td>Стрелка вверх</td>
<td>Предыдущая команда (readline)</td>
</tr>
<tr>
<td>Стрелка вниз</td>
<td>Следующая команда (readline)</td>
</tr>
</tbody>
</table></div>
<h3 id="psevdonimy-komand">Псевдонимы команд<a class="heading-anchor" href="#psevdonimy-komand" title="Link to this section">&para;</a></h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Псевдоним</th>
<th>Команда</th>
</tr>
</thead>
<tbody>
<tr>
<td>/h</td>
<td>/help</td>
</tr>
<tr>
<td>/q</td>
<td>/exit</td>
</tr>
<tr>
<td>/quit</td>
<td>/exit</td>
</tr>
<tr>
<td>/stats</td>
<td>/stat</td>
</tr>
<tr>
<td>/sql</td>
<td>/query</td>
</tr>
<tr>
<td>/proj</td>
<td>/project</td>
</tr>
<tr>
<td>/grp</td>
<td>/group</td>
</tr>
<tr>
<td>/sess</td>
<td>/session</td>
</tr>
<tr>
<td>/whoami</td>
<td>/auth me</td>
</tr>
</tbody>
</table></div>
<h3 id="effektivnye-rabochie-protsessy">Эффективные рабочие процессы<a class="heading-anchor" href="#effektivnye-rabochie-protsessy" title="Link to this section">&para;</a></h3>
<p><strong>Быстрый аудит безопасности:</strong></p>
<div class="highlight"><pre><span></span><code>/select 2
Найти уязвимости к SQL-инъекциям
Найти риски командных инъекций
Найти уязвимости к XSS
</code></pre></div>

<p><strong>Исследование кода:</strong></p>
<div class="highlight"><pre><span></span><code>/select 1
Что делает функция main?
Покажи граф вызовов для функции X
</code></pre></div>

<p><strong>Процесс проверки кода:</strong></p>
<div class="highlight"><pre><span></span><code>/review git
<span class="gh">#</span> Просмотр результатов
/save security_review_dec9
</code></pre></div>

<h3 id="sovety-po-zaprosam">Советы по запросам<a class="heading-anchor" href="#sovety-po-zaprosam" title="Link to this section">&para;</a></h3>
<ol>
<li><strong>Будьте конкретны</strong>: “Найти SQL-инъекции в модуле аутентификации” лучше, чем “Найти SQL-инъекции”</li>
<li><strong>Используйте контекст сценария</strong>: Выберите подходящий сценарий перед выполнением запроса</li>
<li><strong>Сначала проверьте статистику</strong>: Используйте <code>/stat</code>, чтобы понять размер базы данных</li>
<li><strong>Используйте SQL для точности</strong>: <code>/query SELECT * FROM nodes_method WHERE name LIKE '%auth%'</code></li>
</ol>
<hr />
<h2 id="ustranenie-nepoladok">Устранение неполадок<a class="heading-anchor" href="#ustranenie-nepoladok" title="Link to this section">&para;</a></h2>
<h3 id="rasprostranyonnye-problemy">Распространённые проблемы<a class="heading-anchor" href="#rasprostranyonnye-problemy" title="Link to this section">&para;</a></h3>
<h4 id="copilot-nedostupen">«Copilot недоступен»<a class="heading-anchor" href="#copilot-nedostupen" title="Link to this section">&para;</a></h4>
<p><strong>Причина</strong>: ChromaDB не установлен или инициализация не удалась.</p>
<p><strong>Решения:</strong></p>
<div class="highlight"><pre><span></span><code>pip install chromadb
# или
pip install -r requirements.txt
</code></pre></div>

<h4 id="baza-dannyh-ne-naydena">«База данных не найдена»<a class="heading-anchor" href="#baza-dannyh-ne-naydena" title="Link to this section">&para;</a></h4>
<p><strong>Причина</strong>: Отсутствует база данных CPG.</p>
<p><strong>Решения:</strong>
1. Импортируйте проект:</p>
<div class="highlight"><pre><span></span><code>bash
   python -m src.cli.import_commands full --path ./mycode
</code></pre></div>

<ol start="2">
<li>Проверьте конфигурацию проекта:</li>
</ol>
<div class="highlight"><pre><span></span><code>bash
   /project list
</code></pre></div>

<h4 id="oshibka-postavschika-llm">«Ошибка поставщика LLM»<a class="heading-anchor" href="#oshibka-postavschika-llm" title="Link to this section">&para;</a></h4>
<p><strong>Причина</strong>: Отсутствуют учётные данные API.</p>
<p><strong>Решения:</strong>
1. Проверьте переменные окружения:</p>
<div class="highlight"><pre><span></span><code>bash
   echo $GIGACHAT_CREDENTIALS
   echo $OPENAI_API_KEY
</code></pre></div>

<ol start="2">
<li>Проверьте config.yaml:</li>
</ol>
<div class="highlight"><pre><span></span><code>bash
   /config llm
</code></pre></div>

<h4 id="medlennye-otvety">Медленные ответы<a class="heading-anchor" href="#medlennye-otvety" title="Link to this section">&para;</a></h4>
<p><strong>Причина</strong>: Большая база данных или задержка в сети.</p>
<p><strong>Решения:</strong>
1. Проверьте статистику базы данных: <code>/stat</code>
2. Используйте более конкретные запросы
3. Рассмотрите возможность использования локального поставщика LLM
4. Уменьшите размер контекста в config.yaml:</p>
<div class="highlight"><pre><span></span><code>yaml
   llm:
     local:
       n_ctx: 4096  # Уменьшить с 8192
</code></pre></div>

<h4 id="problemy-s-kodirovkoy-simvolov-windows">Проблемы с кодировкой символов (Windows)<a class="heading-anchor" href="#problemy-s-kodirovkoy-simvolov-windows" title="Link to this section">&para;</a></h4>
<p><strong>Причина</strong>: Несоответствие кодировки терминала.</p>
<p><strong>Решения:</strong></p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">Установите</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">в</span><span class="w"> </span><span class="n">PowerShell</span>
<span class="o">[</span><span class="n">Console</span><span class="o">]::</span><span class="n">OutputEncoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">System.Text.Encoding</span><span class="o">]::</span><span class="n">UTF8</span>

<span class="err">#</span><span class="w"> </span><span class="n">Или</span><span class="w"> </span><span class="n">используйте</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="n">Terminal</span><span class="w"> </span><span class="p">(</span><span class="n">рекомендуется</span><span class="p">)</span>
</code></pre></div>

<h3 id="rezhim-otladki">Режим отладки<a class="heading-anchor" href="#rezhim-otladki" title="Link to this section">&para;</a></h3>
<p>Включите логирование отладки для диагностики:</p>
<div class="highlight"><pre><span></span><code>python -m src.tui.app --debug
</code></pre></div>

<p>Это позволяет увидеть:
- Вызовы API LLM
- Запросы к базе данных
- Операции поиска
- Трассировки ошибок</p>
<h3 id="fayly-zhurnalov-logov">Файлы журналов (логов)<a class="heading-anchor" href="#fayly-zhurnalov-logov" title="Link to this section">&para;</a></h3>
<p>Журналы записываются в файл <code>logs/tui.log</code> (если настроено).</p>
<h3 id="poluchenie-pomoschi">Получение помощи<a class="heading-anchor" href="#poluchenie-pomoschi" title="Link to this section">&para;</a></h3>
<ul>
<li>Введите <code>/help</code> для справки по командам</li>
<li>Введите <code>/help &lt;команда&gt;</code> для справки по конкретной команде</li>
<li>Проверьте логи в каталоге <code>logs/</code></li>
<li>Сообщите о проблемах: https://github.com/anthropics/claude-code/issues</li>
</ul>
<hr />
<h2 id="smotrite-takzhe">Смотрите также<a class="heading-anchor" href="#smotrite-takzhe" title="Link to this section">&para;</a></h2>
<ul>
<li><a href="./CLI_GUIDE.html">Руководство CLI</a> — Интерфейс командной строки</li>
<li><a href="./SCENARIOS.html">Сценарии</a> — Использование сценариев в программном коде</li>
<li><a href="../api/REST_API.html">REST API</a> — Справочник по HTTP API</li>
<li><a href="../reference/SECURITY.html">Безопасность</a> — Функции безопасности</li>
</ul>
<hr />
<p><em>Создано для CodeGraph v1.0</em></p>
      </article>

      <!-- Page Navigation -->
      <nav class="doc-page-nav">

      <a href="QUICK_REFERENCE.html" class="doc-page-nav-prev">
        <span class="doc-page-nav-label">Назад</span>
        <span class="doc-page-nav-title">Краткое руководство по CodeGraph</span>
      </a>

      <a href="CLI_GUIDE.html" class="doc-page-nav-next">
        <span class="doc-page-nav-label">Вперед</span>
        <span class="doc-page-nav-title">Руководство по CLI</span>
      </a>
    </nav>

      <!-- Footer -->
      <footer class="doc-footer">
        <span>Обновлено: 2025-12-25</span>
        <a href="https://github.com/your-org/codegraph/edit/main/docs/guides/TUI_USER_GUIDE.md" target="_blank" rel="noopener">Редактировать на GitHub</a>
      </footer>
    </main>

    <!-- Table of Contents -->
    <aside class="doc-toc">
      <div class="doc-toc-title">На этой странице</div>
      <ul class="doc-toc-list">
        <li><a href="#rukovodstvo-polzovatelya-codegraph" class="level-1">Руководство пользователя CodeGraph</a></li>
<li><a href="#soderzhanie" class="level-2">Содержание</a></li>
<li><a href="#bystryy-start" class="level-2">Быстрый старт</a></li>
<li><a href="#ustanovka" class="level-3">Установка</a></li>
<li><a href="#kloniruyte-repozitoriy-i-ustanovite-zavisimosti" class="level-1">Клонируйте репозиторий и установите зависимости</a></li>
<li><a href="#nastroyte-uchetnye-dannye-api-vyberite-odin-variant" class="level-1">Настройте учетные данные API (выберите один вариант)</a></li>
<li><a href="#ili" class="level-1">ИЛИ</a></li>
<li><a href="#zapusk-tui" class="level-3">Запуск TUI</a></li>
<li><a href="#vash-pervyy-zapros" class="level-3">Ваш первый запрос</a></li>
<li><a href="#osnovnye-komandy" class="level-3">Основные команды</a></li>
<li><a href="#stsenarii-dlya-razrabotchikov" class="level-2">Сценарии для разработчиков</a></li>
<li><a href="#den-1-osvoenie-kodovoy-bazy" class="level-3">День 1: Освоение кодовой базы</a></li>
<li><a href="#poisk-opredeleniy-funktsiy" class="level-3">Поиск определений функций</a></li>
<li><a href="#dobavlenie-novyh-funktsiy" class="level-3">Добавление новых функций</a></li>
<li><a href="#pomosch-pri-otladke" class="level-3">Помощь при отладке</a></li>
<li><a href="#refaktoring-koda" class="level-3">Рефакторинг кода</a></li>
<li><a href="#stsenarii-dlya-qatestirovschikov" class="level-2">Сценарии для QA/тестировщиков</a></li>
<li><a href="#analiz-pokrytiya-testami" class="level-3">Анализ покрытия тестами</a></li>
<li><a href="#pomosch-pri-kod-revyu" class="level-3">Помощь при код-ревью</a></li>
<li><a href="#generatsiya-testovyh-stsenariev" class="level-3">Генерация тестовых сценариев</a></li>
<li><a href="#stsenarii-spetsialista-po-informatsionnoy-bezopasnosti" class="level-2">Сценарии специалиста по информационной безопасности</a></li>
<li><a href="#skanirovanie-uyazvimostey" class="level-3">Сканирование уязвимостей</a></li>
<li><a href="#analiz-potoka-zarazhyonnyh-dannyh-taint-flow-analysis" class="level-3">Анализ потока заражённых данных (Taint Flow Analysis)</a></li>
<li><a href="#ukreplenie-ishodnogo-koda-po-d3fend" class="level-3">Укрепление исходного кода по D3FEND</a></li>
<li><a href="#stsenarii-dlya-tehnicheskogo-pisatelya" class="level-2">Сценарии для технического писателя</a></li>
<li><a href="#generatsiya-dokumentatsii-po-api" class="level-3">Генерация документации по API</a></li>
<li><a href="#ponimanie-arhitektury-modulya" class="level-3">Понимание архитектуры модуля</a></li>
<li><a href="#sozdanie-spravochnika-funktsiy" class="level-3">Создание справочника функций</a></li>
<li><a href="#spravochnik-komand-tui" class="level-2">Справочник команд TUI</a></li>
<li><a href="#vse-komandy" class="level-3">Все команды</a></li>
<li><a href="#podrobnoe-opisanie-komand" class="level-3">Подробное описание команд</a></li>
<li><a href="#pokazat-informatsiyu-o-tekuschem-proekte" class="level-1">Показать информацию о текущем проекте</a></li>
<li><a href="#spisok-vseh-dostupnyh-proektov" class="level-1">Список всех доступных проектов</a></li>
<li><a href="#pereklyuchitsya-na-drugoy-proekt" class="level-1">Переключиться на другой проект</a></li>
<li><a href="#dobavit-novyy-proekt" class="level-1">Добавить новый проект</a></li>
<li><a href="#primer-pereklyuchenie-na-proekt-pythondjango" class="level-1">Пример: переключение на проект Python/Django</a></li>
<li><a href="#vyvod-domen-aktivirovan-python-django" class="level-1">Вывод: Домен активирован: python_django</a></li>
<li><a href="#primer-vozvrat-k-proektu-na-c" class="level-1">Пример: возврат к проекту на C</a></li>
<li><a href="#vyvod-domen-aktivirovan-postgresql" class="level-1">Вывод: Домен активирован: postgresql</a></li>
<li><a href="#pokazat-vse-stsenarii" class="level-1">Показать все сценарии</a></li>
<li><a href="#filtratsiya-po-gruppe" class="level-1">Фильтрация по группе</a></li>
<li><a href="#vybor-po-nomeru" class="level-1">Выбор по номеру</a></li>
<li><a href="#pokazat-vse-razdely-konfiguratsii" class="level-1">Показать все разделы конфигурации</a></li>
<li><a href="#pokazat-konkretnyy-razdel" class="level-1">Показать конкретный раздел</a></li>
<li><a href="#ustanovit-znachenie" class="level-1">Установить значение</a></li>
<li><a href="#prostye-zaprosy" class="level-1">Простые запросы</a></li>
<li><a href="#opisanie-tablits" class="level-1">Описание таблиц</a></li>
<li><a href="#slozhnye-zaprosy" class="level-1">Сложные запросы</a></li>
<li><a href="#interaktivnyy-rezhim-vybor-istochnika" class="level-1">Интерактивный режим (выбор источника)</a></li>
<li><a href="#github-pr" class="level-1">GitHub PR</a></li>
<li><a href="#gitlab-mr" class="level-1">GitLab MR</a></li>
<li><a href="#lokalnye-izmeneniya-v-git" class="level-1">Локальные изменения в git</a></li>
<li><a href="#fayl-patcha" class="level-1">Файл патча</a></li>
<li><a href="#rukovodstvo-po-nastroyke" class="level-2">Руководство по настройке</a></li>
<li><a href="#nastroyka-postavschika-llm" class="level-3">Настройка поставщика LLM</a></li>
<li><a href="#configyaml" class="level-1">config.yaml</a></li>
<li><a href="#peremennaya-okruzheniya" class="level-1">Переменная окружения</a></li>
<li><a href="#configyaml" class="level-1">config.yaml</a></li>
<li><a href="#peremennaya-okruzheniya" class="level-1">Переменная окружения</a></li>
<li><a href="#configyaml" class="level-1">config.yaml</a></li>
<li><a href="#nastroyki-poiska" class="level-3">Настройки поиска</a></li>
<li><a href="#ogranicheniya-zaprosov" class="level-3">Ограничения запросов</a></li>
<li><a href="#prilozhenie-vse-16-stsenariev" class="level-2">Приложение: Все 16 сценариев</a></li>
<li><a href="#rukovodstvo-po-vyboru-stsenariev" class="level-3">Руководство по выбору сценариев</a></li>
<li><a href="#otchyoty-o-proverke-bezopasnosti-cli" class="level-2">Отчёты о проверке безопасности (CLI)</a></li>
<li><a href="#obzor" class="level-3">Обзор</a></li>
<li><a href="#stsenariy-proverka-bezopasnosti-proekta-na-django" class="level-3">Сценарий: Проверка безопасности проекта на Django</a></li>
<li><a href="#otchyot-po-bezopasnosti-my-django-project" class="level-1">Отчёт по безопасности: My Django Project</a></li>
<li><a href="#kratkoe-rezyume" class="level-2">Краткое резюме</a></li>
<li><a href="#kriticheskiy-uroven-uyazvimosti-2" class="level-2">🔴 КРИТИЧЕСКИЙ уровень уязвимости (2)</a></li>
<li><a href="#1-secret-key-s-rezervnym-znacheniem-skanirovanie-faylov" class="level-3">1. SECRET_KEY с резервным значением (сканирование файлов)</a></li>
<li><a href="#stsenariy-bystraya-proverka-bezopasnosti" class="level-3">Сценарий: Быстрая проверка безопасности</a></li>
<li><a href="#stsenariy-integratsiya-v-cicd" class="level-3">Сценарий: Интеграция в CI/CD</a></li>
<li><a href="#programmnoe-ispolzovanie" class="level-3">Программное использование</a></li>
<li><a href="#initsializatsiya-skanera" class="level-1">Инициализация сканера</a></li>
<li><a href="#zapusk-skanirovaniya" class="level-1">Запуск сканирования</a></li>
<li><a href="#generatsiya-otchyota" class="level-1">Генерация отчёта</a></li>
<li><a href="#sohranenie-v-neskolkih-formatah" class="level-1">Сохранение в нескольких форматах</a></li>
<li><a href="#obnaruzhivaemye-shablony-uyazvimostey" class="level-3">Обнаруживаемые шаблоны уязвимостей</a></li>
<li><a href="#razdel-sootvetstviya-d3fend" class="level-3">Раздел соответствия D3FEND</a></li>
<li><a href="#sootvetstvie-d3fend-ukrepleniyu-ishodnogo-koda" class="level-2">Соответствие D3FEND укреплению исходного кода</a></li>
<li><a href="#tipovye-rabochie-protsessy" class="level-2">Типовые рабочие процессы</a></li>
<li><a href="#ezhednevnaya-proverka-bezopasnosti" class="level-3">Ежедневная проверка безопасности</a></li>
<li><a href="#utrenniy-analiz-bezopasnosti" class="level-1">Утренний анализ безопасности</a></li>
<li><a href="#ezhenedelnaya-proverka-kachestva-koda" class="level-3">Еженедельная проверка качества кода</a></li>
<li><a href="#ezhenedelnyy-analiz-kachestva" class="level-1">Еженедельный анализ качества</a></li>
<li><a href="#audit-pered-relizom" class="level-3">Аудит перед релизом</a></li>
<li><a href="#pered-osnovnym-relizom" class="level-1">Перед основным релизом</a></li>
<li><a href="#onbording-novogo-razrabotchika" class="level-3">Онбординг нового разработчика</a></li>
<li><a href="#nastroyka-pervogo-dnya" class="level-1">Настройка первого дня</a></li>
<li><a href="#temy" class="level-2">Темы</a></li>
<li><a href="#dostupnye-temy" class="level-3">Доступные темы</a></li>
<li><a href="#ispolzovanie-tem" class="level-3">Использование тем</a></li>
<li><a href="#cherez-komandnuyu-stroku" class="level-1">Через командную строку</a></li>
<li><a href="#v-configyaml" class="level-1">В config.yaml</a></li>
<li><a href="#elementy-temy" class="level-3">Элементы темы</a></li>
<li><a href="#sessii" class="level-2">Сессии</a></li>
<li><a href="#avtomaticheskoe-upravlenie-sessiyami" class="level-3">Автоматическое управление сессиями</a></li>
<li><a href="#ruchnoe-upravlenie-sessiyami" class="level-3">Ручное управление сессиями</a></li>
<li><a href="#soderzhimoe-sessii" class="level-3">Содержимое сессии</a></li>
<li><a href="#raspolozhenie-hranilischa-sessiy" class="level-3">Расположение хранилища сессий</a></li>
<li><a href="#sovety-i-rekomendatsii" class="level-2">Советы и рекомендации</a></li>
<li><a href="#goryachie-klavishi" class="level-3">Горячие клавиши</a></li>
<li><a href="#psevdonimy-komand" class="level-3">Псевдонимы команд</a></li>
<li><a href="#effektivnye-rabochie-protsessy" class="level-3">Эффективные рабочие процессы</a></li>
<li><a href="#prosmotr-rezultatov" class="level-1">Просмотр результатов</a></li>
<li><a href="#sovety-po-zaprosam" class="level-3">Советы по запросам</a></li>
<li><a href="#ustranenie-nepoladok" class="level-2">Устранение неполадок</a></li>
<li><a href="#rasprostranyonnye-problemy" class="level-3">Распространённые проблемы</a></li>
<li><a href="#ili" class="level-1">или</a></li>
<li><a href="#ustanovite-utf-8-v-powershell" class="level-1">Установите UTF-8 в PowerShell</a></li>
<li><a href="#ili-ispolzuyte-windows-terminal-rekomenduetsya" class="level-1">Или используйте Windows Terminal (рекомендуется)</a></li>
<li><a href="#rezhim-otladki" class="level-3">Режим отладки</a></li>
<li><a href="#fayly-zhurnalov-logov" class="level-3">Файлы журналов (логов)</a></li>
<li><a href="#poluchenie-pomoschi" class="level-3">Получение помощи</a></li>
<li><a href="#smotrite-takzhe" class="level-2">Смотрите также</a></li>
      </ul>
    </aside>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../../../assets/svg/logo.svg" alt="CodeGraph" width="160" height="40">
          <p>AI-копилот для анализа исходного кода</p>
        </div>
        <div class="footer-links">
          <div class="footer-links-group">
            <h4>Продукт</h4>
            <ul class="footer-links-list">
              <li><a href="../../../index.html#features" class="footer-link">Возможности</a></li>
              <li><a href="../../../index.html#integrations" class="footer-link">Интеграции</a></li>
              <li><a href="../../../index.html#faq" class="footer-link">FAQ</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Документация</h4>
            <ul class="footer-links-list">
              <li><a href="../getting-started/index.html" class="footer-link">Начало работы</a></li>
              <li><a href="../guides/index.html" class="footer-link">Руководства</a></li>
              <li><a href="../api/index.html" class="footer-link">API</a></li>
              <li><a href="../enterprise/index.html" class="footer-link">Enterprise</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Ресурсы</h4>
            <ul class="footer-links-list">
              <li><a href="../../../whitepaper.html" class="footer-link">Whitepaper</a></li>
            </ul>
          </div>
          <div class="footer-links-group">
            <h4>Контакты</h4>
            <ul class="footer-links-list">
              <li><a href="mailto:hello@codegraph.ru" class="footer-link">hello@codegraph.ru</a></li>
              <li><a href="https://t.me/codegraph" class="footer-link" target="_blank" rel="noopener">Telegram</a></li>
              <li><a href="https://github.com/codegraph" class="footer-link" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
            <div class="footer-social">
              <a href="https://t.me/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="Telegram">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
              <a href="https://github.com/codegraph" class="footer-social-link" target="_blank" rel="noopener" aria-label="GitHub">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 CodeGraph. Все права защищены.</p>
      </div>
    </div>
  </footer>

  <script src="../../../js/main.js"></script>
</body>
</html>
